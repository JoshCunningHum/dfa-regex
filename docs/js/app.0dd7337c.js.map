{"version":3,"file":"js/app.0dd7337c.js","mappings":"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","sources":["webpack://dfa-regex/./node_modules/cli-table/node_modules/colors/lib/ sync","webpack://dfa-regex/./src/App.vue","webpack://dfa-regex/./src/commons/input/InputProcessorEvent.js","webpack://dfa-regex/./src/commons/input/InputProcessor.js","webpack://dfa-regex/./src/commons/Util.js","webpack://dfa-regex/./src/commons/graph/State.js","webpack://dfa-regex/./src/stores/stateStore.js","webpack://dfa-regex/./src/commons/graph/Transition.js","webpack://dfa-regex/./src/stores/transitionStore.js","webpack://dfa-regex/./src/stores/alphabetStore.js","webpack://dfa-regex/./src/commons/canvas/Drawables.js","webpack://dfa-regex/./src/stores/mouseStore.js","webpack://dfa-regex/./src/stores/modeStore.js","webpack://dfa-regex/./src/commons/canvas/CanvasInit.js","webpack://dfa-regex/./src/commons/Local.js","webpack://dfa-regex/./src/stores/fileStore.js","webpack://dfa-regex/./src/stores/settingsStore.js","webpack://dfa-regex/./src/stores/mainStore.js","webpack://dfa-regex/./src/components/FSMVisualizer.vue","webpack://dfa-regex/./src/components/FSMVisualizer.vue?05df","webpack://dfa-regex/./src/components/AlphabetLister.vue","webpack://dfa-regex/./src/components/AlphabetLister.vue?6bc6","webpack://dfa-regex/./src/components/TransitionFab.vue","webpack://dfa-regex/./src/components/TransitionFab.vue?3a33","webpack://dfa-regex/./src/components/StateHelper.vue","webpack://dfa-regex/./src/components/StateHelper.vue?1035","webpack://dfa-regex/./src/components/SettingsMenu.vue","webpack://dfa-regex/./src/components/SettingsMenu.vue?6704","webpack://dfa-regex/./src/components/SaveFile.vue","webpack://dfa-regex/./src/components/SaveFile.vue?ad0d","webpack://dfa-regex/./src/App.vue?7ccd","webpack://dfa-regex/./src/plugins/vuetify.js","webpack://dfa-regex/./src/plugins/webfontloader.js","webpack://dfa-regex/./src/main.js","webpack://dfa-regex/./src/plugins/noam.js","webpack://dfa-regex/webpack/bootstrap","webpack://dfa-regex/webpack/runtime/chunk loaded","webpack://dfa-regex/webpack/runtime/compat get default export","webpack://dfa-regex/webpack/runtime/create fake namespace object","webpack://dfa-regex/webpack/runtime/define property getters","webpack://dfa-regex/webpack/runtime/ensure chunk","webpack://dfa-regex/webpack/runtime/get javascript chunk filename","webpack://dfa-regex/webpack/runtime/get mini-css chunk filename","webpack://dfa-regex/webpack/runtime/global","webpack://dfa-regex/webpack/runtime/hasOwnProperty shorthand","webpack://dfa-regex/webpack/runtime/load script","webpack://dfa-regex/webpack/runtime/make namespace object","webpack://dfa-regex/webpack/runtime/publicPath","webpack://dfa-regex/webpack/runtime/jsonp chunk loading","webpack://dfa-regex/webpack/startup"],"sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 1585;\nmodule.exports = webpackEmptyContext;","<template>\n  <v-app>\n    <v-main class=\"flex h-screen w-screen min-h-0\">\n        <!-- Options / Settings -->\n        <v-sheet width=\"400px\" class=\"p-3 flex flex-col gap-2 overflow-auto\">\n\n          <!-- Alphabet -->\n          <AlphabetLister />\n\n          <v-divider></v-divider>\n\n          <!-- Node Selector -->\n          <StateHelper />\n\n        </v-sheet>\n\n        <!-- DFA Visualizer -->\n        <v-sheet class=\"flex-grow bg-neutral-900 flex flex-col\">\n\n          <div class=\"flex flex-grow\">\n            <!-- Controls -->\n            <v-sheet height=\"100%\" width=\"50px\" color=\"#252525\" elevation=\"3\" class=\"flex flex-col gap-2 p-2 justify-between\" id=\"toolbar\">\n\n              <div class=\"flex flex-col gap-2\">\n                \n                <v-btn-toggle v-model=\"m\" class=\"flex-col gap-2 items-center w-full h-auto\" mandatory rounded=\"0\">\n\n                  <v-btn v-for=\"t in tools\" :key=\"t.name\" :value=\"t.name\">\n                    {{ t.text }}\n                    <v-tooltip\n                      activator=\"parent\"\n                      class=\"p-0\"\n                      contentClass=\"hotkey-tooltip\"\n                      >\n                      <span class=\"capitalize\">{{t.name}}</span> Mode [{{ t.hotkey }}]\n                    </v-tooltip>\n                  </v-btn>\n\n                </v-btn-toggle>\n\n              </div>\n\n              <div class=\"flex-col gap-2\">\n                <!-- Delete All -->\n                <div class=\"pt-1\">\n                  <v-btn @click=\"mainStore.deleteAll()\">  \n                    <v-tooltip\n                      activator=\"parent\"\n                      class=\"p-0\"\n                      content-class=\"hotkey-tooltip\">\n                        <span class=\"capitalize\">Delete All</span>\n                    </v-tooltip>\n                  </v-btn>\n                </div>\n\n                <!-- Import/Export -->\n                <div class=\"pt-1\">\n                <div class=\"pt-1\">\n                  <input type=\"file\" class=\"sr-only\" ref=\"fileinput\" @change=\"loadJSON\" >\n                  <v-btn\n                    @click=\"fileinput.click()\">\n                    <v-icon size=\"large\">mdi-import</v-icon>\n                    <v-tooltip\n                      activator=\"parent\"\n                      class=\"p-0\"\n                      content-class=\"hotkey-tooltip\">\n                        <span class=\"capitalize\">Import</span>\n                    </v-tooltip>\n                  </v-btn>\n                </div>\n                  <v-btn>\n                    <v-icon >mdi-export</v-icon>\n                    <v-tooltip\n                      activator=\"parent\"\n                      class=\"p-0\"\n                      content-class=\"hotkey-tooltip\">\n                        <span class=\"capitalize\">Export</span>\n                    </v-tooltip>\n                    <v-dialog\n                      activator=\"parent\">\n\n                        <SaveFile />\n\n                    </v-dialog>\n                  </v-btn>\n                </div>\n              </div>\n            </v-sheet>\n\n            <FSMVisualizer class=\"flex-grow\" />\n\n          </div>\n\n          <v-sheet class=\"flex items-center\" color=\"#2A2A2A\">\n\n            <v-text-field v-model=\"regex\" label=\"Regex\" hideDetails rounded=\"0\" variant=\"solo-filled\" @keydown.enter=\"e => mainStore.genDFA(e.target.value)\"/>\n\n          </v-sheet>\n        </v-sheet>\n\n        <div class=\"absolute right-0 p-4\">\n          <SettingsMenu />\n        </div>\n\n    </v-main>\n  </v-app>\n  <!-- Dialog -->\n  <TransitionFab />\n</template>\n\n<script>\n\nimport { computed, ref } from 'vue';\nimport { watch } from 'vue';\nimport { reactive } from 'vue';\nimport { onMounted } from 'vue';\n\n// Stores\nimport { useMainStore } from './stores/mainStore';\nimport { useModeStore } from './stores/modeStore';\nimport { useAlphabetStore } from './stores/alphabetStore';\nimport { useTransitionStore } from './stores/transitionStore';\nimport { useStateStore } from './stores/stateStore';\nimport { useFileStore } from './stores/fileStore';\nimport { useSettingStore } from './stores/settingsStore';\n\n// Components\nimport FSMVisualizer from './components/FSMVisualizer.vue';\nimport AlphabetLister from './components/AlphabetLister.vue';\nimport TransitionFab from './components/TransitionFab.vue';\nimport StateHelper from './components/StateHelper.vue';\nimport SettingsMenu from './components/SettingsMenu.vue';\nimport SaveFile from './components/SaveFile.vue';\n\nexport default {\n  name: 'App',\n  components: {\n    FSMVisualizer,\n    AlphabetLister,\n    TransitionFab,\n    StateHelper,\n    SettingsMenu,\n    SaveFile\n  },\n  setup() {\n\n    // Initialize Store Modules\n    const mainStore = useMainStore(),\n      modeStore = useModeStore(),\n      alphabetStore = useAlphabetStore(),\n      transitionStore = useTransitionStore(),\n      stateStore = useStateStore(),\n      settingsStore = useSettingStore(),\n      fileStore = useFileStore();\n\n    const tools = reactive([\n      {\n        name: 'default',\n        text: '',\n        hotkey: 'V',\n      },\n      {\n        name: 'linking',\n        text: '',\n        hotkey: 'C',\n      },\n      {\n        name: 'delete',\n        text: '',\n        hotkey: 'D',\n      }\n    ]);\n\n    const fileinput = ref(null);\n    const regex = ref('');\n    const regexResult = computed(() => mainStore.regexResult);\n\n      watch(regexResult, v => {\n        if(v === '') return;\n\n        regex.value = regexResult.value;\n      })\n\n    const m = computed({\n      get: () => modeStore.mode,\n      set: v => modeStore.mode = v\n    });\n\n    const loadJSON = async () => {\n      const file = fileinput.value.files.length === 0 ? null : await fileinput.value.files[0].text();\n\n      if(file === null) return;\n      \n      fileStore.loadDFA(JSON.parse(file));\n    }\n    \n    // Load settings on local storage\n    settingsStore.sync();\n\n    return {\n      mainStore,\n      m,\n      tools,\n      regex,\n      fileinput,\n      loadJSON\n    }\n  },\n}\n</script>\n\n<style lang=\"scss\">\n* {\n  box-sizing: border-box;\n}\n\nhtml,\nbody {\n  overflow-y: auto;\n}\n\nhtml {\n  overflow-y: hidden !important;\n}\n\n.v-btn.smolbtn {\n  padding-left: 0;\n  padding-right: 0;\n  min-width: 0;\n}\n\n#toolbar {\n  button {\n    @apply p-2 rounded;\n\n    min-width: 0;\n\n  }\n}\n\n.hotkey-tooltip {\n  padding: 2px 10px !important;\n  border-radius: 2px !important;\n  background: #252525 !important;\n  color: #aaa !important;\n}\n</style>\n","// eslint-disable-next-line no-unused-vars\nimport { InputProcessor, MouseInputModule } from \"./InputProcessor\";\n\n/**\n * @typedef Coordinate\n * @property {Number} x\n * @property {Number} y\n */\n\nclass InputProcessorKeyboardEvent{\n    /**\n     * Contains the key along with active modifiers. Ex: SHIFT+A, CTRL+SHIFT+C.\n     * \n     * Modifers follow alphabetical order. Although this is not needed when adding listeners to the input processor.\n     * \n     * CTRL and CONTROL are the same when adding a listener, however, ipkey will use CONTROL.\n     */\n    _ipkey = \"\";\n    /**\n     * @type {InputProcessor}\n     */\n    ip;\n    /**@type {InputProcessorMouseEvent} */\n    mouse;\n\n    get ipkey(){\n        return this._ipkey.replace(InputProcessor.seperator, '+');\n    }\n\n    set ipkey(value){\n        this._ipkey = value; \n    }\n\n    /**\n     * List of currently active keys (key with states true)\n     */\n    get activeKeys(){\n        return this.ip.states.filter(v => v[1]).map(v => v[0])\n    }\n\n    get ipkeySet(){\n        return new Set([\n            this.altKey ? \"ALT\" : null,\n            this.ctrlKey ? \"CONTROL\" : null,\n            this.shiftKey ? \"SHIFT\" : null,\n            this._ipkey.split(InputProcessor.splitter).at(-1)\n        ].filter(v => v !== null))\n    }\n\n    // Native KeyboardEvent Properties\n    // I can't extend this to a keyboard event since there's no such thing. However, there is a KeyboardEventInit but that requires native data straight from the browser (can't imitate that data)\n    key = \"\";\n    code = \"\";\n    location = \"\";\n    repeat = false;\n    isComposing = false;\n\n    altKey = false;\n    ctrlKey = false;\n    shiftKey = false;\n    getModifierState = \"\";\n\n    /**\n     *  \n     * @param {KeyboardEvent} ev \n     * @param {String} ipkey Input Processor Key\n     * @param {InputProcessor} ip\n     */\n    constructor(ev, ipkey, ip){\n        Object.assign(this, ev);\n        this.getModifierState = ev.getModifierState;\n        this._ipkey = ipkey;\n        this.ip = ip;\n        this.mouse = new InputProcessorMouseEvent(ip.cursor);\n    }\n}\n\n\nclass InputProcessorMouseEvent{\n    /**@type {Coordinate} */\n    client = {};\n    /**@type {Coordinate} */\n    screen = {};\n    /**@type {Coordinate} */\n    lastClick = {};\n    /**@type {Coordinate} */\n    dragDiff = {};\n\n    isDragging = false;\n\n    /**\n     * \n     * @param {MouseInputModule} ip \n     */\n    constructor(ip){\n        this.client = structuredClone(ip.client);\n        this.screen = structuredClone(ip.screen);\n        this.lastClick = structuredClone(ip.lastClick);\n\n        this.isDragging = ip.isDragging;\n\n        if(!ip.isDragging) return;\n        \n        this.dragDiff.x = ip.client.x - ip.lastClick.x;\n        this.dragDiff.y = ip.client.y - ip.lastClick.y;\n\n    }\n}\n\nexport {\n    InputProcessorKeyboardEvent,\n    InputProcessorMouseEvent\n}","import { InputProcessorKeyboardEvent, InputProcessorMouseEvent } from \"./InputProcessorEvent\";\n\n//#region baseclass\nclass EventEmitter{\n\n    constructor(){\n        /**\n         * @protected\n         */\n        this.__evs__ = {};\n        this.__any__ = [];\n    }\n    \n    has(event){\n        return this.__evs__[event] !== undefined;\n    }\n    \n    on(event, cb){\n        this.__evs__[event] = this.__evs__[event] || [];\n        this.__evs__[event].push(cb);\n    }\n\n    onAny(cb){\n        this.__any__.push(cb);\n    }\n\n    off(event, cb){\n        if(!this.has(event)) return;\n        // Added a check where even if two functions don't belong to the same part in the memory, as long as they do the same thing, they will be removed\n        const i = this.__evs__[event].findIndex(ev => ev === cb || ev.toString() === cb.toString());\n        if(i === -1) return;\n        this.__evs__[event].splice(i, 1);\n    }\n\n    emit(event, ...args){\n        this.__any__.forEach(ev => ev(event, ...args));\n        if(!this.has(event)) return;\n        this.__evs__[event].forEach(ev => ev(...args));\n    }\n\n    renameEvent(oldEvent, newEvent){\n        if(!this.has(oldEvent)) return;\n        if(newEvent === oldEvent) return;\n        this.oldEvent = this.newEvent;\n        delete this.oldEvent;\n    }\n}\n//#endregion\n\n\n/**\n * @callback InputProcessorEventCallback\n * @param {(InputProcessorKeyboardEvent | InputProcessorMouseEvent)} ev\n */\n\n/**\n * @typedef {Ojbect} BuildInFunctionFormat\n * @property {String} event\n * @property {Function} fn\n */\n\n/**\n * @typedef KeyboardEventType\n * @property {string} keydown\n * @property {string} keyup\n */\n\n/**\n * @typedef MouseEventType\n * @property {string} mousemove\n * @property {string} click\n * @property {string} auxclick\n * @property {string} dblclick\n * @property {string} contextmenu\n * @property {string} mousedown\n * @property {string} mouseup\n * @property {string} mouseenter\n * @property {string} mouseover\n * @property {string} mouseleave\n * @property {string} mouseout\n * @property {string} drag\n * @property {string} dragstart\n * @property {string} dragend\n */\n\nclass InputProcessorConfig {\n    /**\n     * @type {HTMLElement}\n     */\n    monitor;\n    /**Determines wether capture KeyEvents is enabled. */\n    captureKey = true;\n    /**Determines wether the MouseInputModule is used */\n    captureMouse = false;\n    \n    // Future Options --- Not yet implemented\n    string; // prevent defaults and other stuff\n}\n\nclass InputProcessor extends EventEmitter{\n    \n    /**\n     * Recognizes keycodes to be used as property in instances. Used in tandem with check().\n     * \n     * Can also accept basic keys to be converted into property in instances of this class. (e.g. a -> KEY_A, + -> NUM_ADD)\n     * \n     * @param {String} key the key property of a KeyBoard Event\n     * @param {String} code the code property of a KeyBoard Event\n     * @returns {String} the appropriate property of this InputProcessor instance\n     */\n    static recognize(key, code){\n        const capKey = key.toUpperCase();\n\n        // If this came from an HTML Keyboard Event\n        if(code){\n            // If an alphabet key\n            if(code.match((/key(?!_)/igm))) return code.replace(/key/igm, \"KEY_\");\n            // If a numpad key\n            if(code.match(/numpad(?!_)/igm)) return code.replace(/numpad/igm, \"NUM_\");\n            // if a digit key\n            if(code.match(/digit(?!_)/igm)) return code.replace(/digit/igm, \"DIG_\");\n        }\n\n\n        // TODO: Create a more concise processing of exceptions\n        // Sing Characters, usually uses outside the KeyBoard Event\n        if(capKey.length === 1){\n            const charCode = capKey.charCodeAt(0);\n            if(65 <= charCode && 90 >= charCode) return `KEY_${capKey}`;\n            if(48 <= charCode && 57 >= charCode) return `NUM_${capKey}`;\n            switch(capKey){\n                case '+':\n                    return \"NUM_ADD\";\n                case '-':\n                    return 'NUM_SUB';\n                case '*':\n                    return 'NUM_MUL';\n                case '/':\n                    return 'SLASH_FORWARD';\n                case '\\\\':\n                    return 'SLASH_BACKWARD';\n                case ' ':\n                    return 'SPACE';\n            }\n        }\n        \n        return capKey;\n    }\n\n    /**\n     * Serializes combinational keys (if ever it has modifier keys) for a more consistent event type on emitting and listening events.\n     * @param {String[] | String} keys \n     */\n    static serialize(keys){\n        if(!Array.isArray(keys) && typeof keys === 'string'){\n            // Split by the plus sign, if there's a two consecutive plus signs, only split the first occurent (results from CTRL and '+' making CTRL++)\n            keys = this.split(keys);\n        }\n        keys.sort(); // Sort before anything else\n\n        // Find any Non-Modifier Key (if any) and put it on the last\n        const nonModifierIndex = keys.findIndex(k => !this.MODIFIERS.includes(k));\n        if(nonModifierIndex !== -1) keys.push(keys.splice(nonModifierIndex, 1)[0]); \n        \n        return keys.map(k => this.recognize(k, '')).join(this.seperator);\n    }\n\n    static get MODIFIERS(){\n        return [\"ALT\", \"CONTROL\", \"SHIFT\"];\n    }\n\n    static seperator = '';\n    static splitter = /\\+(?<=[^+].)/igm;\n\n    static split(keys){\n        return keys.split(this.splitter).join(this.seperator).split(this.seperator);\n    }\n    \n    //#region --- KEY STATES ---\n    \n    // Directional keys\n    ARROW_UP = false;\n    ARROW_DOWN = false;\n    ARROW_LEFT = false;\n    ARROW_RIGHT = false;\n\n    // Alphabet Keys: --- Initialized in the constructor\n    // Numpad Keys: --- Initialized in the constructor\n    // Digital Keys: --- Initialized in the constructor\n\n    // Modifier Keys\n    CONTROL = false;\n    SHIFT = false;\n    ALT = false;\n\n    // Miscellaneous Keys\n    SPACE = false;\n    TAB = false;\n    \n    //#endregion\n\n    //#region --- MOUSE STATES ---\n\n    cursor = new MouseInputModule(this);\n    \n    //#endregion\n\n    /**\n     * \n     * @param {HTMLElement} element the element to monitor inputs\n     * @param {InputProcessorConfig} config\n     */\n    constructor(element, config){\n        super();\n\n        // Set Alphabet keys\n        for(let c = 0; c < 26; c++){\n            this[`KEY_${String.fromCharCode(65 + c)}`] = false;\n        }\n        // Set Digital and Numpad Keys\n        for(let n = 0; n < 10; n++){\n            this[`NUM_${n}`] = false; // Numpad (Right Side of Keyboard)\n            this[`DIG_${n}`] = false; // Digital (Above the alphabet keys)\n        }\n\n        this.config = config || new InputProcessorConfig();\n\n        if(element) this.monitor = element;\n    }\n\n    /**\n     * @type {InputProcessorConfig}\n     */\n    config;\n\n    get monitor(){\n        return this.config.monitor;\n    }\n\n    set monitor(el){\n        // Remove listeners from the previous monitored element\n        if(this.monitor){\n            this.__built_listeners__.forEach(bl => this.monitor.removeEventListener(bl.event, bl.fn));\n        }\n            \n        if(el === undefined || el === null){\n            console.warn(`Element set to monitor is undefined`);\n            return;\n        }else if(this.config.captureMouse) this.cursor.monitor = el;\n        if(el.tagName === 'CANVAS') el.tabIndex = 1;\n\n        if(this.config.captureKey) this.__built_listeners__.forEach(bl => el.addEventListener(bl.event, bl.fn.bind(this)));\n        this.config.monitor = el;\n    }\n\n    /**\n     * @type {BuildInFunctionFormat[]}\n     */\n    get __built_listeners__(){\n        return [\n            this.__onKeyDown, \n            this.__onKeyUp,\n            this.__onFocusOut\n        ].map(fn => {\n            return {\n                // Formats the name to something that can be applied on html events\n                event: fn.name.replace('__on', '').toLowerCase(),\n                fn: fn\n            } \n        })\n    }\n\n    /**\n     * TODO: Make this more secure. Prepare a comprehensive list of actual keyboard and mouse codes\n     * @type {Array<[String, Boolean]>}\n     */\n    get states(){\n        return Object.entries(this).filter(v => typeof v[1] === 'boolean');\n    }\n\n\n    check(key){\n        if(key === '+') key = [key];\n        const keys = Array.isArray(key) ? key : typeof key === 'string' ? InputProcessor.split(key) : key;\n        return keys.every(k => this[InputProcessor.recognize(k, \"\")]);\n    }\n\n    /**\n     * \n     * @param {String[]} keys Key properties in clockwise order (e.g. up, right, down, left)\n     * @returns \n     */\n    direction(keys = ['ARROW_UP', 'ARROW_RIGHT', 'ARROW_DOWN', 'ARROW_LEFT']){\n        if(keys.length !== 4) throw new Error(`Directional Key Array length must be exactly 4`);\n\n        const u = this.check(keys[0]),\n              d = this.check(keys[2]),\n              l = this.check(keys[3]),\n              r = this.check(keys[1]);\n\n        const x = !l && !r ? 0 : !l && r ? 1 : -1,\n              y = !u && !d ? 0 : !u && d ? 1 : -1;\n\n        return [x, y];\n    }\n\n    reset(){\n        // Make all boolean true property false\n        Object.entries(([k, v]) => {\n            if(v === true) this[k] = false;\n        });\n    }\n\n    focus(){\n        this.monitor.focus();\n    }\n\n    /**\n     * Override the on and off event for any combinational hotkeys\n     * @param {(keyof KeyboardEventType | keyof MouseEventType | Array)} event A key or key combination. Put a '+' for added modifiers, order does not matter. e.g. SHIFT+CTRL+C is equal to CTRL+SHIFT+C. CTRL and CONTROL are the same however, the InputProcessorEvent uses CONTROL.\n     * @param {InputProcessorEventCallback} cb \n     * @param {Boolean} release Set to true if the callback is only invoked when releasing the said key\n     */\n    on(event, cb, release = false){\n        if(event === '') return;\n        switch(event){\n            case 'keydown':\n            case 'keyup':\n                break;\n            // Mouse events starts here\n            case 'mousemove':\n            case 'click': \n            case 'auxclick':\n            case 'dblclick':\n            case 'contextmenu':\n            case 'mousedown':\n            case 'mouseup':\n            case 'mouseenter':\n            case 'mouseover':\n            case 'mouseleave':\n            case 'mouseout':\n            case 'dragstart':\n            case 'dragend':\n            case 'drag':\n                break;\n            default:\n                event = event.replace('CTRL', 'CONTROL');\n                event = InputProcessor.serialize(event);\n        }\n        // Modify event to properly recognize if its a release event\n        if(release) event = `UP:${event}`;\n        super.on(event, cb);\n    }\n\n    /**\n     * Override the on and off event for any combinational hotkeys\n     * @param {(keyof KeyboardEventType | keyof MouseEventType | Array)} event A key or key combination\n     * @param {InputProcessorEventCallback} cb \n     * @param {Boolean} release Set to true if the callback is only invoked when releasing the said key\n     */\n    off(event, cb, release = false){\n        if(event === '') return;\n        switch(event){\n            case 'keydown':\n            case 'keyup':\n                break;\n            // Mouse events starts here\n            case 'mousemove':\n            case 'click': \n            case 'auxclick':\n            case 'dblclick':\n            case 'contextmenu':\n            case 'mousedown':\n            case 'mouseup':\n            case 'mouseenter':\n            case 'mouseover':\n            case 'mouseleave':\n            case 'mouseout':\n            case 'dragstart':\n            case 'dragend':\n            case 'drag':\n                break;\n            default:\n                event = event.replace('CTRL', 'CONTROL');\n                event = InputProcessor.serialize(event);\n        }\n        // Modify event to properly recognize if its a release event\n        if(release) event = `UP:${event}`;\n        super.off(event, cb);\n    }\n\n    /**\n     * @private\n     * @param {KeyboardEvent} e \n     * @returns \n     */\n    _processKeyBoardEvent(e){\n\n        const key = e.key.replace(/ARROW/gi, \"ARROW_\");\n\n        // Modifier Key States\n        this.ALT = e.altKey;\n        this.CONTROL = e.ctrlKey;\n        this.SHIFT = e.shiftKey;\n        \n        const keyprop = InputProcessor.recognize(key, e.code);\n        const active_keys = [key.toUpperCase()];\n        if(this.ALT && keyprop !== 'ALT') active_keys.unshift('ALT');\n        if(this.CONTROL && keyprop !== 'CONTROL') active_keys.unshift('CONTROL');\n        if(this.SHIFT && keyprop !== 'SHIFT') active_keys.unshift('SHIFT');\n\n        // Modified KeyboardEvent\n        const combined = InputProcessor.serialize(active_keys);\n        const ipev = new InputProcessorKeyboardEvent(e, combined, this);\n\n        return {\n            keyprop,\n            combined,\n            ipev,\n        }\n    }\n\n    //#region --- PreBuilt Listeners ---\n\n    /**\n     * \n     * @param {KeyboardEvent} e \n     */\n    __onKeyDown(e){\n        e.preventDefault();\n\n        const {keyprop, combined, ipev} = this._processKeyBoardEvent(e);\n        this[keyprop] = true;\n\n        // Emit Hotkey listeners (If not on repeat)\n        if(!e.repeat) this.emit(combined, ipev);\n        // Emit Also the simple/not-combined listener\n        if(!e.repeat && combined !== keyprop) this.emit(keyprop, ipev);\n        // Emit basic onkeydown (if any)\n        this.emit(`keydown`, ipev);\n    }\n\n    /**\n     * \n     * @param {KeyboardEvent} e \n     */\n    __onKeyUp(e){\n        e.preventDefault();\n        \n        const {keyprop, combined, ipev} = this._processKeyBoardEvent(e);\n        this[keyprop] = false;\n\n        // Emit hotkey listeners for release type\n        this.emit(`UP:${combined}`, ipev);\n        // Emit Also the simple/not-combined listener\n        if(combined !== keyprop) this.emit(`UP:${keyprop}`, ipev);\n        // Emit basic onkeyup (if any)\n        this.emit(`keyup`, ipev);\n\n    }\n    __onFocusOut(){\n        // Emit all keyup emitters if a key state is true\n        Object.entries(([k, v]) => {\n            if(typeof this[k] === \"boolean\" && v){\n                this.emit(`UP:${k}`);\n            }\n        })\n    }\n\n    //#endregion\n}\n\nclass Coordinate{\n    /**\n     * @type {Number}\n     */\n    x;\n    /**\n     * @type {Number}\n     */\n    y;\n\n    constructor(x, y){\n        this.x = x;\n        this.y = y;\n    }\n\n    /**\n     * \n     * @param {Coordinate} coord \n     * @returns {Coordinate}\n     */\n    difference(coord){\n        return new Coordinate(\n            this.x - coord.x,\n            this.y - coord.y\n        )\n    }\n\n    sum(coord){\n        return new Coordinate(\n            this.x + coord.x,\n            this.y + coord.y\n        )\n    }\n\n    /**@type {Coordinate} */\n    get clone(){\n        return new Coordinate(this.x, this.y);\n    }\n\n    /**\n     * Returns the array form of the coordinate\n     * @type {Number[]}\n     */\n    get arr(){\n        return [this.x, this.y];\n    }\n}\n\nclass MouseInputModule{\n    client = new Coordinate(0, 0);\n    screen = new Coordinate(0, 0);\n    /**\n     * The coordinate when the dragging starts. Can be used to determine the change of coordinate from the first drag starts and to the current.\n     * @type {Coordinate}\n     */\n    lastClick;\n\n    /**\n     * @type {HTMLElement}\n     */\n    _monitor;\n\n    isDragging = false;\n\n    get monitor(){\n        return this._monitor;\n    }\n\n    set monitor(el){\n        if(this.monitor){\n            this.__built_listeners__.forEach(bl => this.monitor.removeEventListener(bl.event, bl.fn));\n        }\n            \n        this.__built_listeners__.forEach(bl => el.addEventListener(bl.event, bl.fn.bind(this)));\n        this._monitor = el;\n    }\n\n    get __built_listeners__(){\n        return [\n            this.__onClick,\n            this.__onAuxClick,\n            this.__onDblClick,\n            this.__onContextMenu,\n            this.__onMouseDown,\n            this.__onMouseUp,\n            this.__onMouseEnter,\n            this.__onMouseOver,\n            this.__onMouseLeave,\n            this.__onMouseOut,\n            this.__onMouseMove,\n            this.__onFocusOut\n        ].map(fn => {\n            return {\n                event: fn.name.replace('__on', '').toLowerCase(),\n                fn: fn\n            }\n        })\n    }\n\n    /**\n     * @type {InputProcessor}\n     */\n    _ip;\n\n    /**\n     * \n     * @param {InputProcessor} processor \n     */\n    constructor(processor){\n        this._ip = processor;\n    }\n\n    /**\n     * \n     * @param {keyof MouseEventType} event \n     * @param  {...any} args \n     */\n    emit(event, ...args){\n        this._ip.emit(event, ...args);\n    }\n\n    /**@param {MouseEvent} e*/\n    __processMouseEvent__(e){\n        const rect = this.monitor.getBoundingClientRect();\n\n        this.screen.x = e.screenX;\n        this.screen.y = e.screenY;\n        this.client.x = e.clientX - rect.left;\n        this.client.y = e.clientY - rect.top;\n\n        if(e.type === 'mousedown') this.lastClick = this.client.clone;\n\n        const ipmouse = new InputProcessorMouseEvent(this);\n\n        return ipmouse;\n    }\n\n    //#region Built In Listeners\n\n    /**@param {MouseEvent} e*/\n    __onMouseMove(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        if(this.isDragging) this.emit('drag', ipmouse);\n\n        this.emit('mousemove', ipmouse);\n    }\n\n    //\n\n    /**@param {MouseEvent} e*/\n    __onClick(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('click', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onAuxClick(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('auxclick', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onDblClick(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('dblclick', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onContextMenu(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('contextmenu', ipmouse);\n    }\n\n    //\n\n    /**@param {MouseEvent} e*/\n    __onMouseDown(e){\n        this.isDragging = true;\n        const ipmouse = this.__processMouseEvent__(e);\n        this.emit('dragstart', ipmouse);\n        this.emit('mousedown', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseUp(e){\n        this.isDragging = false;\n        this.lastClick = null;\n        const ipmouse = this.__processMouseEvent__(e);\n        this.emit('dragend', ipmouse);\n        this.emit('mouseup', ipmouse);\n    }\n\n    //\n\n    /**@param {MouseEvent} e*/\n    __onMouseOver(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('mouseover', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseEnter(e){\n        const ipmouse = this.__processMouseEvent__(e);\n        if(this.isDragging && e.buttons === 0){\n            this.isDragging = false;\n            this.lastClick = null;\n        }\n        this.emit('mouseenter', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseOut(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('mouseout', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseLeave(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('mouseleave', ipmouse);\n    }\n\n    __onFocusOut(){\n        this.isDragging = false;\n        this.lastClick = null;\n    }\n}\n\nexport {\n    InputProcessor,\n    MouseInputModule\n}","import Victor from \"victor\";\r\nimport State from \"./graph/State\";\r\nimport Transition from \"./graph/Transition\";\r\n\r\nexport default class Util {\r\n    static genString(len){\r\n        return Math.random().toString(36).substring(2,len+2);\r\n    }\r\n\r\n    static deg360 = Math.PI * 2;\r\n    static deg90 = Math.PI / 2;\r\n    static deg2Rad = deg => Math.PI * deg / 180;\r\n    static rad2Deg = rad => rad * 180 / Math.PI;\r\n\r\n    /**\r\n     *  \r\n     * @param  {(State[]|Transition[])} states \r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @returns {(State[]|Transition[])}\r\n     */\r\n    static FindHits(states, x, y){\r\n        return states.filter(s => s.hits(x, y));\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     * @param {Number} fx From X \r\n     * @param {Number} fy From Y\r\n     * @param {Number} tx To X\r\n     * @param {Number} ty To Y\r\n     * @param {Number} arcAngle Arc Angle to be shown in degrees\r\n     * @param {Boolean} cw Clockwise\r\n     */\r\n    static drawArcFromTwoPoints(ctx, fx, fy, tx, ty, arcAngle, cw = false){\r\n        const f = new Victor(fx, fy),\r\n            t = new Victor(tx, ty),\r\n            a2 = arcAngle / 2,\r\n            m = f.clone().mix(t, 0.5),\r\n            l = f.distance(t);\r\n\r\n        // Calculations\r\n        const ti = 90 - a2, // Theta Inner\r\n            r = l / (2 * Math.cos(this.deg2Rad(ti))); // radius\r\n\r\n        const center = t.clone().subtract(f)\r\n        .rotateDeg(cw ? ti : -ti) // change this according to cw\r\n        .norm().multiplyScalar(r);\r\n\r\n        const coa = center.clone().add(f);\r\n\r\n        // ctx.strokeStyle = 'crimson';\r\n        // this.line(ctx, ...f.toArray(), ...t.toArray());\r\n        // ctx.strokeStyle = 'blue';\r\n        // this.line(ctx, ...f.toArray(), ...coa.toArray());\r\n        // this.line(ctx, ...coa.toArray(), ...t.toArray());\r\n\r\n        ctx.strokeStyle = '#999';\r\n        const sa = center.clone().invert().angle(),\r\n            ea = sa - this.deg2Rad(arcAngle);\r\n        \r\n        ctx.beginPath();\r\n        ctx.arc(...center.clone().add(f).toArray(), r, sa, ea, !cw);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        const endTangent = t.clone().subtract(coa).rotateDeg(-90).invert(),\r\n            startTangent = f.clone().subtract(coa);\r\n\r\n        const ctd = center.clone().invert().rotateDeg(-a2);\r\n        const ct = ctd.clone().add(ctd.norm().multiplyScalar(15)).add(coa);\r\n\r\n        // ctx.strokeStyle = 'green';\r\n        // this.line(ctx, ...coa.toArray(), ...ct.toArray());\r\n\r\n        return {\r\n            start: startTangent,\r\n            end: endTangent,\r\n            center: ct\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     * @param {Number} fx \r\n     * @param {Number} fy \r\n     * @param {Number} tx \r\n     * @param {Number} ty \r\n     */\r\n    static line(ctx, fx, fy, tx, ty){\r\n        ctx.beginPath();\r\n        ctx.moveTo(fx, fy);\r\n        ctx.lineTo(tx, ty);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {(Number|Victor)} angle \r\n     * @param {Boolean} goIn \r\n     */\r\n    static drawArrow(ctx, x, y, angle, arrowAngle = 25, arrowSize = 25, goIn = true){\r\n        const o = new Victor(x, y),\r\n            a = angle instanceof Victor ? \r\n            angle.clone().norm() : \r\n            (new Victor(1, 0)).rotateByDeg(angle);\r\n\r\n        const orig_a = a.clone().multiplyScalar(arrowSize);\r\n\r\n        ctx.beginPath();\r\n\r\n        a.rotateDeg(-arrowAngle/2).multiplyScalar(arrowSize);\r\n        ctx.moveTo(...o.toArray());\r\n        ctx.lineTo(...o.clone().add(a).toArray());\r\n        a.rotateDeg(arrowAngle);\r\n        ctx.lineTo(...o.clone().add(a).toArray());\r\n        ctx.lineTo(...o.toArray());\r\n        ctx.fill();\r\n\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n\r\n        // ctx.strokeStyle = 'red';\r\n        // ctx.moveTo(...o.toArray());\r\n        // ctx.lineTo(...o.add(orig_a).toArray());\r\n        // ctx.stroke();\r\n\r\n        ctx.closePath();\r\n    }\r\n\r\n    static copyToClipboard = text => {\r\n        // I thought I have to do the input trick\r\n        navigator.clipboard.writeText(text);\r\n    }\r\n}","import Victor from \"victor\";\r\nimport Util from \"../Util\";\r\nimport { useMainStore } from \"@/stores/mainStore\";\r\n\r\nclass StateOptions{\r\n    // Put more here\r\n    radius = 15;\r\n    border = 2;\r\n    borderColor = '#888';\r\n    bg = '#444';\r\n    labelColor = '#999';\r\n    selected_bg = '#888';\r\n    selected_labelColor = '#fff';\r\n}\r\n\r\n/**Constants */\r\nconst deg360 = Math.PI * 2;\r\n\r\nexport default class State{\r\n    /**@type {Victor} */\r\n    pos;\r\n    /**@type {String} */\r\n    label;\r\n    /**@type {StateOptions} */\r\n    options;\r\n    isFinish = false;\r\n    isStart = false;\r\n\r\n    /**\r\n     * \r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {String} label \r\n     * @param {StateOptions} options \r\n     */\r\n    constructor(x, y, label, options = {}){\r\n        const defOptions = new StateOptions();\r\n        Object.assign(defOptions, options);\r\n\r\n        this.pos = new Victor(x, y);\r\n        this.label = label || Util.genString(3);\r\n        this.options = defOptions;\r\n\r\n        Math.sq\r\n    }\r\n\r\n    /**\r\n     * Checks if a coordinate is inside this state\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @returns {Boolean}\r\n     */\r\n    hits(x, y){\r\n        const d = this.pos.distance(new Victor(x, y));\r\n        return this.options.radius >= d;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     */\r\n    draw(ctx){\r\n        const mainStore = useMainStore();\r\n\r\n        const { pos, options, label } = this;\r\n        const { x, y } = pos;\r\n        const { radius, \r\n            border, borderColor, \r\n            bg, labelColor,\r\n            selected_bg, selected_labelColor } = options;\r\n        const fullWidth = radius + border;\r\n\r\n        if(this.isFinish){\r\n            ctx.beginPath();\r\n            ctx.fillStyle = borderColor;\r\n            ctx.arc(x, y, fullWidth + 6, 0, deg360);\r\n            ctx.fill();\r\n            ctx.closePath()\r\n            \r\n            ctx.beginPath();\r\n            ctx.fillStyle = \"#171717\";\r\n            ctx.arc(x, y, fullWidth + 4, 0, deg360);\r\n            ctx.fill();\r\n            ctx.closePath()\r\n        }\r\n\r\n        ctx.beginPath();\r\n        // Fill first using the border\r\n        ctx.fillStyle = borderColor;\r\n        ctx.ellipse(x, y, fullWidth, fullWidth, 0, 0, deg360);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        // Then the inner part\r\n        ctx.fillStyle = mainStore.selected?.label === this.label ? selected_bg : bg;\r\n        ctx.ellipse(x, y, radius, radius, 0, 0, deg360);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.fillStyle = mainStore.selected?.label === this.label ? selected_labelColor : labelColor;\r\n        ctx.textAlign = 'center';\r\n        ctx.textBaseline = 'middle';\r\n        ctx.font = '12px Roboto';\r\n        ctx.fillText(label, x, y + 1);\r\n\r\n        ctx.fillStyle = borderColor;\r\n        if(this.isStart) Util.drawArrow(ctx, x - radius, y, 180, 90);\r\n    }\r\n}","import State from \"@/commons/graph/State\";\r\nimport { defineStore } from \"pinia\";\r\nimport { computed, reactive, ref } from \"vue\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport { useMainStore } from \"./mainStore\";\r\n\r\nexport const useStateStore = defineStore('state', () => {\r\n\r\n    const transitionStore = useTransitionStore(),\r\n        mainStore = useMainStore();\r\n\r\n    /**@type {State[]} */\r\n    const states = reactive([]);\r\n\r\n    /**\r\n     * @param {State} state \r\n     */\r\n    const addState = (state) => {\r\n        states.push(state);\r\n        mainStore.genRegex();\r\n    };\r\n\r\n    const getStateIndex = label => states.findIndex(s => s.label === label),\r\n        getState = label => states.find(s => s.label === label);\r\n\r\n    const removeState = (label) => {\r\n        const i = getStateIndex(label);\r\n        if(i === -1) return;\r\n\r\n        // Find all transitions that is connected to this state\r\n        const froms = transitionStore.getTransitionsFrom(label);\r\n        froms.forEach(f => transitionStore.removeTransition(f.from.label, f.to.label));\r\n\r\n        const tos = transitionStore.getTransitionsTo(label);\r\n        tos.forEach(t => transitionStore.removeTransition(t.from.label, t.to.label));\r\n\r\n        if(mainStore.selected.label === label) mainStore.select(undefined);\r\n\r\n        states.splice(i , 1);\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const savedStart = ref(undefined);\r\n\r\n    const setStart = (c) => {\r\n        const t = getState(c);\r\n\r\n        if(savedStart.value === undefined) {\r\n            savedStart.value = t;\r\n        } else {\r\n            savedStart.value.isStart = false;\r\n            savedStart.value = t;\r\n        }\r\n\r\n        t.isStart = true;\r\n\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const accepting = computed(() => states.filter(s => s.isFinish));\r\n\r\n    return {\r\n        states,\r\n        addState,\r\n        getStateIndex,\r\n        getState,\r\n        removeState,\r\n        setStart,\r\n        savedStart,\r\n        accepting\r\n    }\r\n})","import Victor from \"victor\";\r\nimport State from \"./State\";\r\nimport { useTransitionStore } from \"@/stores/transitionStore\";\r\nimport Util from \"../Util\";\r\nimport { useStateStore } from \"@/stores/stateStore\";\r\n\r\nexport default class Transition{\r\n    /**@type {State} */\r\n    from;\r\n    /**@type {State} */\r\n    to;\r\n    /**@type {String[]} */\r\n    v = [];\r\n\r\n    /**\r\n     * \r\n     * @param {State} from \r\n     * @param {State} to \r\n     * @param {String[]} v\r\n     */\r\n    constructor(from, to, ...v){\r\n        this.from = from;\r\n        this.to = to;\r\n        this.v = v.sort();\r\n    }\r\n    \r\n\r\n    equalWith(from, to){\r\n        return this.from.label === from && this.to.label === to;\r\n    }\r\n\r\n    /**\r\n     * @param {Transition} other \r\n     * @returns {Boolean}\r\n     */\r\n    equals(other){\r\n        return other.from.label === this.from.label && other.to.label === this.to.label;\r\n    }\r\n\r\n    addValue(...v){\r\n        this.v.push(...v.sort());\r\n    }\r\n\r\n    removeValue(v){\r\n        const i = this.v.findIndex(a => a === v);\r\n        if(i === -1) return;\r\n        this.v.splice(i, 1);\r\n\r\n        if(this.v.length > 0) return;\r\n        // If no labels left, then delete the transition\r\n        const transitionStore = useTransitionStore();\r\n        transitionStore.removeTransition(this.from.label, this.to.label);\r\n    }\r\n\r\n    str(){\r\n        return this.v.map(v => `${this.from.label}:${v}>${this.to.label}`).join('\\n');\r\n    }\r\n\r\n    /**\r\n     * @param {CanvasRenderingContext2D} ctx \r\n     */\r\n    draw(ctx){\r\n        const vdir = this.to.pos.clone().\r\n        subtract(this.from.pos);\r\n\r\n        const vnorm = vdir.clone().norm();\r\n\r\n        const v = vnorm.clone().multiplyScalar(this.from.options.radius + 7);\r\n        \r\n        let end = this.to.pos.clone().subtract(v),\r\n            start = this.from.pos.clone().add(v);\r\n\r\n        const transitionStore = useTransitionStore(),\r\n            stateStore = useStateStore();\r\n\r\n        let textPos = null;\r\n\r\n        // Line\r\n        ctx.strokeStyle = '#999';\r\n\r\n        // Text\r\n        ctx.textAlign = 'center';\r\n        const tw = ctx.measureText(this.v.join(', ')).width;\r\n\r\n        ctx.fillStyle = '#999';\r\n\r\n        let arrowSize = 20;\r\n\r\n        if(transitionStore.getTransitionIndex(this.to.label, this.from.label) === -1){\r\n            ctx.beginPath();\r\n            ctx.moveTo(...start.toArray());\r\n            ctx.lineTo(...end.clone().subtract(v).toArray());\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            vnorm.invert();\r\n\r\n            textPos = this.from.pos.clone().mix(this.to.pos, 0.5)\r\n            .add(vdir.clone().rotateDeg(-90)\r\n            .norm().multiplyScalar(tw)).toArray();\r\n\r\n        }else if(this.from.label === this.to.label){\r\n            // For self referencing\r\n\r\n            // Get all vector directions that connects to this state, and fine the average\r\n            /**@type {Set<State>} */\r\n            const cSet = new Set();\r\n\r\n            transitionStore.transitions.forEach(t => {\r\n                // Skip self\r\n                if(t.from.label === this.from.label\r\n                    && t.to.label === this.to.label) return;\r\n\r\n                if(t.from.label === this.from.label) cSet.add(t.to.label);\r\n                else if(t.to.label === this.from.label) cSet.add(t.from.label);\r\n            })\r\n\r\n            /**@type {State[]} */\r\n            const connected = [];\r\n            cSet.forEach(sLabel => connected.push(stateStore.getState(sLabel)));\r\n\r\n            // this.v.splice(0);\r\n            // this.v.push(...connected.map(s => s.label));\r\n\r\n            const sldir = new Victor(0, cSet.size === 0 ? 1 : 0);\r\n\r\n            // Loop  through all connected states then get the average vector\r\n            connected.forEach(s => {\r\n                sldir.add(s.pos.clone().subtract(this.from.pos).norm())\r\n            })\r\n            sldir.norm().invert();\r\n\r\n\r\n            const arcCoverage = 60, \r\n                arcLoc = sldir.angleDeg(), \r\n                len = 15,\r\n                touchPoint = this.from.options.radius + 7,\r\n                ssl = new Victor(touchPoint, 0).rotateDeg(arcLoc + arcCoverage / 2),\r\n                esl = ssl.clone().rotateDeg(-arcCoverage),\r\n                dir = ssl.clone().rotateDeg(-arcCoverage / 2).norm(),\r\n                sel = ssl.clone().add(dir.clone().multiplyScalar(len)),\r\n                eel = esl.clone().add(dir.clone().multiplyScalar(len));\r\n\r\n            textPos = this.from.pos.clone()\r\n                .add(dir.multiplyScalar(touchPoint + len + 20)).toArray();\r\n\r\n            Util.line(ctx,\r\n                ...this.from.pos.clone().add(ssl).toArray(),\r\n                ...this.from.pos.clone().add(sel).toArray());\r\n            Util.line(ctx,\r\n                ...this.from.pos.clone().add(esl).toArray(),\r\n                ...this.from.pos.clone().add(eel).toArray());\r\n\r\n            const { end: ea } = Util.drawArcFromTwoPoints(ctx,\r\n                ...this.from.pos.clone().add(sel).toArray(),\r\n                ...this.from.pos.clone().add(eel).toArray(),\r\n                180);\r\n\r\n            // ctx.strokeStyle = 'green';\r\n            // Util.line(ctx,\r\n            //     ...this.from.pos.toArray(),\r\n            //     ...this.from.pos.clone().add(ssl).toArray())\r\n            \r\n            end.copy(this.from.pos.clone().add(esl));\r\n\r\n            arrowSize = 15;\r\n\r\n            vnorm.copy(ea);\r\n        }else {\r\n            \r\n            const maxArc = 150, minArc = 15,\r\n                arc = maxArc**2 / this.from.pos.distanceSq(this.to.pos);\r\n                \r\n\r\n            const { start: sa, end: ea, center: c } = Util.drawArcFromTwoPoints(ctx, \r\n                ...start.toArray(), ...end.toArray(), \r\n                arc > 1 ? maxArc : maxArc * arc < minArc ? minArc : maxArc * arc\r\n            )\r\n            vnorm.copy(ea);\r\n\r\n            textPos = c.toArray();\r\n        }\r\n\r\n        // Arrow\r\n        const arrowAngle = 20;\r\n        Util.drawArrow(ctx, ...end.toArray(), vnorm, arrowAngle, arrowSize);\r\n\r\n        ctx.fillText(\r\n            this.v.join(', '), \r\n        ...textPos\r\n        );\r\n    }\r\n}","import Transition from \"@/commons/graph/Transition\";\r\nimport { defineStore } from \"pinia\";\r\nimport { reactive } from \"vue\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport { useMainStore } from \"./mainStore\";\r\n\r\nexport const useTransitionStore = defineStore('transition', () => {\r\n\r\n    const stateStore = useStateStore(),\r\n        mainStore = useMainStore();\r\n\r\n    /**@type {Transition[]} */\r\n    const transitions = reactive([]);\r\n\r\n    const addTransition = ({labels, from, to}) => {\r\n        // Find first if said transition is existing\r\n        const i = getTransitionIndex(from, to);\r\n        if(i === -1){\r\n            // Add transition if not found\r\n            const f = stateStore.getState(from),\r\n                t = stateStore.getState(to);\r\n            transitions.push(new Transition(f, t, ...labels));\r\n        }else{\r\n            // Just add the new labels to the transition\r\n            transitions[i].v.splice(0);\r\n            transitions[i].addValue(...labels);\r\n            \r\n            if(labels.length === 0) removeTransition(from, to);\r\n        }\r\n        \r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const getTransitionIndex = (from, to) => {\r\n        return transitions.findIndex(t => t.equalWith(from, to));\r\n    }\r\n\r\n    const getTransition = (from, to) => transitions.find(t => t.equalWith(from, to));\r\n\r\n    const getTransitionsFrom = from => transitions.filter(t => t.from.label === from);\r\n\r\n    const getTransitionsTo = to => transitions.filter(t => t.to.label === to);\r\n\r\n    const removeTransition = (from, to) => {\r\n        const i = getTransitionIndex(from, to);\r\n        if(i === -1) return;\r\n        transitions[i].v.splice(0);\r\n        transitions.splice(i , 1);\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    return {\r\n        addTransition,\r\n        getTransitionIndex,\r\n        getTransition,\r\n        removeTransition,\r\n        transitions,\r\n        getTransitionsFrom,\r\n        getTransitionsTo\r\n    }\r\n})","import { defineStore } from \"pinia\";\r\nimport { reactive } from \"vue\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport { useMainStore } from \"./mainStore\";\r\n\r\n\r\nconst MAX_ALHPABET = 10;\r\n\r\nexport const useAlphabetStore = defineStore('alphabet', () => {\r\n    const alphabet = reactive(['a', 'b']);\r\n\r\n    const transitionStore = useTransitionStore(),\r\n        mainStore = useMainStore();\r\n        \r\n    const removeAlphabet = c => {\r\n        const i = alphabet.indexOf(c);\r\n        if(i === - 1) return;\r\n        alphabet.splice(i, 1);\r\n\r\n        // Remove all occurences in all transition of the said alphabet\r\n        transitionStore.transitions.forEach(t => t.removeValue(c));\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const removeAll = () => {\r\n        alphabet.forEach(ap => removeAlphabet(ap));\r\n    }\r\n\r\n    const addAlphabet = c => {\r\n        if(alphabet.length >= MAX_ALHPABET) return;\r\n\r\n        c = c.trim();\r\n        if(c === '') return;\r\n        const i = alphabet.indexOf(c);\r\n        if(i === -1) {\r\n            alphabet.push(c);\r\n            mainStore.genRegex();\r\n        }\r\n    }\r\n\r\n    const resetAlphabet = () => {\r\n        alphabet.splice(0);\r\n        alphabet.push('a', 'b');\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    return {\r\n        alphabet,\r\n        addAlphabet,\r\n        removeAlphabet,\r\n        resetAlphabet,\r\n        removeAll\r\n    }\r\n})","/**\r\n * @callback DrawableGFX\r\n * @param {CanvasRenderingContext2D} ctx\r\n */\r\n\r\nimport Util from \"../Util\";\r\n\r\nexport class Drawables{\r\n    /**@type {Drawables[]} */\r\n    static instances = [];\r\n\r\n    /**@type {String} */\r\n    id;\r\n    /**@type {DrawableGFX} */\r\n    gfx;\r\n    /**@type {Boolean} */\r\n    isRegistered = false;\r\n\r\n    /**\r\n     * \r\n     * @param {Drawables} d \r\n     */\r\n    static register(d){\r\n        const i = this.instances.findIndex(n => n.id === d.id);\r\n        if(i !== -1) return;\r\n        this.instances.push(d);\r\n        d.isRegistered = true;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {DrawableGFX} gfx \r\n     * @param {String} id \r\n     */\r\n    constructor(gfx, id){\r\n        this.gfx = gfx;\r\n        this.id = id || Util.genString(8);\r\n    }\r\n\r\n    remove(){\r\n        const i = Drawables.instances.findIndex(d => d.id === this.id);\r\n        if(i === -1) return;\r\n        Drawables.instances.splice(i, 1);\r\n        this.isRegistered = false;\r\n    }\r\n\r\n    register(){\r\n        if(this.isRegistered) return;\r\n        Drawables.register(this);\r\n    }\r\n\r\n    draw(ctx){\r\n        this.gfx(ctx);\r\n    }\r\n}","import { defineStore } from \"pinia\"\r\nimport { ref } from \"vue\";\r\n\r\nexport const useMouseStore = defineStore('mouse', () => {\r\n    \r\n    const x = ref(0),\r\n        y = ref(0),\r\n        set = (nx, ny) => {\r\n            x.value = nx;\r\n            y.value = ny;\r\n        }\r\n\r\n    return {\r\n        x,\r\n        y,\r\n        set\r\n    }\r\n})","import { Drawables } from \"@/commons/canvas/Drawables\";\r\nimport { defineStore } from \"pinia\";\r\nimport { ref, watch } from \"vue\";\r\nimport { useMouseStore } from \"./mouseStore\";\r\nimport State from \"@/commons/graph/State\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport Victor from \"victor\";\r\nimport Util from \"@/commons/Util\";\r\n\r\n\r\nexport const useModeStore = defineStore('mode', () => {\r\n\r\n    //#region Stores and Drawables\r\n    const stateStore = useStateStore();\r\n    const mousestore = useMouseStore();\r\n    \r\n    const linkingArrow = new Drawables(ctx => {\r\n        const { x, y } = mousestore;\r\n        \r\n        /**@type {State} */\r\n        const start = stateStore.getState(linkStart.value);\r\n        if(start === undefined) return;\r\n\r\n        // Line\r\n        ctx.lineWidth = 2;\r\n        ctx.strokeStyle = '#999999';\r\n        ctx.fillStyle = '#999';\r\n        ctx.beginPath();\r\n        ctx.moveTo(...start.pos.toArray());\r\n        ctx.lineTo(x, y);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        // Triangle\r\n        const v = new Victor(x, y).subtract(start.pos).normalize().multiplyScalar(25).invert();\r\n        Util.drawArrow(ctx, x, y, v);\r\n\r\n        // Inner Circle\r\n        ctx.beginPath();\r\n        ctx.arc(...start.pos.toArray(), 15, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n    }, 'link-arrow');\r\n    //#endregion\r\n\r\n    /**@type {('default'|'linking'|'delete')} */\r\n    const mode = ref('default');\r\n\r\n    watch(mode, v => {\r\n        linkReset();\r\n        if(v === 'linking') linkingArrow.register();\r\n        else linkingArrow.remove();\r\n    })\r\n\r\n    const linkStart = ref(''),\r\n        linkEnd = ref(''),\r\n        linkReset = () => {\r\n            linkStart.value = '';\r\n            linkEnd.value = '';\r\n        }\r\n\r\n    const openTransitionDialog = ref(false);\r\n\r\n    watch(linkEnd, v => {\r\n        openTransitionDialog.value = v !== '';\r\n    })\r\n\r\n    return {\r\n        linkStart,\r\n        linkEnd,\r\n        linkReset,\r\n        \r\n        mode,\r\n        openTransitionDialog\r\n    }\r\n})","import { InputProcessor } from \"../input/InputProcessor\";\r\n\r\nimport { useAlphabetStore } from \"@/stores/alphabetStore\";\r\nimport { useTransitionStore } from \"@/stores/transitionStore\";\r\nimport { useStateStore } from \"@/stores/stateStore\";\r\nimport { useMainStore } from \"@/stores/mainStore\";\r\n\r\nimport State from \"../graph/State\";\r\nimport Util from \"../Util\";\r\nimport { useModeStore } from \"@/stores/modeStore\";\r\nimport { Drawables } from \"./Drawables\";\r\nimport { useMouseStore } from \"@/stores/mouseStore\";\r\n\r\nconst ip = new InputProcessor(null, {\r\n    captureKey: true,\r\n    captureMouse: true\r\n})\r\n\r\n/**\r\n * \r\n * @param {HTMLElement} c \r\n */\r\nexport function monitor(c){\r\n    ip.monitor = c;\r\n}\r\n\r\n\r\nlet HAS_INITIALIZED = false;\r\nexport function initCanvas(){\r\n    // To be sure that this function is only run once\r\n    if(HAS_INITIALIZED) return;\r\n    HAS_INITIALIZED = true;\r\n\r\n    const alphabetStore = useAlphabetStore(),\r\n        transitionStore = useTransitionStore(),\r\n        stateStore = useStateStore(),\r\n        mouseStore = useMouseStore(),\r\n        modeStore = useModeStore(),\r\n        mainStore = useMainStore();\r\n\r\n    const { monitor: c } = ip,\r\n        ctx = c.getContext('2d');\r\n\r\n    const canvas = {};\r\n\r\n    Object.defineProperty(canvas, 'cursor', {\r\n        get: () => c.style.cursor,\r\n        set: v => c.style.cursor = v\r\n    })\r\n\r\n    // Add a state on double click\r\n    ip.on('dblclick', ev => {\r\n        const { x, y } = ev.client;\r\n\r\n        // Only add states when mode is default\r\n        if(modeStore.mode !== 'default') return;\r\n        stateStore.addState(new State(x, y));\r\n        // set the cursor to pointer after creating a state\r\n        canvas.cursor = 'pointer';\r\n    })\r\n\r\n    ip.on('drag', ev => {\r\n        const { x, y } = ev.dragDiff,\r\n            selected = mainStore.selected,\r\n            origin = mainStore.selectedOrigin;\r\n\r\n        // Only support drag when default mode\r\n        if(modeStore.mode !== 'default') return;\r\n\r\n        if(selected === undefined || !(selected instanceof State)) return;\r\n\r\n        const { x: ox, y: oy } = origin;\r\n\r\n        selected.pos.x = ox + x;\r\n        selected.pos.y = oy + y;\r\n    })\r\n\r\n    ip.on('dragend', ev => {\r\n        if(mainStore.selected) canvas.cursor = 'pointer';\r\n    })\r\n\r\n    // Monitor on clicks\r\n    ip.on('mousedown', ev => {\r\n        const { x , y } = ev.client;\r\n\r\n        const clicked = Util.FindHits(stateStore.states, x, y)[0];\r\n\r\n        mainStore.select(clicked);\r\n\r\n\r\n        if(modeStore.mode === 'linking'){\r\n            if(clicked instanceof State){\r\n                if(!modeStore.linkStart) modeStore.linkStart = clicked.label;\r\n                else modeStore.linkEnd = clicked.label;\r\n            }else modeStore.linkStart = '';\r\n        } \r\n        if(clicked === undefined) return;\r\n        if(modeStore.mode === 'delete') stateStore.removeState(clicked.label);\r\n    })\r\n\r\n    ip.on('mousemove', ev => {\r\n        const { x, y } = ev.client,\r\n            selected = mainStore.selected;\r\n\r\n        mouseStore.set(x, y);\r\n\r\n        const hovering = Util.FindHits(stateStore.states, x, y )[0];\r\n\r\n        let cursor = 'default';\r\n\r\n        // Manage cursors while moving\r\n        switch(modeStore.mode){\r\n            case 'default':\r\n                // When dragging\r\n                if(selected && ev.isDragging) cursor = 'grabbing'\r\n                else if(hovering) cursor = 'pointer'\r\n                break;\r\n            case 'linking':\r\n                if(modeStore.linkStart) cursor = 'crosshair';\r\n                else if(hovering instanceof State) cursor = 'copy';\r\n                break;\r\n            case 'delete':\r\n                if(hovering) cursor = 'crosshair';\r\n                break;\r\n        }\r\n\r\n\r\n        canvas.cursor = cursor;\r\n    })\r\n\r\n    ip.on('mouseup', ev => {\r\n        // When stopped dragging\r\n    })\r\n\r\n    // Hotkeys \r\n    \r\n    window.ip = ip;\r\n\r\n    ip.on('C', () => {\r\n      modeStore.mode = 'linking';\r\n    })\r\n\r\n    ip.on('V', () => {\r\n        modeStore.mode = 'default';\r\n    })\r\n\r\n    ip.on('D', () => {\r\n        modeStore.mode = 'delete';\r\n    })\r\n}\r\n\r\nexport function focus(){\r\n    ip.focus();\r\n    ip.monitor.focus()\r\n}\r\n\r\nexport function getMonitor(){\r\n    return ip.monitor;\r\n}","const project = 'DFAREGEX';\r\n\r\nexport default class Local {\r\n    static get = (item, def) => {\r\n        const value = localStorage.getItem(`${project}${item}`);\r\n        \r\n        if(value === null) return def || null;\r\n        \r\n        let parsed;\r\n\r\n        try { parsed = JSON.parse(value) }\r\n        catch{ parsed = value }\r\n\r\n        return parsed;\r\n    }\r\n\r\n    static set = (item, value) => {\r\n        try {\r\n            if(typeof value !== 'string') value = JSON.stringify(value)\r\n            localStorage.setItem(`${project}${item}`, value);\r\n        }catch(e){\r\n            alert(`Session Storage Error: ${e}`);\r\n        }\r\n    }\r\n\r\n    static has = item => this.get(item) !== null;\r\n\r\n    static remove = item => localStorage.removeItem(item);\r\n}","import { defineStore } from \"pinia\";\r\nimport { useAlphabetStore } from \"./alphabetStore\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport { useMainStore } from \"./mainStore\";\r\nimport State from \"@/commons/graph/State\";\r\n\r\nconst saveAsFile = (data, filename) => {\r\n    const pom = document.createElement('a');\r\n    pom.setAttribute('href', `data:text/plain;charset-utf-8,${encodeURIComponent(data)}`);\r\n    pom.setAttribute(\"download\", filename);\r\n\r\n    if(document.createEvent){\r\n        const ev = document.createEvent(\"MouseEvent\");\r\n        ev.initEvent('click', true, true);\r\n        pom.dispatchEvent(ev);\r\n    }else{\r\n        pom.click();\r\n    }\r\n}\r\n\r\nexport const useFileStore = defineStore('file', () => {\r\n    \r\n    const alphabetStore = useAlphabetStore(),\r\n        stateStore = useStateStore(),\r\n        transitionStore = useTransitionStore(),\r\n        mainStore = useMainStore();\r\n\r\n    const getFSMAsJSON = () => {\r\n        // Get all alphabet\r\n        const alphabet = [...alphabetStore.alphabet];\r\n        // Get all states, and their positions, and configurations (start/end)\r\n        const states = stateStore.states.map(s => {\r\n            return {\r\n                label: s.label,\r\n                x: s.pos.x,\r\n                y: s.pos.y\r\n            }\r\n        })\r\n        // Get all transitions\r\n        const transitions = transitionStore.transitions.map(t => {\r\n            return {\r\n                values: [...t.v],\r\n                from: t.from.label,\r\n                to: t.to.label\r\n            }\r\n        })\r\n        // Get DFA Information\r\n        const start = stateStore.savedStart?.label,\r\n            final = stateStore.accepting.map(s => s.label);\r\n\r\n        return {\r\n            alphabet: alphabet,\r\n            states: states,\r\n            transitions: transitions,\r\n            start: start,\r\n            final: final\r\n        }\r\n    }\r\n\r\n    const saveDFA = filename => {\r\n        const { alphabet, states, start, transitions, final } = getFSMAsJSON();\r\n\r\n        // Save as json string\r\n        saveAsFile(JSON.stringify({\r\n            alphabet: alphabet,\r\n            states: states,\r\n            transitions: transitions,\r\n            start: start,\r\n            final: final\r\n        }), `${filename}.json`);\r\n    }\r\n\r\n    const loadDFA = data => {\r\n        if(data === undefined) return;\r\n\r\n        const { alphabet, final, states, transitions, start } = data;\r\n\r\n        console.log(\"Imported Data: \", data);\r\n\r\n        mainStore.deleteAll();\r\n        alphabetStore.removeAll();\r\n\r\n        try {\r\n            // Add alphabet\r\n            alphabet.forEach(a => alphabetStore.addAlphabet(a));\r\n\r\n            // Generate States\r\n            states.forEach(s => {\r\n                const gen = new State(s.x, s.y);\r\n                gen.label = s.label;\r\n\r\n                if(final.includes(s.label)) gen.isFinish = true;\r\n                stateStore.addState(gen);\r\n            })\r\n\r\n            if(start && states.includes(start)) stateStore.setStart(start);\r\n\r\n            // Generate Transitions\r\n            transitions.forEach(t => {\r\n                const { values, from, to } = t;\r\n\r\n                transitionStore.addTransition({\r\n                    labels: values,\r\n                    from: from,\r\n                    to: to\r\n                })\r\n            })\r\n\r\n            mainStore.genRegex();\r\n        }catch(err){\r\n            console.log(err);\r\n            alert(\"Please import a correct file\");\r\n        }\r\n    }\r\n\r\n    return {\r\n        saveDFA,\r\n        loadDFA,\r\n        getFSMAsJSON\r\n    }\r\n})","import { defineStore } from \"pinia\";\r\nimport { ref, watch } from \"vue\";\r\nimport { useMainStore } from \"./mainStore\";\r\nimport Local from \"@/commons/Local\";\r\nimport { useFileStore } from \"./fileStore\";\r\n\r\nexport const useSettingStore = defineStore('setting', () => {\r\n    const mainStore = useMainStore(),\r\n        fileStore = useFileStore();\r\n\r\n    const simplifyDFARegex = ref(true);\r\n    const saveFSMOnExit = ref(false);\r\n\r\n    watch(simplifyDFARegex, () => {\r\n        mainStore.genRegex();\r\n    })\r\n\r\n    const startSync = () => {\r\n        // Sync with local storage\r\n        const data = Local.get('config');\r\n\r\n        if(data === null) return;\r\n\r\n        simplifyDFARegex.value = data.simplifyDFARegex;\r\n        saveFSMOnExit.value = data.saveFSMOnExit;\r\n\r\n        if(saveFSMOnExit.value) fileStore.loadDFA(data.fsmData);\r\n\r\n        // Listen for when the page closes/refreshes\r\n        window.addEventListener(\"beforeunload\", () => save());\r\n    }\r\n\r\n    const save = () => {\r\n        // Save current settings to local storage\r\n        const fsmData = saveFSMOnExit.value ? fileStore.getFSMAsJSON() : null;\r\n\r\n        Local.set('config', {\r\n            simplifyDFARegex: simplifyDFARegex.value,\r\n            saveFSMOnExit: saveFSMOnExit.value,\r\n            fsmData: fsmData\r\n        })\r\n    }\r\n\r\n    return {\r\n        simplifyDFARegex,\r\n        saveFSMOnExit,\r\n        sync: startSync\r\n    }\r\n});","import { focus, getMonitor, initCanvas, monitor } from \"@/commons/canvas/CanvasInit\";\r\nimport State from \"@/commons/graph/State\";\r\nimport Transition from \"@/commons/graph/Transition\";\r\nimport { defineStore } from \"pinia\";\r\nimport { computed, reactive, ref } from \"vue\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport noam from \"@/plugins/noam\";\r\nimport Victor from \"victor\";\r\nimport { useAlphabetStore } from \"./alphabetStore\";\r\nimport { useSettingStore } from \"./settingsStore\";\r\n\r\nexport const useMainStore = defineStore(\"main\", () => {\r\n\r\n    const stateStore = useStateStore(),\r\n        transitionStore = useTransitionStore(),\r\n        alphabetStore = useAlphabetStore(),\r\n        settingsStore = useSettingStore();\r\n\r\n    /**@type {State} */\r\n    const selected = ref(undefined),\r\n        selectedOrigin = ref({x: 0, y: 0});\r\n\r\n    // Input Processor\r\n    const processInput = c => {\r\n        // set height and width;\r\n        c.width = c.clientWidth;\r\n        c.height = c.clientHeight;\r\n\r\n        monitor(c);\r\n        initCanvas();\r\n    }\r\n\r\n    const select = o => {\r\n        selected.value = o;\r\n        if(!(o instanceof State)) return;\r\n        \r\n        selectedOrigin.value.x = o.pos?.x;\r\n        selectedOrigin.value.y = o.pos?.y;\r\n    }\r\n\r\n    const inputFocus = () => focus();\r\n\r\n    const deleteAll = () => {\r\n        select(undefined);\r\n        stateStore.states.splice(0);\r\n        transitionStore.transitions.splice(0);\r\n    }\r\n\r\n    const checkForValidity = () => {\r\n        const states = stateStore.states,\r\n            transition = transitionStore.transitions,\r\n            initial = stateStore.savedStart,\r\n            accepting = stateStore.accepting;\r\n\r\n        if(initial === undefined ||\r\n            states.length === 0 ||\r\n            transition.length === 0 ||\r\n            accepting.length === 0) return false;\r\n\r\n            // TODO: More checks\r\n\r\n        return true;\r\n    }\r\n\r\n    const genDFA = regex => {\r\n        deleteAll();\r\n\r\n        let a;\r\n\r\n        try{\r\n            \r\n            a = noam.re.string.toAutomaton(regex);\r\n            a = noam.fsm.convertEnfaToNfa(a);\r\n            a = noam.fsm.convertNfaToDfa(a);\r\n            a = noam.fsm.minimize(a);\r\n            a = noam.fsm.convertStatesToNumbers(a);\r\n            \r\n        }catch(err){\r\n            console.log(err);\r\n        }\r\n\r\n        const { states: st, alphabet: al, acceptingStates: acc, initialState: ini, transitions: trs} = a;\r\n\r\n        const { clientHeight: h, clientWidth: w } = getMonitor();\r\n\r\n        const hand = new Victor(0, 250),\r\n            center = new Victor(w/2, h/2);\r\n\r\n        // Set alphabet\r\n        alphabetStore.removeAll();\r\n        al.forEach(c => alphabetStore.addAlphabet(c));\r\n\r\n        // Generate the states first (circular layout)\r\n        st.forEach((s, i) => {\r\n            const gens = new State(...hand.clone().add(center).toArray(), `q${s}`);\r\n            stateStore.addState(gens)\r\n            if(s === ini) gens.isStart = true;\r\n            hand.rotateDeg(360 / st.length);\r\n            if(acc.includes(s)) gens.isFinish = true;\r\n        })\r\n\r\n        // Set transitions\r\n        trs.forEach(t => {\r\n\r\n            const { fromState, symbol, toStates: toStateArr } = t,\r\n                toState = toStateArr[0];\r\n\r\n            transitionStore.addTransition({\r\n                labels: [symbol],\r\n                from: `q${fromState}`,\r\n                to: `q${toState}`\r\n            })\r\n        })\r\n    }\r\n\r\n    const regexResult = ref('');\r\n\r\n    const formal_specs = computed(() => {\r\n\r\n        const states = stateStore.states,\r\n            transition = transitionStore.transitions,\r\n            initial = stateStore.savedStart,\r\n            accepting = stateStore.accepting;\r\n\r\n        return `#states\r\n${states.map(s => s.label).join('\\n')}\r\n#initial\r\n${initial?.label}\r\n#accepting\r\n${accepting.map(a => a.label).join('\\n')}\r\n#alphabet\r\n${alphabetStore.alphabet.join('\\n')}\r\n#transitions\r\n${transition.map(t => t.str()).join('\\n')}`;\r\n    });\r\n\r\n    const genRegex = () => {\r\n\r\n        // validate first\r\n        if(!checkForValidity()) return;\r\n\r\n        const str = formal_specs.value;\r\n\r\n        let a, r;\r\n\r\n        try {\r\n            a = noam.fsm.parseFsmFromString(str);\r\n            a = noam.fsm.minimize(a);\r\n            a = noam.fsm.toRegex(a);\r\n            a = noam.re.tree.simplify(a, {\"useFsmPatterns\": settingsStore.simplifyDFARegex});\r\n            r = noam.re.tree.toString(a);\r\n        }catch(err){\r\n            regexResult.value = '';\r\n            console.log(err);\r\n        }\r\n\r\n        regexResult.value = r;\r\n    }\r\n\r\n    return {\r\n        processInput,\r\n        inputFocus,\r\n\r\n        selected,\r\n        selectedOrigin,\r\n        select,\r\n\r\n        deleteAll,\r\n        checkForValidity,\r\n        \r\n        genDFA,\r\n        genRegex,\r\n        regexResult,\r\n        \r\n        formal_specs\r\n    }\r\n}) ","<template>\r\n    <canvas\r\n        ref=\"c\">\r\n\r\n    </canvas>\r\n</template>\r\n\r\n<script>\r\nimport { useMainStore } from '@/stores/mainStore';\r\nimport { useAlphabetStore } from '@/stores/alphabetStore';\r\nimport { useStateStore } from '@/stores/stateStore';\r\nimport { useTransitionStore } from '@/stores/transitionStore';\r\nimport { ref, computed } from 'vue';\r\nimport { Drawables } from '@/commons/canvas/Drawables';\r\n\r\nwindow.Drawables = Drawables;\r\n\r\nexport default {\r\n    setup () {\r\n\r\n        const c = ref(null),\r\n            ctxRef = computed(() => c.value.getContext('2d')),\r\n            mainStore = useMainStore(),\r\n            alphabetStore = useAlphabetStore(),\r\n            transitionStore = useTransitionStore(),\r\n            stateStore = useStateStore(),\r\n            rafID = ref(0);\r\n\r\n\r\n        const states = computed(() => stateStore.states),\r\n            transitions = computed(() => transitionStore.transitions);\r\n\r\n        const animate = () => {\r\n            const { clientHeight: h, clientWidth: w} = c.value;\r\n            /**@type {CanvasRenderingContext2D} */\r\n            const ctx = ctxRef.value;\r\n            \r\n            // Clear Canvas\r\n            ctx.clearRect(0, 0, w, h);\r\n\r\n            // Draw States\r\n            states.value.forEach(s => s.draw(ctx));\r\n\r\n            // Draw Transitions\r\n            transitions.value.forEach(t => t.draw(ctx));\r\n\r\n            // Draw Drawables\r\n            Drawables.instances.forEach(d => d.draw(ctx));\r\n\r\n            rafID.value = requestAnimationFrame(animate);\r\n        }\r\n\r\n        return {\r\n            c,\r\n            mainStore,\r\n            \r\n            rafID,\r\n            animate\r\n        }\r\n    },\r\n    mounted(){\r\n        // Set canvas element to process any incoming input\r\n        this.mainStore.processInput(this.c);\r\n\r\n        this.animate();\r\n    },\r\n    beforeUnmount(){\r\n        cancelAnimationFrame(this.rafID);\r\n    },\r\n    emits: ['select:node']\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import { render } from \"./FSMVisualizer.vue?vue&type=template&id=3c8998b0\"\nimport script from \"./FSMVisualizer.vue?vue&type=script&lang=js\"\nexport * from \"./FSMVisualizer.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div class=\"flex flex-col gap-2\">\r\n        <!-- Alphabet -->\r\n        <div class=\"flex justify-between\">\r\n          <div class=\"text-2xl\">Alphabet</div>\r\n\r\n          <v-btn \r\n            color=\"red\" \r\n            density=\"comfortable\" \r\n            @click=\"resetAlphabet\"\r\n            v-if=\"resetAble\">Reset</v-btn>\r\n\r\n        </div>\r\n        \r\n        <!-- Alphabet List -->\r\n        <v-container class=\"p-0\">\r\n          <v-row\r\n            align=\"center\"\r\n            justify=\"start\"\r\n            noGutters\r\n            class=\" gap-x-1 gap-y-0.5\">\r\n            <v-col\r\n              v-for=\"c in alphabet\" :key=\"c+''+Math.random()\"\r\n              cols=\"auto\">\r\n              <v-chip\r\n                closable\r\n                @click:close=\"removeAlphabet(c)\"\r\n                size=\"small\">\r\n                {{ c }}\r\n              </v-chip>\r\n            </v-col>\r\n          </v-row>\r\n        </v-container>\r\n\r\n        <div class=\"\">\r\n          <v-text-field \r\n            label=\"Add alphabet\"\r\n            variant=\"solo-filled\"\r\n            placeholder=\"Press Enter to add\" \r\n            v-model=\"temp\"\r\n            maxLength=\"1\"\r\n            clearable\r\n            hideDetails\r\n            @keydown.enter=\"addAlphabet(temp); temp = ''\" />\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useAlphabetStore } from '@/stores/alphabetStore';\r\nimport { computed, ref } from 'vue';\r\n\r\nexport default {\r\n    setup () {\r\n        \r\n        const store = useAlphabetStore(),\r\n            alphabet = computed(() => store.alphabet);\r\n\r\n        const temp = ref('');\r\n\r\n        const resetAble = computed(() => {\r\n\r\n            return alphabet.value.length !== 2 ||\r\n                !alphabet.value.every(v => v === 'a' || v === 'b');\r\n        })\r\n\r\n        return {\r\n            temp,\r\n            alphabet,\r\n            resetAlphabet: () => store.resetAlphabet(),\r\n            removeAlphabet: c => store.removeAlphabet(c),\r\n            addAlphabet: c => store.addAlphabet(c),\r\n\r\n            resetAble\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import { render } from \"./AlphabetLister.vue?vue&type=template&id=3a8c942e\"\nimport script from \"./AlphabetLister.vue?vue&type=script&lang=js\"\nexport * from \"./AlphabetLister.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div>\r\n        <v-dialog\r\n            @click:outside=\"cancel\"\r\n            v-model=\"open\"\r\n            width=\"auto\"\r\n            min-width=\"300px\">\r\n            <v-sheet class=\"flex gap-2 p-4 pt-3 flex-col\">\r\n                <div class=\"text-2xl pb-1\">Create Transition \r\n                    <div class=\"text-subtitle-1 text-neutral-400\">\r\n                        {{ modeStore.linkStart }}  {{ modeStore.linkEnd }}\r\n                    </div>\r\n                </div>\r\n                <v-btn-toggle\r\n                    multiple\r\n                    class=\"flex-col h-auto\"\r\n                    rounded=\"0\"\r\n                    v-model=\"selectedItems\">\r\n                    <v-btn v-for=\"a in alphabet\" :key=\"a\"\r\n                        style=\"height: 36px;\" :value=\"a\">\r\n                        {{  a }}\r\n                    </v-btn>\r\n                </v-btn-toggle>\r\n                <div>\r\n                    <v-btn :disabled=\"selectedItems.length === 0\" block color=\"success\" @click=\"add\">\r\n                        Add\r\n                    </v-btn>\r\n                </div>\r\n            </v-sheet>\r\n        </v-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useAlphabetStore } from '@/stores/alphabetStore';\r\nimport { useModeStore } from '@/stores/modeStore';\r\nimport { useTransitionStore } from '@/stores/transitionStore';\r\nimport { useMainStore } from '@/stores/mainStore';\r\nimport { watch } from 'vue';\r\nimport { ref } from 'vue';\r\nimport { computed } from 'vue';\r\n\r\nexport default {\r\n    setup () {\r\n        const modeStore = useModeStore();\r\n        const alphabetStore = useAlphabetStore();\r\n        const transitionStore = useTransitionStore();\r\n        const mainStore = useMainStore();\r\n\r\n        const open = computed({\r\n            get: () => modeStore.openTransitionDialog,\r\n            set: v => modeStore.openTransitionDialog = v\r\n        });\r\n\r\n        watch(open, v => {\r\n            const { linkStart: start, linkEnd: end } = modeStore;\r\n            // Find existing label\r\n            const ex = transitionStore.getTransition(start, end);\r\n            if(ex === undefined) return;\r\n\r\n            selectedItems.value.push(...ex.v);\r\n\r\n            mainStore.inputFocus();\r\n        })\r\n\r\n        const alphabet = computed(() => alphabetStore.alphabet);\r\n        const selectedItems = ref([]);\r\n\r\n        const cancel = () => {\r\n            modeStore.linkReset();\r\n            selectedItems.value.splice(0);\r\n        }\r\n\r\n        const add = () => {\r\n\r\n            transitionStore.addTransition({\r\n                labels: [...selectedItems.value],\r\n                from: modeStore.linkStart,\r\n                to: modeStore.linkEnd\r\n            })\r\n\r\n            selectedItems.value.splice(0);\r\n            open.value = false;\r\n            modeStore.linkReset();\r\n        }\r\n\r\n        return {\r\n            open,\r\n            alphabet,\r\n            modeStore,\r\n            selectedItems,\r\n            \r\n            cancel,\r\n            add,\r\n\r\n            transitionStore,\r\n            modeStore\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.v-btn-toggle {\r\n    flex-direction: column;\r\n}\r\n</style>","import { render } from \"./TransitionFab.vue?vue&type=template&id=2a8447b3&scoped=true\"\nimport script from \"./TransitionFab.vue?vue&type=script&lang=js\"\nexport * from \"./TransitionFab.vue?vue&type=script&lang=js\"\n\nimport \"./TransitionFab.vue?vue&type=style&index=0&id=2a8447b3&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2a8447b3\"]])\n\nexport default __exports__","<template>\r\n    <div v-if=\"state !== undefined\" class=\"flex flex-grow flex-col gap-2\">\r\n        <div class=\"flex justify-between items-end\">\r\n            <div class=\"text-2xl\">State</div>\r\n            <span class=\"text-caption text-neutral-500\">[{{ state.pos.x.toFixed(0) }}, {{ state.pos.y.toFixed(0) }}]</span>\r\n        </div>\r\n        <div>\r\n            <v-text-field\r\n                v-model=\"state.label\"\r\n                hide-details\r\n                variant=\"solo-filled\"\r\n                label=\"State Label\"\r\n                density=\"compact\"\r\n                clearable>\r\n\r\n            </v-text-field>\r\n        </div>\r\n        <div>\r\n            <v-btn\r\n                block\r\n                color=\"#DC143C\"\r\n                @click=\"stateStore.removeState(label)\">\r\n                Delete State\r\n            </v-btn>\r\n        </div>\r\n\r\n        <div class=\"px-2\">\r\n            <div>\r\n                <v-switch\r\n                    hide-details\r\n                    density=\"compact\"\r\n                    :true-value=\"true\"\r\n                    :false-value=\"false\"\r\n                    v-model=\"tempIsStart\"\r\n                    @change=\"changeStartStatus\"\r\n                    :label=\"'Starting State'\">\r\n                </v-switch>\r\n            </div>\r\n            <div>\r\n            <v-switch\r\n                hide-details\r\n                density=\"compact\"\r\n                v-model=\"state.isFinish\"\r\n                :label=\"'Ending State'\"\r\n                @change=\"mainStore.genRegex()\">\r\n            </v-switch>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"text-subtitle-1\">\r\n            Transitions\r\n        </div>\r\n\r\n        <div class=\"flex flex-col flex-grow gap-2\">\r\n            <div v-for=\"(t, index) in transArr\" :key=\"t.to\"\r\n            class=\"flex gap-2\">\r\n                <div class=\"text-button w-12 flex justify-center items-center overflow-hidden\">\r\n                    <v-btn @click=\"setSelectedState(t.to)\">\r\n                        {{ t.to }}\r\n                    </v-btn>\r\n                </div>\r\n                <div class=\"flex-grow\">\r\n                    <v-autocomplete \r\n                        clearable\r\n                        chips\r\n                        label=\"Labels\"\r\n                        :items=\"alphabet\"\r\n                        multiple\r\n                        hide-details\r\n                        variant=\"outlined\"\r\n                        @update:model-value=\"v => updateTransition(t.to, v, index)\"\r\n                        v-model=\"t.vs\"\r\n                        density=\"compact\"/>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"flex flex-col gap-2\">\r\n\r\n            <v-divider></v-divider>\r\n\r\n            <div class=\"flex flex-col gap-2 pt-3\">\r\n                <div class=\"\">\r\n                    <v-autocomplete \r\n                        hide-details\r\n                        density=\"compact\"\r\n                        append-icon=\"\"\r\n                        variant=\"outlined\"\r\n                        label=\"Destination State\"\r\n                        :items=\"stateList\"\r\n                        v-model=\"tempLabel\"/>\r\n                </div>\r\n                <div class=\"flex-grow\">\r\n                    <v-autocomplete \r\n                        clearable\r\n                        chips\r\n                        label=\"Transition\"\r\n                        :items=\"alphabet\"\r\n                        append-icon=\"\"\r\n                        multiple\r\n                        hide-details\r\n                        variant=\"outlined\"\r\n                        v-model=\"tempTransitions\"\r\n                        density=\"compact\"/>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <v-btn block color=\"success\" @click=\"addTransition\"> \r\n                    Add Transition\r\n                </v-btn>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useAlphabetStore } from '@/stores/alphabetStore';\r\nimport { useMainStore } from '@/stores/mainStore';\r\nimport { useStateStore } from '@/stores/stateStore';\r\nimport { useTransitionStore } from '@/stores/transitionStore';\r\nimport { reactive, onMounted } from 'vue';\r\nimport { ref } from 'vue';\r\nimport { watch } from 'vue';\r\nimport { computed } from 'vue';\r\n\r\nexport default {\r\n    setup () {\r\n        const mainStore = useMainStore(),\r\n            transitionStore = useTransitionStore(),\r\n            alphabetStore = useAlphabetStore(),\r\n            stateStore = useStateStore();\r\n\r\n        const state = computed(() => mainStore.selected),\r\n            label = computed(() => state.value?.label),\r\n            alphabet = computed(() => alphabetStore.alphabet);\r\n\r\n        const transArr = reactive([]);\r\n\r\n        const associatedTransitions = computed(() => transitionStore.getTransitionsFrom(label.value));\r\n\r\n        const stateList = computed(() => stateStore.states.map(v =>  v.label)),\r\n            tempLabel = ref(''), tempTransitions = ref([]);\r\n\r\n        function updateTransArr(){\r\n            transArr.splice(0);\r\n            associatedTransitions.value.forEach(at => {\r\n                transArr.push({\r\n                    to: at.to.label,\r\n                    vs: [...at.v]\r\n                })\r\n            })\r\n        }\r\n\r\n        \r\n        const tempIsStart = ref(false);\r\n\r\n        // watch(tempIsStart, v => {\r\n        //     if(v) stateStore.setStart(label.value);\r\n        //     else if(state.value) state.value.isStart = false;\r\n        // })\r\n\r\n        const changeStartStatus = () => {\r\n            const v = tempIsStart.value;\r\n            if(v) stateStore.setStart(label.value);\r\n            else if(state.value) state.value.isStart = false;\r\n        }\r\n\r\n        watch(label, v => {\r\n            transArr.splice(0);\r\n            tempIsStart.value = false;\r\n            if(v === undefined) return;\r\n            updateTransArr();\r\n            tempIsStart.value = state.value.isStart;\r\n        })\r\n\r\n        const updateTransition = (to, v, index) => {\r\n            if(v.length === 0){\r\n                transitionStore.removeTransition(label.value, to);\r\n                transArr.splice(index, 1);\r\n                return;\r\n            }\r\n\r\n            transitionStore.addTransition({\r\n                labels: [...v],\r\n                from: label.value,\r\n                to: to\r\n            })\r\n        }   \r\n\r\n        const setSelectedState = label => {\r\n            const ts = stateStore.getState(label);\r\n            mainStore.select(ts);\r\n        }\r\n\r\n        const addTransition = () => {\r\n            transitionStore.addTransition({\r\n                labels: [...tempTransitions.value],\r\n                from: label.value,\r\n                to: tempLabel.value\r\n            })\r\n\r\n            updateTransArr();\r\n        }\r\n\r\n        watch(state, () => {\r\n            if(state.value !== undefined) return;\r\n            tempLabel.value = '';\r\n            tempTransitions.value.splice(0);\r\n        })\r\n\r\n        return {\r\n            state,\r\n            label,\r\n            associatedTransitions,\r\n            alphabet,\r\n            updateTransition,\r\n            transArr,\r\n            setSelectedState,\r\n            stateStore,\r\n            stateList,\r\n            tempLabel,\r\n            tempTransitions,\r\n            addTransition,\r\n            tempIsStart,\r\n            mainStore,\r\n            changeStartStatus\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import { render } from \"./StateHelper.vue?vue&type=template&id=621d8f72\"\nimport script from \"./StateHelper.vue?vue&type=script&lang=js\"\nexport * from \"./StateHelper.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <v-btn\r\n        variant=\"tonal\"\r\n        size=\"small\"\r\n        icon>\r\n        \r\n        <v-icon>mdi-cog</v-icon>\r\n\r\n        <v-dialog\r\n            v-model=\"expand\"\r\n            activator=\"parent\"\r\n            width=\"500px\"\r\n            max-height=\"80vh\">\r\n            <v-sheet\r\n            class=\"px-3 p-2 flex flex-col pb-4\">\r\n\r\n                <div class=\"text-2xl\">\r\n                    Settings\r\n                </div>\r\n\r\n                <div class=\"flex-grow overflow-y-auto flex flex-col gap-2 pt-2\">\r\n                    \r\n                    <div class=text-caption>Conversion</div>\r\n                    <div class=\"pl-5 flex flex-col gap-2\">\r\n                        <!--  Simplification -->\r\n                        <div>\r\n                            <v-switch\r\n                                v-model=\"settingsStore.simplifyDFARegex\"\r\n                                hide-details\r\n                                density=\"compact\">\r\n\r\n                                <template v-slot:label>\r\n                                    Simplified DFA-Regex\r\n                                    <span class=\"ml-1 bg-neutral-500/50 rounded-full w-5 h-5 flex justify-center items-center\">\r\n                                        \r\n                                        <v-icon size=\"xs\">mdi-help</v-icon>\r\n\r\n                                        <v-tooltip\r\n                                            activator=\"parent\">\r\n                                            Optimizes the result conversion to its most minimized version. <br>\r\n                                            $ - symbolizes the empty string\r\n                                        </v-tooltip>\r\n                                    </span>\r\n                                </template>\r\n\r\n                            </v-switch>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"text-caption\">Miscellaneous</div>\r\n                    <div class=\"px-5 flex flex-col gap-2\">\r\n                        <div>\r\n                            <v-switch\r\n                                v-model=\"settingsStore.saveFSMOnExit\"\r\n                                hide-details\r\n                                density=\"compact\"\r\n                                label=\"Save FSM on exit\">\r\n\r\n                            </v-switch>\r\n                        </div>\r\n                        <div>\r\n                            <v-btn elevation=\"3\" block\r\n                                @click=\"copyFormalSpecs\">\r\n                                Copy current machine formal specifications\r\n                            </v-btn>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n            </v-sheet>\r\n        </v-dialog>\r\n\r\n    </v-btn>\r\n</template>\r\n\r\n<script setup>\r\nimport Util from '../commons/Util';\r\nimport { useMainStore } from '@/stores/mainStore';\r\nimport { useSettingStore } from '@/stores/settingsStore';\r\nimport { ref } from 'vue';\r\n\r\n\r\nconst mainStore = useMainStore();\r\n\r\nconst settingsStore = useSettingStore();\r\n\r\nconst expand = ref(false);\r\n\r\nconst copyFormalSpecs = () => {\r\n    const text = mainStore.formal_specs;\r\n    Util.copyToClipboard(text);\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import script from \"./SettingsMenu.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SettingsMenu.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n    <div class=\"flex justify-center\">\r\n        <v-sheet class=\"px-4 p-2 pb-4 gap-2 d-flex flex-col\" rounded min-width=\"300px\">\r\n            <div class=\"text-xl\">Save File As</div>\r\n            <div>\r\n                <v-text-field \r\n                    variant=\"outlined\"\r\n                    label=\"Filename\"\r\n                    v-model=\"filename\"\r\n                    :rules=\"[v => !!v || 'Please assign a file name']\"/>\r\n            </div>\r\n            <div>\r\n                <v-btn color=\"success\" block :disabled=\"filename === '' || filename === null\"\r\n                    @click=\"save\">Save</v-btn>\r\n            </div>\r\n        </v-sheet>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue';\r\nimport { useFileStore } from '../stores/fileStore';\r\n\r\nconst fileStore = useFileStore();\r\n\r\nconst filename = ref('');\r\n\r\nconst save = () => {\r\n    fileStore.saveDFA(filename.value);\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import script from \"./SaveFile.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SaveFile.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=9079c2c0\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=9079c2c0&lang=scss\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","// Styles\nimport '@mdi/font/css/materialdesignicons.css'\nimport 'vuetify/styles'\n\n// Vuetify\nimport { createVuetify } from 'vuetify'\nimport * as directives from 'vuetify/directives';\nimport * as components from 'vuetify/components';\n\nexport default createVuetify({\n  directives,\n  components,\n  theme: {\n    defaultTheme: 'dark'\n  }\n})","/**\n * plugins/webfontloader.js\n *\n * webfontloader documentation: https://github.com/typekit/webfontloader\n */\n\nexport async function loadFonts () {\n  const webFontLoader = await import(/* webpackChunkName: \"webfontloader\" */'webfontloader')\n\n  webFontLoader.load({\n    google: {\n      families: ['Roboto:100,300,400,500,700,900&display=swap'],\n    },\n  })\n}\n","import { createApp } from 'vue'\r\nimport App from './App.vue'\r\nimport './index.css';\r\nimport vuetify from './plugins/vuetify'\r\nimport { loadFonts } from './plugins/webfontloader'\r\nimport { createPinia } from 'pinia'\r\n\r\nimport '@mdi/font/css/materialdesignicons.css'\r\n\r\nconst pinia = createPinia()\r\n\r\nloadFonts()\r\n\r\ncreateApp(App)\r\n  .use(pinia)\r\n  .use(vuetify)\r\n  .mount('#app')\r\n","/*\n * noam - JavaScript library for working with automata and grammars for \n *        regular and context-free languages. https://github.com/izuzak/noam\n *\n * Copyright 2012 Ivan Zuzak, Ivan Budiselic\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function (noam) {\n\n  /*\n   * Expose the module to the 'world' when loaded via CommonJS/NodeJS, \n   * AMD and <script> tags.\n   */\n\n  if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n    module.exports = noam; // NodeJS\n  }\n  \n  if (typeof exports !== 'undefined' && typeof exports !== \"function\") {\n    exports.noam = noam; // CommonJs\n  }\n\n  if (typeof define === \"function\" && define.amd) {\n    define('noam', [], function () { return noam; } ); // AMD\n  }\n\n  if (typeof window !== 'undefined') {\n    window.noam = noam;  // <script>\n  }\n\n}((function () {\n\n  var noam = {};\n\n  noam.util = {};\n\n  // \"deep\" compare of two objects\n  // taken from http://stackoverflow.com/questions/1068834/object-comparison-in-javascript\n  noam.util.areEquivalent = function(object1, object2) {\n    if (object1 === object2) {\n      return true;\n    }\n\n    if (object1 instanceof Date && object2 instanceof Date) {\n      return object1.getTime() === object2.getTime();\n    }\n\n    if (object1 instanceof RegExp && object2 instanceof RegExp) {\n      return object1.source === object2.source &&\n             object1.global === object2.global &&\n             object1.multiline === object2.multiline &&\n             object1.lastIndex === object2.lastIndex &&\n             object1.ignoreCase === object2.ignoreCase;\n    }\n\n    if (!(object1 instanceof Object) || !(object2 instanceof Object) ) {\n      return false;\n    }\n\n    if (typeof object1 === 'undefined' || typeof object2 === 'undefined') {\n      return false;\n    }\n\n    if (object1.constructor !== object2.constructor) {\n      return false;\n    }\n\n    for (var p in object1) {\n      if (!(p in object2)) {\n        return false;\n      }\n\n      if (object1[p] === object2[p]) {\n        continue;\n      }\n\n      if (typeof(object1[p]) !== \"object\") {\n        return false;\n      }\n\n      if (!(noam.util.areEquivalent(object1[p], object2[p]))) {\n        return false;\n      }\n    }\n\n    for (p in object2) {\n      if (!(p in object1)) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  // check if array arr contains obj starting from index startIndex\n  noam.util.contains = function(arr, obj, startIndex) {\n    startIndex = startIndex ? startIndex : 0;\n\n    for (var i=startIndex; i<arr.length; i++) {\n      if (noam.util.areEquivalent(arr[i], obj)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // returns the index of the leftmost obj instance in arr starting from startIndex or -1\n  // if no instance of obj is found\n  noam.util.index = function(arr, obj, startIndex) {\n    var i = startIndex || 0;\n    while (i < arr.length) {\n      if (noam.util.areEquivalent(arr[i], obj)) {\n        return i;\n      }\n      i++;\n    }\n    return -1;\n  };\n\n  // check if array arr1 contains all elements from array arr2\n  noam.util.containsAll = function(arr1, arr2) {\n    for (var i=0; i<arr2.length; i++) {\n      if (!(noam.util.contains(arr1, arr2[i]))) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  // check if array arr1 contains any element from array arr2\n  noam.util.containsAny = function(arr1, arr2) {\n    for (var i=0; i<arr2.length; i++) {\n      if (noam.util.contains(arr1, arr2[i])) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // check if arrays arr1 and arr2 contain the same elements\n  noam.util.areEqualSets = function(arr1, arr2) {\n    if (arr1.length !== arr2.length) {\n      return false;\n    }\n\n    for (var i=0; i<arr1.length; i++) {\n      if (!(noam.util.contains(arr2, arr1[i]))) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  // check if array arr1 contains the set obj\n  noam.util.containsSet = function(arr1, obj) {\n    for (var i=0; i<arr1.length; i++) {\n      if (noam.util.areEqualSets(arr1[i], obj)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // returns an unsorted array representation of the union of the two arrays arr1 and arr2\n  // with each element included exactly once, regardless of the count in arr1 and arr2\n  noam.util.setUnion = function(arr1, arr2) {\n    var res = [];\n    var i;\n    for (i=0; i<arr1.length; i++) {\n      // this will not include duplicates from arr1\n      if (!noam.util.contains(res, arr1[i])) {\n        res.push(arr1[i]);\n      }\n    }\n    for (i=0; i<arr2.length; i++) {\n      if (!noam.util.contains(res, arr2[i])) {\n        res.push(arr2[i]);\n      }\n    }\n    return res;\n  };\n\n  // returns an unsorted array representation of the intersection of the two\n  // arrays arr1 and arr2 with each element included exactly once, regardless\n  // of the count in arr1 and arr2\n  noam.util.setIntersection = function(arr1, arr2) {\n    var res = [];\n    var i;\n    for (i=0; i<arr1.length; i++) {\n      if (noam.util.contains(arr2, arr1[i])) {\n        res.push(arr1[i]);\n      }\n    }\n\n    return res;\n  };\n\n  // make a deep clone of an object\n  noam.util.clone = function(obj) {\n    return JSON.parse(JSON.stringify(obj));\n  };\n\n\n  // Returns an object that is basically an integer reference useful for counting\n  // across multiple function calls. The current value can be accessed through the\n  // value property.\n  // See the noam.re.tree.toAutomaton function for a usage example.\n  noam.util.makeCounter = (function() {\n    function getAndAdvance() {\n      return this.value++;\n    }\n\n    function makeCounter(init) {\n      return {\n        value: init,\n        getAndAdvance: getAndAdvance\n      };\n    }\n\n    return makeCounter;\n  })();\n\n\n  // Returns a random integer from the interval [from, to].\n  noam.util.randint = function(from, to) {\n    return Math.floor(Math.random()*(to-from+1)) + from;\n  };\n\n  var structure = {};\n\n  /* General purpose hashtable implementation.\n   * Note that all the performance guarantees assume (as usual for hashtables) that\n   *    1) hashing keys is O(1)\n   *    2) comparing keys for equality is O(1)\n   *    3) array access in JS is O(1)\n   * In other words, the guarantees specify the number of these\n   * three operations for any hashtable operation, rather than\n   * actual time.\n   */\n  (function() {\n    var CAPACITY_CHOICES = [5, 11, 23, 47, 97, 197, 397, 797, 1597, 3203, 6421, 12853,\n        25717, 51437, 102877, 205759, 411527, 823117, 1646237, 3292489, 6584983,\n        13169977, 26339969, 52679969, 105359939];\n\n    var DEFAULT_INITIAL_CAPACITY_IDX = 0;\n    var HASH_MASK = (1<<31) - 1; // keeps everything nonnegative int32\n    var LF_HIGH = 0.75; // load factor upper limit\n    var LF_LOW = 0.25; // load factor lower limit\n\n    // See http://perfectionkills.com/instanceof-considered-harmful-or-how-to-write-a-robust-isarray/\n    function _isArray(obj) {\n      return Object.prototype.toString.call(obj) === \"[object Array]\";\n    }\n\n    function _get_capacity_index(wanted) {\n      wanted = Math.max(wanted, CAPACITY_CHOICES[0]);\n      wanted = Math.min(wanted, CAPACITY_CHOICES[CAPACITY_CHOICES.length-1]);\n      var lo = 0;\n      var hi = CAPACITY_CHOICES.length - 1;\n      var mid;\n      // binary search for the smallest capacity no smaller than wanted\n      while (lo < hi) {\n        mid = lo + Math.floor((hi-lo)/2);\n        if (CAPACITY_CHOICES[mid] >= wanted) {\n          hi = mid;\n        } else {\n          lo = mid + 1;\n        }\n      }\n      return lo;\n    }\n\n    // TODO: needs serious testing\n    function _defaultHash(obj) {\n      var h, i;\n      if (obj === undefined) { // undefined might be a \"value\" of some property\n        return 12345; // arbitrary constant\n      }\n      if (obj === null) {\n        return 54321; // arbitrary constant\n      }\n      if (typeof obj===\"boolean\" || typeof obj===\"number\") {\n        return obj & HASH_MASK;\n      }\n      if (typeof obj===\"string\") {\n        h = 5381;\n        for (i=0; i<obj.length; i++) {\n          h = ((h*33) ^ obj.charCodeAt(i)) & HASH_MASK;\n        }\n        return h;\n      }\n      if (_isArray(obj)) {\n        h = 6421;\n        for (i=0; i<obj.length; i++) {\n          h = ((h*37) ^ _defaultHash(obj[i])) & HASH_MASK;\n        }\n        return h;\n      }\n\n      // objects\n      var props = [];\n      for (i in obj) {\n        if (!(obj.hasOwnProperty(i))) {\n          continue;\n        }\n        props.push(i);\n      }\n      props.sort(); // sort them so that logically equal object get the same hash\n\n      h = 3203;\n      for (i=0; i<props.length; i++) {\n        // hash both the property name and its value\n        h = ((((h*39) ^ _defaultHash(props[i])) * 43) ^ _defaultHash(obj[props[i]])) & HASH_MASK;\n      }\n      return h;\n    }\n\n    // \"deep\" compare of two objects\n    // taken from http://stackoverflow.com/questions/1068834/object-comparison-in-javascript\n    function _defaultEquals(object1, object2) {\n      if (object1 === object2) {\n        return true;\n      }\n\n      if (object1 instanceof Date && object2 instanceof Date) {\n        return object1.getTime() === object2.getTime();\n      }\n\n      if (object1 instanceof RegExp && object2 instanceof RegExp) {\n        return object1.source === object2.source &&\n               object1.global === object2.global &&\n               object1.multiline === object2.multiline &&\n               object1.lastIndex === object2.lastIndex &&\n               object1.ignoreCase === object2.ignoreCase;\n      }\n\n      if (!(object1 instanceof Object) || !(object2 instanceof Object) ) {\n        return false;\n      }\n\n      if (typeof object1 === 'undefined' || typeof object2 === 'undefined') {\n        return false;\n      }\n\n      if (object1.constructor !== object2.constructor) {\n        return false;\n      }\n\n      for (var p in object1) {\n        if (!(p in object2)) {\n          return false;\n        }\n\n        if (object1[p] === object2[p]) {\n          continue;\n        }\n\n        if (typeof(object1[p]) !== \"object\") {\n          return false;\n        }\n\n        if (!(_defaultEquals(object1[p], object2[p]))) {\n          return false;\n        }\n      }\n\n      for (p in object2) {\n        if (!(p in object1)) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    /* Constructor for hash chain nodes.\n     *\n     * Each node has three properties:\n     *  - key: the key of the key-value pair\n     *  - value: the value of the key-value pair\n     *  - next: either another _HashChainNode or undefined if this is the last node\n     *          of the chain\n     */\n    function _HashChainNode(key, value) {\n      this.key = key;\n      this.value = value;\n    }\n\n    /* Constructor for an empty hash chain used for collision resolution.\n     *\n     * Every _HashChain has just one property:\n     *  - head: the first _HashChainNode of the chain or undefined if the chain is\n     *          empty\n     */\n    function _HashChain() {\n      // intentionally empty\n    }\n\n    // Returns true iff the chain is empty.\n    _HashChain.prototype.isEmpty = function() {\n      return this.head === undefined;\n    };\n\n    // Adds the new node to the front of the chain.\n    _HashChain.prototype.insertHead = function(node) {\n      node.next = this.head;\n      this.head = node;\n    };\n\n    /* Removes the successor of @a node from the chain. It is assumed that\n     * the successor exists.\n     *\n     * If @a node equals undefined, removes the head of the chain.\n     */\n    _HashChain.prototype.removeSuccessor = function(node) {\n      if (node === undefined) {\n        this.head = this.head.next;\n      } else {\n        node.next = node.next.next;\n      }\n    };\n\n    /* Inserts the key-value pair into the chain.\n     * @a H is the HashTable that contains this chain.\n     *\n     * Returns true iff @a key is a new key that was not previously in the table.\n     */\n    _HashChain.prototype.put = function(H, key, value) {\n      // first search for the key\n      var iter = this.iterator();\n      while (iter.hasNext()) {\n        var node = iter.next();\n        if (H.equals(key, node.key)) {\n          // old key; just replace the value\n          node.value = value;\n          return false;\n        }\n      }\n      // new key\n      this.insertHead(new _HashChainNode(key, value));\n      return true;\n    };\n\n    /* Returns the value associated with @a key in the chain or undefined\n     * if @a key is not found in the chain.\n     */\n    _HashChain.prototype.get = function(H, key) {\n      var iter = this.iterator();\n      while (iter.hasNext()) {\n        var node = iter.next();\n        if (H.equals(key, node.key)) {\n          return node.value;\n        }\n      }\n      return undefined;\n    };\n\n    /* Removes the key-value pair with the given key from the chain. Does nothing\n     * if there is no key-value pair with the given key in the chain.\n     *\n     * Returns true iff a key-value pair was actually removed.\n     */\n    _HashChain.prototype.remove = function(H, key) {\n      var iter = this.iterator();\n      var prev; // intentionally undefined\n      while (iter.hasNext()) {\n        var node = iter.next();\n        if (H.equals(key, node.key)) {\n          this.removeSuccessor(prev);\n          return true;\n        }\n        prev = node;\n      }\n      return false;\n    };\n\n    /* Constructor for a hash chain iterator.\n     *\n     * Every iterator has two methods:\n     *  - hasNext: returns true iff there is another node in the chain\n     *  - next: returns the next node in the chain or throws if the iterator is\n     *          exhausted\n     *\n     * If the hash chain changes in any way between the construction of the\n     * iterator and a call to one of its methods, the behavior is undefined.\n     */\n    function _HashChainIterator(chain) {\n      this.node = chain.head;\n    }\n    _HashChainIterator.prototype.hasNext = function() {\n      return this.node !== undefined;\n    };\n    _HashChainIterator.prototype.next = function() {\n      if (!this.hasNext()) {\n        throw new Error(\"HashTable internal error: \" +\n            \"called _HashChainIterator.next on exhausted iterator\");\n      }\n      var retval = this.node;\n      this.node = retval.next;\n      return retval;\n    };\n\n    // Returns a new iterator for the hash chain.\n    _HashChain.prototype.iterator = function() {\n      return new _HashChainIterator(this);\n    };\n\n\n    /* Resizes the HashTable @a H to have capacity CAPACITY_CHOICES[to_cap_idx].\n     * Throws if @a to_cap_idx >= CAPACITY_CHOICES.length.\n     * Does nothing if @a to_cap_idx < 0, i.e. the HashTable never decreases below\n     * CAPACITY_CHOICES[0] capacity.\n     *\n     * Takes O(n) time where n is the number of mappings in the HashTable.\n     */\n    function _resize(H, to_cap_idx) {\n      if (to_cap_idx >= CAPACITY_CHOICES.length) {\n        throw new Error(\"Capacity of HashTable can't grow beyond \" + CAPACITY_CHOICES[CAPACITY_CHOICES.length - 1]);\n      }\n      if (to_cap_idx >= 0) {\n        var old_cap = H.capacity;\n        var old_slots = H.slots;\n\n        H.capacity_index = to_cap_idx;\n        H.capacity = CAPACITY_CHOICES[to_cap_idx];\n        H.slots = [];\n        for (var i=0; i<old_cap; i++) {\n          if (old_slots[i] !== undefined) {\n            var chain_iter = old_slots[i].iterator();\n            while (chain_iter.hasNext()) {\n              H._putNodeRsz(chain_iter.next());\n            }\n          }\n        }\n      }\n    }\n\n    // Returns the slot index for @a key in the hashtable @a H.\n    function _getSlotIndex(H, key) {\n      return H.hash(key) % H.capacity; // division method\n    }\n\n    /* Constructor for HashTable. To create an empty HashTable, do something like\n     * var H = new structure.HashTable();\n     *\n     * @a cfg is optional and can contain any or all of the following properties\n     *    - initial_capacity: a number that is a hint for the initial capacity\n     *        - defaults to an implementation defined number\n     *    - hash: a function that takes an object and returns a nonnegative 32-bit integer\n     *        - the usual requirements for this function apply\n     *           - it must be consistent, i.e. return the same value for the same object\n     *             (if the object doesn't change)\n     *           - if two objects are equal by the client's definition of equality,\n     *             this function must return the same value for both of them\n     *        - defaults to _defaultHash\n     *   - equals: a function that takes two objects and returns true iff they are logically equal\n     *        - the usual requirements for this function apply\n     *           - it must be reflexive, symmetric and transitive\n     *           - it must be consistent i.e. return the same value for unchanged arguments every\n     *             time it's called\n     *        - defaults to _defaultEqauls\n     *\n     * If you provide either hash or equals, you probably want to provide both\n     */\n    structure.HashTable = function(cfg) {\n      this.capacity_index = DEFAULT_INITIAL_CAPACITY_IDX;\n      if (cfg) {\n        if (cfg.initial_capacity) {\n          this.capacity_index = _get_capacity_index(cfg.initial_capacity);\n        }\n        if (cfg.hash) { // otherwise we use the prototype one\n          this.hash = cfg.hash;\n        }\n        if (cfg.equals) { // otherwise we use the prototype one\n          this.equals = cfg.equals;\n        }\n      }\n\n      // this is redundan't information, but keeps code somewhat cleaner\n      this.capacity = CAPACITY_CHOICES[this.capacity_index];\n      this.numkeys = 0; // start out empty\n\n      // we will use undefined as the indicator for empty slots so\n      // we don't actually need to \"allocate\" the capacity because\n      // JS arrays don't actually have bounds and a[i] returns\n      // undefined if the ith element is \"out of bounds\"...\n      // however, take care to never use this.slots.length as it will\n      // be meaningless\n      this.slots = [];\n    };\n\n    // defaults for hash and equals\n    structure.HashTable.prototype.hash = _defaultHash;\n    structure.HashTable.prototype.equals = _defaultEquals;\n\n    // Returns the load factor of the HashTable, i.e. the ratio\n    // of occupied slots to the capacity.\n    structure.HashTable.prototype.loadFactor = function() {\n      return this.numkeys / this.capacity;\n    };\n\n    /* Add the key-value pair to the HashTable.\n     * Throws if @a key or @a value equals undefined.\n     *\n     * Takes O(1) time amortized, assuming uniform hashing.\n     *\n     * Only references to the key and value are stored, i.e. the client must do defensive\n     * copies if they are required. If the key is mutable and changes after this operation\n     * is performed, the behavior is undefined (the HashTable will most likely become\n     * invalid and unpredictibly useless).\n     * Changes to the value object are allowed but are in most situations probably\n     * an indicator of bad design.\n     */\n    structure.HashTable.prototype.put = function(key, value) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.put with key === undefined\");\n      }\n\n      if (value === undefined) {\n        throw new Error(\"called HashTable.put with value === undefined\");\n      }\n\n      var h = _getSlotIndex(this, key);\n      if (this.slots[h] === undefined) {\n        this.slots[h] = new _HashChain();\n      }\n      if (this.slots[h].put(this, key, value)) {\n        ++this.numkeys;\n        if (this.loadFactor() > LF_HIGH) {\n          _resize(this, this.capacity_index + 1);\n        }\n      }\n    };\n\n    /* This is an internal put method that reuses existing _HashChainNode objects\n     * to reduce garbage generation when the table gets resized.\n     *\n     * Don't use this outside of resizing functionality!\n     */\n    structure.HashTable.prototype._putNodeRsz = function(node) {\n      // we don't check the validity of node.key and node.value because\n      // it is assumed they are valid as they are already in a preexisting node\n      var h = _getSlotIndex(this, node.key);\n      if (this.slots[h] === undefined) {\n        this.slots[h] = new _HashChain();\n      }\n      // don't need to actually iterate the chain to search for matching keys\n      // because we know that the keys were unique prior to resizing\n      this.slots[h].insertHead(node);\n      // we don't check the load factor because we know that we have just\n      // recently resized so no further resizing will be needed\n    };\n\n    /* Returns the value associated with @a key in the HashTable or\n     * undefined if @a key is not found.\n     *\n     * Throws if @a key equals undefined.\n     *\n     * Takes O(1) time, assuming uniform hashing.\n     */\n    structure.HashTable.prototype.get = function(key) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.get with key === undefined\");\n      }\n\n      var h = _getSlotIndex(this, key);\n      var slot = this.slots[h];\n      return slot===undefined ? undefined : slot.get(this, key);\n    };\n\n    /* Removes @a key from the HashTable. If @a key is not in the HashTable,\n     * this operation does nothing.\n     *\n     * Throws if @a key equals undefined.\n     *\n     * Takes O(1) time ammortized, assuming uniform hashing.\n     */\n    structure.HashTable.prototype.remove = function(key) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.remove with key === undefined\");\n      }\n\n      var h = _getSlotIndex(this, key);\n      var slot = this.slots[h];\n      if (slot === undefined) {\n        return;\n      }\n      if (slot.remove(this, key)) {\n        --this.numkeys;\n        if (this.loadFactor() < LF_LOW) {\n          _resize(this, this.capacity_index - 1);\n        }\n      }\n    };\n\n    // Returns true iff the HashTable is empty.\n    // O(1) time.\n    structure.HashTable.prototype.isEmpty = function() {\n      return this.numkeys === 0;\n    };\n\n    // Clears the HashTable, making it empty.\n    // O(1) time.\n    structure.HashTable.prototype.clear = function() {\n      this.capacity_index = DEFAULT_INITIAL_CAPACITY_IDX;\n      this.capacity = CAPACITY_CHOICES[this.capacity_index];\n      this.numkeys = 0;\n      this.slots = [];\n    };\n\n    // Returns the number of mappings in the HashTable.\n    // O(1) time.\n    structure.HashTable.prototype.size = function() {\n      return this.numkeys;\n    };\n\n    // Returns true iff @a key is in the HashTable.\n    // Equivalent to get(key) !== undefined.\n    structure.HashTable.prototype.containsKey = function(key) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.containsKey with key === undefined\");\n      }\n\n      return this.get(key) !== undefined;\n    };\n\n    // Returns an array with all the keys in the HashTable\n    structure.HashTable.prototype.keys = function() {\n      var keys = [];\n\n      for (var it = this.keyIterator(); it.hasNext(); ) {\n        keys.push(it.next());\n      }\n\n      return keys;\n    };\n\n    // Returns an array with all the values in the HashTable\n    structure.HashTable.prototype.values = function() {\n      var values = [];\n\n      for (var it = this.valueIterator(); it.hasNext(); ) {\n        values.push(it.next());\n      }\n\n      return values;\n    };\n\n    // Returns an array with all the key-value pairs in the HashTable\n    structure.HashTable.prototype.entries = function() {\n      var entries = [];\n\n      for (var it = this.keyValueIterator(); it.hasNext(); ) {\n        entries.push(it.next());\n      }\n\n      return entries;\n    };\n\n    // Iterators internals. The API is below.\n    var Iterator = {\n      hasNext: function() {\n        // first try the current chain iterator\n        if (this.cur_chain_iterator!==undefined && this.cur_chain_iterator.hasNext()) {\n          return true;\n        }\n        if (this.cur_chain_iterator !== undefined) {\n          ++this.idx; // this chain iterator was exhausted\n        }\n        // try to find another chain\n        while (this.idx<this.H.capacity &&\n            (this.H.slots[this.idx]===undefined || // no chain OR\n             this.H.slots[this.idx].isEmpty())) {  // empty chain\n          ++this.idx;\n        }\n        var slotval = this.H.slots[this.idx];\n        if (slotval === undefined) { // no more chains in the table\n          this.cur_chain_iterator = undefined;\n          return false;\n        }\n        this.cur_chain_iterator = slotval.iterator();\n        return true; // we know this chain isn't empty so just return true\n      },\n      // @a err_msg is the message to throw if the iterator is empty\n      // @a extract_next is a function that takes the iterator as its only\n      // parameter and returns the required item\n      _next: function(err_msg, extract_next) {\n        if (!this.hasNext()) {\n          throw new Error(err_msg);\n        }\n        //assert(this.H.keys[this.idx] !== undefined);\n        var retval = extract_next(this);\n        return retval;\n      },\n      // invoke function @a iterator_func with context @a context on each\n      // element of the iterable collection\n      each: function(iterator_func, context) {\n        if (iterator_func === undefined) {\n          throw new Error(\"called iterator.each with iterator_func === undefined\");\n        }\n\n        for (var i=0, it = this; this.hasNext(); i++) {\n          iterator_func.call(context, this.next(), i, this.H);\n        }\n      }\n    };\n\n    function _KeyIterator(H) {\n      this.idx = 0;\n      this.H = H;\n    }\n    _KeyIterator.prototype = Object.create(Iterator);\n    _KeyIterator.prototype.next = function() {\n      return this._next(\"KeyIterator.next called on empty iterator\", function(it) {\n        return it.cur_chain_iterator.next().key;\n      });\n    };\n\n    function _ValueIterator(H) {\n      this.idx = 0;\n      this.H = H;\n    }\n    _ValueIterator.prototype = Object.create(Iterator);\n    _ValueIterator.prototype.next = function() {\n      return this._next(\"ValueIterator.next called on empty iterator\", function(it) {\n        return it.cur_chain_iterator.next().value;\n      });\n    };\n\n    function _KeyValueIterator(H) {\n      this.idx = 0;\n      this.H = H;\n    }\n    _KeyValueIterator.prototype = Object.create(Iterator);\n    _KeyValueIterator.prototype.next = function() {\n      return this._next(\"KeyValueIterator.next called on empty iterator\", function(it) {\n        var node = it.cur_chain_iterator.next();\n        return [node.key, node.value];\n      });\n    };\n\n    /* Iterator API\n     *\n     * HashTable supports three iterators for iteration over keys, values\n     * and key-value pairs.\n     * The iterator is returned by the appropriate *Iterator\n     * function on the hashtable. All three iterators have two methods\n     *   - hasNext: Returns true iff there is at least one more item to iterate over.\n     *   - next: Returns the next item from the iterator, or throws if the iterator is\n     *           exhausted. It is guaranteed that next does not throw if a preceeding\n     *           call to hasNext returned true.\n     *   - each: Iterates over all elements in the collection, invoking a function on\n     *           each element. The function is passed a reference to the element, the\n     *           index of the element and a reference to the hashtable.\n     *\n     * If the HashTable changes in any way during iteration (e.g. by calling put, remove or clear),\n     * the iterator is invalidated and the behavior of subsequent calls to hasNext or next is undefined.\n     *\n     * All three iterators iterate over the whole HashTable in O(n) time where n is the number of mappings\n     * in the table.\n     *\n     * The KeyValueIterator's next method returns arrays of length two where the first element is the key\n     * and the second element is the value.\n     */\n    structure.HashTable.prototype.keyIterator = function() {\n      return new _KeyIterator(this);\n    };\n    structure.HashTable.prototype.valueIterator = function() {\n      return new _ValueIterator(this);\n    };\n    structure.HashTable.prototype.keyValueIterator = function() {\n      return new _KeyValueIterator(this);\n    };\n\n  })();\n\n  // import structure.HashTable into noam.util\n  noam.util.HashTable = structure.HashTable;\n  delete structure; // don't need structure any more\n\n  noam.fsm = {};\n\n  noam.fsm.epsilonSymbol = '$';\n  noam.fsm.dfaType = 'DFA';\n  noam.fsm.nfaType = 'NFA';\n  noam.fsm.enfaType = 'eNFA';\n\n  // FSM creation API\n\n  // Creates and returns an empty FSM that can then be manipulated through the other\n  // functions in the API.\n  noam.fsm.makeNew = function() {\n    return {\n      states: [],\n      alphabet: [],\n      acceptingStates: [],\n      initialState: undefined,\n      transitions: []\n    };\n  };\n\n  // Common internal implementation for addState and addSymbol.\n  noam.fsm._addStateOrSymbol = function(arr, obj, undefErrorMsg, existsErrorMsg) {\n    // need to check this because undefined would otherwise be added as a state\n    // or symbol which is probably not what you want\n    if (obj === undefined) {\n      throw new Error(undefErrorMsg);\n    }\n    if (noam.util.contains(arr, obj)) {\n      throw new Error(existsErrorMsg);\n    }\n\n    arr.push(obj);\n    return obj;\n  };\n\n  // Adds stateObj as a state to the fsm.\n  // Throws an Error if no stateObj is passed or if the same state already exists.\n  // Returns the added state object.\n  noam.fsm.addState = function(fsm, stateObj) {\n    return noam.fsm._addStateOrSymbol(fsm.states, stateObj,\n        \"No state object specified\", \"State already exists\");\n  };\n\n  // Adds symObj as an alphabet symbol to the fsm.\n  // Throws an Error if no symObj is passed or if the same symbol already exists.\n  // Returns the added symbol object.\n  noam.fsm.addSymbol = function(fsm, symObj) {\n    if (noam.util.areEquivalent(symObj, noam.fsm.epsilonSymbol)) {\n      throw new Error(\"Can't add the epsilon symbol to the alphabet\");\n    }\n    return noam.fsm._addStateOrSymbol(fsm.alphabet, symObj,\n        \"No symbol object specified\", \"Symbol already exists\");\n  };\n\n  // Makes stateObj an accepting state of the fsm.\n  // Throws an Error if stateObj is not a state of the fsm or if it is already\n  // accepting.\n  noam.fsm.addAcceptingState = function(fsm, stateObj) {\n    if (!noam.util.contains(fsm.states, stateObj)) {\n      throw new Error(\"The specified object is not a state of the FSM\");\n    }\n    noam.fsm._addStateOrSymbol(fsm.acceptingStates, stateObj, \"\",\n        \"The specified state is already accepting\");\n  };\n\n  // Sets stateObj as the start state of the fsm.\n  // Throws an Error if stateObj is not a state of the fsm.\n  noam.fsm.setInitialState = function(fsm, stateObj) {\n    if (!noam.util.contains(fsm.states, stateObj)) {\n      throw new Error(\"The specified object is not a state of the FSM\");\n    }\n    fsm.initialState = stateObj;\n  };\n\n  // Common implementation for addTransition and addEpsilonTransition.\n  noam.fsm._addTransition = function(fsm, fromState, toStates, transitionSymbol) {\n    if (!Array.isArray(toStates)) {\n      throw new Error(\"The toStates argument must be an array\");\n    }\n    if (!noam.util.contains(fsm.states, fromState) ||\n        !noam.util.containsAll(fsm.states, toStates)) {\n      throw new Error(\"One of the specified objects is not a state of the FSM\");\n    }\n\n    var i;\n    var added = false;\n    for (i=0; i<fsm.transitions.length; i++) {\n      if (noam.util.areEquivalent(fromState, fsm.transitions[i].fromState) &&\n          noam.util.areEquivalent(transitionSymbol, fsm.transitions[i].symbol)) {\n        fsm.transitions[i].toStates = noam.util.setUnion(fsm.transitions[i].toStates, toStates);\n        added = true;\n        break;\n      }\n    }\n    if (!added) {\n      fsm.transitions.push({fromState: fromState, toStates: toStates, symbol: transitionSymbol});\n    }\n  };\n\n  // Adds a transition from fromState to the set of states represented by the array\n  // toStates, using transitionSymbol.\n  // If a transition for this pair of (fromState, transitionSymbol) already exists,\n  // toStates is added to the existing set of destination states.\n  // Throws an Error if any of the states is not actually in the fsm or if the\n  // transition symbol is not in the fsm's alphabeth.\n  // Note that this means that an Error will be thrown if you try to use this to\n  // specify an epsilon transition. For that, use addEpsilonTransition instead.\n  noam.fsm.addTransition = function(fsm, fromState, toStates, transitionSymbol) {\n    if (!noam.util.contains(fsm.alphabet, transitionSymbol)) {\n      throw new Error(\"The specified object is not an alphabet symbol of the FSM\");\n    }\n    noam.fsm._addTransition(fsm, fromState, toStates, transitionSymbol);\n  };\n\n  // Equivalent to addTransition except that there is no transition symbol, i.e. the\n  // transition can be executed without consuming an input symbol.\n  noam.fsm.addEpsilonTransition = function(fsm, fromState, toStates) {\n    noam.fsm._addTransition(fsm, fromState, toStates, noam.fsm.epsilonSymbol);\n  };\n\n  // end of FSM creation API\n\n  // validates a FSM definition\n  noam.fsm.validate = function(fsm) {\n    var i, j, k;\n\n    if (!(typeof fsm !== 'undefined' &&\n        Array.isArray(fsm.states) &&\n        Array.isArray(fsm.alphabet) &&\n        Array.isArray(fsm.acceptingStates) &&\n        typeof fsm.initialState !== 'undefined' && fsm.initialState !== null &&\n        Array.isArray(fsm.transitions))) {\n      throw new Error('FSM must be defined and have states, alphabet, acceptingStates, initialState and transitions array properties!');\n    }\n\n    if (fsm.states.length < 1) {\n      throw new Error('Set of states must not be empty.');\n    }\n\n    for (i=0; i<fsm.states.length; i++) {\n      if (noam.util.contains(fsm.states, fsm.states[i], i+1)) {\n        throw new Error('Equivalent states');\n      }\n    }\n\n    if (fsm.alphabet.length < 1) {\n      throw new Error('Alphabet must not be empty.');\n    }\n\n    for (i=0; i<fsm.alphabet.length; i++) {\n      if (noam.util.contains(fsm.alphabet, fsm.alphabet[i], i+1)) {\n        throw new Error('Equivalent alphabet symbols');\n      }\n    }\n\n    if (noam.util.contains(fsm.alphabet, noam.fsm.epsilonSymbol)) {\n      throw new Error('FSM alphabet must not contain the epsilon symbol');\n    }\n\n    for (i=0; i<fsm.alphabet.length; i++) {\n      if (noam.util.contains(fsm.states, fsm.alphabet[i])) {\n        throw new Error('States and alphabet symbols must not overlap');\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      if (noam.util.contains(fsm.acceptingStates, fsm.acceptingStates[i], i+1)) {\n        throw new Error('Equivalent acceptingStates');\n      }\n\n      if (!(noam.util.contains(fsm.states, fsm.acceptingStates[i]))) {\n        throw new Error('Each accepting state must be in states');\n      }\n    }\n\n    if (!(noam.util.contains(fsm.states, fsm.initialState))) {\n      throw new Error('Initial state must be in states');\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (typeof transition.fromState === 'undefined' ||\n          typeof transition.toStates === 'undefined' ||\n          typeof transition.symbol === 'undefined') {\n        throw new Error('Transitions must have fromState, toState and symbol');\n      }\n\n      if (!(noam.util.contains(fsm.states, transition.fromState))) {\n        throw new Error('Transition fromState must be in states.');\n      }\n\n      if (!(noam.util.contains(fsm.alphabet, transition.symbol)) &&\n          transition.symbol !== noam.fsm.epsilonSymbol) {\n        throw new Error('Transition symbol must be in alphabet.');\n      }\n\n      for (k=0; k<transition.toStates.length; k++) {\n        if (!(noam.util.contains(fsm.states, transition.toStates[k]))) {\n          throw new Error('Transition toStates must be in states.');\n        }\n\n        if (noam.util.contains(transition.toStates, transition.toStates[k], k+1)) {\n          throw new Error('Transition toStates must not contain duplicates.');\n        }\n      }\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      for (j=i+1; j<fsm.transitions.length; j++) {\n        if (fsm.transitions[i].fromState === fsm.transitions[j].fromState &&\n            fsm.transitions[i].symbol === fsm.transitions[j].symbol) {\n          throw new Error('Transitions for the same fromState and symbol must be defined in a single trainsition.');\n        }\n      }\n    }\n\n    return true;\n  };\n\n  // determine if stateObj is an accepting state in fsm\n  noam.fsm.isAcceptingState = function(fsm, stateObj) {\n    return noam.util.contains(fsm.acceptingStates, stateObj);\n  };\n\n  // determine fsm type based on transition function\n  noam.fsm.determineType = function(fsm) {\n    var fsmType = noam.fsm.dfaType;\n\n    for (var i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (transition.symbol === noam.fsm.epsilonSymbol) {\n        fsmType = noam.fsm.enfaType;\n        break;\n      } else if (transition.toStates.length === 0 ||\n          transition.toStates.length > 1) {\n        fsmType = noam.fsm.nfaType;\n      }\n    }\n\n    if (fsmType === noam.fsm.dfaType) {\n      if (fsm.transitions.length < fsm.states.length * fsm.alphabet.length) {\n        fsmType = noam.fsm.nfaType;\n      }\n    }\n\n    return fsmType;\n  };\n\n  // computes epsilon closure of fsm from states array states\n  noam.fsm.computeEpsilonClosure = function(fsm, states) {\n    if (!(noam.util.containsAll(fsm.states, states))) {\n      throw new Error('FSM must contain all states for which epsilon closure is being computed');\n    }\n\n    var unprocessedStates = states;\n    var targetStates = [];\n\n    while (unprocessedStates.length !== 0) {\n      var currentState = unprocessedStates.pop();\n      targetStates.push(currentState);\n\n      for (var i=0; i<fsm.transitions.length; i++) {\n        var transition = fsm.transitions[i];\n\n        if (transition.symbol === noam.fsm.epsilonSymbol &&\n            noam.util.areEquivalent(transition.fromState, currentState)) {\n          for (var j=0; j<transition.toStates.length; j++) {\n            if (noam.util.contains(targetStates, transition.toStates[j]) ||\n                noam.util.contains(unprocessedStates, transition.toStates[j])) {\n              continue;\n            }\n\n            unprocessedStates.push(transition.toStates[j]);\n          }\n        }\n      }\n    }\n\n    return targetStates;\n  };\n\n  // determines the target states from reading symbol at states array states\n  noam.fsm.makeSimpleTransition = function(fsm, states, symbol) {\n    if (!(noam.util.containsAll(fsm.states, states))) {\n      throw new Error('FSM must contain all states for which the transition is being computed');\n    }\n\n    if (!(noam.util.contains(fsm.alphabet, symbol))) {\n      throw new Error('FSM must contain input symbol for which the transition is being computed');\n    }\n\n    var targetStates = [];\n\n    for (var i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (noam.util.areEquivalent(fsm.transitions[i].symbol, symbol) &&\n          noam.util.contains(states, transition.fromState)) {\n        for (var j=0; j<transition.toStates.length; j++) {\n          if (!(noam.util.contains(targetStates, transition.toStates[j]))) {\n            targetStates.push(transition.toStates[j]);\n          }\n        }\n      }\n    }\n\n    return targetStates;\n  };\n\n  // makes transition from states array states and for input symbol symbol by:\n  //   a) computing the epsilon closure of states\n  //   b) making a simple transition from resulting states of a)\n  //   c) computing the epsilon closure of resulting states of b)\n  noam.fsm.makeTransition = function(fsm, states, symbol) {\n    if (!(noam.util.containsAll(fsm.states, states))) {\n      throw new Error('FSM must contain all states for which the transition is being computed');\n    }\n\n    if (!(noam.util.contains(fsm.alphabet, symbol))) {\n      throw new Error('FSM must contain input symbol for which the transition is being computed');\n    }\n\n    var targetStates = noam.util.clone(states);\n\n    targetStates = noam.fsm.computeEpsilonClosure(fsm, targetStates);\n    targetStates = noam.fsm.makeSimpleTransition(fsm, targetStates, symbol);\n    targetStates = noam.fsm.computeEpsilonClosure(fsm, targetStates);\n\n    return targetStates;\n  };\n\n  // read a stream of input symbols and determine target states\n  noam.fsm.readString = function(fsm, inputSymbolStream) {\n    if (!(noam.util.containsAll(fsm.alphabet, inputSymbolStream))) {\n      throw new Error('FSM must contain all symbols for which the transition is being computed');\n    }\n\n    var states = noam.fsm.computeEpsilonClosure(fsm, [fsm.initialState]);\n\n    for (var i=0; i<inputSymbolStream.length; i++) {\n      states = noam.fsm.makeTransition(fsm, states, inputSymbolStream[i]);\n    }\n\n    return states;\n  };\n\n  // read a stream of input symbols starting from state and make a list of\n  // states that were on the transition path\n  noam.fsm.transitionTrail = function(fsm, state, inputSymbolStream) {\n    if (!(noam.util.containsAll(fsm.alphabet, inputSymbolStream))) {\n      throw new Error('FSM must contain all symbols for which the transition is being computed');\n    }\n\n    var states = [state];\n    var trail = [noam.util.clone(states)];\n\n    for (var i=0; i<inputSymbolStream.length; i++) {\n      states = noam.fsm.makeTransition(fsm, states, inputSymbolStream[i]);\n      trail.push(noam.util.clone(states));\n    }\n\n    return trail;\n  };\n\n  // test if a stream of input symbols leads a fsm to an accepting state\n  noam.fsm.isStringInLanguage = function(fsm, inputSymbolStream) {\n    var states = noam.fsm.readString(fsm, inputSymbolStream);\n\n    return noam.util.containsAny(fsm.acceptingStates, states);\n  };\n\n  // pretty print the fsm transition function and accepting states as a table\n  noam.fsm.printTable = function(fsm) {\n    var Table = require('cli-table');\n    var colHeads = [\"\"].concat(fsm.alphabet);\n\n    if (noam.fsm.determineType(fsm) === noam.fsm.enfaType) {\n      colHeads.push(noam.fsm.epsilonSymbol);\n    }\n\n    colHeads.push(\"\");\n\n    var table = new Table({\n       head: colHeads,\n       chars: {\n         'top': '-',\n         'top-mid': '+',\n         'top-left': '+',\n         'top-right': '+',\n         'bottom': '-',\n         'bottom-mid': '+',\n         'bottom-left': '+',\n         'bottom-right': '+',\n         'left': '|',\n         'left-mid': '+',\n         'mid': '-',\n         'mid-mid': '+',\n         'right': '|',\n         'right-mid': '+'\n       },\n       truncate: '~'\n    });\n\n    var tableRows = [], i, j;\n    for (i=0; i<fsm.states.length; i++) {\n      tableRows.push(new Array(colHeads.length));\n      for (j=0; j<colHeads.length; j++) {\n        tableRows[i][j] = \"\";\n      }\n      tableRows[i][0] = fsm.states[i].toString();\n      tableRows[i][colHeads.length-1] =\n        noam.util.contains(fsm.acceptingStates, fsm.states[i]) ?\n        \"1\" : \"0\" ;\n      table.push(tableRows[i]);\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      var colNum = null;\n      var rowNum = null;\n\n      for (j=0; j<fsm.states.length; j++) {\n        if (noam.util.areEquivalent(fsm.states[j], transition.fromState)) {\n          rowNum = j;\n          break;\n        }\n      }\n\n      if (transition.symbol === noam.fsm.epsilonSymbol) {\n        colNum = colHeads.length-2;\n      } else {\n        for (j=0; j<fsm.alphabet.length; j++) {\n          if (noam.util.areEquivalent(fsm.alphabet[j], transition.symbol)) {\n            colNum = j+1;\n            break;\n          }\n        }\n      }\n\n      if (typeof tableRows[rowNum][colNum].text === \"undefined\") {\n        tableRows[rowNum][colNum] = { text : [] };\n      }\n\n      tableRows[rowNum][colNum].text.push(transition.toStates);\n    }\n\n    return table.toString();\n  };\n\n  noam.fsm.serializeFsmToString = function(fsm) {\n    var lines = [];\n\n    lines.push(\"#states\");\n\n    for (var i = 0; i < fsm.states.length; i++) {\n      lines.push(fsm.states[i].toString());\n    }\n\n    lines.push(\"#initial\");\n\n    lines.push(fsm.initialState.toString());\n\n    lines.push(\"#accepting\");\n\n    for (var i = 0; i < fsm.acceptingStates.length; i++) {\n      lines.push(fsm.acceptingStates[i].toString());\n    }\n\n    lines.push(\"#alphabet\");\n\n    for (var i = 0; i < fsm.alphabet.length; i++) {\n      lines.push(fsm.alphabet[i].toString());\n    }\n\n    lines.push(\"#transitions\");\n\n    for (var i = 0; i < fsm.transitions.length; i++) {\n      lines.push(fsm.transitions[i].fromState.toString() + \":\" +\n                 fsm.transitions[i].symbol.toString() + \">\" +\n                 fsm.transitions[i].toStates.join(\",\"));\n    }\n\n    return lines.join(\"\\n\");\n  };\n\n  noam.fsm.parseFsmFromString = function(fsm_string) {\n    var lines = fsm_string.split(/\\r?\\n/);\n\n    var states = [];\n    var initial;\n    var accepting = [];\n    var alphabet = [];\n    var transitions = [];\n\n    var parseState = null;\n\n    var parseCounts = {\n      states : 0,\n      initial : 0,\n      accepting : 0,\n      alphabet : 0,\n      transitions : 0\n    };\n\n    for (var i=0; i<lines.length; i++) {\n      var line = lines[i].replace(/\\s/g, \"\");\n\n      if (line.length === 0) {\n        continue;\n      } else if (line[0] === '#') {\n        parseState = line.substr(1);\n\n        if (typeof parseCounts[parseState] === 'undefined') {\n          throw new Error('Line ' + (i+1).toString() + ': invalid section name ' +\n                           parseState + '. Must be one of: states, initial, \\\n                           accepting, alphabet, transitions.');\n        } else {\n          parseCounts[parseState] += 1;\n\n          if (parseCounts[parseState] > 1) {\n            throw new Error('Line ' + (i+1).toString() +\n                            ': duplicate section name ' + parseState + '.');\n          }\n        }\n      } else {\n        if (parseState == null) {\n          throw new Error('Line ' + (i+1).toString() + ': no #section declared. \\\n                          Add one section: states, initial, accepting, \\\n                          alphabet, transitions.');\n        } else if (parseState === 'states') {\n          var st = line.split(\";\");\n          states = states.concat(st);\n        } else if (parseState == 'initial') {\n          initial = line;\n        } else if (parseState == 'accepting') {\n          var ac = line.split(\";\");\n          accepting = accepting.concat(ac);\n        } else if (parseState == 'alphabet') {\n          var al = line.split(\";\");\n          alphabet = alphabet.concat(al);\n        } else if (parseState == 'transitions') {\n          var state_rest = line.split(':');\n\n          var state = state_rest[0].split(',');\n          var parts = state_rest[1].split(';');\n\n          for (var j=0; j<parts.length; j++) {\n            var left_right = parts[j].split('>');\n            var al_t = left_right[0].split(',');\n            var st_t = left_right[1].split(',');\n          }\n\n          transitions.push([state, al_t, st_t]);\n        }\n      }\n    }\n\n    for (var k in parseCounts) {\n      if (parseCounts[k] !== 1) {\n        throw new Error('Specification missing #' + parseCounts[k] +\n          ' section.');\n      }\n    }\n\n    var fsm = noam.fsm.makeNew();\n\n    for (var i = states.length - 1; i >= 0; i--) {\n      noam.fsm.addState(fsm, states[i]);\n    }\n\n    for (var i = alphabet.length - 1; i >= 0; i--) {\n      noam.fsm.addSymbol(fsm, alphabet[i]);\n    }\n\n    for (var i = 0; i < accepting.length; i++) {\n      noam.fsm.addAcceptingState(fsm, accepting[i]);\n    }\n\n    noam.fsm.setInitialState(fsm, initial);\n\n    for (var i = 0; i < transitions.length; i++) {\n      var transition = transitions[i];\n\n      for (var j = 0; j < transition[0].length; j++) {\n        for (var k = 0; k < transition[1].length; k++) {\n          if (transition[1][k] === noam.fsm.epsilonSymbol) {\n            noam.fsm.addEpsilonTransition(fsm, transition[0][j], transition[2]);\n          } else {\n            noam.fsm.addTransition(fsm, transition[0][j], transition[2], transition[1][k]);\n          }\n        }\n      }\n    }\n\n    noam.fsm.validate(fsm);\n\n    return fsm;\n  };\n\n  // print the fsm transition function and accepting states as an HTML table\n  noam.fsm.printHtmlTable = function(fsm) {\n    var headers = [\"\"].concat(fsm.alphabet);\n    if (noam.fsm.determineType(fsm) === noam.fsm.enfaType) {\n      headers.push(noam.fsm.epsilonSymbol);\n    }\n    headers.push(\"\");\n\n    var tableRows = [], i, j;\n\n    for (i=0; i<fsm.states.length; i++) {\n      tableRows.push(new Array(headers.length));\n      for (j=0; j<headers.length; j++) {\n        tableRows[i][j] = { text : []};\n      }\n      tableRows[i][0] = { text : fsm.states[i].toString() };\n      tableRows[i][headers.length-1] =\n        noam.util.contains(fsm.acceptingStates, fsm.states[i]) ?\n        { text : [\"1\"] } : { text : [\"0\"] };\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      var colNum = null;\n      var rowNum = null;\n\n      for (j=0; j<fsm.states.length; j++) {\n        if (noam.util.areEquivalent(fsm.states[j], transition.fromState)) {\n          rowNum = j;\n          break;\n        }\n      }\n\n      if (transition.symbol === noam.fsm.epsilonSymbol) {\n        colNum = headers.length-2;\n      } else {\n        for (j=0; j<fsm.alphabet.length; j++) {\n          if (noam.util.areEquivalent(fsm.alphabet[j], transition.symbol)) {\n            colNum = j+1;\n            break;\n          }\n        }\n      }\n\n      if (typeof tableRows[rowNum][colNum].text === \"undefined\") {\n        tableRows[rowNum][colNum] = { text : [] };\n      }\n\n      tableRows[rowNum][colNum].text.push(transition.toStates);\n    }\n\n    var htmlString = [];\n\n    htmlString.push(\"<table border='1'>\");\n    htmlString.push(\"  <tr>\");\n\n    for (i=0; i<headers.length; i++) {\n      htmlString.push(\"    <th>\" + headers[i].toString() + \"</th>\");\n    }\n\n    htmlString.push(\"  </tr>\");\n\n    for (i=0; i<tableRows.length; i++) {\n      htmlString.push(\"  <tr>\");\n      for (j=0; j<tableRows[i].length; j++) {\n        htmlString.push(\"    <td>\" + tableRows[i][j].text + \"</td>\");\n      }\n\n      htmlString.push(\"  </tr>\");\n    }\n\n    htmlString.push(\"</table>\");\n    return htmlString.join(\"\\n\");\n  };\n\n  // print the fsm in the graphviz dot format\n  noam.fsm.printDotFormat = function(fsm) {\n    var result = [\"digraph finite_state_machine {\", \"  rankdir=LR;\"];\n    var accStates = [\"  node [shape = doublecircle];\"];\n\n    var i, j, k, trans;\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      accStates.push(fsm.acceptingStates[i].toString());\n    }\n\n    accStates.push(\";\");\n    if (accStates.length > 2) {\n      result.push(accStates.join(\" \"));\n    }\n    result.push(\"  node [shape = circle];\");\n    result.push(\"  secret_node [style=invis, shape=point];\");\n    //var initState = ['  {rank = source; \"'];\n    //initState.push(fsm.initialState.toString());\n    //initState.push('\" \"secret_node\"}');\n    //result.push(initState.join(\"\"));\n\n    var initStateArrow = [\"  secret_node ->\"];\n    initStateArrow.push(fsm.initialState.toString());\n    initStateArrow.push(\"[style=bold];\");\n    result.push(initStateArrow.join(\" \"));\n\n    var newTransitions = [];\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      for (j=0; j<fsm.transitions[i].toStates.length; j++) {\n        var found = null;\n\n        for (k=0; k<newTransitions.length; k++) {\n          if (noam.util.areEquivalent(newTransitions[k].fromState, fsm.transitions[i].fromState) &&\n              noam.util.areEquivalent(newTransitions[k].toStates, [fsm.transitions[i].toStates[j]])) {\n            found = newTransitions[k];\n          }\n        }\n\n        if (found === null) {\n          var newTransition = noam.util.clone(fsm.transitions[i]);\n          newTransition.toStates = [newTransition.toStates[j]];\n          newTransition.symbol = [newTransition.symbol];\n          newTransitions.push(newTransition);\n        } else {\n          found.symbol.push(fsm.transitions[i].symbol);\n        }\n      }\n    }\n\n    for (i=0; i<newTransitions.length; i++) {\n      if (noam.util.areEquivalent(newTransitions[i].toStates[0], fsm.initialState)) {\n        trans = [\" \"];\n        trans.push(newTransitions[i].toStates[0].toString());\n        trans.push(\"->\");\n        trans.push(newTransitions[i].fromState.toString());\n        trans.push(\"[\");\n        trans.push(\"label =\");\n        trans.push('\"' + newTransitions[i].symbol.toString() + '\"');\n        trans.push(\" dir = back];\");\n        result.push(trans.join(\" \"));\n      } else {\n        trans = [\" \"];\n        trans.push(newTransitions[i].fromState.toString());\n        trans.push(\"->\");\n        trans.push(newTransitions[i].toStates[0].toString());\n        trans.push(\"[\");\n        trans.push(\"label =\");\n        trans.push('\"' + newTransitions[i].symbol.toString() + '\"');\n        trans.push(\" ];\");\n        result.push(trans.join(\" \"));\n      }\n    }\n\n    result.push(\"}\");\n\n    return result.join(\"\\n\").replace(/\\$/g, \"$\");\n  };\n\n  // determine reachable states\n  noam.fsm.getReachableStates = function(fsm, state, shouldIncludeInitialState) {\n    var unprocessedStates = [state], i, j;\n    var reachableStates = shouldIncludeInitialState ? [state] : [];\n\n    while (unprocessedStates.length !== 0) {\n      var currentState = unprocessedStates.pop();\n\n      for (i=0; i<fsm.transitions.length; i++) {\n        var transition = fsm.transitions[i];\n\n        if (noam.util.areEquivalent(currentState, transition.fromState)) {\n          for (j=0; j<transition.toStates.length; j++) {\n            if (!(noam.util.contains(reachableStates, transition.toStates[j]))) {\n              reachableStates.push(transition.toStates[j]);\n\n              if (!(noam.util.contains(unprocessedStates, transition.toStates[j]))) {\n                unprocessedStates.push(transition.toStates[j]);\n              }\n            }\n          }\n        }\n      }\n    }\n\n   return reachableStates;\n  };\n\n  // determine and remove unreachable states\n  noam.fsm.removeUnreachableStates = function (fsm) {\n    var reachableStates = noam.fsm.getReachableStates(fsm, fsm.initialState, true);\n    var newFsm = noam.util.clone(fsm), i;\n    newFsm.states = [];\n    newFsm.acceptingStates = [];\n    newFsm.transitions = [];\n\n    for (i=0; i<fsm.states.length; i++) {\n      if(noam.util.contains(reachableStates, fsm.states[i])) {\n        newFsm.states.push(noam.util.clone(fsm.states[i]));\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      if (noam.util.contains(reachableStates, fsm.acceptingStates[i])) {\n        newFsm.acceptingStates.push(noam.util.clone(fsm.acceptingStates[i]));\n      }\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      if (noam.util.contains(reachableStates, fsm.transitions[i].fromState)) {\n        newFsm.transitions.push(noam.util.clone(fsm.transitions[i]));\n      }\n    }\n\n    return newFsm;\n  };\n\n  // determines if two states from potentially different fsms are equivalent\n  noam.fsm.areEquivalentStates = function(fsmA, stateA, fsmB, stateB) {\n    if (noam.fsm.determineType(fsmA) !== noam.fsm.dfaType ||\n        noam.fsm.determineType(fsmB) !== noam.fsm.dfaType) {\n      throw new Error('FSMs must be DFAs');\n    }\n\n    if (fsmA.alphabet.length !== fsmB.alphabet.length ||\n        !(noam.util.containsAll(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error('FSM alphabets must be the same');\n    }\n\n    if (!(noam.util.contains(fsmA.states, stateA)) ||\n        !(noam.util.contains(fsmB.states, stateB))) {\n      throw new Error('FSMs must contain states');\n    }\n\n    function doBothStatesHaveSameAcceptance(fsmX, stateX, fsmY, stateY) {\n      var stateXAccepting = noam.util.contains(fsmX.acceptingStates, stateX);\n      var stateYAccepting = noam.util.contains(fsmY.acceptingStates, stateY);\n\n      return (stateXAccepting && stateYAccepting) ||\n             (!(stateXAccepting) && !(stateYAccepting));\n    }\n\n    var unprocessedPairs = [[stateA, stateB]];\n    var processedPairs = [], i, j;\n\n    while (unprocessedPairs.length !== 0) {\n      var currentPair = unprocessedPairs.pop();\n\n      if (!(doBothStatesHaveSameAcceptance(fsmA, currentPair[0], fsmB, currentPair[1]))) {\n          return false;\n        }\n\n      processedPairs.push(currentPair);\n\n      for (j=0; j<fsmA.alphabet.length; j++) {\n        var pair = [noam.fsm.makeTransition(fsmA, [currentPair[0]], fsmA.alphabet[j])[0],\n                    noam.fsm.makeTransition(fsmB, [currentPair[1]], fsmA.alphabet[j])[0]];\n\n        if (!(noam.util.contains(processedPairs, pair)) &&\n            !(noam.util.contains(unprocessedPairs, pair))) {\n          unprocessedPairs.push(pair);\n        }\n      }\n    }\n\n    return true;\n  };\n\n  // determines if two fsms are equivalent by testing equivalence of starting states\n  noam.fsm.areEquivalentFSMs = function(fsmA, fsmB) {\n    return noam.fsm.areEquivalentStates(fsmA, fsmA.initialState, fsmB, fsmB.initialState);\n  };\n\n  // finds and removes equivalent states\n  noam.fsm.removeEquivalentStates = function(fsm) {\n    if (noam.fsm.determineType(fsm) !== noam.fsm.dfaType) {\n      throw new Error('FSM must be DFA');\n    }\n\n    var equivalentPairs = [], i, j, k;\n\n    for (i=0; i<fsm.states.length; i++) {\n      for (j=i+1; j<fsm.states.length; j++) {\n        if (noam.fsm.areEquivalentStates(fsm, fsm.states[i], fsm, fsm.states[j])) {\n          var pair = [fsm.states[i], fsm.states[j]];\n\n          for (k=0; k<equivalentPairs.length; k++) {\n            if (noam.util.areEquivalent(equivalentPairs[k][1], pair[0])) {\n              pair[0] = equivalentPairs[k][1];\n              break;\n            }\n          }\n\n          if (!(noam.util.contains(equivalentPairs, pair))) {\n            equivalentPairs.push(pair);\n          }\n        }\n      }\n    }\n\n    var newFsm = {\n      states : [],\n      alphabet : noam.util.clone(fsm.alphabet),\n      initialState : [],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    function isOneOfEquivalentStates(s) {\n      for (var i=0; i<equivalentPairs.length; i++) {\n        if (noam.util.areEquivalent(equivalentPairs[i][1], s)) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    function getEquivalentState(s) {\n      for (var i=0; i<equivalentPairs.length; i++) {\n        if (noam.util.areEquivalent(equivalentPairs[i][1], s)) {\n          return equivalentPairs[i][0];\n        }\n      }\n\n      return s;\n    }\n\n    for (i=0; i<fsm.states.length; i++) {\n      if (!(isOneOfEquivalentStates(fsm.states[i]))) {\n        newFsm.states.push(noam.util.clone(fsm.states[i]));\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      if (!(isOneOfEquivalentStates(fsm.acceptingStates[i]))) {\n        newFsm.acceptingStates.push(noam.util.clone(fsm.acceptingStates[i]));\n      }\n    }\n\n    newFsm.initialState = noam.util.clone(getEquivalentState(fsm.initialState));\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = noam.util.clone(fsm.transitions[i]);\n\n      if (isOneOfEquivalentStates(transition.fromState)) {\n        continue;\n      }\n\n      for (j=0; j<transition.toStates.length; j++) {\n        transition.toStates[j] = getEquivalentState(transition.toStates[j]);\n      }\n\n      newFsm.transitions.push(transition);\n    }\n\n    return newFsm;\n  };\n\n  // minimizes the fsm by removing unreachable and equivalent states\n  noam.fsm.minimize = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    var fsmWithoutUnreachableStates = noam.fsm.removeUnreachableStates(newFsm);\n    var minimalFsm = noam.fsm.removeEquivalentStates(fsmWithoutUnreachableStates);\n    return minimalFsm;\n  };\n\n  noam.fsm.convertStatesToNumbers = function(fsm) {\n    var newFsm = noam.fsm.makeNew();\n    var mapping = {};\n\n    for (i=0; i<fsm.states.length; i++) {\n      mapping[fsm.states[i].toString()] = i;\n    }\n\n    newFsm.alphabet = noam.util.clone(fsm.alphabet);\n\n    for (i=0; i<fsm.states.length; i++) {\n      noam.fsm.addState(newFsm, mapping[fsm.states[i].toString()]);\n    }\n\n    noam.fsm.setInitialState(newFsm, mapping[fsm.initialState.toString()]);\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      noam.fsm.addAcceptingState(newFsm, mapping[fsm.acceptingStates[i].toString()]);\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var newToStates = [];\n\n      for (j=0; j<fsm.transitions[i].toStates.length; j++) {\n        newToStates.push(mapping[fsm.transitions[i].toStates[j].toString()]);\n      }\n\n      noam.fsm.addTransition(newFsm,\n        mapping[fsm.transitions[i].fromState.toString()],\n        newToStates,\n        fsm.transitions[i].symbol);\n    }\n\n    return newFsm;\n  }\n\n  // generate random fsm\n  noam.fsm.createRandomFsm = function(fsmType, numStates, numAlphabet, maxNumToStates) {\n    var newFsm = {}, i, j, k;\n\n    function prefix(ch, num, str) {\n      var retStr = str;\n\n      for (var i=0; i<str.length - num; i++) {\n        retStr = ch + str;\n      }\n\n      return retStr;\n    }\n\n    newFsm.states = [];\n    for (i=0, len=numStates.toString().length; i<numStates; i++) {\n      newFsm.states.push(\"s\" + prefix(\"0\", len, i.toString()));\n    }\n\n    newFsm.alphabet = [];\n\n    if (numAlphabet > 26) {\n      for (i=0, len=numAlphabet.toString().length; i<numAlphabet; i++) {\n        newFsm.alphabet.push(\"a\" + prefix(\"0\", len, i.toString()));\n      }\n    } else {\n      newFsm.alphabet = \"abcdefghijklmnopqrstuvwxyz\".substr(0,numAlphabet).split(\"\");\n    }\n\n    newFsm.initialState = newFsm.states[0];\n\n    newFsm.acceptingStates = [];\n    for (i=0; i<numStates; i++) {\n      if (Math.round(Math.random())) {\n        newFsm.acceptingStates.push(newFsm.states[i]);\n      }\n    }\n\n    if (fsmType === noam.fsm.enfaType) {\n      newFsm.alphabet.push(noam.fsm.epsilonSymbol);\n    }\n\n    newFsm.transitions = [];\n    for (i=0; i<numStates; i++) {\n      for (j=0; j<newFsm.alphabet.length; j++) {\n        var numToStates = 1;\n\n        if (fsmType !== noam.fsm.dfaType) {\n          numToStates = Math.floor(Math.random()*maxNumToStates);\n        }\n\n        if (numToStates > 0) {\n          var toStates = [];\n          for (k=0; k<newFsm.states.length && toStates.length < numToStates; k++) {\n            var diff = (newFsm.states.length-k)-(numToStates-toStates.length) + 1;\n\n            if (diff <= 0) {\n              diff = 1;\n            } else {\n              diff = 1/diff;\n            }\n\n            if (Math.random() <= diff) {\n              toStates.push(newFsm.states[k]);\n            }\n          }\n\n          newFsm.transitions.push({fromState : newFsm.states[i], symbol : newFsm.alphabet[j], toStates : toStates});\n        }\n      }\n    }\n\n    if (fsmType === noam.fsm.enfaType) {\n      newFsm.alphabet.pop();\n    }\n\n    return newFsm;\n  };\n\n  noam.fsm.convertNfaToDfa = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    if (fsmType === noam.fsm.enfaType) {\n      throw new Error('FSM must be an NFA');\n    }\n\n    if (fsmType === noam.fsm.dfaType) {\n      return fsm; // no need to convert it\n    }\n\n    var newFsm = {}, i, j, k, transition;\n\n    newFsm.alphabet = noam.util.clone(fsm.alphabet);\n    newFsm.states = [];\n    newFsm.acceptingStates = [];\n    newFsm.initialState = [noam.util.clone(fsm.initialState)];\n    newFsm.transitions = [];\n\n    for (i=0; i<fsm.states.length; i++) {\n      newFsm.states.push([noam.util.clone(fsm.states[i])]);\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      newFsm.acceptingStates.push([noam.util.clone(fsm.acceptingStates[i])]);\n    }\n\n    var newStates = [];\n    var multiStates = [];\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      transition = noam.util.clone(fsm.transitions[i]);\n      transition.fromState = [transition.fromState];\n\n      transition.toStates = [transition.toStates];\n\n      if (transition.toStates[0].length > 1) {\n        if (!(noam.util.containsSet(newStates, transition.toStates[0]))) {\n          newStates.push(transition.toStates[0]);\n        }\n      }\n\n      newFsm.transitions.push(transition);\n    }\n\n    while (newStates.length !== 0) {\n      var state = newStates.pop();\n\n      newFsm.states.push(state);\n\n      if (noam.util.containsAny(fsm.acceptingStates, state)) {\n        newFsm.acceptingStates.push(state);\n      }\n\n      for (i=0; i<newFsm.alphabet.length; i++) {\n        var ts = noam.fsm.makeTransition(fsm, state, newFsm.alphabet[i]).sort();\n\n        for (j=0; j<newFsm.states.length; j++) {\n          if (noam.util.areEqualSets(ts, newFsm.states[j])) {\n            ts = newFsm.states[j];\n            break;\n          }\n        }\n\n        for (j=0; j<newStates.length; j++) {\n          if (noam.util.areEqualSets(ts, newStates[j])) {\n            ts = newStates[j];\n            break;\n          }\n        }\n\n        if (ts.length > 0) {\n          newFsm.transitions.push({fromState : state, symbol : newFsm.alphabet[i], toStates : [ts]});\n        }\n\n        if (!(noam.util.containsSet(newFsm.states, ts)) && !(noam.util.containsSet(newStates, ts)) && ts.length > 1) {\n          newStates.push(ts);\n        }\n      }\n    }\n\n    var errorAdded = false;\n    var errorState = \"ERROR\";\n\n    for (i=0; i<newFsm.states.length; i++) {\n      for (j=0; j<newFsm.alphabet.length; j++) {\n        var found = false;\n        for (k=0; k<newFsm.transitions.length; k++) {\n          transition = newFsm.transitions[k];\n\n          if (noam.util.areEquivalent(transition.symbol, newFsm.alphabet[j]) &&\n              noam.util.areEquivalent(transition.fromState, newFsm.states[i])) {\n            found = true;\n            break;\n          }\n        }\n\n        if (found === false) {\n          if (errorAdded === false) {\n            newFsm.states.push([errorState]);\n            errorAdded = true;\n          }\n\n          newFsm.transitions.push({fromState : newFsm.states[i], symbol : newFsm.alphabet[j], toStates : [[errorState]]});\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  noam.fsm.convertEnfaToNfa = function(fsm) {\n    if (noam.fsm.determineType(fsm) !== noam.fsm.enfaType) {\n      return fsm; // this is already an NFA (or a DFA which is also an NFA)\n    }\n\n    var newFsm = noam.util.clone(fsm), i, j;\n\n    var initialEpsilon = noam.fsm.computeEpsilonClosure(fsm, [fsm.initialState]);\n\n    if (noam.util.containsAny(newFsm.acceptingStates, initialEpsilon) &&\n        !(noam.util.contains(newFsm.acceptingStates, newFsm.initialState))) {\n      newFsm.acceptingStates.push(newFsm.initialState);\n    }\n\n    var newTransitions = [];\n\n    for (i=0; i<newFsm.states.length; i++) {\n      for (j=0; j<newFsm.alphabet.length; j++) {\n        var toStates = noam.fsm.makeTransition(newFsm, [newFsm.states[i]], newFsm.alphabet[j]).sort();\n\n        if (toStates.length > 0) {\n          newTransitions.push({\n            fromState : newFsm.states[i],\n            toStates : toStates,\n            symbol : newFsm.alphabet[j]\n          });\n        }\n      }\n    }\n\n    newFsm.transitions = newTransitions;\n\n    var multiStateTransitions = [];\n\n    for (i=0; i<newFsm.transitions.length; i++) {\n      var transition = newFsm.transitions[i];\n\n      if (transition.toStates.length > 1) {\n        var existing = false;\n\n        for (j=0; j<multiStateTransitions.length; j++) {\n          if (noam.util.areEqualSets(transition.toStates, multiStateTransitions[j])) {\n            transition.toStates = multiStateTransitions[j];\n            existing = true;\n            break;\n          }\n        }\n\n        if (existing === false) {\n          multiStateTransitions.push(transition.toStates);\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // test whether if the language accepted by the fsm contains at least one string\n  noam.fsm.isLanguageNonEmpty = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    return newFsm.acceptingStates.length > 0;\n  };\n\n  noam.fsm.isLanguageInfinite = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    var deadState = null, i, reachable;\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (noam.util.contains(newFsm.acceptingStates, newFsm.states[i])) {\n        continue;\n      }\n\n      reachable = noam.fsm.getReachableStates(newFsm, newFsm.states[i], true);\n\n      if (noam.util.containsAny(newFsm.acceptingStates, reachable)) {\n        continue;\n      }\n\n      deadState = newFsm.states[i];\n      break;\n    }\n\n    if (deadState === null) {\n      return true;\n    }\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (noam.util.areEquivalent(deadState, newFsm.states[i])) {\n        continue;\n      }\n\n      reachable = noam.fsm.getReachableStates(newFsm, newFsm.states[i], false);\n\n      if (noam.util.contains(reachable, newFsm.states[i])) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // generate a random string which the fsm accepts\n  noam.fsm.randomStringInLanguage = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    if (newFsm.acceptingStates.length === 0) {\n      return null;\n    }\n\n    var currentState = newFsm.acceptingStates[Math.floor(Math.random()*newFsm.acceptingStates.length)];\n    var trail = [];\n\n    while (true) {\n      if (noam.util.areEquivalent(currentState, newFsm.initialState) === true) {\n        if (Math.round(Math.random())) {\n          break;\n        }\n      }\n\n      var transitions = [], i;\n\n      for (i=0; i<newFsm.transitions.length; i++) {\n        if (noam.util.areEquivalent(newFsm.transitions[i].toStates[0], currentState)) {\n          transitions.push(newFsm.transitions[i]);\n        }\n      }\n\n      if (transitions.length === 0) {\n        break;\n      }\n\n      var transition = transitions[Math.floor(Math.random()*transitions.length)];\n\n      trail.push(transition.symbol);\n      currentState = transition.fromState;\n    }\n\n    trail.reverse();\n\n    return trail;\n  };\n\n  // generate a random string which the fsm doest accept\n  noam.fsm.randomStringNotInLanguage = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    var nonAcceptingStates = [], i;\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (!(noam.util.contains(newFsm.acceptingStates, newFsm.states[i]))) {\n        nonAcceptingStates.push(newFsm.states[i]);\n      }\n    }\n\n    if (nonAcceptingStates.length === 0) {\n      return null;\n    }\n\n    var currentState = nonAcceptingStates[Math.floor(Math.random()*nonAcceptingStates.length)];\n    var trail = [];\n\n    while (true) {\n      if (noam.util.areEquivalent(currentState, newFsm.initialState) === true) {\n        if (Math.round(Math.random())) {\n          break;\n        }\n      }\n\n      var transitions = [];\n\n      for (i=0; i<newFsm.transitions.length; i++) {\n        if (noam.util.areEquivalent(newFsm.transitions[i].toStates[0], currentState)) {\n          transitions.push(newFsm.transitions[i]);\n        }\n      }\n\n      if (transitions.length === 0) {\n        break;\n      }\n\n      var transition = transitions[Math.floor(Math.random()*transitions.length)];\n\n      trail.push(transition.symbol);\n      currentState = transition.fromState;\n    }\n\n    trail.reverse();\n\n    return trail;\n  };\n\n  // get a new fsm which accepts the language L=L1+L2 (set union) where\n  // L1 is the language accepted by fsma and\n  // L2 is the language accepted by fsmB\n  noam.fsm.union = function(fsmA, fsmB) {\n    if (!(noam.util.areEquivalent(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error(\"Alphabets must be the same\");\n    }\n\n    var newFsm = {\n      alphabet : noam.util.clone(fsmA.alphabet),\n      states : [],\n      initialState : [noam.util.clone(fsmA.initialState), noam.util.clone(fsmB.initialState)],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    var i, j, k;\n\n    for (i=0; i<fsmA.states.length; i++) {\n      for (j=0; j<fsmB.states.length; j++) {\n        var newState = [noam.util.clone(fsmA.states[i]), noam.util.clone(fsmB.states[j])];\n        newFsm.states.push(newState);\n\n        if (noam.util.contains(fsmA.acceptingStates, fsmA.states[i]) ||\n            noam.util.contains(fsmB.acceptingStates, fsmB.states[j])) {\n          newFsm.acceptingStates.push(newState);\n        }\n\n        for (k=0; k<newFsm.alphabet.length; k++) {\n          newFsm.transitions.push({\n            fromState : newState,\n            symbol : newFsm.alphabet[k],\n            toStates : [[noam.fsm.makeTransition(fsmA, [fsmA.states[i]], newFsm.alphabet[k])[0],\n                        noam.fsm.makeTransition(fsmB, [fsmB.states[j]], newFsm.alphabet[k])[0]]]\n          });\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L=L1/L2 (set intersection) where\n  // L1 is the language accepted by fsma and\n  // L2 is the language accepted by fsmB\n  noam.fsm.intersection = function(fsmA, fsmB) {\n    var new_alphabet = noam.util.clone(noam.util.setIntersection(fsmA.alphabet, fsmB.alphabet));\n\n    var newFsm = {\n      alphabet : new_alphabet,\n      states : [],\n      initialState : [noam.util.clone(fsmA.initialState), noam.util.clone(fsmB.initialState)],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    var i, j, k;\n\n    for (i=0; i<fsmA.states.length; i++) {\n      for (j=0; j<fsmB.states.length; j++) {\n        var newState = [noam.util.clone(fsmA.states[i]), noam.util.clone(fsmB.states[j])];\n        newFsm.states.push(newState);\n\n        if (noam.util.contains(fsmA.acceptingStates, fsmA.states[i]) &&\n            noam.util.contains(fsmB.acceptingStates, fsmB.states[j])) {\n          newFsm.acceptingStates.push(newState);\n        }\n\n        for (k=0; k<newFsm.alphabet.length; k++) {\n          newFsm.transitions.push({\n            fromState : newState,\n            symbol : newFsm.alphabet[k],\n            toStates : [[noam.fsm.makeTransition(fsmA, [fsmA.states[i]], newFsm.alphabet[k])[0],\n                        noam.fsm.makeTransition(fsmB, [fsmB.states[j]], newFsm.alphabet[k])[0]]]\n          });\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L=L1-L2 (set difference) where\n  // L1 is the language accepted by fsma and\n  // L2 is the language accepted by fsmB\n  noam.fsm.difference = function(fsmA, fsmB) {\n    if (!(noam.util.areEquivalent(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error(\"Alphabets must be the same\");\n    }\n\n    var newFsm = {\n      alphabet : noam.util.clone(fsmA.alphabet),\n      states : [],\n      initialState : [noam.util.clone(fsmA.initialState), noam.util.clone(fsmB.initialState)],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    var i, j, k;\n\n    for (i=0; i<fsmA.states.length; i++) {\n      for (j=0; j<fsmB.states.length; j++) {\n        var newState = [noam.util.clone(fsmA.states[i]), noam.util.clone(fsmB.states[j])];\n        newFsm.states.push(newState);\n\n        if (noam.util.contains(fsmA.acceptingStates, fsmA.states[i]) &&\n            !(noam.util.contains(fsmB.acceptingStates, fsmB.states[j]))) {\n          newFsm.acceptingStates.push(newState);\n        }\n\n        for (k=0; k<newFsm.alphabet.length; k++) {\n          newFsm.transitions.push({\n            fromState : newState,\n            symbol : newFsm.alphabet[k],\n            toStates : [[noam.fsm.makeTransition(fsmA, [fsmA.states[i]], newFsm.alphabet[k])[0],\n                        noam.fsm.makeTransition(fsmB, [fsmB.states[j]], newFsm.alphabet[k])[0]]]\n          });\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the complement language of the\n  // langauge accepted by the input fsm\n  noam.fsm.complement = function(fsm) {\n    var newFsm = noam.util.clone(fsm);\n\n    var newAccepting = [], i;\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (!(noam.util.contains(newFsm.acceptingStates, newFsm.states[i]))) {\n        newAccepting.push(newFsm.states[i]);\n      }\n    }\n\n    newFsm.acceptingStates = newAccepting;\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L1L2 where\n  // L1 is the language accepted by fsmA and L2 is the\n  // langauge accepted by fsmB\n  noam.fsm.concatenation = function(fsmA, fsmB) {\n    if (!(noam.util.areEquivalent(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error(\"Alphabets must be the same\");\n    }\n\n    if (noam.util.containsAny(fsmA.states, fsmB.states)) {\n      throw new Error(\"States must not overlap\");\n    }\n\n    var newFsm = {\n      alphabet : noam.util.clone(fsmA.alphabet),\n      states : noam.util.clone(fsmA.states).concat(noam.util.clone(fsmB.states)),\n      initialState : noam.util.clone(fsmA.initialState),\n      acceptingStates : noam.util.clone(fsmB.acceptingStates),\n      transitions : noam.util.clone(fsmA.transitions).concat(noam.util.clone(fsmB.transitions))\n    };\n\n    for (var i=0; i<fsmA.acceptingStates.length; i++) {\n      newFsm.transitions.push({\n        fromState : noam.util.clone(fsmA.acceptingStates[i]),\n        toStates : [noam.util.clone(fsmB.initialState)],\n        symbol : noam.fsm.epsilonSymbol\n      });\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L*, where L is\n  // accepted by the input fsm and * is the kleene operator\n  noam.fsm.kleene = function(fsm) {\n    var newFsm = noam.util.clone(fsm);\n\n    var newInitial = \"NEW_INITIAL\";\n\n    newFsm.states.push(newInitial);\n    newFsm.transitions.push({\n      fromState : newInitial,\n      toStates : [newFsm.initialState],\n      symbol : noam.fsm.epsilonSymbol\n    });\n    newFsm.initialState = newInitial;\n\n    for (var i=0; i<newFsm.acceptingStates.length; i++) {\n      newFsm.transitions.push({\n        fromState : newFsm.acceptingStates[i],\n        toStates : [newInitial],\n        symbol : noam.fsm.epsilonSymbol\n      });\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the reverse language of the input fsm\n  noam.fsm.reverse = function(fsm) {\n    var newFsm = noam.util.clone(fsm);\n\n    var newTransitions = [];\n\n    for (var i=0; i<newFsm.transitions.length; i++) {\n      for (var j=0; j<newFsm.transitions[i].toStates.length; j++) {\n        newTransitions.push({\n          fromState : newFsm.transitions[i].toStates[j],\n          toStates : [newFsm.transitions[i].fromState],\n          symbol : newFsm.transitions[i].symbol\n        });\n      }\n    }\n\n    newFsm.transitions = newTransitions;\n\n    var oldAcceptingStates = newFsm.acceptingStates;\n\n    newFsm.acceptingStates = [newFsm.initialState];\n\n    var newInitialState = \"NEW_INITIAL\";\n    newFsm.states.push(newInitialState);\n    newFsm.initialState = newInitialState;\n\n    newFsm.transitions.push({\n      fromState : newInitialState,\n      toStates : oldAcceptingStates,\n      symbol : noam.fsm.epsilonSymbol\n    });\n\n    return newFsm;\n  };\n\n  // check whether the language accepted by fsmB is a subset of\n  // the language accepted by fsmA\n  noam.fsm.isSubset = function(fsmA, fsmB) {\n    var fsmIntersection = noam.fsm.intersection(fsmA, fsmB);\n\n    return noam.fsm.areEquivalentFSMs(fsmB, fsmIntersection);\n  };\n\n  // convert the fsm into a regular grammar\n  noam.fsm.grammar = function(fsm) {\n    var grammar = {\n      nonterminals : noam.util.clone(fsm.states),\n      terminals : noam.util.clone(fsm.alphabet),\n      initialNonterminal : noam.util.clone(fsm.initialState),\n      productions : []\n    };\n\n    var i;\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      if (fsm.transitions[i].symbol === noam.fsm.epsilonSymbol) {\n        grammar.productions.push({\n          left : [noam.util.clone(fsm.transitions[i].fromState)],\n          right : noam.util.clone(fsm.transitions[i].toStates)\n        });\n      } else {\n        grammar.productions.push({\n          left : [noam.util.clone(fsm.transitions[i].fromState)],\n          right : [noam.util.clone(fsm.transitions[i].symbol)].concat(\n            noam.util.clone(fsm.transitions[i].toStates))\n        });\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      grammar.productions.push({\n        left : [noam.util.clone(fsm.acceptingStates[i])],\n        right : [noam.grammar.epsilonSymbol]\n      });\n    }\n\n    return grammar;\n  };\n\n  noam.fsm.symbolsForTransitions = function(fsm, stateA, stateB) {\n    var res = [];\n\n    for (var i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (noam.util.areEquivalent(transition.fromState, stateA) &&\n          noam.util.contains(transition.toStates, stateB)) {\n        res.push(transition.symbol);\n      }\n    }\n\n    return res;\n  };\n\n  noam.fsm.toRegex = function(fsm) {\n    var r = [];\n    var n = fsm.states.length;\n\n    var i, j, k, z;\n\n    for (k=0; k<n+1; k++) {\n      r[k] = [];\n      for (i=0; i<n; i++) {\n        r[k][i] = [];\n      }\n    }\n\n    for (i=0; i<n; i++) {\n      for (j=0; j<n; j++) {\n        var symbols = noam.fsm.symbolsForTransitions(fsm, fsm.states[i], fsm.states[j]);\n\n        for (z=0; z<symbols.length; z++) {\n          symbols[z] = noam.re.tree.makeLit(symbols[z]);\n        }\n\n        if (i === j) {\n          symbols.push(noam.re.tree.makeEps());\n        }\n\n        r[0][i][j] = noam.re.tree.makeAlt(symbols);\n      }\n    }\n\n    for (k=1; k<n+1; k++) {\n      for (i=0; i<n; i++) {\n        for (j=0; j<n; j++) {\n          var t1 = ((typeof r[k-1][i][k-1].choices !== \"undefined\" && r[k-1][i][k-1].choices.length === 0) ||\n              (typeof r[k-1][k-1][j].choices !== \"undefined\" && r[k-1][k-1][j].choices.length === 0) ||\n              (typeof r[k-1][k-1][k-1].choices !== \"undefined\" && r[k-1][k-1][k-1].choices.length === 0));\n          var t2 =  (typeof r[k-1][i][j].choices !== \"undefined\" && r[k-1][i][j].choices.length === 0);\n\n          var seq = null\n\n          if (r[k-1][k-1][k-1].tag === noam.re.tree.tags.EPS) {\n            seq = noam.re.tree.makeSeq([r[k-1][i][k-1], r[k-1][k-1][j]]);\n          } else {\n            seq = noam.re.tree.makeSeq([r[k-1][i][k-1], noam.re.tree.makeKStar(r[k-1][k-1][k-1]), r[k-1][k-1][j]]);\n          }\n\n          var alt = [];\n\n          if (!t2) {\n            alt.push(r[k-1][i][j]);\n          }\n\n          if (!t1) {\n            alt.push(seq);\n          }\n\n          alt = noam.re.tree.makeAlt(alt);\n\n          r[k][i][j] = alt;\n        }\n      }\n    }\n\n    var startStateIndex = -1;\n    var acceptableStatesIndexes = [];\n\n    for (i=0; i<fsm.states.length; i++) {\n      if (noam.util.areEquivalent(fsm.states[i], fsm.initialState)) {\n        startStateIndex = i;\n      }\n\n      if (noam.util.contains(fsm.acceptingStates, fsm.states[i])) {\n        acceptableStatesIndexes.push(i);\n      }\n    }\n\n    var elements = [];\n\n    for (i=0; i<acceptableStatesIndexes.length; i++) {\n      elements.push(r[n][startStateIndex][acceptableStatesIndexes[i]]);\n    }\n\n    return noam.re.tree.makeAlt(elements);\n  };\n\n  noam.grammar = {};\n\n  noam.grammar.epsilonSymbol = '$';\n  noam.grammar.regType = 'regular';\n  noam.grammar.cfgType = 'context-free';\n  noam.grammar.csgType = 'context-sensitive';\n  noam.grammar.unrestrictedType = 'unrestricted';\n\n  // validate the grammar\n  noam.grammar.validate = function(grammar) {\n    if (!(typeof grammar !== 'undefined' &&\n        Array.isArray(grammar.nonterminals) &&\n        Array.isArray(grammar.terminals) &&\n        typeof grammar.initialNonterminal !== 'undefined' && grammar.initialNonterminal !== null &&\n        Array.isArray(grammar.productions))) {\n      throw new Error('Grammar must be defined and have nonterminals, terminals, initialNonterminal and productions array properties!');\n    }\n    \n    var i, j;\n\n    if (grammar.nonterminals.length < 1) {\n      throw new Error('Set of nonterminals must not be empty.');\n    }\n\n    if (grammar.terminals.length < 1) {\n      throw new Error('Set of terminals must not be empty.');\n    }\n\n    for (i=0; i<grammar.nonterminals.length; i++) {\n      if (noam.util.contains(grammar.nonterminals, grammar.nonterminals[i], i+1)) {\n        throw new Error('Equivalent nonterminals');\n      }\n    }\n\n    for (i=0; i<grammar.terminals.length; i++) {\n      if (noam.util.contains(grammar.terminals, grammar.terminals[i], i+1)) {\n        throw new Error('Equivalent terminals');\n      }\n    }\n\n    for (i=0; i<grammar.terminals.length; i++) {\n      if (noam.util.contains(grammar.nonterminals, grammar.terminals[i])) {\n        throw new Error('Terminals and nonterminals must not overlap');\n      }\n    }\n\n    if (!(noam.util.contains(grammar.nonterminals, grammar.initialNonterminal))) {\n      throw new Error('InitialNonterminal must be in nonterminals');\n    }\n\n    for (i=0; i<grammar.productions.length; i++) {\n      var production = grammar.productions[i];\n\n      if (!(Array.isArray(production.left))) {\n        throw new Error('Left side of production must be an array');\n      }\n\n      if (production.left.length === 0) {\n        throw new Error('Left side of production must have at least one terminal or nonterminal');\n      }\n\n      for (j=0; j<production.left.length; j++) {\n        if (!(noam.util.contains(grammar.nonterminals, production.left[j])) &&\n            !(noam.util.contains(grammar.terminals, production.left[j]))) {\n          throw new Error('Left side of production must be in nonterminals or terminals');\n        }\n      }\n\n      if (!(Array.isArray(production.right))) {\n        throw new Error('Right side of production must be an array');\n      }\n\n      if (production.right.length === 1 && production.right[0] === noam.grammar.epsilonSymbol) {\n        \n      } else {\n        if (production.right.length === 0) {\n          throw new Error('Right side of production must have at least one terminal or nonterminal or epsilon symbol');\n        }\n\n        for (j=0; j<production.right.length; j++) {\n          if (!(noam.util.contains(grammar.nonterminals, production.right[j])) &&\n              !(noam.util.contains(grammar.terminals, production.right[j]))) {\n            throw new Error('Right side of production must be in nonterminals or terminals');\n          }\n        }\n      }\n\n      if (noam.util.contains(grammar.productions, production, i+1)) {\n        throw new Error('Grammar must not have duplicate productions');\n      }\n    }\n\n    return true;\n  };\n\n  // determine whether the grammar is regular, context-free, \n  // context-sensitive or unrestricted\n  noam.grammar.determineType = function(grammar) {\n    var type = noam.grammar.regType;\n    var isRightRegular = null;\n    var i, j, indexOfNonterminal;\n\n    for (i=0; i<grammar.productions.length; i++) {\n      var production = grammar.productions[i];\n\n      // handle both left-regular and right-regular\n      if (type === noam.grammar.regType) {\n        if (production.left.length !== 1 || !(noam.util.contains(grammar.nonterminals, production.left[0]))) {\n          type = noam.grammar.cfgType;\n        } else {\n          if (production.right.length === 1) {\n            continue;\n          } else {\n            var rightNonTerminalCount = 0;\n            indexOfNonterminal = -1;\n\n            for (j=0; j<production.right.length; j++) {\n              if (noam.util.contains(grammar.nonterminals, production.right[j])) {\n                rightNonTerminalCount += 1;\n                indexOfNonterminal = j;\n              }\n            }\n\n            if (rightNonTerminalCount > 1) {\n              type = noam.grammar.cfgType;\n            } else if (rightNonTerminalCount === 0) {\n              continue;\n            } else {\n              if (indexOfNonterminal === 0) {\n                if (isRightRegular === null) {\n                  isRightRegular = false;\n                  continue;\n                } else if (isRightRegular === false) {\n                  continue;\n                } else if (isRightRegular === true) {\n                  type = noam.grammar.cfgType;\n                }\n              } else if (indexOfNonterminal === production.right.length - 1) {\n                if (isRightRegular === null) {\n                  isRightRegular = true;\n                  continue;\n                } else if (isRightRegular === true) {\n                  continue;\n                } else if (isRightRegular === false) {\n                  type = noam.grammar.cfgType;\n                }\n              } else {\n                type = noam.grammar.cfgType;\n              }\n            }\n          }\n        }\n      }\n\n      if (type === noam.grammar.cfgType) {\n        if (production.left.length !== 1 || !(noam.util.contains(grammar.nonterminals, production.left[0]))) {\n          type = noam.grammar.csgType;\n        }\n      }\n\n      if (type === noam.grammar.csgType) {\n        var leftNonTerminalCount = 0;\n        indexOfNonterminal = -1;\n\n        for (j=0; j<production.left.length; j++) {\n          if (noam.util.contains(grammar.nonterminals, production.left[j])) {\n            leftNonTerminalCount += 1;\n            indexOfNonterminal = j;\n          }\n        }\n\n        if (leftNonTerminalCount > 1) {\n          return noam.grammar.unrestrictedType;\n        }\n\n        var prefix = production.left.slice(0, indexOfNonterminal-1);\n        var sufix = production.left.slice(indexOfNonterminal);\n\n        for (j=0; j<prefix.length; j++) {\n          if (!(noam.util.areEquivalent(prefix[j], production.right[j]))) {\n            return noam.grammar.unrestrictedType;\n          }\n        }\n\n        for (j=0; j<sufix.length; j++) {\n          if (!(noam.util.areEquivalent(sufix[sufix.length-j-1], production.right[production.right.length-j-1]))) {\n            return noam.grammar.unrestrictedType;\n          }\n        }\n\n        if (production.right.length <= prefix.length + sufix.length) {\n          return noam.grammar.unrestrictedType;\n        }\n      }\n    }\n\n    return type;\n  };\n\n  // print the grammar in a human-readable condensed ascii format\n  noam.grammar.printAscii = function(grammar) {\n    var str = [];\n\n    str.push(\"Initial nonterminal: \" + \"<\" + grammar.initialNonterminal + \">\");\n\n    var slimProds = [], i, j, k;\n\n    for (i=0; i<grammar.productions.length; i++) {\n      var foundSlim = -1;\n\n      for (j=0; j<slimProds.length; j++) {\n        if (noam.util.areEquivalent(slimProds[j][0], grammar.productions[i].left)) {\n          foundSlim = j;\n          break;\n        }\n      }\n\n      if (foundSlim === -1) {\n        slimProds[slimProds.length] = [grammar.productions[i].left, [grammar.productions[i].right]];\n      } else {\n        slimProds[foundSlim][1].push(grammar.productions[i].right);\n      }\n    }\n\n    for (i=0; i<slimProds.length; i++) {\n      var prod = [];\n\n      for (j=0; j<slimProds[i][0].length; j++) {\n        if (noam.util.contains(grammar.nonterminals, slimProds[i][0][j])) {\n          prod.push(\"<\" + slimProds[i][0][j].toString() + \">\");\n        } else {\n          if (slimProds[i][0][j] === noam.grammar.epsilonSymbol) {\n            prod.push(slimProds[i][0][j].toString());\n          } else {\n            prod.push('\"' + slimProds[i][0][j].toString() + '\"');\n          }\n        }\n      }\n\n      prod.push(\"->\");\n\n      for (j=0; j<slimProds[i][1].length; j++) {\n        for (k=0; k<slimProds[i][1][j].length; k++) {\n          if (noam.util.contains(grammar.nonterminals, slimProds[i][1][j][k])) {\n            prod.push(\"<\" + slimProds[i][1][j][k].toString() + \">\");\n          } else {\n            if (slimProds[i][1][j][k] === noam.grammar.epsilonSymbol) {\n              prod.push(slimProds[i][1][j][k].toString());\n            } else {\n              prod.push('\"' + slimProds[i][1][j][k].toString() + '\"');\n            }\n          }\n        }\n\n        if (j < slimProds[i][1].length - 1) {\n          prod.push(\"|\");\n        }\n      }\n\n      str.push(prod.join(\" \"));\n    }\n\n    return str.join(\"\\n\");\n  };\n\n  /*\n   * Regular expressions module.\n   *\n   * Parsed regular expressions are represented by a syntax tree. Tools for working with that\n   * representation are accessible through noam.re.tree.\n   *\n   * Two linear representations are also available and provide a convenient way to specify\n   * some languages, but are not composable like the tree representation. The array representation\n   * is available through noam.re.array and supports arbitrarily complex literals. If all the\n   * literals are characters, the string representation should be more convenient. It is\n   * available through noam.re.string. These linear representations are only useful for specifying\n   * languages and should usually be converted to a tree representation or to an automaton immediately.\n   */\n  noam.re = (function() {\n\n    /*\n     * Tools for creating and manipulating parsed regular expressions.\n     *\n     * The make* functions are a minimal API that can be used to create arbitrarily complex\n     * regular expressions programatically.\n     */\n    var tree = (function() {\n      var tags = {\n        ALT: 'alt',\n        SEQ: 'sequence',\n        KSTAR: 'kleene_star',\n        LIT: 'literal',\n        EPS: 'epsilon'\n      };\n\n      function copyAndDeleteProperties(o1, o2) {\n        var p;\n\n        for (p in o1) {\n          if (o1.hasOwnProperty(p)) {\n            delete o1[p];\n          }\n        }\n\n        for (p in o2) {\n          if (o2.hasOwnProperty(p)) {\n            o1[p] = o2[p];\n          }\n        }\n      }\n\n      /*\n        Simplifies the regular expression @a tree (a noam.re.tree object).\n        The goal of simplification is to obtain a regular expression which\n        defines the same language but has a smaller number of elements in\n        the tree structure and therefore less elements in array or string\n        form. Simplification is performed by iteratively transforming the\n        tree using a set of known algebraic equivalences in Kleene algebra.\n        If specified, the @a numIterations integer limits the number of\n        transformations that will be performed. Furthermore, if specified,\n        the @a appliedPatterns array will be filled with objects that\n        describe which patterns were applied, i.e. which transformations\n        were performed. The original tree @a tree is not modified; a new\n        tree is returned as a result.\n\n        The current set of patterns that are checked are (small alphabet\n        letters represent any regular expression):\n\n          # (a) => a (sequence of 1 element)\n          # (a) => a (choices with 1 element)\n          # $* => $\n          # (a*)* => a*\n          # (a+b*)* => (a+b)*\n          # $+a* => a*\n          # (a*b*c*)* => (a*+b*+c*)*\n          # $a => a\n          # (a+(b+c)) => a+b+c\n          # ab(cd) => abcd\n          # a+b+a => b+a\n          # a+b+a* => b+a*\n          # a*a* => a*\n          # (aa+a)* => a*\n          # (a+$)* => a*\n          # (ab+ac) => a(b+c)\n          # a*aa* => aa*\n          # (ab+cb) => (a+c)b\n          # a*($+b(a+b)*) => (a+b)*\n          # ($+(a+b)*a)b* => (a+b)*\n          # (a()) => ()\n          # ()* => ()\n\n        If none of these \"simple\" patterns can be applied, the simplification\n        process tries to apply patterns based on language subset (via\n        transformations to fsms):\n\n          # L1+L2 => L2, if L1 is subset of L2\n          # (L1+L2)* => L2, if L1* is subset of L2*\n          # L1*L2* => L2, if L1* is subset of L2*\n          # $+L => L, if L contains $\n          # (L1+$)(L2)* => (L2)* if L1 is subset of L2\n\n        The tree transformation process is stopped after no transformation\n        can be applied to the tree.\n      */\n\n      var _regex_simplification_patterns = [];\n\n      // (a) => a (sequence)\n      function _regex_simplify_1(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length === 1){\n          tree.tag = tree.elements[0].tag;\n\n          copyAndDeleteProperties(tree, tree.elements[0]);\n          return true;\n        }\n\n        return false;\n      }\n\n      // (a) => a (choices)\n      function _regex_simplify_2(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length === 1) {\n          tree.tag = tree.choices[0].tag;\n\n          copyAndDeleteProperties(tree, tree.choices[0]);\n          return true;\n        }\n\n        return false;\n      }\n\n      // $* => $\n      function _regex_simplify_3(tree, fsmCache) {\n         if (tree.tag === tags.KSTAR && tree.expr.tag === tags.EPS) {\n           tree.tag = tree.expr.tag;\n           delete tree.expr;\n           return true;\n         }\n\n         return false;\n      }\n\n      // (a*)* => a*\n      function _regex_simplify_4(tree, fsmCache) {\n         if (tree.tag === tags.KSTAR && tree.expr.tag === tags.KSTAR) {\n           tree.expr = tree.expr.expr;\n           return true;\n         }\n\n         return false;\n      }\n\n      // (a+b*)* => (a+b)*\n      function _regex_simplify_5(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT) {\n          var changed = false;\n          for (var i=0; i<tree.expr.choices.length; i++) {\n            if (tree.expr.choices[i].tag === tags.KSTAR) {\n              tree.expr.choices[i] = tree.expr.choices[i].expr;\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // $+a* => a*\n      function _regex_simplify_6(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          var epsIndex = -1;\n          var kstarIndex = -1;\n\n          for (var i=0; i<tree.choices.length; i++) {\n            if (tree.choices[i].tag === tags.EPS) {\n              epsIndex = i;\n            } else if (tree.choices[i].tag === tags.KSTAR) {\n              kstarIndex = i;\n            }\n          }\n\n          if (epsIndex >= 0 && kstarIndex >= 0) {\n            tree.choices.splice(epsIndex, 1);\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // (a*b*)* => (a*+b*)*\n      function _regex_simplify_7(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.SEQ && tree.expr.elements.length > 0) {\n          var check = true;\n          for (var i=0; i<tree.expr.elements.length; i++) {\n            if (tree.expr.elements[i].tag !== tags.KSTAR) {\n              check = false;\n              break;\n            }\n          }\n\n          if (check) {\n            tree.expr.tag = tags.ALT;\n            tree.expr.choices = tree.expr.elements;\n            delete tree.expr.elements;\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // $a => a\n      function _regex_simplify_8(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var epsIndex = -1;\n\n          for (var i=0; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.EPS) {\n              epsIndex = i;\n            }\n          }\n\n          if (epsIndex >= 0) {\n            tree.elements.splice(epsIndex, 1);\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // (a+(b+c)) => a+b+c\n      function _regex_simplify_9(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          var found = -1, i;\n          for (i=0; i<tree.choices.length; i++) {\n            if (tree.choices[i].tag === tags.ALT) {\n              found = i;\n            }\n          }\n\n          if (found >= 0) {\n            var node = tree.choices[found];\n            tree.choices.splice(found, 1);\n\n            for (i=0; i<node.choices.length; i++) {\n              tree.choices.splice(found+i, 0, node.choices[i]);\n            }\n\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // ab(cd) => abcd\n      function _regex_simplify_10(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var found = -1, i;\n          for (i=0; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.SEQ) {\n              found = i;\n              break;\n            }\n          }\n\n          if (found >= 0) {\n            var node = tree.elements[i];\n            tree.elements.splice(i, 1);\n\n            for (i=0; i<node.elements.length; i++) {\n              tree.elements.splice(found+i, 0, node.elements[i]);\n            }\n\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // a+a => a\n      function _regex_simplify_11(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            var found = -1;\n            for (var j=i+1; j<tree.choices.length; j++) {\n              if (noam.util.areEquivalent(tree.choices[i], tree.choices[j])) {\n                found = j;\n                break;\n              }\n            }\n\n            if (found >= 0) {\n              tree.choices.splice(found, 1);\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a+a* => a*\n      function _regex_simplify_12(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            var found = -1;\n            for (var j=i+1; j<tree.choices.length; j++) {\n              if (tree.choices[j].tag === tags.KSTAR && noam.util.areEquivalent(tree.choices[j].expr, tree.choices[i])) {\n                found = i;\n                break;\n              }\n\n              else if (tree.choices[i].tag === tags.KSTAR && noam.util.areEquivalent(tree.choices[i].expr, tree.choices[j])) {\n                found = j;\n                break;\n              }\n            }\n\n            if (found >= 0) {\n              tree.choices.splice(found, 1);\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a*a* => a*\n      function _regex_simplify_13(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var found = -1;\n\n          for (var i=0; i<tree.elements.length-1; i++) {\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i+1].tag === tags.KSTAR && noam.util.areEquivalent(tree.elements[i], tree.elements[i+1])) {\n              found = i;\n              break;\n            }\n          }\n\n          if (found >= 0) {\n            tree.elements.splice(found+1, 1);\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // (aa+a)* => (a)*\n      function _regex_simplify_14(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT && tree.expr.choices.length >= 2) {\n          for (var i=0; i<tree.expr.choices.length; i++) {\n            for (var j=0; j<tree.expr.choices.length; j++) {\n              if (i !== j && tree.expr.choices[j].tag === tags.SEQ && tree.expr.choices[j].elements.length >= 2) {\n                var found = true;\n\n                for (var k=0; k<tree.expr.choices[j].elements.length; k++) {\n                  if (!(noam.util.areEquivalent(tree.expr.choices[i], tree.expr.choices[j].elements[k]))) {\n                    found = false;\n                    break;\n                  }\n                }\n\n                if (found) {\n                  tree.expr.choices.splice(j, 1);\n                  return true;\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (a + $)* => (a)*\n      function _regex_simplify_15(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT && tree.expr.choices.length >= 2) {\n          for (var i=0; i<tree.expr.choices.length; i++) {\n            if (tree.expr.choices[i].tag === tags.EPS) {\n              tree.expr.choices.splice(i, 1);\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (ab+ac) => a(b+c)\n      function _regex_simplify_16(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >=2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            if (tree.choices[i].tag === tags.SEQ && tree.choices[i].elements.length >= 2) {\n              for (var j=i+1; j<tree.choices.length; j++) {\n                if (tree.choices[j].tag === tags.SEQ && tree.choices[j].elements.length >= 2) {\n                  if (noam.util.areEquivalent(tree.choices[j].elements[0], tree.choices[i].elements[0])) {\n                    var first = tree.choices[i].elements[0];\n                    var rest1 = makeSeq(tree.choices[i].elements.slice(1));\n                    var rest2 = makeSeq(tree.choices[j].elements.slice(1));\n\n                    var _alt = makeAlt([rest1, rest2]);\n                    var _seq = makeSeq([first, _alt]);\n\n                    tree.choices[i] = _seq;\n                    tree.choices.splice(j, 1);\n\n                    return true;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a*aa* => aa*\n      function _regex_simplify_17(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >=3) {\n          for (var i=1; i<tree.elements.length-1; i++) {\n            if (tree.elements[i-1].tag === tags.KSTAR && tree.elements[i+1].tag === tags.KSTAR) {\n              if (noam.util.areEquivalent(tree.elements[i-1], tree.elements[i+1]) &&\n                  noam.util.areEquivalent(tree.elements[i-1].expr, tree.elements[i])) {\n                tree.elements.splice(i-1, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (ab+cb) => (a+c)b\n      function _regex_simplify_18(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >=2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            if (tree.choices[i].tag === tags.SEQ && tree.choices[i].elements.length >= 2) {\n              for (var j=i+1; j<tree.choices.length; j++) {\n                if (tree.choices[j].tag === tags.SEQ && tree.choices[j].elements.length >= 2) {\n                  if (noam.util.areEquivalent(tree.choices[j].elements[tree.choices[j].elements.length-1],\n                                              tree.choices[i].elements[tree.choices[i].elements.length-1])) {\n                    var last = tree.choices[i].elements[tree.choices[i].elements.length-1];\n                    var rest1 = makeSeq(tree.choices[i].elements.slice(0, tree.choices[i].elements.length-1));\n                    var rest2 = makeSeq(tree.choices[j].elements.slice(0, tree.choices[j].elements.length-1));\n\n                    var _alt = makeAlt([rest1, rest2]);\n                    var _seq = makeSeq([_alt, last]);\n\n                    tree.choices[i] = _seq;\n                    tree.choices.splice(j, 1);\n\n                    return true;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // L1+L2 => L2, if L1 is subset of L2\n      function _regex_simplify_19(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          var fsms = [];\n\n          fsms.push(getFromCacheOrCreateFsm(tree.choices[0], fsmCache));\n\n          var found = -1;\n\n          for (var i=0; i<tree.choices.length-1; i++) {\n            for (var j=i+1; j<tree.choices.length; j++) {\n              if (fsms.length <= j) {\n                fsms.push(getFromCacheOrCreateFsm(tree.choices[j], fsmCache));\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[i], fsms[j]) ) {\n                  found = j;\n                }\n              } catch (e) {\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[j], fsms[i]) ) {\n                  found = i;\n                }\n              } catch (e) {\n              }\n\n              if (found >= 0) {\n                tree.choices.splice(found, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n          return false;\n      }\n\n      // (L1+L2)* => L2*, if L1* is subset of L2*\n      function _regex_simplify_20(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT && tree.expr.choices.length >= 2) {\n          var fsms = [];\n\n          fsms.push(getFromCacheOrCreateFsm(makeKStar(tree.expr.choices[0]), fsmCache));\n\n          var found = -1;\n\n          for (var i=0; i<tree.expr.choices.length-1; i++) {\n            for (var j=i+1; j<tree.expr.choices.length; j++) {\n              if (fsms.length <= j) {\n                fsms.push(getFromCacheOrCreateFsm(makeKStar(tree.expr.choices[j]), fsmCache));\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[i], fsms[j]) ) {\n                  found = j;\n                }\n              } catch (e) {\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[j], fsms[i]) ) {\n                  found = i;\n                }\n              } catch (e) {\n              }\n\n              if (found >= 0) {\n                tree.expr.choices.splice(found, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      function getFromCacheOrCreateFsm(key, ht) {\n        var fsm = ht.get(key);\n\n        if (!(fsm)) {\n          fsm = noam.fsm.minimize(noam.re.tree.toAutomaton(key));\n          ht.put(key, fsm);\n        }\n\n        return fsm;\n      }\n\n      // L1*L2* => L2, if L1* is subset of L2*\n      function _regex_simplify_21(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var fsms = [];\n          fsms.push(getFromCacheOrCreateFsm(tree.elements[0], fsmCache));\n\n          var found = -1;\n\n          for (var i=0; i<tree.elements.length-1; i++) {\n            fsms.push(getFromCacheOrCreateFsm(tree.elements[i+1], fsmCache));\n\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i+1].tag === tags.KSTAR) {\n              try {\n                if (noam.fsm.isSubset(fsms[i], fsms[i+1]) ) {\n                  found = i+1;\n                }\n              } catch (e) {\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[i+1], fsms[i]) ) {\n                  found = i;\n                }\n              } catch (e) {\n              }\n\n              if (found >= 0) {\n                tree.elements.splice(found, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // $+L => L, if L contains $\n      function _regex_simplify_22(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length > 1) {\n          var index_eps = noam.util.index(tree.choices, makeEps());\n\n          if (index_eps >= 0) {\n            for (var i=0; i<tree.choices.length; i++) {\n              if (tree.choices[i].tag !== tags.EPS) {\n                var fsm = getFromCacheOrCreateFsm(tree.choices[i], fsmCache);\n\n                if (noam.fsm.isAcceptingState(fsm, fsm.initialState)) {\n                  tree.choices.splice(index_eps, 1);\n                  return true;\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a*($+b(a+b)*) => (a+b)*\n      function _regex_simplify_23(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length > 1) {\n          for (var i=0; i<tree.elements.length-1; i++) {\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i+1].tag === tags.ALT &&\n              tree.elements[i+1].choices.length === 2) {\n\n              var index_eps = noam.util.index(tree.elements[i+1].choices, makeEps());\n\n              if (index_eps >= 0) {\n                var internal = index_eps === 0 ? tree.elements[i+1].choices[1] : tree.elements[i+1].choices[0];\n\n                if (internal.tag === tags.SEQ && internal.elements.length === 2) {\n                  if (internal.elements[1].tag === tags.KSTAR && internal.elements[1].expr.tag === tags.ALT &&\n                      internal.elements[1].expr.choices.length === 2 && noam.util.contains(internal.elements[1].expr.choices, tree.elements[i].expr)) {\n                    if (noam.util.contains(internal.elements[1].expr.choices, internal.elements[0])) {\n                      tree.elements[i+1] = internal.elements[1];\n                      tree.elements.splice(i, 1);\n                      return true;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // ($+(a+b)*a)b* => (a+b)*\n      function _regex_simplify_24(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length > 1) {\n          for (var i=1; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i-1].tag === tags.ALT &&\n              tree.elements[i-1].choices.length === 2) {\n\n              var index_eps = noam.util.index(tree.elements[i-1].choices, makeEps());\n\n              if (index_eps >= 0) {\n                var internal = index_eps === 0 ? tree.elements[i-1].choices[1] : tree.elements[i-1].choices[0];\n\n                if (internal.tag === tags.SEQ && internal.elements.length === 2) {\n                  if (internal.elements[0].tag === tags.KSTAR && internal.elements[0].expr.tag === tags.ALT &&\n                      internal.elements[0].expr.choices.length === 2 && noam.util.contains(internal.elements[0].expr.choices, tree.elements[i].expr)) {\n                    if (noam.util.contains(internal.elements[0].expr.choices, internal.elements[1])) {\n                      tree.elements[i-1] = internal.elements[0];\n                      tree.elements.splice(i, 1);\n                      return true;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (L1+$)(L2)* => (L2)* if L1 is subset of L2\n      function _regex_simplify_27(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length > 1) {\n          for (var i=0; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.KSTAR) {\n              if (i > 0 && tree.elements[i-1].tag === tags.ALT && tree.elements[i-1].choices.length > 1) {\n                var index_eps = noam.util.index(tree.elements[i-1].choices, makeEps());\n\n                if (index_eps >= 0) {\n                  var eps = tree.elements[i-1].choices.splice(index_eps, 1)[0];\n\n                  var fsm_kstar = getFromCacheOrCreateFsm(tree.elements[i], fsmCache);\n                  var fsm_other = getFromCacheOrCreateFsm(tree.elements[i-1], fsmCache);\n\n                  var found = false;\n\n                  try {\n                    if (noam.fsm.isSubset(fsm_kstar, fsm_other)) {\n                      found = true;\n                    }\n                  } catch (e) {\n                  }\n\n                  if (found) {\n                    tree.elements.splice(i-1, 1);\n                    return true;\n                  } else {\n                    tree.elements[i-1].choices.splice(index_eps, 0, eps);\n                  }\n                }\n              } else if (i < tree.elements.length-1 && tree.elements[i+1].tag === tags.ALT && tree.elements[i+1].choices.length > 1) {\n                var index_eps = noam.util.index(tree.elements[i+1].choices, makeEps());\n\n                if (index_eps >= 0) {\n                  var eps = tree.elements[i+1].choices.splice(index_eps, 1)[0];\n\n                  var fsm_kstar = getFromCacheOrCreateFsm(tree.elements[i], fsmCache);\n                  var fsm_other = getFromCacheOrCreateFsm(tree.elements[i+1], fsmCache);\n\n                  var found = false;\n\n                  try {\n                    if (noam.fsm.isSubset(fsm_kstar, fsm_other)) {\n                      found = true;\n                    }\n                  } catch (e) {\n                  }\n\n                  if (found) {\n                    tree.elements.splice(i+1, 1);\n                    return true;\n                  } else {\n                    tree.elements[i+1].choices.splice(index_eps, 0, eps);\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      // (a()) => ()\n      function _regex_simplify_25(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 1) {\n          for (var i=0; i<tree.elements.length; i++) {\n            if ((tree.elements[i].tag === tags.SEQ && tree.elements[i].elements.length === 0) ||\n                (tree.elements[i].tag === tags.ALT && tree.elements[i].choices.length === 0)) {\n              tree.elements = [];\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // ()* => ()\n      function _regex_simplify_26(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.SEQ && tree.expr.elements.length === 0) {\n          tree.tag = tags.SEQ;\n          delete tree.expr;\n          tree.elements = [];\n          return true;\n        }\n\n        return false;\n      }\n\n      _regex_simplification_patterns.push({ 'pattern' : \"(a()) => ()\", 'type' : 'structure', 'function' : _regex_simplify_25});\n      _regex_simplification_patterns.push({ 'pattern' : \"()* => ()\", 'type' : 'structure', 'function' : _regex_simplify_26});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a) => a\", 'type' : 'structure', 'function' : _regex_simplify_1 });\n      _regex_simplification_patterns.push({ 'pattern' : \"(a) => a\", 'type' : 'structure', 'function' : _regex_simplify_2 });\n      _regex_simplification_patterns.push({ 'pattern' : \"$* => $\", 'type' : 'structure', 'function' : _regex_simplify_3});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a*)* => a*\", 'type' : 'structure', 'function' : _regex_simplify_4});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a+b*)* => (a+b)*\", 'type' : 'structure', 'function' : _regex_simplify_5});\n      _regex_simplification_patterns.push({ 'pattern' : \"$+a* => a*\", 'type' : 'structure', 'function' : _regex_simplify_6});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a*b*)* => (a*+b*)*\", 'type' : 'structure', 'function' : _regex_simplify_7});\n      _regex_simplification_patterns.push({ 'pattern' : \"$a => a\", 'type' : 'structure', 'function' : _regex_simplify_8});\n      _regex_simplification_patterns.push({ 'pattern' : \"a+a => a\", 'type' : 'structure', 'function' : _regex_simplify_11});\n      _regex_simplification_patterns.push({ 'pattern' : \"a+a* => a*\", 'type' : 'structure', 'function' : _regex_simplify_12});\n      _regex_simplification_patterns.push({ 'pattern' : \"a*a* => a*\", 'type' : 'structure', 'function' : _regex_simplify_13});\n      _regex_simplification_patterns.push({ 'pattern' : \"(aa+a)* => (a)*\", 'type' : 'structure', 'function' : _regex_simplify_14});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a + $)* => (a)*\", 'type' : 'structure', 'function' : _regex_simplify_15});\n      _regex_simplification_patterns.push({ 'pattern' : \"(ab+ac) => a(b+c)\", 'type' : 'structure', 'function' : _regex_simplify_16});\n      _regex_simplification_patterns.push({ 'pattern' : \"a*aa* => aa*\", 'type' : 'structure', 'function' : _regex_simplify_17});\n      _regex_simplification_patterns.push({ 'pattern' : \"(ab+cb) => (a+c)b\", 'type' : 'structure', 'function' : _regex_simplify_18});\n      _regex_simplification_patterns.push({ 'pattern' : \"a*($+b(a+b)*) => (a+b)*\", 'type' : 'structure', 'function' : _regex_simplify_23});\n      _regex_simplification_patterns.push({ 'pattern' : \"($+(a+b)*a)b* => (a+b)*\", 'type' : 'structure', 'function' : _regex_simplify_24});\n      _regex_simplification_patterns.push({ 'pattern' : \"$+L => L, if L contains $\", 'type' : 'fsm', 'function' : _regex_simplify_22});\n      _regex_simplification_patterns.push({ 'pattern' : \"L1+L2 => L2, if L1 is subset of L2\", 'type' : 'fsm', 'function' : _regex_simplify_19});\n      _regex_simplification_patterns.push({ 'pattern' : \"(L1+L2)* => L2, if L1* is subset of L2*\", 'type' : 'fsm', 'function' : _regex_simplify_20});\n      _regex_simplification_patterns.push({ 'pattern' : \"L1*L2* => L2, if L1* is subset of L2*\", 'type' : 'fsm', 'function' : _regex_simplify_21});\n      _regex_simplification_patterns.push({ 'pattern' : \"(L1+$)(L2)* => (L2)* if L1 is subset of L2\", 'type' : 'fsm', 'function' : _regex_simplify_27});\n      _regex_simplification_patterns.push({ 'pattern' : \"ab(cd) => abcd\", 'type' : 'structure', 'function' : _regex_simplify_10});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a+(b+c)) => a+b+c\", 'type' : 'structure', 'function' : _regex_simplify_9});\n\n      function simplify(tree, config) {\n        var treeClone = noam.util.clone(tree);\n\n        if (typeof config === \"undefined\") {\n          config = {};\n        }\n\n        var opts = noam.util.clone(config);\n\n        if (typeof opts.numIterations === \"undefined\") {\n          opts.numIterations = null;\n        }\n\n        if (typeof opts.appliedPatterns === 'undefined') {\n          opts.appliedPatterns = null;\n        } else {\n          opts.appliedPatterns = config.appliedPatterns;\n        }\n\n        if (typeof opts.useFsmPatterns === \"undefined\") {\n          opts.useFsmPatterns = true;\n        }\n\n        var appliedPattern = \"temp\";\n        var iterCount = 0;\n        var fsmCache = new noam.util.HashTable();\n\n        while (appliedPattern !== null && (opts.numIterations === null || iterCount < opts.numIterations)) {\n          appliedPattern = _simplify_iteration(treeClone, fsmCache, opts.useFsmPatterns);\n\n          if (appliedPattern !== null && opts.appliedPatterns !== null) {\n            opts.appliedPatterns.push(appliedPattern);\n          }\n\n          iterCount += 1;\n        }\n\n        return treeClone;\n      }\n\n      function _simplify_iteration(tree, fsmCache, useFsmPatterns) {\n        var pattern = null;\n        var result = null;\n\n        for (var i=0; i<_regex_simplification_patterns.length; i++) {\n          pattern = _regex_simplification_patterns[i];\n\n          if (useFsmPatterns === false && pattern.type === \"fsm\") {\n            continue;\n          }\n\n          result = _simplify_recursion(tree, pattern['function'], fsmCache);\n\n          if (result) {\n            return pattern.pattern;\n          }\n        }\n\n        return null;\n      }\n\n      function _simplify_recursion(tree, patternFunction, fsmCache) {\n        var appliedPattern = patternFunction(tree, fsmCache);\n\n        if (appliedPattern) {\n          return appliedPattern;\n        }\n\n        var children = [];\n\n        if (tree.tag === tags.ALT) {\n          children = tree.choices;\n        } else if (tree.tag === tags.SEQ) {\n          children = tree.elements;\n        } else if (tree.tag === tags.KSTAR) {\n          children = [tree.expr];\n        }\n\n        for (var i=0; i<children.length; i++) {\n          appliedPattern = _simplify_recursion(children[i], patternFunction, fsmCache);\n          if (appliedPattern) {\n            return appliedPattern;\n          }\n        }\n\n        return false;\n      }\n\n      // The choices parameter must be an array of expression trees.\n      // Returns the root of a new tree that represents the expression that is the union of\n      // all the choices.\n      function makeAlt(choices) {\n        return {\n          tag: tags.ALT,\n          choices: choices\n        };\n      }\n\n      // The elements parameter must be an array of expression trees.\n      // Returns the root of a new tree that represents the expression that is the sequence\n      // of all the elements.\n      function makeSeq(elements) {\n        return {\n          tag: tags.SEQ,\n          elements: elements\n        };\n      }\n\n      // Wraps the given expressin tree unde a Kleene star operator.\n      // Returns the root of the new tree.\n      function makeKStar(expr) {\n        return {\n          tag: tags.KSTAR,\n          expr: expr\n        };\n      }\n\n      // Creates a node that represents the literal obj.\n      function makeLit(obj) {\n        return {\n          tag: tags.LIT,\n          obj: obj\n        };\n      }\n\n      var epsNode = {\n        tag: tags.EPS\n      };\n      // Returns a node representing the empty string regular expression.\n      function makeEps() {\n        return epsNode;\n      }\n\n      function _altToAutomaton(regex, automaton, stateCounter) {\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        for (var i=0; i<regex.choices.length; i++) {\n          var statePair = _dispatchToAutomaton(regex.choices[i], automaton, stateCounter);\n          noam.fsm.addEpsilonTransition(automaton, l, [statePair[0]]);\n          noam.fsm.addEpsilonTransition(automaton, statePair[1], [r]);\n        }\n        return [l, r];\n      }\n\n      function _seqToAutomaton(regex, automaton, stateCounter) {\n        // Create the parts for the sequence elements and connect them via epsilon transitions.\n        var l, r, statePair;\n        for (var i=0; i<regex.elements.length; i++) {\n          statePair = _dispatchToAutomaton(regex.elements[i], automaton, stateCounter);\n          if (i === 0) { // this is the first element\n            l = statePair[0];\n          } else { // this is a later element that needs to be connected to the previous elements\n            noam.fsm.addEpsilonTransition(automaton, r, [statePair[0]]);\n          }\n          r = statePair[1];\n        }\n\n        if (l === undefined) { // empty language\n          l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n          r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        }\n\n        return [l, r];\n      }\n\n      function _KStarToAutomaton(regex, automaton, stateCounter) {\n        // The $ sign in the following drawing represents an epsilon transition.\n        //\n        //    ----------------$>----------------\n        //   /                                  \\\n        // |l|-$>-|ll|...(regex.expr)...|rr|-$>-|r|\n        //          \\_________<$_________/\n        //\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var inner = _dispatchToAutomaton(regex.expr, automaton, stateCounter);\n        var ll = inner[0];\n        var rr = inner[1];\n        noam.fsm.addEpsilonTransition(automaton, l, [r]); // zero times\n        noam.fsm.addEpsilonTransition(automaton, l, [ll]); // once or more times\n        noam.fsm.addEpsilonTransition(automaton, rr, [ll]); // repeat\n        noam.fsm.addEpsilonTransition(automaton, rr, [r]); // continue after one or more repetitions\n\n        return [l, r];\n      }\n\n      function _litToAutomaton(regex, automaton, stateCounter) {\n        // Generate the \"left\" and \"right\" states and connect them with the appropriate\n        // transition symbol.\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        try {\n          noam.fsm.addSymbol(automaton, regex.obj);\n        } catch (err) {\n            // addSymbol can throw if the symbol already exists - that's ok but\n            // would like to be able to avoid catching other exceptions\n            // TODO: use a custom exception class instead of Error\n        }\n        noam.fsm.addTransition(automaton, l, [r], regex.obj);\n        return [l, r];\n      }\n\n      function _epsToAutomaton(regex, automaton, stateCounter) {\n        // Generate the \"left\" and \"right\" states and connect them with an epsilon transition.\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        noam.fsm.addEpsilonTransition(automaton, l, [r]);\n        return [l, r];\n      }\n\n      var _toAutomatonFuns = {};\n      _toAutomatonFuns[tags.ALT] = _altToAutomaton;\n      _toAutomatonFuns[tags.SEQ] = _seqToAutomaton;\n      _toAutomatonFuns[tags.KSTAR] = _KStarToAutomaton;\n      _toAutomatonFuns[tags.LIT] = _litToAutomaton;\n      _toAutomatonFuns[tags.EPS] = _epsToAutomaton;\n\n      // Calls the appropriate *ToAutomaton function to handle the various kinds of regular expressions.\n      // @a stateCounter holds the number of the next state to be added to the automaton.\n      // Every *ToAutomaton function modifies @a automaton and returns a pair of states (as a two element array).\n      // The first state is the start state and the second state is the accepting state of the part of the\n      // automaton that accepts the language defined by @a regex.\n      function _dispatchToAutomaton(regex, automaton, stateCounter) {\n        return _toAutomatonFuns[regex.tag](regex, automaton, stateCounter);\n      }\n\n      // Returns the equivalent FSM for the specified regular expression in the tree representation.\n      function toAutomaton(regex) {\n        var automaton = noam.fsm.makeNew();\n        var statePair = _dispatchToAutomaton(regex, automaton, noam.util.makeCounter(0));\n        noam.fsm.setInitialState(automaton, statePair[0]);\n        noam.fsm.addAcceptingState(automaton, statePair[1]);\n        return automaton;\n      }\n\n\n      // \"Operator\" precedence lookup. This is used when determining if we need to\n      // insert parentheses to preserve the meaning of the regex when converting from\n      // the tree representation to the array representation.\n      var _prec = {};\n      _prec[tags.ALT] = 0;\n      _prec[tags.SEQ] = 1;\n      _prec[tags.KSTAR] = 2;\n      // these two are not operators, but it's convenient to assign them a precedence\n      // for uniformity... since they are just atoms (i.e. can't be \"regrouped\"), their\n      // precedence is higher than all the operators\n      _prec[tags.LIT] = 3;\n      _prec[tags.EPS] = 3;\n\n      // Returns true if parantheses are needed around the child expression\n      // when it is embedded into the parent expression, false otherwise.\n      function _needParens(par, child) {\n        return _prec[par.tag] >= _prec[child.tag];\n      }\n\n      // Add child to the array representation, and surround it with parentheses\n      // if necessary.\n      function _optParenToArray(par, child, arr) {\n        var parens = _needParens(par, child);\n        if (parens) {\n            arr.push(noam.re.array.specials.LEFT_PAREN);\n        }\n        _dispatchToArray(child, arr);\n        if (parens) {\n            arr.push(noam.re.array.specials.RIGHT_PAREN);\n        }\n      }\n\n      // Common implementation for _altToArray and _seqToArray.\n      function _binOpToArray(regex, arr, parts, operand) {\n        for (var i=0; i<parts.length; i++) {\n          if (operand!==undefined && i>0) {\n            arr.push(operand);\n          }\n          _optParenToArray(regex, parts[i], arr);\n        }\n      }\n\n      function _altToArray(regex, arr) {\n        _binOpToArray(regex, arr, regex.choices, noam.re.array.specials.ALT);\n      }\n\n      function _seqToArray(regex, arr) {\n        _binOpToArray(regex, arr, regex.elements);\n      }\n\n      function _KStarToArray(regex, arr) {\n        _optParenToArray(regex, regex.expr, arr);\n        arr.push(noam.re.array.specials.KSTAR);\n      }\n\n      function _litToArray(regex, arr) {\n        arr.push(regex.obj);\n      }\n\n      function _epsToArray(regex, arr) {\n        arr.push(noam.re.array.specials.EPS);\n      }\n\n      var _toArrayFuns = {};\n      _toArrayFuns[tags.ALT] = _altToArray;\n      _toArrayFuns[tags.SEQ] = _seqToArray;\n      _toArrayFuns[tags.KSTAR] = _KStarToArray;\n      _toArrayFuns[tags.LIT] = _litToArray;\n      _toArrayFuns[tags.EPS] = _epsToArray;\n\n      // Calls the appropriate *ToArray function to handle the various kinds of regular expressions.\n      // @a arr acts as an accumulator for all *ToArray functions.\n      function _dispatchToArray(regex, arr) {\n        return _toArrayFuns[regex.tag](regex, arr);\n      }\n\n      // Returns the array representation (i.e. noam.re.array) of @a regex which must\n      // be in the tree (i.e. noam.re.tree) representation.\n      // Parentheses are inserted into the array to preserve the meaning of the\n      // regex. However, this does not really lead to minimal parenthesization because\n      // it doesn't consider any rewriting rules. More specifically, if there were\n      // parentheses that modify associativity of alteration or sequencing in the\n      // original regex that was parsed into this tree, they will be preserved\n      // even though they are not necessary.\n      function toArray(regex) {\n        var arr = [];\n        _dispatchToArray(regex, arr);\n        return arr;\n      }\n\n      // Returns the string representation of @a regex which must be in the tree\n      // (i.e. noam.re.tree) representation. This is not always possible, so\n      // this function throws when the regex contains some symbols which are not\n      // single-character strings.\n      //\n      // Semantically equivalent to first calling toArray and then calling\n      // noam.re.array.toString on the result.\n      function toString(regex) {\n        return noam.re.array.toString(toArray(regex));\n      }\n\n      // Returns a random regex containing at most @a numSymbols symbols from the\n      // specified array of possible symbols @a alphabet. The probability distribution\n      // of symbol selection is uniform and can be skewed by repeating elements in\n      // alphabet. The parameter @a cfg is optional and can contain the following\n      // fields:\n      //   ALT_PROB    - the probability that alteration is used between two subexpressions\n      //                 instead of sequencing (default 0.5)\n      //   KLEENE_PROB - the probability that any subexpression is put under the Kleene\n      //                 star operator (default 0.1)\n      //   EPS_PROB    - the probability that epsilon is added as an alteration choice\n      //                 (default 0.1)\n      function random(numSymbols, alphabet, cfg) {\n        var altp = 0.5;\n        var kleenep = 0.1;\n        var epsp = 0.1;\n        if (cfg) {\n          if (cfg.ALT_PROB) {\n            altp = cfg.ALT_PROB;\n          }\n          if (cfg.KLEENE_PROB) {\n            kleenep = cfg.KLEENE_PROB;\n          }\n          if (cfg.EPS_PROB) {\n            epsp = cfg.EPS_PROB;\n          }\n        }\n\n        return _randomKleene(numSymbols, alphabet, altp, kleenep, epsp);\n      }\n\n      function _randomKleene(numSymbols, alphabet, altp, kleenep, epsp) {\n        var expr = _randomExpr(numSymbols, alphabet, altp, kleenep, epsp);\n        if (Math.random() <= kleenep) {\n          expr = makeKStar(expr);\n        }\n        return expr;\n      }\n\n      function _randomExpr(numSymbols, alphabet, altp, kleenep, epsp) {\n        if (numSymbols === 0) {\n          return makeEps();\n        } else if (numSymbols == 1) {\n          return makeLit(alphabet[noam.util.randint(0, alphabet.length-1)]);\n        } else if (Math.random() <= epsp) {\n          return makeAlt([makeEps(),\n              _randomKleene(numSymbols, alphabet, altp, kleenep, epsp)]);\n        } else {\n          var left_sz = noam.util.randint(1, numSymbols-1);\n          var left = _randomKleene(left_sz, alphabet, altp, kleenep, epsp);\n          var right = _randomKleene(numSymbols - left_sz, alphabet, altp, kleenep, epsp);\n          if (Math.random() <= altp) {\n            return makeAlt([left, right]);\n          } else {\n            return makeSeq([left, right]);\n          }\n        }\n      }\n\n      return {\n        tags: tags,\n\n        makeAlt: makeAlt,\n        makeSeq: makeSeq,\n        makeKStar: makeKStar,\n        makeLit: makeLit,\n        makeEps: makeEps,\n\n        toAutomaton: toAutomaton,\n        toArray: toArray,\n        toString: toString,\n\n        random: random,\n        simplify: simplify\n      };\n    })();\n\n    /*\n     * A linear representation of regular expressions.\n     * Every symbol can be an arbitrary object.\n     *\n     * Regular expression operators, parentheses and epsilon must be represented using\n     * the array.specials constants.\n     *\n     * Concatenation is implicit when there are no operators between two subexpressions.\n     * The default operator precedence is Kleene star > concatenation > alteration, and\n     * can be modified using parentheses.\n     */\n    var array = (function() {\n      // This is based on object identity, i.e. each of these constants will be different\n      // from any other object that can be inserted into the regex array.\n      var specials = {\n        ALT: {},\n        KSTAR: {},\n        LEFT_PAREN: {},\n        RIGHT_PAREN: {},\n        EPS: {}\n      };\n\n      // give objects their usual string representation\n      specials.ALT.toString = function() { return \"+\"; };\n      specials.KSTAR.toString = function() { return \"*\"; };\n      specials.LEFT_PAREN.toString = function() { return \"(\"; };\n      specials.RIGHT_PAREN.toString = function() { return \")\"; };\n      specials.EPS.toString = function() { return \"$\"; };\n\n      /* Custom Error constructor for regular expression errors.\n       *\n       * Every RegexError object has the following properties:\n       *  - name: the string \"RegexError\"\n       *  - message: a string description of the error\n       *  - position: a number specifying the 0-based index of the position where the error\n       *              was found (note that this might not be where the error actually is, i.e.\n       *              this number is a hint rather than a definite answer)\n       */\n      function RegexError(message, position) {\n        this.name = \"RegexError\";\n        this.message = message;\n        this.position = position;\n      }\n\n      // We do this to get the stack trace when RegexError objects are thrown.\n      RegexError.prototype = new Error();\n\n      // The next three functions are used to make a convenient array wrapper\n      // used in the parsing code.\n      //\n      // This peek method relies on the fact that accessing \"out of bounds\"\n      // will return undefined.\n      function _peek() {\n        return this.arr[this.idx];\n      }\n      function _advance() {\n        ++this.idx;\n      }\n      function _makeInputSeq(arr) {\n        return {\n          arr: arr,\n          idx: 0,\n          peek: _peek,\n          advance: _advance\n        };\n      }\n\n      // Returns the tree representation of the regex given by @a arr.\n      function toTree(arr) {\n        // special case for the empty language\n        // empty subexpressions are not allowed except when defining the empty language\n        if (arr.length === 0) {\n          return noam.re.tree.makeSeq([]);\n        }\n        var input = _makeInputSeq(arr);\n        var result = _parseExpr(input);\n\n        // should be at end of input\n        if (input.peek() !== undefined) {\n          throw new RegexError(\"Malformed regex array: successfully parsed up to position \" + input.idx, input.idx);\n        }\n        return result;\n      }\n\n      // Returns the replacement string for objects in noam.re.array.specials or\n      // undefined if @a obj doesn't match any of them.\n      function _replacementStr(obj) {\n        // This can't be done with a dict because objects are not hashable...\n        if (obj === specials.ALT || obj === specials.KSTAR ||\n            obj === specials.LEFT_PAREN || obj === specials.RIGHT_PAREN ||\n            obj === specials.EPS) {\n          return obj.toString();\n        } else {\n          return undefined;\n        }\n      }\n\n      // If @a chr is one of the escapable characters\n      // in the string representation (i.e. element of noam.re.string.escapable),\n      // returns it prefixed by a backslash (i.e. escaped).\n      // Otherwise returns chr unchanged.\n      function _escape(chr) {\n        var escapable = noam.re.string.escapable;\n        for (var i=0; i<escapable.length; i++) {\n          if (chr === escapable[i]) {\n            return \"\\\\\" + chr;\n          }\n        }\n        return chr;\n      }\n\n      // Returns the string representation of the regex given by @a arr.\n      //\n      // Throws if the regex contains any symbols which are not one-character strings\n      // and special symbols from noam.re.array.specials.\n      function toString(arr) {\n        var res = [];\n        var elem;\n        var failed = false;\n        for (var i=0; i<arr.length; i++) {\n          elem = arr[i];\n          if (typeof(elem) === \"string\") {\n            if (elem.length !== 1) {\n              failed = true;\n            } else {\n              elem = _escape(elem);\n            }\n          } else {\n            elem = _replacementStr(elem);\n            if (elem === undefined) {\n              failed = true;\n            }\n          }\n          if (failed) {\n            throw new RegexError(\"Array regex not convertible to string representation:\" +\n                \" failed at position \" + i, i);\n          }\n          res.push(elem);\n        }\n        return res.join(\"\");\n      }\n\n      // Returns the automaton accepting the language represented by the regex @a arr.\n      //\n      // Semantically equivalent to first calling toTree on @a arr and then converting\n      // the result to an automaton via noam.re.tree.toAutomaton.\n      function toAutomaton(arr) {\n        var tree = noam.re.array.toTree(arr);\n        return noam.re.tree.toAutomaton(tree);\n      }\n\n      // <expr> ::= <concat> (\"|\" <concat>)*\n      function _parseExpr(input) {\n        var concats = [];\n        while (true) {\n          concats.push(_parseConcat(input));\n          if (input.peek() === specials.ALT) {\n            input.advance();\n          } else {\n            break;\n          }\n        }\n\n        return noam.re.tree.makeAlt(concats);\n      }\n\n      // <concat> ::= <katom>+\n      function _parseConcat(input) {\n        var katoms = [];\n        var katom;\n        while (true) {\n          katom = _parseKatom(input);\n          if (katom === undefined) {\n            break;\n          }\n          katoms.push(katom);\n        }\n        if (katoms.length === 0) {\n          throw new RegexError(\"Malformed regex array: empty choice subexpression at index \" +\n              input.idx, input.idx);\n        }\n\n        return noam.re.tree.makeSeq(katoms);\n      }\n\n      // <katom> ::= <atom> (\"*\" | eps)\n      function _parseKatom(input) {\n        var atom = _parseAtom(input);\n        if (input.peek() === specials.KSTAR) {\n          input.advance();\n          atom = noam.re.tree.makeKStar(atom);\n        }\n        return atom;\n      }\n\n      // <atom> ::= \"(\" <expr> \")\" | eps | symbol\n      function _parseAtom(input) {\n        if (input.peek() === specials.LEFT_PAREN) {\n          input.advance(); // skip the left parenthesis\n          var expr = _parseExpr(input);\n          if (input.peek() !== specials.RIGHT_PAREN) {\n            throw new RegexError(\"Malformed regex array: missing matching right parenthesis at index \" +\n                input.idx, input.idx);\n          }\n          input.advance(); // skip the right parenthesis\n          return expr;\n        } else if (input.peek() === specials.EPS) {\n          input.advance();\n          return noam.re.tree.makeEps();\n        } else if (input.peek()===undefined || input.peek()===specials.ALT ||\n              input.peek()===specials.RIGHT_PAREN) {\n          return undefined; // this will stop the parsing of <concat>\n        } else if (input.peek() === specials.KSTAR) {\n            throw new RegexError(\"Malformed regex array: empty subexpression before Kleene star at index \" +\n                input.idx, input.idx);\n        } else {\n          var sym = noam.re.tree.makeLit(input.peek());\n          input.advance();\n          return sym;\n        }\n      }\n\n      // Returns a random regex in the array representation.\n      // See noam.re.tree.random for further information.\n      function random(numSymbols, alphabet, cfg) {\n        return noam.re.tree.toArray(noam.re.tree.random(numSymbols, alphabet, cfg));\n      }\n\n      function simplify(arr, numIterations, appliedPatterns) {\n        var tree = noam.re.array.toTree(arr);\n        var treeSimplified = noam.re.tree.simplify(tree, numIterations, appliedPatterns);\n        return noam.re.tree.toArray(treeSimplified);\n      }\n\n      return {\n        specials: specials,\n\n        toTree: toTree,\n        toString: toString,\n        toAutomaton: toAutomaton,\n\n        random: random,\n        simplify: simplify\n      };\n    })();\n\n\n    /*\n     * A string representation of regular expressions.\n     *\n     * The alphabet is limited to string characters, i.e. every character in the string is an input\n     * symbol in the language except:\n     *    - the dollar symbol ($) which is used as epsilon, i.e. the empty string\n     *    - the plus character (+) which is used as the alteration operator\n     *    - the star character (*) which is used as the Kleene star\n     *    - parentheses which are used for grouping\n     *    - the backslash character (\\) which is used for escaping the special meaning of all\n     *      the listed characters, including backslash itself; for example, the regex\n     *      \"(a+b)*\\\\+\" represents the language of all strings of as and bs ending in one\n     *      plus character (notice that due to the fact that backslash also escapes in\n     *      JavaScript strings, we need two backslashes to get the two-character\n     *      sequence \\+ that we want)\n     */\n    var string = (function() {\n\n      var escapable = \"$+*()\\\\\";\n\n      // Returns the array representation of the regex represented by @a str.\n      //\n      // Throws an Error if @a str contains illegal escape sequences.\n      function toArray(str) {\n        var arr = [];\n        var escaped = false;\n        var specials = noam.re.array.specials;\n        var chr;\n        for (var i=0; i<str.length; ++i) {\n          if (escaped) {\n            if (escapable.indexOf(str[i]) === -1) {\n              throw new RegexError(\"Malformed string regex: illegal escape sequence \\\\\" + str[i], i);\n            }\n            arr.push(str[i]); // the result of the escape sequence is the escaped character itself\n            escaped = false;\n          } else if (str[i] === '\\\\') {\n            escaped = true;\n          } else {\n            chr = str[i];\n            switch (chr) {\n              case \"$\": chr = specials.EPS; break;\n              case \"+\": chr = specials.ALT; break;\n              case \"*\": chr = specials.KSTAR; break;\n              case \"(\": chr = specials.LEFT_PAREN; break;\n              case \")\": chr = specials.RIGHT_PAREN; break;\n            }\n            arr.push(chr);\n          }\n        }\n        if (escaped) {\n          throw new RegexError(\"Malformed string regex: unfinished escape sequence at end of string\", str.length-1);\n        }\n\n        return arr;\n      }\n\n      // Returns the tree representation of the regex represented by @a str.\n      //\n      // Semantically equivalent to first converting the @a str to the array\n      // representation via noam.re.string.toArray and then converting the\n      // result to a tree via noam.re.array.toTree.\n      function toTree(str) {\n        var arr = noam.re.string.toArray(str);\n        return noam.re.array.toTree(arr);\n      }\n\n      // Returns an FSM accepting the language of the regex represented by @a str.\n      //\n      // Semantically equivalent to first converting the @a str to the array\n      // representation via noam.re.string.toArray, then converting the\n      // result to a tree via noam.re.array.toTree and finally converting the result\n      // of that to an automaton via noam.re.tree.toAutomaton.\n      function toAutomaton(str) {\n        var tree = noam.re.string.toTree(str);\n        return noam.re.tree.toAutomaton(tree);\n      }\n\n      // Returns a random regex string. @a alphabet must be a string. The other\n      // parameters have exactly the same role as in noam.re.tree.random.\n      function random(numSymbols, alphabet, cfg) {\n        var arr = [];\n        for (var i=0; i<alphabet.length; i++) {\n          arr.push(alphabet.charAt(i));\n        }\n        return noam.re.tree.toString(noam.re.tree.random(numSymbols, arr, cfg));\n      }\n\n      function simplify(str, numIterations, appliedPatterns) {\n        var tree = noam.re.string.toTree(str);\n        var treeSimplified = noam.re.tree.simplify(tree, numIterations, appliedPatterns);\n        return noam.re.tree.toString(treeSimplified);\n      }\n\n      return {\n        escapable: escapable,\n\n        toArray: toArray,\n        toTree: toTree,\n        toAutomaton: toAutomaton,\n\n        random: random,\n        simplify: simplify\n      };\n\n    })();\n\n    return {\n      tree: tree,\n      array: array,\n      string: string\n    };\n  })();\n\n  return noam;\n}())));\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? function(obj) { return Object.getPrototypeOf(obj); } : function(obj) { return obj.__proto__; };\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach(function(key) { def[key] = function() { return value[key]; }; });\n\t}\n\tdef['default'] = function() { return value; };\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + \"webfontloader\" + \".\" + \"02ff9497\" + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"dfa-regex:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkdfa_regex\"] = self[\"webpackChunkdfa_regex\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(9914); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","id","module","exports","class","_createElementVNode","_createVNode","_component_v_app","_component_v_main","_component_v_sheet","width","_component_AlphabetLister","_component_v_divider","_component_StateHelper","_hoisted_1","height","color","elevation","_hoisted_2","_component_v_btn_toggle","$setup","m","$event","mandatory","rounded","_createElementBlock","_Fragment","_renderList","tools","t","_createBlock","_component_v_btn","key","name","value","text","_component_v_tooltip","activator","contentClass","_hoisted_3","_toDisplayString","hotkey","_hoisted_4","_hoisted_5","onClick","_cache","mainStore","deleteAll","_hoisted_6","_hoisted_7","_hoisted_8","type","ref","onChange","args","loadJSON","fileinput","click","_component_v_icon","size","_hoisted_9","_hoisted_10","_component_v_dialog","_component_SaveFile","_component_FSMVisualizer","_component_v_text_field","regex","label","hideDetails","variant","onKeydown","_withKeys","genDFA","target","_hoisted_11","_component_SettingsMenu","_component_TransitionFab","InputProcessorKeyboardEvent","ipkey","this","_ipkey","replace","InputProcessor","seperator","activeKeys","ip","states","filter","v","map","ipkeySet","Set","altKey","ctrlKey","shiftKey","split","splitter","at","constructor","ev","_defineProperty","Object","assign","getModifierState","mouse","InputProcessorMouseEvent","cursor","client","structuredClone","screen","lastClick","isDragging","dragDiff","x","y","EventEmitter","__evs__","__any__","has","event","undefined","on","cb","push","onAny","off","i","findIndex","toString","splice","emit","forEach","renameEvent","oldEvent","newEvent","InputProcessorConfig","recognize","capKey","toUpperCase","match","length","charCode","charCodeAt","serialize","Array","isArray","sort","nonModifierIndex","k","MODIFIERS","includes","join","element","config","super","MouseInputModule","c","String","fromCharCode","n","monitor","el","__built_listeners__","bl","removeEventListener","fn","captureMouse","tagName","tabIndex","captureKey","addEventListener","bind","console","warn","__onKeyDown","__onKeyUp","__onFocusOut","toLowerCase","entries","check","every","direction","u","d","l","r","reset","focus","release","_processKeyBoardEvent","ALT","CONTROL","SHIFT","keyprop","active_keys","unshift","combined","ipev","preventDefault","repeat","Coordinate","difference","coord","sum","clone","arr","_monitor","__onClick","__onAuxClick","__onDblClick","__onContextMenu","__onMouseDown","__onMouseUp","__onMouseEnter","__onMouseOver","__onMouseLeave","__onMouseOut","__onMouseMove","processor","_ip","__processMouseEvent__","rect","getBoundingClientRect","screenX","screenY","clientX","left","clientY","top","ipmouse","buttons","Util","genString","len","Math","random","substring","FindHits","s","hits","drawArcFromTwoPoints","ctx","fx","fy","tx","ty","arcAngle","cw","f","Victor","a2","mix","distance","ti","cos","deg2Rad","center","subtract","rotateDeg","norm","multiplyScalar","coa","add","strokeStyle","sa","invert","angle","ea","beginPath","arc","toArray","stroke","closePath","endTangent","startTangent","ctd","ct","start","end","line","moveTo","lineTo","drawArrow","arrowAngle","arrowSize","goIn","o","a","rotateByDeg","fill","PI","deg","rad","navigator","clipboard","writeText","StateOptions","deg360","State","options","defOptions","pos","sq","radius","draw","useMainStore","border","borderColor","bg","labelColor","selected_bg","selected_labelColor","fullWidth","isFinish","fillStyle","ellipse","selected","textAlign","textBaseline","font","fillText","isStart","useStateStore","defineStore","transitionStore","useTransitionStore","reactive","addState","state","genRegex","getStateIndex","getState","find","removeState","froms","getTransitionsFrom","removeTransition","from","to","tos","getTransitionsTo","select","savedStart","setStart","accepting","computed","Transition","equalWith","equals","other","addValue","removeValue","str","vdir","vnorm","stateStore","textPos","tw","measureText","getTransitionIndex","cSet","transitions","connected","sLabel","sldir","arcCoverage","arcLoc","angleDeg","touchPoint","ssl","esl","dir","sel","eel","copy","maxArc","minArc","distanceSq","addTransition","labels","getTransition","MAX_ALHPABET","useAlphabetStore","alphabet","removeAlphabet","indexOf","removeAll","ap","addAlphabet","trim","resetAlphabet","Drawables","register","instances","isRegistered","gfx","remove","useMouseStore","set","nx","ny","useModeStore","mousestore","linkingArrow","linkStart","lineWidth","normalize","mode","watch","linkReset","linkEnd","openTransitionDialog","HAS_INITIALIZED","initCanvas","mouseStore","modeStore","canvas","getContext","defineProperty","get","style","origin","selectedOrigin","ox","oy","clicked","hovering","window","getMonitor","project","Local","_class","item","def","localStorage","getItem","parsed","JSON","parse","stringify","setItem","alert","removeItem","saveAsFile","data","filename","pom","document","createElement","setAttribute","encodeURIComponent","createEvent","initEvent","dispatchEvent","useFileStore","alphabetStore","getFSMAsJSON","values","final","saveDFA","loadDFA","log","gen","err","useSettingStore","fileStore","simplifyDFARegex","saveFSMOnExit","startSync","fsmData","save","sync","settingsStore","processInput","clientWidth","clientHeight","inputFocus","checkForValidity","transition","initial","noam","string","toAutomaton","convertEnfaToNfa","convertNfaToDfa","minimize","convertStatesToNumbers","st","al","acceptingStates","acc","initialState","ini","trs","h","w","hand","gens","fromState","symbol","toStates","toStateArr","toState","regexResult","formal_specs","parseFsmFromString","toRegex","tree","simplify","setup","ctxRef","rafID","animate","clearRect","requestAnimationFrame","mounted","beforeUnmount","cancelAnimationFrame","emits","__exports__","resetAble","density","_component_v_container","_component_v_row","align","justify","noGutters","_component_v_col","cols","_component_v_chip","closable","placeholder","temp","maxLength","clearable","store","cancel","open","multiple","selectedItems","disabled","block","ex","toFixed","_component_v_switch","tempIsStart","changeStartStatus","transArr","index","setSelectedState","_component_v_autocomplete","chips","items","updateTransition","vs","_hoisted_12","stateList","tempLabel","_hoisted_13","tempTransitions","associatedTransitions","updateTransArr","ts","expand","copyFormalSpecs","copyToClipboard","components","FSMVisualizer","AlphabetLister","TransitionFab","StateHelper","SettingsMenu","SaveFile","async","file","files","render","createVuetify","directives","theme","defaultTheme","loadFonts","webFontLoader","load","google","families","pinia","createPinia","createApp","App","use","vuetify","mount","define","util","areEquivalent","object1","object2","Date","getTime","RegExp","source","global","multiline","lastIndex","ignoreCase","p","contains","obj","startIndex","containsAll","arr1","arr2","containsAny","areEqualSets","containsSet","setUnion","res","setIntersection","makeCounter","getAndAdvance","init","randint","floor","structure","CAPACITY_CHOICES","DEFAULT_INITIAL_CAPACITY_IDX","HASH_MASK","LF_HIGH","LF_LOW","_isArray","prototype","call","_get_capacity_index","wanted","max","min","mid","lo","hi","_defaultHash","props","hasOwnProperty","_defaultEquals","_HashChainNode","_HashChain","_HashChainIterator","chain","node","head","_resize","H","to_cap_idx","old_cap","capacity","old_slots","slots","capacity_index","chain_iter","iterator","hasNext","_putNodeRsz","next","_getSlotIndex","hash","isEmpty","insertHead","removeSuccessor","put","iter","prev","retval","HashTable","cfg","initial_capacity","numkeys","loadFactor","slot","clear","containsKey","it","keyIterator","valueIterator","keyValueIterator","Iterator","cur_chain_iterator","idx","slotval","_next","err_msg","extract_next","each","iterator_func","context","_KeyIterator","_ValueIterator","_KeyValueIterator","create","fsm","epsilonSymbol","dfaType","nfaType","enfaType","makeNew","_addStateOrSymbol","undefErrorMsg","existsErrorMsg","stateObj","addSymbol","symObj","addAcceptingState","setInitialState","_addTransition","transitionSymbol","added","addEpsilonTransition","validate","j","isAcceptingState","determineType","fsmType","computeEpsilonClosure","unprocessedStates","targetStates","currentState","pop","makeSimpleTransition","makeTransition","readString","inputSymbolStream","transitionTrail","trail","isStringInLanguage","printTable","Table","require","colHeads","concat","table","chars","truncate","tableRows","colNum","rowNum","serializeFsmToString","lines","fsm_string","parseState","parseCounts","substr","ac","state_rest","parts","left_right","al_t","st_t","printHtmlTable","headers","htmlString","printDotFormat","trans","result","accStates","initStateArrow","newTransitions","found","newTransition","getReachableStates","shouldIncludeInitialState","reachableStates","removeUnreachableStates","newFsm","areEquivalentStates","fsmA","stateA","fsmB","stateB","doBothStatesHaveSameAcceptance","fsmX","stateX","fsmY","stateY","stateXAccepting","stateYAccepting","unprocessedPairs","processedPairs","currentPair","pair","areEquivalentFSMs","removeEquivalentStates","equivalentPairs","isOneOfEquivalentStates","getEquivalentState","fsmWithoutUnreachableStates","minimalFsm","mapping","newToStates","createRandomFsm","numStates","numAlphabet","maxNumToStates","prefix","ch","num","retStr","round","numToStates","diff","newStates","errorAdded","errorState","initialEpsilon","multiStateTransitions","existing","isLanguageNonEmpty","isLanguageInfinite","reachable","deadState","randomStringInLanguage","reverse","randomStringNotInLanguage","nonAcceptingStates","union","newState","intersection","new_alphabet","complement","newAccepting","concatenation","kleene","newInitial","oldAcceptingStates","newInitialState","isSubset","fsmIntersection","grammar","nonterminals","terminals","initialNonterminal","productions","right","symbolsForTransitions","z","symbols","re","makeLit","makeEps","makeAlt","t1","choices","t2","seq","tag","tags","EPS","makeSeq","makeKStar","alt","startStateIndex","acceptableStatesIndexes","elements","regType","cfgType","csgType","unrestrictedType","production","indexOfNonterminal","isRightRegular","rightNonTerminalCount","leftNonTerminalCount","slice","sufix","printAscii","slimProds","foundSlim","prod","SEQ","KSTAR","LIT","copyAndDeleteProperties","o1","o2","_regex_simplification_patterns","_regex_simplify_1","fsmCache","_regex_simplify_2","_regex_simplify_3","expr","_regex_simplify_4","_regex_simplify_5","_regex_simplify_6","epsIndex","kstarIndex","_regex_simplify_7","_regex_simplify_8","_regex_simplify_9","_regex_simplify_10","_regex_simplify_11","_regex_simplify_12","_regex_simplify_13","_regex_simplify_14","_regex_simplify_15","_regex_simplify_16","first","rest1","rest2","_alt","_seq","_regex_simplify_17","_regex_simplify_18","last","_regex_simplify_19","fsms","getFromCacheOrCreateFsm","_regex_simplify_20","ht","_regex_simplify_21","_regex_simplify_22","index_eps","_regex_simplify_23","internal","_regex_simplify_24","_regex_simplify_27","eps","fsm_kstar","fsm_other","_regex_simplify_25","_regex_simplify_26","treeClone","opts","numIterations","appliedPatterns","useFsmPatterns","appliedPattern","iterCount","_simplify_iteration","pattern","_simplify_recursion","patternFunction","children","epsNode","_altToAutomaton","automaton","stateCounter","statePair","_dispatchToAutomaton","_seqToAutomaton","_KStarToAutomaton","inner","ll","rr","_litToAutomaton","_epsToAutomaton","_toAutomatonFuns","_prec","_needParens","par","child","_optParenToArray","parens","array","specials","LEFT_PAREN","_dispatchToArray","RIGHT_PAREN","_binOpToArray","operand","_altToArray","_seqToArray","_KStarToArray","_litToArray","_epsToArray","_toArrayFuns","numSymbols","altp","kleenep","epsp","ALT_PROB","KLEENE_PROB","EPS_PROB","_randomKleene","_randomExpr","left_sz","RegexError","message","position","_peek","_advance","_makeInputSeq","peek","advance","toTree","input","_parseExpr","_replacementStr","_escape","chr","escapable","elem","failed","concats","_parseConcat","katom","katoms","_parseKatom","atom","_parseAtom","sym","treeSimplified","escaped","charAt","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","deferred","O","chunkIds","priority","notFulfilled","Infinity","fulfilled","getter","__esModule","leafPrototypes","getProto","getPrototypeOf","__proto__","then","ns","current","getOwnPropertyNames","definition","enumerable","chunkId","Promise","all","reduce","promises","miniCssF","g","globalThis","Function","prop","inProgress","dataWebpackPrefix","url","done","script","needAttach","scripts","getElementsByTagName","getAttribute","charset","timeout","nc","src","onScriptComplete","onerror","onload","clearTimeout","doneFns","parentNode","removeChild","setTimeout","appendChild","Symbol","toStringTag","installedChunks","installedChunkData","promise","reject","error","loadingEnded","errorType","realSrc","request","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}