{"version":3,"file":"js/app.e53ac3b9.js","mappings":"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","sources":["webpack://dfa-regex/./node_modules/cli-table/node_modules/colors/lib/ sync","webpack://dfa-regex/./src/App.vue","webpack://dfa-regex/./src/commons/input/InputProcessorEvent.js","webpack://dfa-regex/./src/commons/input/InputProcessor.js","webpack://dfa-regex/./src/commons/Util.js","webpack://dfa-regex/./src/commons/graph/State.js","webpack://dfa-regex/./src/commons/graph/Transition.js","webpack://dfa-regex/./src/stores/stateStore.js","webpack://dfa-regex/./src/stores/transitionStore.js","webpack://dfa-regex/./src/stores/alphabetStore.js","webpack://dfa-regex/./src/commons/canvas/Drawables.js","webpack://dfa-regex/./src/stores/mouseStore.js","webpack://dfa-regex/./src/stores/modeStore.js","webpack://dfa-regex/./src/commons/canvas/CanvasInit.js","webpack://dfa-regex/./src/stores/mainStore.js","webpack://dfa-regex/./src/components/FSMVisualizer.vue","webpack://dfa-regex/./src/components/FSMVisualizer.vue?05df","webpack://dfa-regex/./src/components/AlphabetLister.vue","webpack://dfa-regex/./src/components/AlphabetLister.vue?6bc6","webpack://dfa-regex/./src/components/TransitionFab.vue","webpack://dfa-regex/./src/components/TransitionFab.vue?3a33","webpack://dfa-regex/./src/components/StateHelper.vue","webpack://dfa-regex/./src/components/StateHelper.vue?1035","webpack://dfa-regex/./src/App.vue?7ccd","webpack://dfa-regex/./src/plugins/vuetify.js","webpack://dfa-regex/./src/plugins/webfontloader.js","webpack://dfa-regex/./src/main.js","webpack://dfa-regex/./src/plugins/noam.js","webpack://dfa-regex/webpack/bootstrap","webpack://dfa-regex/webpack/runtime/chunk loaded","webpack://dfa-regex/webpack/runtime/compat get default export","webpack://dfa-regex/webpack/runtime/create fake namespace object","webpack://dfa-regex/webpack/runtime/define property getters","webpack://dfa-regex/webpack/runtime/ensure chunk","webpack://dfa-regex/webpack/runtime/get javascript chunk filename","webpack://dfa-regex/webpack/runtime/get mini-css chunk filename","webpack://dfa-regex/webpack/runtime/global","webpack://dfa-regex/webpack/runtime/hasOwnProperty shorthand","webpack://dfa-regex/webpack/runtime/load script","webpack://dfa-regex/webpack/runtime/make namespace object","webpack://dfa-regex/webpack/runtime/publicPath","webpack://dfa-regex/webpack/runtime/jsonp chunk loading","webpack://dfa-regex/webpack/startup"],"sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 1585;\nmodule.exports = webpackEmptyContext;","<template>\n  <v-app>\n    <v-main class=\"flex h-screen w-screen min-h-0\">\n        <!-- Options / Settings -->\n        <v-sheet width=\"300px\" class=\"p-3 flex flex-col gap-2 overflow-auto\">\n\n          <!-- Alphabet -->\n          <AlphabetLister />\n\n          <v-divider></v-divider>\n\n          <!-- Node Selector -->\n          <StateHelper />\n\n        </v-sheet>\n\n        <!-- DFA Visualizer -->\n        <v-sheet class=\"flex-grow bg-neutral-900 flex flex-col\">\n\n          <div class=\"flex flex-grow\">\n            <!-- Controls -->\n            <v-sheet height=\"100%\" width=\"50px\" color=\"#252525\" elevation=\"3\" class=\" flex-col gap-2 p-2\" id=\"toolbar\">\n\n              <v-btn-toggle v-model=\"m\" class=\"flex-col gap-2 items-center w-full h-auto\" mandatory rounded=\"0\">\n\n                <v-btn v-for=\"t in tools\" :key=\"t.name\" :value=\"t.name\">\n                  {{ t.text }}\n                  <v-tooltip\n                    activator=\"parent\"\n                    class=\"p-0\"\n                    contentClass=\"hotkey-tooltip\"\n                    >\n                    <span class=\"capitalize\">{{t.name}}</span> Mode [{{ t.hotkey }}]\n                  </v-tooltip>\n                </v-btn>\n\n              </v-btn-toggle>\n\n              <div class=\"pt-1\">\n                <v-btn @click=\"mainStore.deleteAll()\"> 🗑️ </v-btn>\n              </div>\n\n            </v-sheet>\n\n            <FSMVisualizer class=\"flex-grow\" />\n\n          </div>\n\n          <v-sheet class=\"flex items-center\" color=\"#2A2A2A\">\n\n            <v-text-field v-model=\"regex\" label=\"Regex\" hideDetails rounded=\"0\" variant=\"solo-filled\" @keydown.enter=\"e => mainStore.genDFA(e.target.value)\"/>\n\n          </v-sheet>\n        </v-sheet>\n\n\n    </v-main>\n  </v-app>\n  <!-- Dialog -->\n  <TransitionFab />\n</template>\n\n<script>\n\nimport { computed, ref } from 'vue';\nimport { watch } from 'vue';\nimport { reactive } from 'vue';\n\n// Stores\nimport { useMainStore } from './stores/mainStore';\nimport { useModeStore } from './stores/modeStore';\nimport { useAlphabetStore } from './stores/alphabetStore';\nimport { useTransitionStore } from './stores/transitionStore';\nimport { useStateStore } from './stores/stateStore';\n\n// Components\nimport FSMVisualizer from './components/FSMVisualizer.vue';\nimport AlphabetLister from './components/AlphabetLister.vue';\nimport TransitionFab from './components/TransitionFab.vue';\nimport StateHelper from './components/StateHelper.vue';\n\nexport default {\n  name: 'App',\n  components: {\n    FSMVisualizer,\n    AlphabetLister,\n    TransitionFab,\n    StateHelper\n  },\n  setup() {\n\n    // Initialize Store Modules\n    const mainStore = useMainStore(),\n      modeStore = useModeStore(),\n      alphabetStore = useAlphabetStore(),\n      transitionStore = useTransitionStore(),\n      stateStore = useStateStore();\n\n    const tools = reactive([\n      {\n        name: 'default',\n        text: '➕',\n        hotkey: 'V',\n      },\n      {\n        name: 'linking',\n        text: '🔗',\n        hotkey: 'C',\n      },\n      {\n        name: 'delete',\n        text: '❌',\n        hotkey: 'D',\n      }\n    ]);\n\n    const regex = ref('');\n    const regexResult = computed(() => mainStore.regexResult);\n\n      watch(regexResult, v => {\n        if(v === '') return;\n\n        regex.value = regexResult.value;\n      })\n\n    const m = computed({\n      get: () => modeStore.mode,\n      set: v => modeStore.mode = v\n    });\n\n    return {\n      mainStore,\n      m,\n      tools,\n      regex\n    }\n  },\n}\n</script>\n\n<style lang=\"scss\">\n* {\n  box-sizing: border-box;\n}\n\nhtml,\nbody {\n  overflow-y: auto;\n}\n\nhtml {\n  overflow-y: hidden !important;\n}\n\n.v-btn.smolbtn {\n  padding-left: 0;\n  padding-right: 0;\n  min-width: 0;\n}\n\n#toolbar {\n  button {\n    @apply p-2 rounded;\n\n    min-width: 0;\n\n  }\n}\n\n.hotkey-tooltip {\n  padding: 2px 10px !important;\n  border-radius: 2px !important;\n  background: #252525 !important;\n  color: #aaa !important;\n}\n</style>\n","// eslint-disable-next-line no-unused-vars\nimport { InputProcessor, MouseInputModule } from \"./InputProcessor\";\n\n/**\n * @typedef Coordinate\n * @property {Number} x\n * @property {Number} y\n */\n\nclass InputProcessorKeyboardEvent{\n    /**\n     * Contains the key along with active modifiers. Ex: SHIFT+A, CTRL+SHIFT+C.\n     * \n     * Modifers follow alphabetical order. Although this is not needed when adding listeners to the input processor.\n     * \n     * CTRL and CONTROL are the same when adding a listener, however, ipkey will use CONTROL.\n     */\n    _ipkey = \"\";\n    /**\n     * @type {InputProcessor}\n     */\n    ip;\n    /**@type {InputProcessorMouseEvent} */\n    mouse;\n\n    get ipkey(){\n        return this._ipkey.replace(InputProcessor.seperator, '+');\n    }\n\n    set ipkey(value){\n        this._ipkey = value; \n    }\n\n    /**\n     * List of currently active keys (key with states true)\n     */\n    get activeKeys(){\n        return this.ip.states.filter(v => v[1]).map(v => v[0])\n    }\n\n    get ipkeySet(){\n        return new Set([\n            this.altKey ? \"ALT\" : null,\n            this.ctrlKey ? \"CONTROL\" : null,\n            this.shiftKey ? \"SHIFT\" : null,\n            this._ipkey.split(InputProcessor.splitter).at(-1)\n        ].filter(v => v !== null))\n    }\n\n    // Native KeyboardEvent Properties\n    // I can't extend this to a keyboard event since there's no such thing. However, there is a KeyboardEventInit but that requires native data straight from the browser (can't imitate that data)\n    key = \"\";\n    code = \"\";\n    location = \"\";\n    repeat = false;\n    isComposing = false;\n\n    altKey = false;\n    ctrlKey = false;\n    shiftKey = false;\n    getModifierState = \"\";\n\n    /**\n     *  \n     * @param {KeyboardEvent} ev \n     * @param {String} ipkey Input Processor Key\n     * @param {InputProcessor} ip\n     */\n    constructor(ev, ipkey, ip){\n        Object.assign(this, ev);\n        this.getModifierState = ev.getModifierState;\n        this._ipkey = ipkey;\n        this.ip = ip;\n        this.mouse = new InputProcessorMouseEvent(ip.cursor);\n    }\n}\n\n\nclass InputProcessorMouseEvent{\n    /**@type {Coordinate} */\n    client = {};\n    /**@type {Coordinate} */\n    screen = {};\n    /**@type {Coordinate} */\n    lastClick = {};\n    /**@type {Coordinate} */\n    dragDiff = {};\n\n    isDragging = false;\n\n    /**\n     * \n     * @param {MouseInputModule} ip \n     */\n    constructor(ip){\n        this.client = structuredClone(ip.client);\n        this.screen = structuredClone(ip.screen);\n        this.lastClick = structuredClone(ip.lastClick);\n\n        this.isDragging = ip.isDragging;\n\n        if(!ip.isDragging) return;\n        \n        this.dragDiff.x = ip.client.x - ip.lastClick.x;\n        this.dragDiff.y = ip.client.y - ip.lastClick.y;\n\n    }\n}\n\nexport {\n    InputProcessorKeyboardEvent,\n    InputProcessorMouseEvent\n}","import { InputProcessorKeyboardEvent, InputProcessorMouseEvent } from \"./InputProcessorEvent\";\n\n//#region baseclass\nclass EventEmitter{\n\n    constructor(){\n        /**\n         * @protected\n         */\n        this.__evs__ = {};\n        this.__any__ = [];\n    }\n    \n    has(event){\n        return this.__evs__[event] !== undefined;\n    }\n    \n    on(event, cb){\n        this.__evs__[event] = this.__evs__[event] || [];\n        this.__evs__[event].push(cb);\n    }\n\n    onAny(cb){\n        this.__any__.push(cb);\n    }\n\n    off(event, cb){\n        if(!this.has(event)) return;\n        // Added a check where even if two functions don't belong to the same part in the memory, as long as they do the same thing, they will be removed\n        const i = this.__evs__[event].findIndex(ev => ev === cb || ev.toString() === cb.toString());\n        if(i === -1) return;\n        this.__evs__[event].splice(i, 1);\n    }\n\n    emit(event, ...args){\n        this.__any__.forEach(ev => ev(event, ...args));\n        if(!this.has(event)) return;\n        this.__evs__[event].forEach(ev => ev(...args));\n    }\n\n    renameEvent(oldEvent, newEvent){\n        if(!this.has(oldEvent)) return;\n        if(newEvent === oldEvent) return;\n        this.oldEvent = this.newEvent;\n        delete this.oldEvent;\n    }\n}\n//#endregion\n\n\n/**\n * @callback InputProcessorEventCallback\n * @param {(InputProcessorKeyboardEvent | InputProcessorMouseEvent)} ev\n */\n\n/**\n * @typedef {Ojbect} BuildInFunctionFormat\n * @property {String} event\n * @property {Function} fn\n */\n\n/**\n * @typedef KeyboardEventType\n * @property {string} keydown\n * @property {string} keyup\n */\n\n/**\n * @typedef MouseEventType\n * @property {string} mousemove\n * @property {string} click\n * @property {string} auxclick\n * @property {string} dblclick\n * @property {string} contextmenu\n * @property {string} mousedown\n * @property {string} mouseup\n * @property {string} mouseenter\n * @property {string} mouseover\n * @property {string} mouseleave\n * @property {string} mouseout\n * @property {string} drag\n * @property {string} dragstart\n * @property {string} dragend\n */\n\nclass InputProcessorConfig {\n    /**\n     * @type {HTMLElement}\n     */\n    monitor;\n    /**Determines wether capture KeyEvents is enabled. */\n    captureKey = true;\n    /**Determines wether the MouseInputModule is used */\n    captureMouse = false;\n    \n    // Future Options --- Not yet implemented\n    string; // prevent defaults and other stuff\n}\n\nclass InputProcessor extends EventEmitter{\n    \n    /**\n     * Recognizes keycodes to be used as property in instances. Used in tandem with check().\n     * \n     * Can also accept basic keys to be converted into property in instances of this class. (e.g. a -> KEY_A, + -> NUM_ADD)\n     * \n     * @param {String} key the key property of a KeyBoard Event\n     * @param {String} code the code property of a KeyBoard Event\n     * @returns {String} the appropriate property of this InputProcessor instance\n     */\n    static recognize(key, code){\n        const capKey = key.toUpperCase();\n\n        // If this came from an HTML Keyboard Event\n        if(code){\n            // If an alphabet key\n            if(code.match((/key(?!_)/igm))) return code.replace(/key/igm, \"KEY_\");\n            // If a numpad key\n            if(code.match(/numpad(?!_)/igm)) return code.replace(/numpad/igm, \"NUM_\");\n            // if a digit key\n            if(code.match(/digit(?!_)/igm)) return code.replace(/digit/igm, \"DIG_\");\n        }\n\n\n        // TODO: Create a more concise processing of exceptions\n        // Sing Characters, usually uses outside the KeyBoard Event\n        if(capKey.length === 1){\n            const charCode = capKey.charCodeAt(0);\n            if(65 <= charCode && 90 >= charCode) return `KEY_${capKey}`;\n            if(48 <= charCode && 57 >= charCode) return `NUM_${capKey}`;\n            switch(capKey){\n                case '+':\n                    return \"NUM_ADD\";\n                case '-':\n                    return 'NUM_SUB';\n                case '*':\n                    return 'NUM_MUL';\n                case '/':\n                    return 'SLASH_FORWARD';\n                case '\\\\':\n                    return 'SLASH_BACKWARD';\n                case ' ':\n                    return 'SPACE';\n            }\n        }\n        \n        return capKey;\n    }\n\n    /**\n     * Serializes combinational keys (if ever it has modifier keys) for a more consistent event type on emitting and listening events.\n     * @param {String[] | String} keys \n     */\n    static serialize(keys){\n        if(!Array.isArray(keys) && typeof keys === 'string'){\n            // Split by the plus sign, if there's a two consecutive plus signs, only split the first occurent (results from CTRL and '+' making CTRL++)\n            keys = this.split(keys);\n        }\n        keys.sort(); // Sort before anything else\n\n        // Find any Non-Modifier Key (if any) and put it on the last\n        const nonModifierIndex = keys.findIndex(k => !this.MODIFIERS.includes(k));\n        if(nonModifierIndex !== -1) keys.push(keys.splice(nonModifierIndex, 1)[0]); \n        \n        return keys.map(k => this.recognize(k, '')).join(this.seperator);\n    }\n\n    static get MODIFIERS(){\n        return [\"ALT\", \"CONTROL\", \"SHIFT\"];\n    }\n\n    static seperator = '§';\n    static splitter = /\\+(?<=[^+].)/igm;\n\n    static split(keys){\n        return keys.split(this.splitter).join(this.seperator).split(this.seperator);\n    }\n    \n    //#region --- KEY STATES ---\n    \n    // Directional keys\n    ARROW_UP = false;\n    ARROW_DOWN = false;\n    ARROW_LEFT = false;\n    ARROW_RIGHT = false;\n\n    // Alphabet Keys: --- Initialized in the constructor\n    // Numpad Keys: --- Initialized in the constructor\n    // Digital Keys: --- Initialized in the constructor\n\n    // Modifier Keys\n    CONTROL = false;\n    SHIFT = false;\n    ALT = false;\n\n    // Miscellaneous Keys\n    SPACE = false;\n    TAB = false;\n    \n    //#endregion\n\n    //#region --- MOUSE STATES ---\n\n    cursor = new MouseInputModule(this);\n    \n    //#endregion\n\n    /**\n     * \n     * @param {HTMLElement} element the element to monitor inputs\n     * @param {InputProcessorConfig} config\n     */\n    constructor(element, config){\n        super();\n\n        // Set Alphabet keys\n        for(let c = 0; c < 26; c++){\n            this[`KEY_${String.fromCharCode(65 + c)}`] = false;\n        }\n        // Set Digital and Numpad Keys\n        for(let n = 0; n < 10; n++){\n            this[`NUM_${n}`] = false; // Numpad (Right Side of Keyboard)\n            this[`DIG_${n}`] = false; // Digital (Above the alphabet keys)\n        }\n\n        this.config = config || new InputProcessorConfig();\n\n        if(element) this.monitor = element;\n    }\n\n    /**\n     * @type {InputProcessorConfig}\n     */\n    config;\n\n    get monitor(){\n        return this.config.monitor;\n    }\n\n    set monitor(el){\n        // Remove listeners from the previous monitored element\n        if(this.monitor){\n            this.__built_listeners__.forEach(bl => this.monitor.removeEventListener(bl.event, bl.fn));\n        }\n            \n        if(el === undefined || el === null){\n            console.warn(`Element set to monitor is undefined`);\n            return;\n        }else if(this.config.captureMouse) this.cursor.monitor = el;\n        if(el.tagName === 'CANVAS') el.tabIndex = 1;\n\n        if(this.config.captureKey) this.__built_listeners__.forEach(bl => el.addEventListener(bl.event, bl.fn.bind(this)));\n        this.config.monitor = el;\n    }\n\n    /**\n     * @type {BuildInFunctionFormat[]}\n     */\n    get __built_listeners__(){\n        return [\n            this.__onKeyDown, \n            this.__onKeyUp,\n            this.__onFocusOut\n        ].map(fn => {\n            return {\n                // Formats the name to something that can be applied on html events\n                event: fn.name.replace('__on', '').toLowerCase(),\n                fn: fn\n            } \n        })\n    }\n\n    /**\n     * TODO: Make this more secure. Prepare a comprehensive list of actual keyboard and mouse codes\n     * @type {Array<[String, Boolean]>}\n     */\n    get states(){\n        return Object.entries(this).filter(v => typeof v[1] === 'boolean');\n    }\n\n\n    check(key){\n        if(key === '+') key = [key];\n        const keys = Array.isArray(key) ? key : typeof key === 'string' ? InputProcessor.split(key) : key;\n        return keys.every(k => this[InputProcessor.recognize(k, \"\")]);\n    }\n\n    /**\n     * \n     * @param {String[]} keys Key properties in clockwise order (e.g. up, right, down, left)\n     * @returns \n     */\n    direction(keys = ['ARROW_UP', 'ARROW_RIGHT', 'ARROW_DOWN', 'ARROW_LEFT']){\n        if(keys.length !== 4) throw new Error(`Directional Key Array length must be exactly 4`);\n\n        const u = this.check(keys[0]),\n              d = this.check(keys[2]),\n              l = this.check(keys[3]),\n              r = this.check(keys[1]);\n\n        const x = !l && !r ? 0 : !l && r ? 1 : -1,\n              y = !u && !d ? 0 : !u && d ? 1 : -1;\n\n        return [x, y];\n    }\n\n    reset(){\n        // Make all boolean true property false\n        Object.entries(([k, v]) => {\n            if(v === true) this[k] = false;\n        });\n    }\n\n    focus(){\n        this.monitor.focus();\n    }\n\n    /**\n     * Override the on and off event for any combinational hotkeys\n     * @param {(keyof KeyboardEventType | keyof MouseEventType | Array)} event A key or key combination. Put a '+' for added modifiers, order does not matter. e.g. SHIFT+CTRL+C is equal to CTRL+SHIFT+C. CTRL and CONTROL are the same however, the InputProcessorEvent uses CONTROL.\n     * @param {InputProcessorEventCallback} cb \n     * @param {Boolean} release Set to true if the callback is only invoked when releasing the said key\n     */\n    on(event, cb, release = false){\n        if(event === '') return;\n        switch(event){\n            case 'keydown':\n            case 'keyup':\n                break;\n            // Mouse events starts here\n            case 'mousemove':\n            case 'click': \n            case 'auxclick':\n            case 'dblclick':\n            case 'contextmenu':\n            case 'mousedown':\n            case 'mouseup':\n            case 'mouseenter':\n            case 'mouseover':\n            case 'mouseleave':\n            case 'mouseout':\n            case 'dragstart':\n            case 'dragend':\n            case 'drag':\n                break;\n            default:\n                event = event.replace('CTRL', 'CONTROL');\n                event = InputProcessor.serialize(event);\n        }\n        // Modify event to properly recognize if its a release event\n        if(release) event = `UP:${event}`;\n        super.on(event, cb);\n    }\n\n    /**\n     * Override the on and off event for any combinational hotkeys\n     * @param {(keyof KeyboardEventType | keyof MouseEventType | Array)} event A key or key combination\n     * @param {InputProcessorEventCallback} cb \n     * @param {Boolean} release Set to true if the callback is only invoked when releasing the said key\n     */\n    off(event, cb, release = false){\n        if(event === '') return;\n        switch(event){\n            case 'keydown':\n            case 'keyup':\n                break;\n            // Mouse events starts here\n            case 'mousemove':\n            case 'click': \n            case 'auxclick':\n            case 'dblclick':\n            case 'contextmenu':\n            case 'mousedown':\n            case 'mouseup':\n            case 'mouseenter':\n            case 'mouseover':\n            case 'mouseleave':\n            case 'mouseout':\n            case 'dragstart':\n            case 'dragend':\n            case 'drag':\n                break;\n            default:\n                event = event.replace('CTRL', 'CONTROL');\n                event = InputProcessor.serialize(event);\n        }\n        // Modify event to properly recognize if its a release event\n        if(release) event = `UP:${event}`;\n        super.off(event, cb);\n    }\n\n    /**\n     * @private\n     * @param {KeyboardEvent} e \n     * @returns \n     */\n    _processKeyBoardEvent(e){\n\n        const key = e.key.replace(/ARROW/gi, \"ARROW_\");\n\n        // Modifier Key States\n        this.ALT = e.altKey;\n        this.CONTROL = e.ctrlKey;\n        this.SHIFT = e.shiftKey;\n        \n        const keyprop = InputProcessor.recognize(key, e.code);\n        const active_keys = [key.toUpperCase()];\n        if(this.ALT && keyprop !== 'ALT') active_keys.unshift('ALT');\n        if(this.CONTROL && keyprop !== 'CONTROL') active_keys.unshift('CONTROL');\n        if(this.SHIFT && keyprop !== 'SHIFT') active_keys.unshift('SHIFT');\n\n        // Modified KeyboardEvent\n        const combined = InputProcessor.serialize(active_keys);\n        const ipev = new InputProcessorKeyboardEvent(e, combined, this);\n\n        return {\n            keyprop,\n            combined,\n            ipev,\n        }\n    }\n\n    //#region --- PreBuilt Listeners ---\n\n    /**\n     * \n     * @param {KeyboardEvent} e \n     */\n    __onKeyDown(e){\n        e.preventDefault();\n\n        const {keyprop, combined, ipev} = this._processKeyBoardEvent(e);\n        this[keyprop] = true;\n\n        // Emit Hotkey listeners (If not on repeat)\n        if(!e.repeat) this.emit(combined, ipev);\n        // Emit Also the simple/not-combined listener\n        if(!e.repeat && combined !== keyprop) this.emit(keyprop, ipev);\n        // Emit basic onkeydown (if any)\n        this.emit(`keydown`, ipev);\n    }\n\n    /**\n     * \n     * @param {KeyboardEvent} e \n     */\n    __onKeyUp(e){\n        e.preventDefault();\n        \n        const {keyprop, combined, ipev} = this._processKeyBoardEvent(e);\n        this[keyprop] = false;\n\n        // Emit hotkey listeners for release type\n        this.emit(`UP:${combined}`, ipev);\n        // Emit Also the simple/not-combined listener\n        if(combined !== keyprop) this.emit(`UP:${keyprop}`, ipev);\n        // Emit basic onkeyup (if any)\n        this.emit(`keyup`, ipev);\n\n    }\n    __onFocusOut(){\n        // Emit all keyup emitters if a key state is true\n        Object.entries(([k, v]) => {\n            if(typeof this[k] === \"boolean\" && v){\n                this.emit(`UP:${k}`);\n            }\n        })\n    }\n\n    //#endregion\n}\n\nclass Coordinate{\n    /**\n     * @type {Number}\n     */\n    x;\n    /**\n     * @type {Number}\n     */\n    y;\n\n    constructor(x, y){\n        this.x = x;\n        this.y = y;\n    }\n\n    /**\n     * \n     * @param {Coordinate} coord \n     * @returns {Coordinate}\n     */\n    difference(coord){\n        return new Coordinate(\n            this.x - coord.x,\n            this.y - coord.y\n        )\n    }\n\n    sum(coord){\n        return new Coordinate(\n            this.x + coord.x,\n            this.y + coord.y\n        )\n    }\n\n    /**@type {Coordinate} */\n    get clone(){\n        return new Coordinate(this.x, this.y);\n    }\n\n    /**\n     * Returns the array form of the coordinate\n     * @type {Number[]}\n     */\n    get arr(){\n        return [this.x, this.y];\n    }\n}\n\nclass MouseInputModule{\n    client = new Coordinate(0, 0);\n    screen = new Coordinate(0, 0);\n    /**\n     * The coordinate when the dragging starts. Can be used to determine the change of coordinate from the first drag starts and to the current.\n     * @type {Coordinate}\n     */\n    lastClick;\n\n    /**\n     * @type {HTMLElement}\n     */\n    _monitor;\n\n    isDragging = false;\n\n    get monitor(){\n        return this._monitor;\n    }\n\n    set monitor(el){\n        if(this.monitor){\n            this.__built_listeners__.forEach(bl => this.monitor.removeEventListener(bl.event, bl.fn));\n        }\n            \n        this.__built_listeners__.forEach(bl => el.addEventListener(bl.event, bl.fn.bind(this)));\n        this._monitor = el;\n    }\n\n    get __built_listeners__(){\n        return [\n            this.__onClick,\n            this.__onAuxClick,\n            this.__onDblClick,\n            this.__onContextMenu,\n            this.__onMouseDown,\n            this.__onMouseUp,\n            this.__onMouseEnter,\n            this.__onMouseOver,\n            this.__onMouseLeave,\n            this.__onMouseOut,\n            this.__onMouseMove,\n            this.__onFocusOut\n        ].map(fn => {\n            return {\n                event: fn.name.replace('__on', '').toLowerCase(),\n                fn: fn\n            }\n        })\n    }\n\n    /**\n     * @type {InputProcessor}\n     */\n    _ip;\n\n    /**\n     * \n     * @param {InputProcessor} processor \n     */\n    constructor(processor){\n        this._ip = processor;\n    }\n\n    /**\n     * \n     * @param {keyof MouseEventType} event \n     * @param  {...any} args \n     */\n    emit(event, ...args){\n        this._ip.emit(event, ...args);\n    }\n\n    /**@param {MouseEvent} e*/\n    __processMouseEvent__(e){\n        const rect = this.monitor.getBoundingClientRect();\n\n        this.screen.x = e.screenX;\n        this.screen.y = e.screenY;\n        this.client.x = e.clientX - rect.left;\n        this.client.y = e.clientY - rect.top;\n\n        if(e.type === 'mousedown') this.lastClick = this.client.clone;\n\n        const ipmouse = new InputProcessorMouseEvent(this);\n\n        return ipmouse;\n    }\n\n    //#region Built In Listeners\n\n    /**@param {MouseEvent} e*/\n    __onMouseMove(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        if(this.isDragging) this.emit('drag', ipmouse);\n\n        this.emit('mousemove', ipmouse);\n    }\n\n    //\n\n    /**@param {MouseEvent} e*/\n    __onClick(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('click', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onAuxClick(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('auxclick', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onDblClick(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('dblclick', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onContextMenu(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('contextmenu', ipmouse);\n    }\n\n    //\n\n    /**@param {MouseEvent} e*/\n    __onMouseDown(e){\n        this.isDragging = true;\n        const ipmouse = this.__processMouseEvent__(e);\n        this.emit('dragstart', ipmouse);\n        this.emit('mousedown', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseUp(e){\n        this.isDragging = false;\n        this.lastClick = null;\n        const ipmouse = this.__processMouseEvent__(e);\n        this.emit('dragend', ipmouse);\n        this.emit('mouseup', ipmouse);\n    }\n\n    //\n\n    /**@param {MouseEvent} e*/\n    __onMouseOver(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('mouseover', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseEnter(e){\n        const ipmouse = this.__processMouseEvent__(e);\n        if(this.isDragging && e.buttons === 0){\n            this.isDragging = false;\n            this.lastClick = null;\n        }\n        this.emit('mouseenter', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseOut(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('mouseout', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseLeave(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('mouseleave', ipmouse);\n    }\n\n    __onFocusOut(){\n        this.isDragging = false;\n        this.lastClick = null;\n    }\n}\n\nexport {\n    InputProcessor,\n    MouseInputModule\n}","import Victor from \"victor\";\r\nimport State from \"./graph/State\";\r\nimport Transition from \"./graph/Transition\";\r\n\r\nexport default class Util {\r\n    static genString(len){\r\n        return Math.random().toString(36).substring(2,len+2);\r\n    }\r\n\r\n    static deg2Rad = deg => Math.PI * deg / 180;\r\n    static rad2Deg = rad => rad * 180 / Math.PI;\r\n\r\n    /**\r\n     *  \r\n     * @param  {(State[]|Transition[])} states \r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @returns {(State[]|Transition[])}\r\n     */\r\n    static FindHits(states, x, y){\r\n        return states.filter(s => s.hits(x, y));\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     * @param {Number} fx From X \r\n     * @param {Number} fy From Y\r\n     * @param {Number} tx To X\r\n     * @param {Number} ty To Y\r\n     * @param {Number} arcAngle Arc Angle to be shown in degrees\r\n     * @param {Boolean} cw Clockwise\r\n     */\r\n    static drawArcFromTwoPoints(ctx, fx, fy, tx, ty, arcAngle, cw = false){\r\n        const f = new Victor(fx, fy),\r\n            t = new Victor(tx, ty),\r\n            a2 = arcAngle / 2,\r\n            m = f.clone().mix(t, 0.5),\r\n            l = f.distance(t);\r\n\r\n        // Calculations\r\n        const ti = 90 - a2, // Theta Inner\r\n            r = l / (2 * Math.cos(this.deg2Rad(ti))); // radius\r\n\r\n        const center = t.clone().subtract(f)\r\n        .rotateDeg(cw ? ti : -ti) // change this according to cw\r\n        .norm().multiplyScalar(r);\r\n\r\n        const coa = center.clone().add(f);\r\n\r\n        // ctx.strokeStyle = 'crimson';\r\n        // this.line(ctx, ...f.toArray(), ...t.toArray());\r\n        // ctx.strokeStyle = 'blue';\r\n        // this.line(ctx, ...f.toArray(), ...coa.toArray());\r\n        // this.line(ctx, ...coa.toArray(), ...t.toArray());\r\n\r\n        ctx.strokeStyle = '#999';\r\n        const sa = center.clone().invert().angle(),\r\n            ea = sa - this.deg2Rad(arcAngle);\r\n        \r\n        ctx.beginPath();\r\n        ctx.arc(...center.clone().add(f).toArray(), r, sa, ea, !cw);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        const ctd = center.clone().invert().rotateDeg(-a2);\r\n        const ct = ctd.clone().add(ctd.norm().multiplyScalar(15)).add(coa);\r\n\r\n        // ctx.strokeStyle = 'green';\r\n        // this.line(ctx, ...coa.toArray(), ...ct.toArray());\r\n\r\n\r\n        return {\r\n            start: sa,\r\n            end: ea,\r\n            center: ct\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     * @param {Number} fx \r\n     * @param {Number} fy \r\n     * @param {Number} tx \r\n     * @param {Number} ty \r\n     */\r\n    static line(ctx, fx, fy, tx, ty){\r\n        ctx.beginPath();\r\n        ctx.moveTo(fx, fy);\r\n        ctx.lineTo(tx, ty);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {(Number|Victor)} angle \r\n     * @param {Boolean} goIn \r\n     */\r\n    static drawArrow(ctx, x, y, angle, arrowAngle = 25, goIn = true){\r\n        const o = new Victor(x, y),\r\n            a = angle instanceof Victor ? \r\n            angle.clone().norm() : \r\n            new Victor(1, 0).rotateDeg(angle);\r\n\r\n        ctx.beginPath();\r\n\r\n        a.rotateDeg(180 - arrowAngle / 2).multiplyScalar(25);\r\n        ctx.moveTo(...o.toArray());\r\n        ctx.lineTo(...o.clone().add(a).toArray());\r\n        a.rotateDeg(arrowAngle);\r\n        ctx.lineTo(...o.clone().add(a).toArray());\r\n        ctx.lineTo(...o.toArray());\r\n        ctx.fill();\r\n\r\n        ctx.closePath();\r\n    }\r\n}","import Victor from \"victor\";\r\nimport Util from \"../Util\";\r\n\r\nclass StateOptions{\r\n    // Put more here\r\n    radius = 15;\r\n    border = 2;\r\n    borderColor = '#888';\r\n    bg = '#444';\r\n}\r\n\r\n/**Constants */\r\nconst deg360 = Math.PI * 2;\r\n\r\nexport default class State{\r\n    /**@type {Victor} */\r\n    pos;\r\n    /**@type {String} */\r\n    label;\r\n    /**@type {StateOptions} */\r\n    options;\r\n    isFinish = false;\r\n    isStart = false;\r\n\r\n    /**\r\n     * \r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {String} label \r\n     * @param {StateOptions} options \r\n     */\r\n    constructor(x, y, label, options = {}){\r\n        const defOptions = new StateOptions();\r\n        Object.assign(defOptions, options);\r\n\r\n        this.pos = new Victor(x, y);\r\n        this.label = label || Util.genString(3);\r\n        this.options = defOptions;\r\n\r\n        Math.sq\r\n    }\r\n\r\n    /**\r\n     * Checks if a coordinate is inside this state\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @returns {Boolean}\r\n     */\r\n    hits(x, y){\r\n        const d = this.pos.distance(new Victor(x, y));\r\n        return this.options.radius >= d;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     */\r\n    draw(ctx){\r\n        const { pos, options, label } = this;\r\n        const { x, y } = pos;\r\n        const { radius, border, borderColor, bg } = options;\r\n        const fullWidth = radius + border;\r\n\r\n        if(this.isFinish){\r\n            ctx.beginPath();\r\n            ctx.fillStyle = borderColor;\r\n            ctx.arc(x, y, fullWidth + 6, 0, deg360);\r\n            ctx.fill();\r\n            ctx.closePath()\r\n            \r\n            ctx.beginPath();\r\n            ctx.fillStyle = \"#171717\";\r\n            ctx.arc(x, y, fullWidth + 4, 0, deg360);\r\n            ctx.fill();\r\n            ctx.closePath()\r\n        }\r\n\r\n        ctx.beginPath();\r\n        // Fill first using the border\r\n        ctx.fillStyle = borderColor;\r\n        ctx.ellipse(x, y, fullWidth, fullWidth, 0, 0, deg360);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        // Then the inner part\r\n        ctx.fillStyle = bg;\r\n        ctx.ellipse(x, y, radius, radius, 0, 0, deg360);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.fillStyle = '#999';\r\n        ctx.textAlign = 'center';\r\n        ctx.font = '12px Roboto';\r\n        ctx.fillText(label, x, y + radius + 15 + (this.isFinish ? 10 : 0));\r\n\r\n        if(this.isStart) Util.drawArrow(ctx, x - radius, y, 0, 90);\r\n    }\r\n}","import Victor from \"victor\";\r\nimport State from \"./State\";\r\nimport { useTransitionStore } from \"@/stores/transitionStore\";\r\nimport Util from \"../Util\";\r\n\r\nexport default class Transition{\r\n    /**@type {State} */\r\n    from;\r\n    /**@type {State} */\r\n    to;\r\n    /**@type {String[]} */\r\n    v = [];\r\n\r\n    /**\r\n     * \r\n     * @param {State} from \r\n     * @param {State} to \r\n     * @param {String[]} v\r\n     */\r\n    constructor(from, to, ...v){\r\n        this.from = from;\r\n        this.to = to;\r\n        this.v = v.sort();\r\n    }\r\n    \r\n\r\n    equalWith(from, to){\r\n        return this.from.label === from && this.to.label === to;\r\n    }\r\n\r\n    /**\r\n     * @param {Transition} other \r\n     * @returns {Boolean}\r\n     */\r\n    equals(other){\r\n        return other.from.label === this.from.label && other.to.label === this.to.label;\r\n    }\r\n\r\n    addValue(...v){\r\n        this.v.push(...v.sort());\r\n    }\r\n\r\n    removeValue(v){\r\n        const i = this.v.findIndex(a => a === v);\r\n        if(i === -1) return;\r\n        this.v.splice(i, 1);\r\n\r\n        if(this.v.length > 0) return;\r\n        // If no labels left, then delete the transition\r\n        const transitionStore = useTransitionStore();\r\n        transitionStore.removeTransition(this.from.label, this.to.label);\r\n    }\r\n\r\n    str(){\r\n        return this.v.map(v => `${this.from.label}:${v}>${this.to.label}`).join('\\n');\r\n    }\r\n\r\n    /**\r\n     * @param {CanvasRenderingContext2D} ctx \r\n     */\r\n    draw(ctx){\r\n        const vdir = this.to.pos.clone().\r\n        subtract(this.from.pos);\r\n\r\n        const vnorm = vdir.clone().norm();\r\n\r\n        const v = vnorm.clone().multiplyScalar(this.from.options.radius + 9);\r\n        \r\n        let end = this.to.pos.clone().subtract(v),\r\n            start = this.from.pos.clone().add(v);\r\n\r\n        const transitionStore = useTransitionStore();\r\n\r\n        let arrAngle = 0, textPos = null;\r\n\r\n        // Line\r\n        ctx.strokeStyle = '#999';\r\n\r\n        // Text\r\n        ctx.textAlign = 'center';\r\n        const tw = ctx.measureText(this.v.join(', ')).width;\r\n\r\n        ctx.fillStyle = '#999';\r\n\r\n        if(transitionStore.getTransitionIndex(this.to.label, this.from.label) === -1){\r\n            ctx.beginPath();\r\n            ctx.moveTo(...start.toArray());\r\n            ctx.lineTo(...end.clone().subtract(v).toArray());\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            textPos = this.from.pos.clone().mix(this.to.pos, 0.5)\r\n            .add(vdir.clone().rotateDeg(-90)\r\n            .norm().multiplyScalar(tw)).toArray();\r\n\r\n        }else if(this.from.label === this.to.label){\r\n            // For self referencing\r\n            const arcLoc = 90, \r\n                tmp = new Victor(0, -(this.from.options.radius + 5));\r\n\r\n            end = this.from.pos.clone().add(tmp.clone().rotateDeg(-arcLoc / 2));\r\n\r\n            const { end: ea } = Util.drawArcFromTwoPoints(ctx,\r\n                ...this.from.pos.clone().add(tmp.clone().rotateDeg(arcLoc / 2)).toArray(),\r\n                ...end.toArray(),\r\n                270);\r\n            \r\n            textPos = this.from.pos.clone().add(tmp.clone().multiplyScalar(2.8)).toArray();\r\n            arrAngle = -ea + (Math.PI * 10 / 9);\r\n        }else {\r\n            \r\n            const maxArc = 150, minArc = 15,\r\n                arc = maxArc**2 / this.from.pos.distanceSq(this.to.pos);\r\n                \r\n\r\n            const { start: sa, end: ea, center: c } = Util.drawArcFromTwoPoints(ctx, ...start.toArray(), ...end.toArray(), \r\n                arc > 1 ? maxArc : maxArc * arc < minArc ? minArc : maxArc * arc\r\n            )\r\n            arrAngle = Math.PI / 2 - sa;\r\n\r\n            textPos = c.toArray();\r\n        }\r\n\r\n        // Arrow\r\n        const arrowAngle = 20;\r\n        Util.drawArrow(ctx, ...end.toArray(), arrAngle === 0 ? vnorm : vnorm.rotateBy(arrAngle), arrowAngle);\r\n\r\n        ctx.fillText(\r\n            this.v.join(', '), \r\n        ...textPos\r\n        );\r\n    }\r\n}","import State from \"@/commons/graph/State\";\r\nimport { defineStore } from \"pinia\";\r\nimport { computed, reactive, ref } from \"vue\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport { useMainStore } from \"./mainStore\";\r\n\r\nexport const useStateStore = defineStore('state', () => {\r\n\r\n    const transitionStore = useTransitionStore(),\r\n        mainStore = useMainStore();\r\n\r\n    /**@type {State[]} */\r\n    const states = reactive([]);\r\n\r\n    /**\r\n     * @param {State} state \r\n     */\r\n    const addState = (state) => {\r\n        states.push(state);\r\n        mainStore.genRegex();\r\n    };\r\n\r\n    const getStateIndex = label => states.findIndex(s => s.label === label),\r\n        getState = label => states.find(s => s.label === label);\r\n\r\n    const removeState = (label) => {\r\n        const i = getStateIndex(label);\r\n        if(i === -1) return;\r\n\r\n        // Find all transitions that is connected to this state\r\n        const froms = transitionStore.getTransitionsFrom(label);\r\n        froms.forEach(f => transitionStore.removeTransition(f.from.label, f.to.label));\r\n\r\n        const tos = transitionStore.getTransitionsTo(label);\r\n        tos.forEach(t => transitionStore.removeTransition(t.from.label, t.to.label));\r\n\r\n        if(mainStore.selected.label === label) mainStore.select(undefined);\r\n\r\n        states.splice(i , 1);\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const savedStart = ref(undefined);\r\n\r\n    const setStart = (c) => {\r\n        const t = getState(c);\r\n\r\n        if(savedStart.value === undefined) {\r\n            savedStart.value = t;\r\n        } else {\r\n            savedStart.value.isStart = false;\r\n            savedStart.value = t;\r\n        }\r\n\r\n        t.isStart = true;\r\n\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const accepting = computed(() => states.filter(s => s.isFinish));\r\n\r\n    return {\r\n        states,\r\n        addState,\r\n        getStateIndex,\r\n        getState,\r\n        removeState,\r\n        setStart,\r\n        savedStart,\r\n        accepting\r\n    }\r\n})","import Transition from \"@/commons/graph/Transition\";\r\nimport { defineStore } from \"pinia\";\r\nimport { reactive } from \"vue\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport { useMainStore } from \"./mainStore\";\r\n\r\nexport const useTransitionStore = defineStore('transition', () => {\r\n\r\n    const stateStore = useStateStore(),\r\n        mainStore = useMainStore();\r\n\r\n    /**@type {Transition[]} */\r\n    const transitions = reactive([]);\r\n\r\n    const addTransition = ({labels, from, to}) => {\r\n        // Find first if said transition is existing\r\n        const i = getTransitionIndex(from, to);\r\n        if(i === -1){\r\n            // Add transition if not found\r\n            const f = stateStore.getState(from),\r\n                t = stateStore.getState(to);\r\n            transitions.push(new Transition(f, t, ...labels));\r\n        }else{\r\n            // Just add the new labels to the transition\r\n            transitions[i].v.splice(0);\r\n            transitions[i].addValue(...labels);\r\n            \r\n            if(labels.length === 0) removeTransition(from, to);\r\n        }\r\n        \r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const getTransitionIndex = (from, to) => {\r\n        return transitions.findIndex(t => t.equalWith(from, to));\r\n    }\r\n\r\n    const getTransition = (from, to) => transitions.find(t => t.equalWith(from, to));\r\n\r\n    const getTransitionsFrom = from => transitions.filter(t => t.from.label === from);\r\n\r\n    const getTransitionsTo = to => transitions.filter(t => t.to.label === to);\r\n\r\n    const removeTransition = (from, to) => {\r\n        const i = getTransitionIndex(from, to);\r\n        if(i === -1) return;\r\n        transitions[i].v.splice(0);\r\n        transitions.splice(i , 1);\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    return {\r\n        addTransition,\r\n        getTransitionIndex,\r\n        getTransition,\r\n        removeTransition,\r\n        transitions,\r\n        getTransitionsFrom,\r\n        getTransitionsTo\r\n    }\r\n})","import { defineStore } from \"pinia\";\r\nimport { reactive } from \"vue\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport { useMainStore } from \"./mainStore\";\r\n\r\n\r\nconst MAX_ALHPABET = 10;\r\n\r\nexport const useAlphabetStore = defineStore('alphabet', () => {\r\n    const alphabet = reactive(['a', 'b']);\r\n\r\n    const transitionStore = useTransitionStore(),\r\n        mainStore = useMainStore();\r\n        \r\n    const removeAlphabet = c => {\r\n        const i = alphabet.indexOf(c);\r\n        if(i === - 1) return;\r\n        alphabet.splice(i, 1);\r\n\r\n        // Remove all occurences in all transition of the said alphabet\r\n        transitionStore.transitions.forEach(t => t.removeValue(c));\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const removeAll = () => {\r\n        alphabet.forEach(ap => removeAlphabet(ap));\r\n    }\r\n\r\n    const addAlphabet = c => {\r\n        if(alphabet.length >= MAX_ALHPABET) return;\r\n\r\n        c = c.trim();\r\n        if(c === '') return;\r\n        const i = alphabet.indexOf(c);\r\n        if(i === -1) {\r\n            alphabet.push(c);\r\n            mainStore.genRegex();\r\n        }\r\n    }\r\n\r\n    const resetAlphabet = () => {\r\n        alphabet.splice(0);\r\n        alphabet.push('a', 'b');\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    return {\r\n        alphabet,\r\n        addAlphabet,\r\n        removeAlphabet,\r\n        resetAlphabet,\r\n        removeAll\r\n    }\r\n})","/**\r\n * @callback DrawableGFX\r\n * @param {CanvasRenderingContext2D} ctx\r\n */\r\n\r\nimport Util from \"../Util\";\r\n\r\nexport class Drawables{\r\n    /**@type {Drawables[]} */\r\n    static instances = [];\r\n\r\n    /**@type {String} */\r\n    id;\r\n    /**@type {DrawableGFX} */\r\n    gfx;\r\n    /**@type {Boolean} */\r\n    isRegistered = false;\r\n\r\n    /**\r\n     * \r\n     * @param {Drawables} d \r\n     */\r\n    static register(d){\r\n        const i = this.instances.findIndex(n => n.id === d.id);\r\n        if(i !== -1) return;\r\n        this.instances.push(d);\r\n        d.isRegistered = true;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {DrawableGFX} gfx \r\n     * @param {String} id \r\n     */\r\n    constructor(gfx, id){\r\n        this.gfx = gfx;\r\n        this.id = id || Util.genString(8);\r\n    }\r\n\r\n    remove(){\r\n        const i = Drawables.instances.findIndex(d => d.id === this.id);\r\n        if(i === -1) return;\r\n        Drawables.instances.splice(i, 1);\r\n        this.isRegistered = false;\r\n    }\r\n\r\n    register(){\r\n        if(this.isRegistered) return;\r\n        Drawables.register(this);\r\n    }\r\n\r\n    draw(ctx){\r\n        this.gfx(ctx);\r\n    }\r\n}","import { defineStore } from \"pinia\"\r\nimport { ref } from \"vue\";\r\n\r\nexport const useMouseStore = defineStore('mouse', () => {\r\n    \r\n    const x = ref(0),\r\n        y = ref(0),\r\n        set = (nx, ny) => {\r\n            x.value = nx;\r\n            y.value = ny;\r\n        }\r\n\r\n    return {\r\n        x,\r\n        y,\r\n        set\r\n    }\r\n})","import { Drawables } from \"@/commons/canvas/Drawables\";\r\nimport { defineStore } from \"pinia\";\r\nimport { ref, watch } from \"vue\";\r\nimport { useMouseStore } from \"./mouseStore\";\r\nimport State from \"@/commons/graph/State\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport Victor from \"victor\";\r\nimport Util from \"@/commons/Util\";\r\n\r\n\r\nexport const useModeStore = defineStore('mode', () => {\r\n\r\n    //#region Stores and Drawables\r\n    const stateStore = useStateStore();\r\n    const mousestore = useMouseStore();\r\n    \r\n    const linkingArrow = new Drawables(ctx => {\r\n        const { x, y } = mousestore;\r\n        \r\n        /**@type {State} */\r\n        const start = stateStore.getState(linkStart.value);\r\n        if(start === undefined) return;\r\n\r\n        // Line\r\n        ctx.lineWidth = 2;\r\n        ctx.strokeStyle = '#999999';\r\n        ctx.fillStyle = '#999';\r\n        ctx.beginPath();\r\n        ctx.moveTo(...start.pos.toArray());\r\n        ctx.lineTo(x, y);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        // Triangle\r\n        const v = new Victor(x, y).subtract(start.pos).normalize().multiplyScalar(25);\r\n        Util.drawArrow(ctx, x, y, v);\r\n\r\n        // Inner Circle\r\n        ctx.beginPath();\r\n        ctx.arc(...start.pos.toArray(), 5, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n    }, 'link-arrow');\r\n    //#endregion\r\n\r\n    /**@type {('default'|'linking'|'delete')} */\r\n    const mode = ref('default');\r\n\r\n    watch(mode, v => {\r\n        linkReset();\r\n        if(v === 'linking') linkingArrow.register();\r\n        else linkingArrow.remove();\r\n    })\r\n\r\n    const linkStart = ref(''),\r\n        linkEnd = ref(''),\r\n        linkReset = () => {\r\n            linkStart.value = '';\r\n            linkEnd.value = '';\r\n        }\r\n\r\n    const openTransitionDialog = ref(false);\r\n\r\n    watch(linkEnd, v => {\r\n        openTransitionDialog.value = v !== '';\r\n    })\r\n\r\n    return {\r\n        linkStart,\r\n        linkEnd,\r\n        linkReset,\r\n        \r\n        mode,\r\n        openTransitionDialog\r\n    }\r\n})","import { InputProcessor } from \"../input/InputProcessor\";\r\n\r\nimport { useAlphabetStore } from \"@/stores/alphabetStore\";\r\nimport { useTransitionStore } from \"@/stores/transitionStore\";\r\nimport { useStateStore } from \"@/stores/stateStore\";\r\nimport { useMainStore } from \"@/stores/mainStore\";\r\n\r\nimport State from \"../graph/State\";\r\nimport Util from \"../Util\";\r\nimport { useModeStore } from \"@/stores/modeStore\";\r\nimport { Drawables } from \"./Drawables\";\r\nimport { useMouseStore } from \"@/stores/mouseStore\";\r\n\r\nconst ip = new InputProcessor(null, {\r\n    captureKey: true,\r\n    captureMouse: true\r\n})\r\n\r\n/**\r\n * \r\n * @param {HTMLElement} c \r\n */\r\nexport function monitor(c){\r\n    ip.monitor = c;\r\n}\r\n\r\n\r\nlet HAS_INITIALIZED = false;\r\nexport function initCanvas(){\r\n    // To be sure that this function is only run once\r\n    if(HAS_INITIALIZED) return;\r\n    HAS_INITIALIZED = true;\r\n\r\n    const alphabetStore = useAlphabetStore(),\r\n        transitionStore = useTransitionStore(),\r\n        stateStore = useStateStore(),\r\n        mouseStore = useMouseStore(),\r\n        modeStore = useModeStore(),\r\n        mainStore = useMainStore();\r\n\r\n    const { monitor: c } = ip,\r\n        ctx = c.getContext('2d');\r\n\r\n    const canvas = {};\r\n\r\n    Object.defineProperty(canvas, 'cursor', {\r\n        get: () => c.style.cursor,\r\n        set: v => c.style.cursor = v\r\n    })\r\n\r\n    // Add a state on double click\r\n    ip.on('dblclick', ev => {\r\n        const { x, y } = ev.client;\r\n\r\n        // Only add states when mode is default\r\n        if(modeStore.mode !== 'default') return;\r\n        stateStore.addState(new State(x, y));\r\n        // set the cursor to pointer after creating a state\r\n        canvas.cursor = 'pointer';\r\n    })\r\n\r\n    ip.on('drag', ev => {\r\n        const { x, y } = ev.dragDiff,\r\n            selected = mainStore.selected,\r\n            origin = mainStore.selectedOrigin;\r\n\r\n        // Only support drag when default mode\r\n        if(modeStore.mode !== 'default') return;\r\n\r\n        if(selected === undefined || !(selected instanceof State)) return;\r\n\r\n        const { x: ox, y: oy } = origin;\r\n\r\n        selected.pos.x = ox + x;\r\n        selected.pos.y = oy + y;\r\n    })\r\n\r\n    ip.on('dragend', ev => {\r\n        if(mainStore.selected) canvas.cursor = 'pointer';\r\n    })\r\n\r\n    // Monitor on clicks\r\n    ip.on('mousedown', ev => {\r\n        const { x , y } = ev.client;\r\n\r\n        const clicked = Util.FindHits(stateStore.states, x, y)[0];\r\n\r\n        mainStore.select(clicked);\r\n\r\n\r\n        if(modeStore.mode === 'linking'){\r\n            if(clicked instanceof State){\r\n                if(!modeStore.linkStart) modeStore.linkStart = clicked.label;\r\n                else modeStore.linkEnd = clicked.label;\r\n            }else modeStore.linkStart = '';\r\n        } \r\n        if(clicked === undefined) return;\r\n        if(modeStore.mode === 'delete') stateStore.removeState(clicked.label);\r\n    })\r\n\r\n    ip.on('mousemove', ev => {\r\n        const { x, y } = ev.client,\r\n            selected = mainStore.selected;\r\n\r\n        mouseStore.set(x, y);\r\n\r\n        const hovering = Util.FindHits(stateStore.states, x, y )[0];\r\n\r\n        let cursor = 'default';\r\n\r\n        // Manage cursors while moving\r\n        switch(modeStore.mode){\r\n            case 'default':\r\n                // When dragging\r\n                if(selected && ev.isDragging) cursor = 'grabbing'\r\n                else if(hovering) cursor = 'pointer'\r\n                break;\r\n            case 'linking':\r\n                if(modeStore.linkStart) cursor = 'crosshair';\r\n                else if(hovering instanceof State) cursor = 'copy';\r\n                break;\r\n            case 'delete':\r\n                if(hovering) cursor = 'crosshair';\r\n                break;\r\n        }\r\n\r\n\r\n        canvas.cursor = cursor;\r\n    })\r\n\r\n    ip.on('mouseup', ev => {\r\n        // When stopped dragging\r\n    })\r\n\r\n    // Hotkeys \r\n    \r\n    window.ip = ip;\r\n\r\n    ip.on('C', () => {\r\n      modeStore.mode = 'linking';\r\n    })\r\n\r\n    ip.on('V', () => {\r\n        modeStore.mode = 'default';\r\n    })\r\n\r\n    ip.on('D', () => {\r\n        modeStore.mode = 'delete';\r\n    })\r\n}\r\n\r\nexport function focus(){\r\n    ip.focus();\r\n    ip.monitor.focus()\r\n}\r\n\r\nexport function getMonitor(){\r\n    return ip.monitor;\r\n}","import { focus, getMonitor, initCanvas, monitor } from \"@/commons/canvas/CanvasInit\";\r\nimport State from \"@/commons/graph/State\";\r\nimport Transition from \"@/commons/graph/Transition\";\r\nimport { defineStore } from \"pinia\";\r\nimport { reactive, ref } from \"vue\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport noam from \"@/plugins/noam\";\r\nimport Victor from \"victor\";\r\nimport { useAlphabetStore } from \"./alphabetStore\";\r\n\r\nexport const useMainStore = defineStore(\"main\", () => {\r\n\r\n    const stateStore = useStateStore(),\r\n        transitionStore = useTransitionStore(),\r\n        alphabetStore = useAlphabetStore();\r\n\r\n    /**@type {State} */\r\n    const selected = ref(undefined),\r\n        selectedOrigin = ref({x: 0, y: 0});\r\n\r\n    // Input Processor\r\n    const processInput = c => {\r\n        // set height and width;\r\n        c.width = c.clientWidth;\r\n        c.height = c.clientHeight;\r\n\r\n        monitor(c);\r\n        initCanvas();\r\n    }\r\n\r\n    const select = o => {\r\n        selected.value = o;\r\n        if(!(o instanceof State)) return;\r\n        \r\n        selectedOrigin.value.x = o.pos?.x;\r\n        selectedOrigin.value.y = o.pos?.y;\r\n    }\r\n\r\n    const inputFocus = () => focus();\r\n\r\n    const deleteAll = () => {\r\n        select(undefined);\r\n        stateStore.states.splice(0);\r\n        transitionStore.transitions.splice(0);\r\n    }\r\n\r\n    const checkForValidity = () => {\r\n        const states = stateStore.states,\r\n            transition = transitionStore.transitions,\r\n            initial = stateStore.savedStart,\r\n            accepting = stateStore.accepting;\r\n\r\n\r\n        if(initial === undefined ||\r\n            states.length === 0 ||\r\n            transition.length === 0 ||\r\n            accepting.length === 0) return false;\r\n\r\n            // TODO: More checks\r\n\r\n        return true;\r\n    }\r\n\r\n    const genDFA = regex => {\r\n        deleteAll();\r\n\r\n        let a;\r\n\r\n        try{\r\n            \r\n            a = noam.re.string.toAutomaton(regex);\r\n            a = noam.fsm.convertEnfaToNfa(a);\r\n            a = noam.fsm.convertNfaToDfa(a);\r\n            a = noam.fsm.minimize(a);\r\n            a = noam.fsm.convertStatesToNumbers(a);\r\n            \r\n        }catch(err){\r\n            console.log(err);\r\n        }\r\n\r\n        const { states: st, alphabet: al, acceptingStates: acc, initialState: ini, transitions: trs} = a;\r\n\r\n        const { clientHeight: h, clientWidth: w } = getMonitor();\r\n\r\n        const hand = new Victor(0, 250),\r\n            center = new Victor(w/2, h/2);\r\n\r\n        // Set alphabet\r\n        alphabetStore.removeAll();\r\n        al.forEach(c => alphabetStore.addAlphabet(c));\r\n\r\n        // Generate the states first (circular layout)\r\n        st.forEach((s, i) => {\r\n            const gens = new State(...hand.clone().add(center).toArray(), `q${s}`);\r\n            stateStore.addState(gens)\r\n            if(s === ini) gens.isStart = true;\r\n            hand.rotateDeg(360 / st.length);\r\n            if(acc.includes(s)) gens.isFinish = true;\r\n        })\r\n\r\n        // Set transitions\r\n        trs.forEach(t => {\r\n\r\n            const { fromState, symbol, toStates: toStateArr } = t,\r\n                toState = toStateArr[0];\r\n\r\n            transitionStore.addTransition({\r\n                labels: [symbol],\r\n                from: `q${fromState}`,\r\n                to: `q${toState}`\r\n            })\r\n        })\r\n    }\r\n\r\n    const regexResult = ref('');\r\n\r\n    const genRegex = () => {\r\n\r\n        console.log('generating');\r\n        // validate first\r\n        if(!checkForValidity()) return;\r\n\r\n        const states = stateStore.states,\r\n            transition = transitionStore.transitions,\r\n            initial = stateStore.savedStart,\r\n            accepting = stateStore.accepting;\r\n\r\n        const str = `#state\r\n        ${states.map(s => s.label).join('\\n')}\r\n        #initial\r\n        ${initial}\r\n        #accepting\r\n        ${accepting.map(a => a.label).join('\\n')}\r\n        #alphabet\r\n        ${alphabetStore.alphabet.join('\\n')}\r\n        #transitions\r\n        ${transition.map(t => t.str).join('\\n')}`;\r\n\r\n        let a, r;\r\n\r\n        try {\r\n            a = noam.fsm.parseFsmFromString(str);\r\n            a = noam.fsm.minimize(a);\r\n            r = noam.re.tree.simplify(r, {\"useFsmPatterns\": false});\r\n            r = noam.re.tree.toString(r);\r\n        }catch(err){\r\n            regexResult.value = '';\r\n            console.log(err);\r\n        }\r\n\r\n        console.log(r);\r\n        regexResult.value = r;\r\n    }\r\n\r\n    return {\r\n        processInput,\r\n        inputFocus,\r\n\r\n        selected,\r\n        selectedOrigin,\r\n        select,\r\n\r\n        deleteAll,\r\n        checkForValidity,\r\n        \r\n        genDFA,\r\n        genRegex,\r\n        regexResult\r\n    }\r\n}) ","<template>\r\n    <canvas\r\n        ref=\"c\">\r\n\r\n    </canvas>\r\n</template>\r\n\r\n<script>\r\nimport { useMainStore } from '@/stores/mainStore';\r\nimport { useAlphabetStore } from '@/stores/alphabetStore';\r\nimport { useStateStore } from '@/stores/stateStore';\r\nimport { useTransitionStore } from '@/stores/transitionStore';\r\nimport { ref, computed } from 'vue';\r\nimport { Drawables } from '@/commons/canvas/Drawables';\r\n\r\nwindow.Drawables = Drawables;\r\n\r\nexport default {\r\n    setup () {\r\n\r\n        const c = ref(null),\r\n            ctxRef = computed(() => c.value.getContext('2d')),\r\n            mainStore = useMainStore(),\r\n            alphabetStore = useAlphabetStore(),\r\n            transitionStore = useTransitionStore(),\r\n            stateStore = useStateStore(),\r\n            rafID = ref(0);\r\n\r\n\r\n        const states = computed(() => stateStore.states),\r\n            transitions = computed(() => transitionStore.transitions);\r\n\r\n        const animate = () => {\r\n            const { clientHeight: h, clientWidth: w} = c.value;\r\n            /**@type {CanvasRenderingContext2D} */\r\n            const ctx = ctxRef.value;\r\n            \r\n            // Clear Canvas\r\n            ctx.clearRect(0, 0, w, h);\r\n\r\n            // Draw States\r\n            states.value.forEach(s => s.draw(ctx));\r\n\r\n            // Draw Transitions\r\n            transitions.value.forEach(t => t.draw(ctx));\r\n\r\n            // Draw Drawables\r\n            Drawables.instances.forEach(d => d.draw(ctx));\r\n\r\n            rafID.value = requestAnimationFrame(animate);\r\n        }\r\n\r\n        return {\r\n            c,\r\n            mainStore,\r\n            \r\n            rafID,\r\n            animate\r\n        }\r\n    },\r\n    mounted(){\r\n        // Set canvas element to process any incoming input\r\n        this.mainStore.processInput(this.c);\r\n\r\n        this.animate();\r\n    },\r\n    beforeUnmount(){\r\n        cancelAnimationFrame(this.rafID);\r\n    },\r\n    emits: ['select:node']\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import { render } from \"./FSMVisualizer.vue?vue&type=template&id=3c8998b0\"\nimport script from \"./FSMVisualizer.vue?vue&type=script&lang=js\"\nexport * from \"./FSMVisualizer.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div class=\"flex flex-col gap-2\">\r\n        <!-- Alphabet -->\r\n        <div class=\"flex justify-between\">\r\n          <div class=\"text-2xl\">Alphabet</div>\r\n\r\n          <v-btn \r\n            color=\"red\" \r\n            density=\"comfortable\" \r\n            @click=\"resetAlphabet\"\r\n            v-if=\"resetAble\">Reset</v-btn>\r\n\r\n        </div>\r\n        \r\n        <!-- Alphabet List -->\r\n        <v-container class=\"p-0\">\r\n          <v-row\r\n            align=\"center\"\r\n            justify=\"start\"\r\n            noGutters\r\n            class=\" gap-x-1 gap-y-0.5\">\r\n            <v-col\r\n              v-for=\"c in alphabet\" :key=\"c+''+Math.random()\"\r\n              cols=\"auto\">\r\n              <v-chip\r\n                closable\r\n                @click:close=\"removeAlphabet(c)\"\r\n                size=\"small\">\r\n                {{ c }}\r\n              </v-chip>\r\n            </v-col>\r\n          </v-row>\r\n        </v-container>\r\n\r\n        <div class=\"\">\r\n          <v-text-field \r\n            label=\"Add alphabet\"\r\n            variant=\"solo-filled\"\r\n            placeholder=\"Press Enter to add\" \r\n            v-model=\"temp\"\r\n            maxLength=\"1\"\r\n            clearable\r\n            hideDetails\r\n            @keydown.enter=\"addAlphabet(temp); temp = ''\" />\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useAlphabetStore } from '@/stores/alphabetStore';\r\nimport { computed, ref } from 'vue';\r\n\r\nexport default {\r\n    setup () {\r\n        \r\n        const store = useAlphabetStore(),\r\n            alphabet = computed(() => store.alphabet);\r\n\r\n        const temp = ref('');\r\n\r\n        const resetAble = computed(() => {\r\n\r\n            return alphabet.value.length !== 2 ||\r\n                !alphabet.value.every(v => v === 'a' || v === 'b');\r\n        })\r\n\r\n        return {\r\n            temp,\r\n            alphabet,\r\n            resetAlphabet: () => store.resetAlphabet(),\r\n            removeAlphabet: c => store.removeAlphabet(c),\r\n            addAlphabet: c => store.addAlphabet(c),\r\n\r\n            resetAble\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import { render } from \"./AlphabetLister.vue?vue&type=template&id=3a8c942e\"\nimport script from \"./AlphabetLister.vue?vue&type=script&lang=js\"\nexport * from \"./AlphabetLister.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div>\r\n        <v-dialog\r\n            @click:outside=\"cancel\"\r\n            v-model=\"open\"\r\n            width=\"auto\"\r\n            min-width=\"300px\">\r\n            <v-sheet class=\"flex gap-2 p-4 pt-3 flex-col\">\r\n                <div class=\"text-2xl pb-1\">Create Transition \r\n                    <div class=\"text-subtitle-1 text-neutral-400\">\r\n                        {{ modeStore.linkStart }} → {{ modeStore.linkEnd }}\r\n                    </div>\r\n                </div>\r\n                <v-autocomplete\r\n                    clearable\r\n                    chips\r\n                    label=\"Transition\"\r\n                    :items=\"alphabet\"\r\n                    multiple\r\n                    hide-details\r\n                    variant=\"outlined\"\r\n                    v-model=\"selectedItems\"\r\n                    density=\"compact\"\r\n                    closable-chips\r\n                    >\r\n\r\n                </v-autocomplete>\r\n                <div>\r\n                    <v-btn :disabled=\"selectedItems.length === 0\" block color=\"success\" @click=\"add\">\r\n                        Add\r\n                    </v-btn>\r\n                </div>\r\n            </v-sheet>\r\n        </v-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useAlphabetStore } from '@/stores/alphabetStore';\r\nimport { useModeStore } from '@/stores/modeStore';\r\nimport { useTransitionStore } from '@/stores/transitionStore';\r\nimport { useMainStore } from '@/stores/mainStore';\r\nimport { watch } from 'vue';\r\nimport { ref } from 'vue';\r\nimport { computed } from 'vue';\r\n\r\nexport default {\r\n    setup () {\r\n        const modeStore = useModeStore();\r\n        const alphabetStore = useAlphabetStore();\r\n        const transitionStore = useTransitionStore();\r\n        const mainStore = useMainStore();\r\n\r\n        const open = computed({\r\n            get: () => modeStore.openTransitionDialog,\r\n            set: v => modeStore.openTransitionDialog = v\r\n        });\r\n\r\n        watch(open, v => {\r\n            const { linkStart: start, linkEnd: end } = modeStore;\r\n            // Find existing label\r\n            const ex = transitionStore.getTransition(start, end);\r\n            if(ex === undefined) return;\r\n\r\n            selectedItems.value.push(...ex.v);\r\n\r\n            mainStore.inputFocus();\r\n        })\r\n\r\n        const alphabet = computed(() => alphabetStore.alphabet);\r\n        const selectedItems = ref([]);\r\n\r\n        const cancel = () => {\r\n            modeStore.linkReset();\r\n            selectedItems.value.splice(0);\r\n        }\r\n\r\n        const add = () => {\r\n\r\n            transitionStore.addTransition({\r\n                labels: [...selectedItems.value],\r\n                from: modeStore.linkStart,\r\n                to: modeStore.linkEnd\r\n            })\r\n\r\n            selectedItems.value.splice(0);\r\n            open.value = false;\r\n            modeStore.linkReset();\r\n            modeStore.mode = 'default';\r\n        }\r\n\r\n        return {\r\n            open,\r\n            alphabet,\r\n            modeStore,\r\n            selectedItems,\r\n            \r\n            cancel,\r\n            add,\r\n\r\n            transitionStore,\r\n            modeStore\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import { render } from \"./TransitionFab.vue?vue&type=template&id=8c3ff66a\"\nimport script from \"./TransitionFab.vue?vue&type=script&lang=js\"\nexport * from \"./TransitionFab.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div v-if=\"state !== undefined\" class=\"flex flex-grow flex-col gap-2\">\r\n        <div class=\"flex justify-between items-end\">\r\n            <div class=\"text-2xl\">State</div>\r\n            <span class=\"text-caption text-neutral-500\">[{{ state.pos.x }}, {{ state.pos.y }}]</span>\r\n        </div>\r\n        <div>\r\n            <v-text-field\r\n                v-model=\"state.label\"\r\n                hide-details\r\n                variant=\"solo-filled\"\r\n                label=\"State Label\"\r\n                clearable>\r\n\r\n            </v-text-field>\r\n        </div>\r\n        <div>\r\n            <v-btn\r\n                block\r\n                color=\"#DC143C\"\r\n                @click=\"stateStore.removeState(label)\">\r\n                Delete State\r\n            </v-btn>\r\n        </div>\r\n\r\n        <div class=\"px-2\">\r\n            <div>\r\n                <v-switch\r\n                    hide-details\r\n                    density=\"compact\"\r\n                    v-model=\"tempIsStart\"\r\n                    :label=\"'Starting State'\">\r\n                </v-switch>\r\n            </div>\r\n            <div>\r\n            <v-switch\r\n                hide-details\r\n                density=\"compact\"\r\n                v-model=\"state.isFinish\"\r\n                :label=\"'Ending State'\">\r\n            </v-switch>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"text-subtitle-1\">\r\n            Transitions\r\n        </div>\r\n\r\n        <div class=\"flex flex-col flex-grow gap-2\">\r\n            <div v-for=\"(t, index) in transArr\" :key=\"t.to\"\r\n            class=\"flex gap-2\">\r\n                <div class=\"text-button w-12 flex justify-center items-center overflow-hidden\">\r\n                    <v-btn @click=\"setSelectedState(t.to)\">\r\n                        {{ t.to }}\r\n                    </v-btn>\r\n                </div>\r\n                <div class=\"flex-grow\">\r\n                    <v-autocomplete \r\n                        clearable\r\n                        chips\r\n                        label=\"Labels\"\r\n                        :items=\"alphabet\"\r\n                        multiple\r\n                        hide-details\r\n                        variant=\"outlined\"\r\n                        @update:model-value=\"v => updateTransition(t.to, v, index)\"\r\n                        v-model=\"t.vs\"\r\n                        density=\"compact\"/>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"flex flex-col gap-2\">\r\n\r\n            <v-divider></v-divider>\r\n\r\n            <div class=\"flex gap-2\">\r\n                <div class=\"w-12\">\r\n                    <v-autocomplete \r\n                        hide-details\r\n                        density=\"compact\"\r\n                        append-icon=\"\"\r\n                        variant=\"outlined\"\r\n                        :items=\"stateList\"\r\n                        v-model=\"tempLabel\"/>\r\n                </div>\r\n                <div class=\"flex-grow\">\r\n                    <v-autocomplete \r\n                        clearable\r\n                        chips\r\n                        label=\"Transition\"\r\n                        :items=\"alphabet\"\r\n                        append-icon=\"\"\r\n                        multiple\r\n                        hide-details\r\n                        variant=\"outlined\"\r\n                        v-model=\"tempTransitions\"\r\n                        density=\"compact\"/>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <v-btn block color=\"success\" @click=\"addTransition\"> \r\n                    Add Transition\r\n                </v-btn>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useAlphabetStore } from '@/stores/alphabetStore';\r\nimport { useMainStore } from '@/stores/mainStore';\r\nimport { useStateStore } from '@/stores/stateStore';\r\nimport { useTransitionStore } from '@/stores/transitionStore';\r\nimport { reactive } from 'vue';\r\nimport { ref } from 'vue';\r\nimport { watch } from 'vue';\r\nimport { computed } from 'vue';\r\n\r\nexport default {\r\n    setup () {\r\n        const mainStore = useMainStore(),\r\n            transitionStore = useTransitionStore(),\r\n            alphabetStore = useAlphabetStore(),\r\n            stateStore = useStateStore();\r\n\r\n        const state = computed(() => mainStore.selected),\r\n            label = computed(() => state.value?.label),\r\n            alphabet = computed(() => alphabetStore.alphabet);\r\n\r\n        const transArr = reactive([]);\r\n\r\n        const associatedTransitions = computed(() => transitionStore.getTransitionsFrom(label.value));\r\n\r\n        const stateList = computed(() => stateStore.states.map(v =>  v.label)),\r\n            tempLabel = ref(''), tempTransitions = ref([]);\r\n\r\n        function updateTransArr(){\r\n            transArr.splice(0);\r\n            associatedTransitions.value.forEach(at => {\r\n                transArr.push({\r\n                    to: at.to.label,\r\n                    vs: [...at.v]\r\n                })\r\n            })\r\n        }\r\n\r\n        \r\n        const tempIsStart = ref(false);\r\n\r\n        watch(tempIsStart, v => {\r\n            if(v) stateStore.setStart(label.value);\r\n            else if(state.value) state.value.isStart = false;\r\n        })\r\n\r\n        watch(label, v => {\r\n            transArr.splice(0);\r\n            tempIsStart.value = false;\r\n            if(v === undefined) return;\r\n            updateTransArr();\r\n            tempIsStart.value = state.value.isStart;\r\n        })\r\n\r\n        const updateTransition = (to, v, index) => {\r\n            if(v.length === 0){\r\n                transitionStore.removeTransition(label.value, to);\r\n                transArr.splice(index, 1);\r\n                return;\r\n            }\r\n\r\n            transitionStore.addTransition({\r\n                labels: [...v],\r\n                from: label.value,\r\n                to: to\r\n            })\r\n        }   \r\n\r\n        const setSelectedState = label => {\r\n            const ts = stateStore.getState(label);\r\n            mainStore.select(ts);\r\n        }\r\n\r\n        const addTransition = () => {\r\n            transitionStore.addTransition({\r\n                labels: [...tempTransitions.value],\r\n                from: label.value,\r\n                to: tempLabel.value\r\n            })\r\n\r\n            updateTransArr();\r\n        }\r\n\r\n        return {\r\n            state,\r\n            label,\r\n            associatedTransitions,\r\n            alphabet,\r\n            updateTransition,\r\n            transArr,\r\n            setSelectedState,\r\n            stateStore,\r\n            stateList,\r\n            tempLabel,\r\n            tempTransitions,\r\n            addTransition,\r\n            tempIsStart\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import { render } from \"./StateHelper.vue?vue&type=template&id=7f9d176e\"\nimport script from \"./StateHelper.vue?vue&type=script&lang=js\"\nexport * from \"./StateHelper.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=1f93b7ed\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=1f93b7ed&lang=scss\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","// Styles\nimport '@mdi/font/css/materialdesignicons.css'\nimport 'vuetify/styles'\n\n// Vuetify\nimport { createVuetify } from 'vuetify'\nimport * as directives from 'vuetify/directives';\nimport * as components from 'vuetify/components';\n\nexport default createVuetify({\n  directives,\n  components,\n  theme: {\n    defaultTheme: 'dark'\n  }\n})","/**\n * plugins/webfontloader.js\n *\n * webfontloader documentation: https://github.com/typekit/webfontloader\n */\n\nexport async function loadFonts () {\n  const webFontLoader = await import(/* webpackChunkName: \"webfontloader\" */'webfontloader')\n\n  webFontLoader.load({\n    google: {\n      families: ['Roboto:100,300,400,500,700,900&display=swap'],\n    },\n  })\n}\n","import { createApp } from 'vue'\r\nimport App from './App.vue'\r\nimport './index.css';\r\nimport vuetify from './plugins/vuetify'\r\nimport { loadFonts } from './plugins/webfontloader'\r\nimport { createPinia } from 'pinia'\r\nconst pinia = createPinia()\r\n\r\nloadFonts()\r\n\r\ncreateApp(App)\r\n  .use(pinia)\r\n  .use(vuetify)\r\n  .mount('#app')\r\n","/*\n * noam - JavaScript library for working with automata and grammars for \n *        regular and context-free languages. https://github.com/izuzak/noam\n *\n * Copyright 2012 Ivan Zuzak, Ivan Budiselic\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function (noam) {\n\n  /*\n   * Expose the module to the 'world' when loaded via CommonJS/NodeJS, \n   * AMD and <script> tags.\n   */\n\n  if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n    module.exports = noam; // NodeJS\n  }\n  \n  if (typeof exports !== 'undefined' && typeof exports !== \"function\") {\n    exports.noam = noam; // CommonJs\n  }\n\n  if (typeof define === \"function\" && define.amd) {\n    define('noam', [], function () { return noam; } ); // AMD\n  }\n\n  if (typeof window !== 'undefined') {\n    window.noam = noam;  // <script>\n  }\n\n}((function () {\n\n  var noam = {};\n\n  noam.util = {};\n\n  // \"deep\" compare of two objects\n  // taken from http://stackoverflow.com/questions/1068834/object-comparison-in-javascript\n  noam.util.areEquivalent = function(object1, object2) {\n    if (object1 === object2) {\n      return true;\n    }\n\n    if (object1 instanceof Date && object2 instanceof Date) {\n      return object1.getTime() === object2.getTime();\n    }\n\n    if (object1 instanceof RegExp && object2 instanceof RegExp) {\n      return object1.source === object2.source &&\n             object1.global === object2.global &&\n             object1.multiline === object2.multiline &&\n             object1.lastIndex === object2.lastIndex &&\n             object1.ignoreCase === object2.ignoreCase;\n    }\n\n    if (!(object1 instanceof Object) || !(object2 instanceof Object) ) {\n      return false;\n    }\n\n    if (typeof object1 === 'undefined' || typeof object2 === 'undefined') {\n      return false;\n    }\n\n    if (object1.constructor !== object2.constructor) {\n      return false;\n    }\n\n    for (var p in object1) {\n      if (!(p in object2)) {\n        return false;\n      }\n\n      if (object1[p] === object2[p]) {\n        continue;\n      }\n\n      if (typeof(object1[p]) !== \"object\") {\n        return false;\n      }\n\n      if (!(noam.util.areEquivalent(object1[p], object2[p]))) {\n        return false;\n      }\n    }\n\n    for (p in object2) {\n      if (!(p in object1)) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  // check if array arr contains obj starting from index startIndex\n  noam.util.contains = function(arr, obj, startIndex) {\n    startIndex = startIndex ? startIndex : 0;\n\n    for (var i=startIndex; i<arr.length; i++) {\n      if (noam.util.areEquivalent(arr[i], obj)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // returns the index of the leftmost obj instance in arr starting from startIndex or -1\n  // if no instance of obj is found\n  noam.util.index = function(arr, obj, startIndex) {\n    var i = startIndex || 0;\n    while (i < arr.length) {\n      if (noam.util.areEquivalent(arr[i], obj)) {\n        return i;\n      }\n      i++;\n    }\n    return -1;\n  };\n\n  // check if array arr1 contains all elements from array arr2\n  noam.util.containsAll = function(arr1, arr2) {\n    for (var i=0; i<arr2.length; i++) {\n      if (!(noam.util.contains(arr1, arr2[i]))) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  // check if array arr1 contains any element from array arr2\n  noam.util.containsAny = function(arr1, arr2) {\n    for (var i=0; i<arr2.length; i++) {\n      if (noam.util.contains(arr1, arr2[i])) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // check if arrays arr1 and arr2 contain the same elements\n  noam.util.areEqualSets = function(arr1, arr2) {\n    if (arr1.length !== arr2.length) {\n      return false;\n    }\n\n    for (var i=0; i<arr1.length; i++) {\n      if (!(noam.util.contains(arr2, arr1[i]))) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  // check if array arr1 contains the set obj\n  noam.util.containsSet = function(arr1, obj) {\n    for (var i=0; i<arr1.length; i++) {\n      if (noam.util.areEqualSets(arr1[i], obj)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // returns an unsorted array representation of the union of the two arrays arr1 and arr2\n  // with each element included exactly once, regardless of the count in arr1 and arr2\n  noam.util.setUnion = function(arr1, arr2) {\n    var res = [];\n    var i;\n    for (i=0; i<arr1.length; i++) {\n      // this will not include duplicates from arr1\n      if (!noam.util.contains(res, arr1[i])) {\n        res.push(arr1[i]);\n      }\n    }\n    for (i=0; i<arr2.length; i++) {\n      if (!noam.util.contains(res, arr2[i])) {\n        res.push(arr2[i]);\n      }\n    }\n    return res;\n  };\n\n  // returns an unsorted array representation of the intersection of the two\n  // arrays arr1 and arr2 with each element included exactly once, regardless\n  // of the count in arr1 and arr2\n  noam.util.setIntersection = function(arr1, arr2) {\n    var res = [];\n    var i;\n    for (i=0; i<arr1.length; i++) {\n      if (noam.util.contains(arr2, arr1[i])) {\n        res.push(arr1[i]);\n      }\n    }\n\n    return res;\n  };\n\n  // make a deep clone of an object\n  noam.util.clone = function(obj) {\n    return JSON.parse(JSON.stringify(obj));\n  };\n\n\n  // Returns an object that is basically an integer reference useful for counting\n  // across multiple function calls. The current value can be accessed through the\n  // value property.\n  // See the noam.re.tree.toAutomaton function for a usage example.\n  noam.util.makeCounter = (function() {\n    function getAndAdvance() {\n      return this.value++;\n    }\n\n    function makeCounter(init) {\n      return {\n        value: init,\n        getAndAdvance: getAndAdvance\n      };\n    }\n\n    return makeCounter;\n  })();\n\n\n  // Returns a random integer from the interval [from, to].\n  noam.util.randint = function(from, to) {\n    return Math.floor(Math.random()*(to-from+1)) + from;\n  };\n\n  var structure = {};\n\n  /* General purpose hashtable implementation.\n   * Note that all the performance guarantees assume (as usual for hashtables) that\n   *    1) hashing keys is O(1)\n   *    2) comparing keys for equality is O(1)\n   *    3) array access in JS is O(1)\n   * In other words, the guarantees specify the number of these\n   * three operations for any hashtable operation, rather than\n   * actual time.\n   */\n  (function() {\n    var CAPACITY_CHOICES = [5, 11, 23, 47, 97, 197, 397, 797, 1597, 3203, 6421, 12853,\n        25717, 51437, 102877, 205759, 411527, 823117, 1646237, 3292489, 6584983,\n        13169977, 26339969, 52679969, 105359939];\n\n    var DEFAULT_INITIAL_CAPACITY_IDX = 0;\n    var HASH_MASK = (1<<31) - 1; // keeps everything nonnegative int32\n    var LF_HIGH = 0.75; // load factor upper limit\n    var LF_LOW = 0.25; // load factor lower limit\n\n    // See http://perfectionkills.com/instanceof-considered-harmful-or-how-to-write-a-robust-isarray/\n    function _isArray(obj) {\n      return Object.prototype.toString.call(obj) === \"[object Array]\";\n    }\n\n    function _get_capacity_index(wanted) {\n      wanted = Math.max(wanted, CAPACITY_CHOICES[0]);\n      wanted = Math.min(wanted, CAPACITY_CHOICES[CAPACITY_CHOICES.length-1]);\n      var lo = 0;\n      var hi = CAPACITY_CHOICES.length - 1;\n      var mid;\n      // binary search for the smallest capacity no smaller than wanted\n      while (lo < hi) {\n        mid = lo + Math.floor((hi-lo)/2);\n        if (CAPACITY_CHOICES[mid] >= wanted) {\n          hi = mid;\n        } else {\n          lo = mid + 1;\n        }\n      }\n      return lo;\n    }\n\n    // TODO: needs serious testing\n    function _defaultHash(obj) {\n      var h, i;\n      if (obj === undefined) { // undefined might be a \"value\" of some property\n        return 12345; // arbitrary constant\n      }\n      if (obj === null) {\n        return 54321; // arbitrary constant\n      }\n      if (typeof obj===\"boolean\" || typeof obj===\"number\") {\n        return obj & HASH_MASK;\n      }\n      if (typeof obj===\"string\") {\n        h = 5381;\n        for (i=0; i<obj.length; i++) {\n          h = ((h*33) ^ obj.charCodeAt(i)) & HASH_MASK;\n        }\n        return h;\n      }\n      if (_isArray(obj)) {\n        h = 6421;\n        for (i=0; i<obj.length; i++) {\n          h = ((h*37) ^ _defaultHash(obj[i])) & HASH_MASK;\n        }\n        return h;\n      }\n\n      // objects\n      var props = [];\n      for (i in obj) {\n        if (!(obj.hasOwnProperty(i))) {\n          continue;\n        }\n        props.push(i);\n      }\n      props.sort(); // sort them so that logically equal object get the same hash\n\n      h = 3203;\n      for (i=0; i<props.length; i++) {\n        // hash both the property name and its value\n        h = ((((h*39) ^ _defaultHash(props[i])) * 43) ^ _defaultHash(obj[props[i]])) & HASH_MASK;\n      }\n      return h;\n    }\n\n    // \"deep\" compare of two objects\n    // taken from http://stackoverflow.com/questions/1068834/object-comparison-in-javascript\n    function _defaultEquals(object1, object2) {\n      if (object1 === object2) {\n        return true;\n      }\n\n      if (object1 instanceof Date && object2 instanceof Date) {\n        return object1.getTime() === object2.getTime();\n      }\n\n      if (object1 instanceof RegExp && object2 instanceof RegExp) {\n        return object1.source === object2.source &&\n               object1.global === object2.global &&\n               object1.multiline === object2.multiline &&\n               object1.lastIndex === object2.lastIndex &&\n               object1.ignoreCase === object2.ignoreCase;\n      }\n\n      if (!(object1 instanceof Object) || !(object2 instanceof Object) ) {\n        return false;\n      }\n\n      if (typeof object1 === 'undefined' || typeof object2 === 'undefined') {\n        return false;\n      }\n\n      if (object1.constructor !== object2.constructor) {\n        return false;\n      }\n\n      for (var p in object1) {\n        if (!(p in object2)) {\n          return false;\n        }\n\n        if (object1[p] === object2[p]) {\n          continue;\n        }\n\n        if (typeof(object1[p]) !== \"object\") {\n          return false;\n        }\n\n        if (!(_defaultEquals(object1[p], object2[p]))) {\n          return false;\n        }\n      }\n\n      for (p in object2) {\n        if (!(p in object1)) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    /* Constructor for hash chain nodes.\n     *\n     * Each node has three properties:\n     *  - key: the key of the key-value pair\n     *  - value: the value of the key-value pair\n     *  - next: either another _HashChainNode or undefined if this is the last node\n     *          of the chain\n     */\n    function _HashChainNode(key, value) {\n      this.key = key;\n      this.value = value;\n    }\n\n    /* Constructor for an empty hash chain used for collision resolution.\n     *\n     * Every _HashChain has just one property:\n     *  - head: the first _HashChainNode of the chain or undefined if the chain is\n     *          empty\n     */\n    function _HashChain() {\n      // intentionally empty\n    }\n\n    // Returns true iff the chain is empty.\n    _HashChain.prototype.isEmpty = function() {\n      return this.head === undefined;\n    };\n\n    // Adds the new node to the front of the chain.\n    _HashChain.prototype.insertHead = function(node) {\n      node.next = this.head;\n      this.head = node;\n    };\n\n    /* Removes the successor of @a node from the chain. It is assumed that\n     * the successor exists.\n     *\n     * If @a node equals undefined, removes the head of the chain.\n     */\n    _HashChain.prototype.removeSuccessor = function(node) {\n      if (node === undefined) {\n        this.head = this.head.next;\n      } else {\n        node.next = node.next.next;\n      }\n    };\n\n    /* Inserts the key-value pair into the chain.\n     * @a H is the HashTable that contains this chain.\n     *\n     * Returns true iff @a key is a new key that was not previously in the table.\n     */\n    _HashChain.prototype.put = function(H, key, value) {\n      // first search for the key\n      var iter = this.iterator();\n      while (iter.hasNext()) {\n        var node = iter.next();\n        if (H.equals(key, node.key)) {\n          // old key; just replace the value\n          node.value = value;\n          return false;\n        }\n      }\n      // new key\n      this.insertHead(new _HashChainNode(key, value));\n      return true;\n    };\n\n    /* Returns the value associated with @a key in the chain or undefined\n     * if @a key is not found in the chain.\n     */\n    _HashChain.prototype.get = function(H, key) {\n      var iter = this.iterator();\n      while (iter.hasNext()) {\n        var node = iter.next();\n        if (H.equals(key, node.key)) {\n          return node.value;\n        }\n      }\n      return undefined;\n    };\n\n    /* Removes the key-value pair with the given key from the chain. Does nothing\n     * if there is no key-value pair with the given key in the chain.\n     *\n     * Returns true iff a key-value pair was actually removed.\n     */\n    _HashChain.prototype.remove = function(H, key) {\n      var iter = this.iterator();\n      var prev; // intentionally undefined\n      while (iter.hasNext()) {\n        var node = iter.next();\n        if (H.equals(key, node.key)) {\n          this.removeSuccessor(prev);\n          return true;\n        }\n        prev = node;\n      }\n      return false;\n    };\n\n    /* Constructor for a hash chain iterator.\n     *\n     * Every iterator has two methods:\n     *  - hasNext: returns true iff there is another node in the chain\n     *  - next: returns the next node in the chain or throws if the iterator is\n     *          exhausted\n     *\n     * If the hash chain changes in any way between the construction of the\n     * iterator and a call to one of its methods, the behavior is undefined.\n     */\n    function _HashChainIterator(chain) {\n      this.node = chain.head;\n    }\n    _HashChainIterator.prototype.hasNext = function() {\n      return this.node !== undefined;\n    };\n    _HashChainIterator.prototype.next = function() {\n      if (!this.hasNext()) {\n        throw new Error(\"HashTable internal error: \" +\n            \"called _HashChainIterator.next on exhausted iterator\");\n      }\n      var retval = this.node;\n      this.node = retval.next;\n      return retval;\n    };\n\n    // Returns a new iterator for the hash chain.\n    _HashChain.prototype.iterator = function() {\n      return new _HashChainIterator(this);\n    };\n\n\n    /* Resizes the HashTable @a H to have capacity CAPACITY_CHOICES[to_cap_idx].\n     * Throws if @a to_cap_idx >= CAPACITY_CHOICES.length.\n     * Does nothing if @a to_cap_idx < 0, i.e. the HashTable never decreases below\n     * CAPACITY_CHOICES[0] capacity.\n     *\n     * Takes O(n) time where n is the number of mappings in the HashTable.\n     */\n    function _resize(H, to_cap_idx) {\n      if (to_cap_idx >= CAPACITY_CHOICES.length) {\n        throw new Error(\"Capacity of HashTable can't grow beyond \" + CAPACITY_CHOICES[CAPACITY_CHOICES.length - 1]);\n      }\n      if (to_cap_idx >= 0) {\n        var old_cap = H.capacity;\n        var old_slots = H.slots;\n\n        H.capacity_index = to_cap_idx;\n        H.capacity = CAPACITY_CHOICES[to_cap_idx];\n        H.slots = [];\n        for (var i=0; i<old_cap; i++) {\n          if (old_slots[i] !== undefined) {\n            var chain_iter = old_slots[i].iterator();\n            while (chain_iter.hasNext()) {\n              H._putNodeRsz(chain_iter.next());\n            }\n          }\n        }\n      }\n    }\n\n    // Returns the slot index for @a key in the hashtable @a H.\n    function _getSlotIndex(H, key) {\n      return H.hash(key) % H.capacity; // division method\n    }\n\n    /* Constructor for HashTable. To create an empty HashTable, do something like\n     * var H = new structure.HashTable();\n     *\n     * @a cfg is optional and can contain any or all of the following properties\n     *    - initial_capacity: a number that is a hint for the initial capacity\n     *        - defaults to an implementation defined number\n     *    - hash: a function that takes an object and returns a nonnegative 32-bit integer\n     *        - the usual requirements for this function apply\n     *           - it must be consistent, i.e. return the same value for the same object\n     *             (if the object doesn't change)\n     *           - if two objects are equal by the client's definition of equality,\n     *             this function must return the same value for both of them\n     *        - defaults to _defaultHash\n     *   - equals: a function that takes two objects and returns true iff they are logically equal\n     *        - the usual requirements for this function apply\n     *           - it must be reflexive, symmetric and transitive\n     *           - it must be consistent i.e. return the same value for unchanged arguments every\n     *             time it's called\n     *        - defaults to _defaultEqauls\n     *\n     * If you provide either hash or equals, you probably want to provide both\n     */\n    structure.HashTable = function(cfg) {\n      this.capacity_index = DEFAULT_INITIAL_CAPACITY_IDX;\n      if (cfg) {\n        if (cfg.initial_capacity) {\n          this.capacity_index = _get_capacity_index(cfg.initial_capacity);\n        }\n        if (cfg.hash) { // otherwise we use the prototype one\n          this.hash = cfg.hash;\n        }\n        if (cfg.equals) { // otherwise we use the prototype one\n          this.equals = cfg.equals;\n        }\n      }\n\n      // this is redundan't information, but keeps code somewhat cleaner\n      this.capacity = CAPACITY_CHOICES[this.capacity_index];\n      this.numkeys = 0; // start out empty\n\n      // we will use undefined as the indicator for empty slots so\n      // we don't actually need to \"allocate\" the capacity because\n      // JS arrays don't actually have bounds and a[i] returns\n      // undefined if the ith element is \"out of bounds\"...\n      // however, take care to never use this.slots.length as it will\n      // be meaningless\n      this.slots = [];\n    };\n\n    // defaults for hash and equals\n    structure.HashTable.prototype.hash = _defaultHash;\n    structure.HashTable.prototype.equals = _defaultEquals;\n\n    // Returns the load factor of the HashTable, i.e. the ratio\n    // of occupied slots to the capacity.\n    structure.HashTable.prototype.loadFactor = function() {\n      return this.numkeys / this.capacity;\n    };\n\n    /* Add the key-value pair to the HashTable.\n     * Throws if @a key or @a value equals undefined.\n     *\n     * Takes O(1) time amortized, assuming uniform hashing.\n     *\n     * Only references to the key and value are stored, i.e. the client must do defensive\n     * copies if they are required. If the key is mutable and changes after this operation\n     * is performed, the behavior is undefined (the HashTable will most likely become\n     * invalid and unpredictibly useless).\n     * Changes to the value object are allowed but are in most situations probably\n     * an indicator of bad design.\n     */\n    structure.HashTable.prototype.put = function(key, value) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.put with key === undefined\");\n      }\n\n      if (value === undefined) {\n        throw new Error(\"called HashTable.put with value === undefined\");\n      }\n\n      var h = _getSlotIndex(this, key);\n      if (this.slots[h] === undefined) {\n        this.slots[h] = new _HashChain();\n      }\n      if (this.slots[h].put(this, key, value)) {\n        ++this.numkeys;\n        if (this.loadFactor() > LF_HIGH) {\n          _resize(this, this.capacity_index + 1);\n        }\n      }\n    };\n\n    /* This is an internal put method that reuses existing _HashChainNode objects\n     * to reduce garbage generation when the table gets resized.\n     *\n     * Don't use this outside of resizing functionality!\n     */\n    structure.HashTable.prototype._putNodeRsz = function(node) {\n      // we don't check the validity of node.key and node.value because\n      // it is assumed they are valid as they are already in a preexisting node\n      var h = _getSlotIndex(this, node.key);\n      if (this.slots[h] === undefined) {\n        this.slots[h] = new _HashChain();\n      }\n      // don't need to actually iterate the chain to search for matching keys\n      // because we know that the keys were unique prior to resizing\n      this.slots[h].insertHead(node);\n      // we don't check the load factor because we know that we have just\n      // recently resized so no further resizing will be needed\n    };\n\n    /* Returns the value associated with @a key in the HashTable or\n     * undefined if @a key is not found.\n     *\n     * Throws if @a key equals undefined.\n     *\n     * Takes O(1) time, assuming uniform hashing.\n     */\n    structure.HashTable.prototype.get = function(key) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.get with key === undefined\");\n      }\n\n      var h = _getSlotIndex(this, key);\n      var slot = this.slots[h];\n      return slot===undefined ? undefined : slot.get(this, key);\n    };\n\n    /* Removes @a key from the HashTable. If @a key is not in the HashTable,\n     * this operation does nothing.\n     *\n     * Throws if @a key equals undefined.\n     *\n     * Takes O(1) time ammortized, assuming uniform hashing.\n     */\n    structure.HashTable.prototype.remove = function(key) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.remove with key === undefined\");\n      }\n\n      var h = _getSlotIndex(this, key);\n      var slot = this.slots[h];\n      if (slot === undefined) {\n        return;\n      }\n      if (slot.remove(this, key)) {\n        --this.numkeys;\n        if (this.loadFactor() < LF_LOW) {\n          _resize(this, this.capacity_index - 1);\n        }\n      }\n    };\n\n    // Returns true iff the HashTable is empty.\n    // O(1) time.\n    structure.HashTable.prototype.isEmpty = function() {\n      return this.numkeys === 0;\n    };\n\n    // Clears the HashTable, making it empty.\n    // O(1) time.\n    structure.HashTable.prototype.clear = function() {\n      this.capacity_index = DEFAULT_INITIAL_CAPACITY_IDX;\n      this.capacity = CAPACITY_CHOICES[this.capacity_index];\n      this.numkeys = 0;\n      this.slots = [];\n    };\n\n    // Returns the number of mappings in the HashTable.\n    // O(1) time.\n    structure.HashTable.prototype.size = function() {\n      return this.numkeys;\n    };\n\n    // Returns true iff @a key is in the HashTable.\n    // Equivalent to get(key) !== undefined.\n    structure.HashTable.prototype.containsKey = function(key) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.containsKey with key === undefined\");\n      }\n\n      return this.get(key) !== undefined;\n    };\n\n    // Returns an array with all the keys in the HashTable\n    structure.HashTable.prototype.keys = function() {\n      var keys = [];\n\n      for (var it = this.keyIterator(); it.hasNext(); ) {\n        keys.push(it.next());\n      }\n\n      return keys;\n    };\n\n    // Returns an array with all the values in the HashTable\n    structure.HashTable.prototype.values = function() {\n      var values = [];\n\n      for (var it = this.valueIterator(); it.hasNext(); ) {\n        values.push(it.next());\n      }\n\n      return values;\n    };\n\n    // Returns an array with all the key-value pairs in the HashTable\n    structure.HashTable.prototype.entries = function() {\n      var entries = [];\n\n      for (var it = this.keyValueIterator(); it.hasNext(); ) {\n        entries.push(it.next());\n      }\n\n      return entries;\n    };\n\n    // Iterators internals. The API is below.\n    var Iterator = {\n      hasNext: function() {\n        // first try the current chain iterator\n        if (this.cur_chain_iterator!==undefined && this.cur_chain_iterator.hasNext()) {\n          return true;\n        }\n        if (this.cur_chain_iterator !== undefined) {\n          ++this.idx; // this chain iterator was exhausted\n        }\n        // try to find another chain\n        while (this.idx<this.H.capacity &&\n            (this.H.slots[this.idx]===undefined || // no chain OR\n             this.H.slots[this.idx].isEmpty())) {  // empty chain\n          ++this.idx;\n        }\n        var slotval = this.H.slots[this.idx];\n        if (slotval === undefined) { // no more chains in the table\n          this.cur_chain_iterator = undefined;\n          return false;\n        }\n        this.cur_chain_iterator = slotval.iterator();\n        return true; // we know this chain isn't empty so just return true\n      },\n      // @a err_msg is the message to throw if the iterator is empty\n      // @a extract_next is a function that takes the iterator as its only\n      // parameter and returns the required item\n      _next: function(err_msg, extract_next) {\n        if (!this.hasNext()) {\n          throw new Error(err_msg);\n        }\n        //assert(this.H.keys[this.idx] !== undefined);\n        var retval = extract_next(this);\n        return retval;\n      },\n      // invoke function @a iterator_func with context @a context on each\n      // element of the iterable collection\n      each: function(iterator_func, context) {\n        if (iterator_func === undefined) {\n          throw new Error(\"called iterator.each with iterator_func === undefined\");\n        }\n\n        for (var i=0, it = this; this.hasNext(); i++) {\n          iterator_func.call(context, this.next(), i, this.H);\n        }\n      }\n    };\n\n    function _KeyIterator(H) {\n      this.idx = 0;\n      this.H = H;\n    }\n    _KeyIterator.prototype = Object.create(Iterator);\n    _KeyIterator.prototype.next = function() {\n      return this._next(\"KeyIterator.next called on empty iterator\", function(it) {\n        return it.cur_chain_iterator.next().key;\n      });\n    };\n\n    function _ValueIterator(H) {\n      this.idx = 0;\n      this.H = H;\n    }\n    _ValueIterator.prototype = Object.create(Iterator);\n    _ValueIterator.prototype.next = function() {\n      return this._next(\"ValueIterator.next called on empty iterator\", function(it) {\n        return it.cur_chain_iterator.next().value;\n      });\n    };\n\n    function _KeyValueIterator(H) {\n      this.idx = 0;\n      this.H = H;\n    }\n    _KeyValueIterator.prototype = Object.create(Iterator);\n    _KeyValueIterator.prototype.next = function() {\n      return this._next(\"KeyValueIterator.next called on empty iterator\", function(it) {\n        var node = it.cur_chain_iterator.next();\n        return [node.key, node.value];\n      });\n    };\n\n    /* Iterator API\n     *\n     * HashTable supports three iterators for iteration over keys, values\n     * and key-value pairs.\n     * The iterator is returned by the appropriate *Iterator\n     * function on the hashtable. All three iterators have two methods\n     *   - hasNext: Returns true iff there is at least one more item to iterate over.\n     *   - next: Returns the next item from the iterator, or throws if the iterator is\n     *           exhausted. It is guaranteed that next does not throw if a preceeding\n     *           call to hasNext returned true.\n     *   - each: Iterates over all elements in the collection, invoking a function on\n     *           each element. The function is passed a reference to the element, the\n     *           index of the element and a reference to the hashtable.\n     *\n     * If the HashTable changes in any way during iteration (e.g. by calling put, remove or clear),\n     * the iterator is invalidated and the behavior of subsequent calls to hasNext or next is undefined.\n     *\n     * All three iterators iterate over the whole HashTable in O(n) time where n is the number of mappings\n     * in the table.\n     *\n     * The KeyValueIterator's next method returns arrays of length two where the first element is the key\n     * and the second element is the value.\n     */\n    structure.HashTable.prototype.keyIterator = function() {\n      return new _KeyIterator(this);\n    };\n    structure.HashTable.prototype.valueIterator = function() {\n      return new _ValueIterator(this);\n    };\n    structure.HashTable.prototype.keyValueIterator = function() {\n      return new _KeyValueIterator(this);\n    };\n\n  })();\n\n  // import structure.HashTable into noam.util\n  noam.util.HashTable = structure.HashTable;\n  delete structure; // don't need structure any more\n\n  noam.fsm = {};\n\n  noam.fsm.epsilonSymbol = '$';\n  noam.fsm.dfaType = 'DFA';\n  noam.fsm.nfaType = 'NFA';\n  noam.fsm.enfaType = 'eNFA';\n\n  // FSM creation API\n\n  // Creates and returns an empty FSM that can then be manipulated through the other\n  // functions in the API.\n  noam.fsm.makeNew = function() {\n    return {\n      states: [],\n      alphabet: [],\n      acceptingStates: [],\n      initialState: undefined,\n      transitions: []\n    };\n  };\n\n  // Common internal implementation for addState and addSymbol.\n  noam.fsm._addStateOrSymbol = function(arr, obj, undefErrorMsg, existsErrorMsg) {\n    // need to check this because undefined would otherwise be added as a state\n    // or symbol which is probably not what you want\n    if (obj === undefined) {\n      throw new Error(undefErrorMsg);\n    }\n    if (noam.util.contains(arr, obj)) {\n      throw new Error(existsErrorMsg);\n    }\n\n    arr.push(obj);\n    return obj;\n  };\n\n  // Adds stateObj as a state to the fsm.\n  // Throws an Error if no stateObj is passed or if the same state already exists.\n  // Returns the added state object.\n  noam.fsm.addState = function(fsm, stateObj) {\n    return noam.fsm._addStateOrSymbol(fsm.states, stateObj,\n        \"No state object specified\", \"State already exists\");\n  };\n\n  // Adds symObj as an alphabet symbol to the fsm.\n  // Throws an Error if no symObj is passed or if the same symbol already exists.\n  // Returns the added symbol object.\n  noam.fsm.addSymbol = function(fsm, symObj) {\n    if (noam.util.areEquivalent(symObj, noam.fsm.epsilonSymbol)) {\n      throw new Error(\"Can't add the epsilon symbol to the alphabet\");\n    }\n    return noam.fsm._addStateOrSymbol(fsm.alphabet, symObj,\n        \"No symbol object specified\", \"Symbol already exists\");\n  };\n\n  // Makes stateObj an accepting state of the fsm.\n  // Throws an Error if stateObj is not a state of the fsm or if it is already\n  // accepting.\n  noam.fsm.addAcceptingState = function(fsm, stateObj) {\n    if (!noam.util.contains(fsm.states, stateObj)) {\n      throw new Error(\"The specified object is not a state of the FSM\");\n    }\n    noam.fsm._addStateOrSymbol(fsm.acceptingStates, stateObj, \"\",\n        \"The specified state is already accepting\");\n  };\n\n  // Sets stateObj as the start state of the fsm.\n  // Throws an Error if stateObj is not a state of the fsm.\n  noam.fsm.setInitialState = function(fsm, stateObj) {\n    if (!noam.util.contains(fsm.states, stateObj)) {\n      throw new Error(\"The specified object is not a state of the FSM\");\n    }\n    fsm.initialState = stateObj;\n  };\n\n  // Common implementation for addTransition and addEpsilonTransition.\n  noam.fsm._addTransition = function(fsm, fromState, toStates, transitionSymbol) {\n    if (!Array.isArray(toStates)) {\n      throw new Error(\"The toStates argument must be an array\");\n    }\n    if (!noam.util.contains(fsm.states, fromState) ||\n        !noam.util.containsAll(fsm.states, toStates)) {\n      throw new Error(\"One of the specified objects is not a state of the FSM\");\n    }\n\n    var i;\n    var added = false;\n    for (i=0; i<fsm.transitions.length; i++) {\n      if (noam.util.areEquivalent(fromState, fsm.transitions[i].fromState) &&\n          noam.util.areEquivalent(transitionSymbol, fsm.transitions[i].symbol)) {\n        fsm.transitions[i].toStates = noam.util.setUnion(fsm.transitions[i].toStates, toStates);\n        added = true;\n        break;\n      }\n    }\n    if (!added) {\n      fsm.transitions.push({fromState: fromState, toStates: toStates, symbol: transitionSymbol});\n    }\n  };\n\n  // Adds a transition from fromState to the set of states represented by the array\n  // toStates, using transitionSymbol.\n  // If a transition for this pair of (fromState, transitionSymbol) already exists,\n  // toStates is added to the existing set of destination states.\n  // Throws an Error if any of the states is not actually in the fsm or if the\n  // transition symbol is not in the fsm's alphabeth.\n  // Note that this means that an Error will be thrown if you try to use this to\n  // specify an epsilon transition. For that, use addEpsilonTransition instead.\n  noam.fsm.addTransition = function(fsm, fromState, toStates, transitionSymbol) {\n    if (!noam.util.contains(fsm.alphabet, transitionSymbol)) {\n      throw new Error(\"The specified object is not an alphabet symbol of the FSM\");\n    }\n    noam.fsm._addTransition(fsm, fromState, toStates, transitionSymbol);\n  };\n\n  // Equivalent to addTransition except that there is no transition symbol, i.e. the\n  // transition can be executed without consuming an input symbol.\n  noam.fsm.addEpsilonTransition = function(fsm, fromState, toStates) {\n    noam.fsm._addTransition(fsm, fromState, toStates, noam.fsm.epsilonSymbol);\n  };\n\n  // end of FSM creation API\n\n  // validates a FSM definition\n  noam.fsm.validate = function(fsm) {\n    var i, j, k;\n\n    if (!(typeof fsm !== 'undefined' &&\n        Array.isArray(fsm.states) &&\n        Array.isArray(fsm.alphabet) &&\n        Array.isArray(fsm.acceptingStates) &&\n        typeof fsm.initialState !== 'undefined' && fsm.initialState !== null &&\n        Array.isArray(fsm.transitions))) {\n      throw new Error('FSM must be defined and have states, alphabet, acceptingStates, initialState and transitions array properties!');\n    }\n\n    if (fsm.states.length < 1) {\n      throw new Error('Set of states must not be empty.');\n    }\n\n    for (i=0; i<fsm.states.length; i++) {\n      if (noam.util.contains(fsm.states, fsm.states[i], i+1)) {\n        throw new Error('Equivalent states');\n      }\n    }\n\n    if (fsm.alphabet.length < 1) {\n      throw new Error('Alphabet must not be empty.');\n    }\n\n    for (i=0; i<fsm.alphabet.length; i++) {\n      if (noam.util.contains(fsm.alphabet, fsm.alphabet[i], i+1)) {\n        throw new Error('Equivalent alphabet symbols');\n      }\n    }\n\n    if (noam.util.contains(fsm.alphabet, noam.fsm.epsilonSymbol)) {\n      throw new Error('FSM alphabet must not contain the epsilon symbol');\n    }\n\n    for (i=0; i<fsm.alphabet.length; i++) {\n      if (noam.util.contains(fsm.states, fsm.alphabet[i])) {\n        throw new Error('States and alphabet symbols must not overlap');\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      if (noam.util.contains(fsm.acceptingStates, fsm.acceptingStates[i], i+1)) {\n        throw new Error('Equivalent acceptingStates');\n      }\n\n      if (!(noam.util.contains(fsm.states, fsm.acceptingStates[i]))) {\n        throw new Error('Each accepting state must be in states');\n      }\n    }\n\n    if (!(noam.util.contains(fsm.states, fsm.initialState))) {\n      throw new Error('Initial state must be in states');\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (typeof transition.fromState === 'undefined' ||\n          typeof transition.toStates === 'undefined' ||\n          typeof transition.symbol === 'undefined') {\n        throw new Error('Transitions must have fromState, toState and symbol');\n      }\n\n      if (!(noam.util.contains(fsm.states, transition.fromState))) {\n        throw new Error('Transition fromState must be in states.');\n      }\n\n      if (!(noam.util.contains(fsm.alphabet, transition.symbol)) &&\n          transition.symbol !== noam.fsm.epsilonSymbol) {\n        throw new Error('Transition symbol must be in alphabet.');\n      }\n\n      for (k=0; k<transition.toStates.length; k++) {\n        if (!(noam.util.contains(fsm.states, transition.toStates[k]))) {\n          throw new Error('Transition toStates must be in states.');\n        }\n\n        if (noam.util.contains(transition.toStates, transition.toStates[k], k+1)) {\n          throw new Error('Transition toStates must not contain duplicates.');\n        }\n      }\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      for (j=i+1; j<fsm.transitions.length; j++) {\n        if (fsm.transitions[i].fromState === fsm.transitions[j].fromState &&\n            fsm.transitions[i].symbol === fsm.transitions[j].symbol) {\n          throw new Error('Transitions for the same fromState and symbol must be defined in a single trainsition.');\n        }\n      }\n    }\n\n    return true;\n  };\n\n  // determine if stateObj is an accepting state in fsm\n  noam.fsm.isAcceptingState = function(fsm, stateObj) {\n    return noam.util.contains(fsm.acceptingStates, stateObj);\n  };\n\n  // determine fsm type based on transition function\n  noam.fsm.determineType = function(fsm) {\n    var fsmType = noam.fsm.dfaType;\n\n    for (var i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (transition.symbol === noam.fsm.epsilonSymbol) {\n        fsmType = noam.fsm.enfaType;\n        break;\n      } else if (transition.toStates.length === 0 ||\n          transition.toStates.length > 1) {\n        fsmType = noam.fsm.nfaType;\n      }\n    }\n\n    if (fsmType === noam.fsm.dfaType) {\n      if (fsm.transitions.length < fsm.states.length * fsm.alphabet.length) {\n        fsmType = noam.fsm.nfaType;\n      }\n    }\n\n    return fsmType;\n  };\n\n  // computes epsilon closure of fsm from states array states\n  noam.fsm.computeEpsilonClosure = function(fsm, states) {\n    if (!(noam.util.containsAll(fsm.states, states))) {\n      throw new Error('FSM must contain all states for which epsilon closure is being computed');\n    }\n\n    var unprocessedStates = states;\n    var targetStates = [];\n\n    while (unprocessedStates.length !== 0) {\n      var currentState = unprocessedStates.pop();\n      targetStates.push(currentState);\n\n      for (var i=0; i<fsm.transitions.length; i++) {\n        var transition = fsm.transitions[i];\n\n        if (transition.symbol === noam.fsm.epsilonSymbol &&\n            noam.util.areEquivalent(transition.fromState, currentState)) {\n          for (var j=0; j<transition.toStates.length; j++) {\n            if (noam.util.contains(targetStates, transition.toStates[j]) ||\n                noam.util.contains(unprocessedStates, transition.toStates[j])) {\n              continue;\n            }\n\n            unprocessedStates.push(transition.toStates[j]);\n          }\n        }\n      }\n    }\n\n    return targetStates;\n  };\n\n  // determines the target states from reading symbol at states array states\n  noam.fsm.makeSimpleTransition = function(fsm, states, symbol) {\n    if (!(noam.util.containsAll(fsm.states, states))) {\n      throw new Error('FSM must contain all states for which the transition is being computed');\n    }\n\n    if (!(noam.util.contains(fsm.alphabet, symbol))) {\n      throw new Error('FSM must contain input symbol for which the transition is being computed');\n    }\n\n    var targetStates = [];\n\n    for (var i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (noam.util.areEquivalent(fsm.transitions[i].symbol, symbol) &&\n          noam.util.contains(states, transition.fromState)) {\n        for (var j=0; j<transition.toStates.length; j++) {\n          if (!(noam.util.contains(targetStates, transition.toStates[j]))) {\n            targetStates.push(transition.toStates[j]);\n          }\n        }\n      }\n    }\n\n    return targetStates;\n  };\n\n  // makes transition from states array states and for input symbol symbol by:\n  //   a) computing the epsilon closure of states\n  //   b) making a simple transition from resulting states of a)\n  //   c) computing the epsilon closure of resulting states of b)\n  noam.fsm.makeTransition = function(fsm, states, symbol) {\n    if (!(noam.util.containsAll(fsm.states, states))) {\n      throw new Error('FSM must contain all states for which the transition is being computed');\n    }\n\n    if (!(noam.util.contains(fsm.alphabet, symbol))) {\n      throw new Error('FSM must contain input symbol for which the transition is being computed');\n    }\n\n    var targetStates = noam.util.clone(states);\n\n    targetStates = noam.fsm.computeEpsilonClosure(fsm, targetStates);\n    targetStates = noam.fsm.makeSimpleTransition(fsm, targetStates, symbol);\n    targetStates = noam.fsm.computeEpsilonClosure(fsm, targetStates);\n\n    return targetStates;\n  };\n\n  // read a stream of input symbols and determine target states\n  noam.fsm.readString = function(fsm, inputSymbolStream) {\n    if (!(noam.util.containsAll(fsm.alphabet, inputSymbolStream))) {\n      throw new Error('FSM must contain all symbols for which the transition is being computed');\n    }\n\n    var states = noam.fsm.computeEpsilonClosure(fsm, [fsm.initialState]);\n\n    for (var i=0; i<inputSymbolStream.length; i++) {\n      states = noam.fsm.makeTransition(fsm, states, inputSymbolStream[i]);\n    }\n\n    return states;\n  };\n\n  // read a stream of input symbols starting from state and make a list of\n  // states that were on the transition path\n  noam.fsm.transitionTrail = function(fsm, state, inputSymbolStream) {\n    if (!(noam.util.containsAll(fsm.alphabet, inputSymbolStream))) {\n      throw new Error('FSM must contain all symbols for which the transition is being computed');\n    }\n\n    var states = [state];\n    var trail = [noam.util.clone(states)];\n\n    for (var i=0; i<inputSymbolStream.length; i++) {\n      states = noam.fsm.makeTransition(fsm, states, inputSymbolStream[i]);\n      trail.push(noam.util.clone(states));\n    }\n\n    return trail;\n  };\n\n  // test if a stream of input symbols leads a fsm to an accepting state\n  noam.fsm.isStringInLanguage = function(fsm, inputSymbolStream) {\n    var states = noam.fsm.readString(fsm, inputSymbolStream);\n\n    return noam.util.containsAny(fsm.acceptingStates, states);\n  };\n\n  // pretty print the fsm transition function and accepting states as a table\n  noam.fsm.printTable = function(fsm) {\n    var Table = require('cli-table');\n    var colHeads = [\"\"].concat(fsm.alphabet);\n\n    if (noam.fsm.determineType(fsm) === noam.fsm.enfaType) {\n      colHeads.push(noam.fsm.epsilonSymbol);\n    }\n\n    colHeads.push(\"\");\n\n    var table = new Table({\n       head: colHeads,\n       chars: {\n         'top': '-',\n         'top-mid': '+',\n         'top-left': '+',\n         'top-right': '+',\n         'bottom': '-',\n         'bottom-mid': '+',\n         'bottom-left': '+',\n         'bottom-right': '+',\n         'left': '|',\n         'left-mid': '+',\n         'mid': '-',\n         'mid-mid': '+',\n         'right': '|',\n         'right-mid': '+'\n       },\n       truncate: '~'\n    });\n\n    var tableRows = [], i, j;\n    for (i=0; i<fsm.states.length; i++) {\n      tableRows.push(new Array(colHeads.length));\n      for (j=0; j<colHeads.length; j++) {\n        tableRows[i][j] = \"\";\n      }\n      tableRows[i][0] = fsm.states[i].toString();\n      tableRows[i][colHeads.length-1] =\n        noam.util.contains(fsm.acceptingStates, fsm.states[i]) ?\n        \"1\" : \"0\" ;\n      table.push(tableRows[i]);\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      var colNum = null;\n      var rowNum = null;\n\n      for (j=0; j<fsm.states.length; j++) {\n        if (noam.util.areEquivalent(fsm.states[j], transition.fromState)) {\n          rowNum = j;\n          break;\n        }\n      }\n\n      if (transition.symbol === noam.fsm.epsilonSymbol) {\n        colNum = colHeads.length-2;\n      } else {\n        for (j=0; j<fsm.alphabet.length; j++) {\n          if (noam.util.areEquivalent(fsm.alphabet[j], transition.symbol)) {\n            colNum = j+1;\n            break;\n          }\n        }\n      }\n\n      if (typeof tableRows[rowNum][colNum].text === \"undefined\") {\n        tableRows[rowNum][colNum] = { text : [] };\n      }\n\n      tableRows[rowNum][colNum].text.push(transition.toStates);\n    }\n\n    return table.toString();\n  };\n\n  noam.fsm.serializeFsmToString = function(fsm) {\n    var lines = [];\n\n    lines.push(\"#states\");\n\n    for (var i = 0; i < fsm.states.length; i++) {\n      lines.push(fsm.states[i].toString());\n    }\n\n    lines.push(\"#initial\");\n\n    lines.push(fsm.initialState.toString());\n\n    lines.push(\"#accepting\");\n\n    for (var i = 0; i < fsm.acceptingStates.length; i++) {\n      lines.push(fsm.acceptingStates[i].toString());\n    }\n\n    lines.push(\"#alphabet\");\n\n    for (var i = 0; i < fsm.alphabet.length; i++) {\n      lines.push(fsm.alphabet[i].toString());\n    }\n\n    lines.push(\"#transitions\");\n\n    for (var i = 0; i < fsm.transitions.length; i++) {\n      lines.push(fsm.transitions[i].fromState.toString() + \":\" +\n                 fsm.transitions[i].symbol.toString() + \">\" +\n                 fsm.transitions[i].toStates.join(\",\"));\n    }\n\n    return lines.join(\"\\n\");\n  };\n\n  noam.fsm.parseFsmFromString = function(fsm_string) {\n    var lines = fsm_string.split(/\\r?\\n/);\n\n    var states = [];\n    var initial;\n    var accepting = [];\n    var alphabet = [];\n    var transitions = [];\n\n    var parseState = null;\n\n    var parseCounts = {\n      states : 0,\n      initial : 0,\n      accepting : 0,\n      alphabet : 0,\n      transitions : 0\n    };\n\n    for (var i=0; i<lines.length; i++) {\n      var line = lines[i].replace(/\\s/g, \"\");\n\n      if (line.length === 0) {\n        continue;\n      } else if (line[0] === '#') {\n        parseState = line.substr(1);\n\n        if (typeof parseCounts[parseState] === 'undefined') {\n          throw new Error('Line ' + (i+1).toString() + ': invalid section name ' +\n                           parseState + '. Must be one of: states, initial, \\\n                           accepting, alphabet, transitions.');\n        } else {\n          parseCounts[parseState] += 1;\n\n          if (parseCounts[parseState] > 1) {\n            throw new Error('Line ' + (i+1).toString() +\n                            ': duplicate section name ' + parseState + '.');\n          }\n        }\n      } else {\n        if (parseState == null) {\n          throw new Error('Line ' + (i+1).toString() + ': no #section declared. \\\n                          Add one section: states, initial, accepting, \\\n                          alphabet, transitions.');\n        } else if (parseState === 'states') {\n          var st = line.split(\";\");\n          states = states.concat(st);\n        } else if (parseState == 'initial') {\n          initial = line;\n        } else if (parseState == 'accepting') {\n          var ac = line.split(\";\");\n          accepting = accepting.concat(ac);\n        } else if (parseState == 'alphabet') {\n          var al = line.split(\";\");\n          alphabet = alphabet.concat(al);\n        } else if (parseState == 'transitions') {\n          var state_rest = line.split(':');\n\n          var state = state_rest[0].split(',');\n          var parts = state_rest[1].split(';');\n\n          for (var j=0; j<parts.length; j++) {\n            var left_right = parts[j].split('>');\n            var al_t = left_right[0].split(',');\n            var st_t = left_right[1].split(',');\n          }\n\n          transitions.push([state, al_t, st_t]);\n        }\n      }\n    }\n\n    for (var k in parseCounts) {\n      if (parseCounts[k] !== 1) {\n        throw new Error('Specification missing #' + parseCounts[k] +\n          ' section.');\n      }\n    }\n\n    var fsm = noam.fsm.makeNew();\n\n    for (var i = states.length - 1; i >= 0; i--) {\n      noam.fsm.addState(fsm, states[i]);\n    }\n\n    for (var i = alphabet.length - 1; i >= 0; i--) {\n      noam.fsm.addSymbol(fsm, alphabet[i]);\n    }\n\n    for (var i = 0; i < accepting.length; i++) {\n      noam.fsm.addAcceptingState(fsm, accepting[i]);\n    }\n\n    noam.fsm.setInitialState(fsm, initial);\n\n    for (var i = 0; i < transitions.length; i++) {\n      var transition = transitions[i];\n\n      for (var j = 0; j < transition[0].length; j++) {\n        for (var k = 0; k < transition[1].length; k++) {\n          if (transition[1][k] === noam.fsm.epsilonSymbol) {\n            noam.fsm.addEpsilonTransition(fsm, transition[0][j], transition[2]);\n          } else {\n            noam.fsm.addTransition(fsm, transition[0][j], transition[2], transition[1][k]);\n          }\n        }\n      }\n    }\n\n    noam.fsm.validate(fsm);\n\n    return fsm;\n  };\n\n  // print the fsm transition function and accepting states as an HTML table\n  noam.fsm.printHtmlTable = function(fsm) {\n    var headers = [\"\"].concat(fsm.alphabet);\n    if (noam.fsm.determineType(fsm) === noam.fsm.enfaType) {\n      headers.push(noam.fsm.epsilonSymbol);\n    }\n    headers.push(\"\");\n\n    var tableRows = [], i, j;\n\n    for (i=0; i<fsm.states.length; i++) {\n      tableRows.push(new Array(headers.length));\n      for (j=0; j<headers.length; j++) {\n        tableRows[i][j] = { text : []};\n      }\n      tableRows[i][0] = { text : fsm.states[i].toString() };\n      tableRows[i][headers.length-1] =\n        noam.util.contains(fsm.acceptingStates, fsm.states[i]) ?\n        { text : [\"1\"] } : { text : [\"0\"] };\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      var colNum = null;\n      var rowNum = null;\n\n      for (j=0; j<fsm.states.length; j++) {\n        if (noam.util.areEquivalent(fsm.states[j], transition.fromState)) {\n          rowNum = j;\n          break;\n        }\n      }\n\n      if (transition.symbol === noam.fsm.epsilonSymbol) {\n        colNum = headers.length-2;\n      } else {\n        for (j=0; j<fsm.alphabet.length; j++) {\n          if (noam.util.areEquivalent(fsm.alphabet[j], transition.symbol)) {\n            colNum = j+1;\n            break;\n          }\n        }\n      }\n\n      if (typeof tableRows[rowNum][colNum].text === \"undefined\") {\n        tableRows[rowNum][colNum] = { text : [] };\n      }\n\n      tableRows[rowNum][colNum].text.push(transition.toStates);\n    }\n\n    var htmlString = [];\n\n    htmlString.push(\"<table border='1'>\");\n    htmlString.push(\"  <tr>\");\n\n    for (i=0; i<headers.length; i++) {\n      htmlString.push(\"    <th>\" + headers[i].toString() + \"</th>\");\n    }\n\n    htmlString.push(\"  </tr>\");\n\n    for (i=0; i<tableRows.length; i++) {\n      htmlString.push(\"  <tr>\");\n      for (j=0; j<tableRows[i].length; j++) {\n        htmlString.push(\"    <td>\" + tableRows[i][j].text + \"</td>\");\n      }\n\n      htmlString.push(\"  </tr>\");\n    }\n\n    htmlString.push(\"</table>\");\n    return htmlString.join(\"\\n\");\n  };\n\n  // print the fsm in the graphviz dot format\n  noam.fsm.printDotFormat = function(fsm) {\n    var result = [\"digraph finite_state_machine {\", \"  rankdir=LR;\"];\n    var accStates = [\"  node [shape = doublecircle];\"];\n\n    var i, j, k, trans;\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      accStates.push(fsm.acceptingStates[i].toString());\n    }\n\n    accStates.push(\";\");\n    if (accStates.length > 2) {\n      result.push(accStates.join(\" \"));\n    }\n    result.push(\"  node [shape = circle];\");\n    result.push(\"  secret_node [style=invis, shape=point];\");\n    //var initState = ['  {rank = source; \"'];\n    //initState.push(fsm.initialState.toString());\n    //initState.push('\" \"secret_node\"}');\n    //result.push(initState.join(\"\"));\n\n    var initStateArrow = [\"  secret_node ->\"];\n    initStateArrow.push(fsm.initialState.toString());\n    initStateArrow.push(\"[style=bold];\");\n    result.push(initStateArrow.join(\" \"));\n\n    var newTransitions = [];\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      for (j=0; j<fsm.transitions[i].toStates.length; j++) {\n        var found = null;\n\n        for (k=0; k<newTransitions.length; k++) {\n          if (noam.util.areEquivalent(newTransitions[k].fromState, fsm.transitions[i].fromState) &&\n              noam.util.areEquivalent(newTransitions[k].toStates, [fsm.transitions[i].toStates[j]])) {\n            found = newTransitions[k];\n          }\n        }\n\n        if (found === null) {\n          var newTransition = noam.util.clone(fsm.transitions[i]);\n          newTransition.toStates = [newTransition.toStates[j]];\n          newTransition.symbol = [newTransition.symbol];\n          newTransitions.push(newTransition);\n        } else {\n          found.symbol.push(fsm.transitions[i].symbol);\n        }\n      }\n    }\n\n    for (i=0; i<newTransitions.length; i++) {\n      if (noam.util.areEquivalent(newTransitions[i].toStates[0], fsm.initialState)) {\n        trans = [\" \"];\n        trans.push(newTransitions[i].toStates[0].toString());\n        trans.push(\"->\");\n        trans.push(newTransitions[i].fromState.toString());\n        trans.push(\"[\");\n        trans.push(\"label =\");\n        trans.push('\"' + newTransitions[i].symbol.toString() + '\"');\n        trans.push(\" dir = back];\");\n        result.push(trans.join(\" \"));\n      } else {\n        trans = [\" \"];\n        trans.push(newTransitions[i].fromState.toString());\n        trans.push(\"->\");\n        trans.push(newTransitions[i].toStates[0].toString());\n        trans.push(\"[\");\n        trans.push(\"label =\");\n        trans.push('\"' + newTransitions[i].symbol.toString() + '\"');\n        trans.push(\" ];\");\n        result.push(trans.join(\" \"));\n      }\n    }\n\n    result.push(\"}\");\n\n    return result.join(\"\\n\").replace(/\\$/g, \"$\");\n  };\n\n  // determine reachable states\n  noam.fsm.getReachableStates = function(fsm, state, shouldIncludeInitialState) {\n    var unprocessedStates = [state], i, j;\n    var reachableStates = shouldIncludeInitialState ? [state] : [];\n\n    while (unprocessedStates.length !== 0) {\n      var currentState = unprocessedStates.pop();\n\n      for (i=0; i<fsm.transitions.length; i++) {\n        var transition = fsm.transitions[i];\n\n        if (noam.util.areEquivalent(currentState, transition.fromState)) {\n          for (j=0; j<transition.toStates.length; j++) {\n            if (!(noam.util.contains(reachableStates, transition.toStates[j]))) {\n              reachableStates.push(transition.toStates[j]);\n\n              if (!(noam.util.contains(unprocessedStates, transition.toStates[j]))) {\n                unprocessedStates.push(transition.toStates[j]);\n              }\n            }\n          }\n        }\n      }\n    }\n\n   return reachableStates;\n  };\n\n  // determine and remove unreachable states\n  noam.fsm.removeUnreachableStates = function (fsm) {\n    var reachableStates = noam.fsm.getReachableStates(fsm, fsm.initialState, true);\n    var newFsm = noam.util.clone(fsm), i;\n    newFsm.states = [];\n    newFsm.acceptingStates = [];\n    newFsm.transitions = [];\n\n    for (i=0; i<fsm.states.length; i++) {\n      if(noam.util.contains(reachableStates, fsm.states[i])) {\n        newFsm.states.push(noam.util.clone(fsm.states[i]));\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      if (noam.util.contains(reachableStates, fsm.acceptingStates[i])) {\n        newFsm.acceptingStates.push(noam.util.clone(fsm.acceptingStates[i]));\n      }\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      if (noam.util.contains(reachableStates, fsm.transitions[i].fromState)) {\n        newFsm.transitions.push(noam.util.clone(fsm.transitions[i]));\n      }\n    }\n\n    return newFsm;\n  };\n\n  // determines if two states from potentially different fsms are equivalent\n  noam.fsm.areEquivalentStates = function(fsmA, stateA, fsmB, stateB) {\n    if (noam.fsm.determineType(fsmA) !== noam.fsm.dfaType ||\n        noam.fsm.determineType(fsmB) !== noam.fsm.dfaType) {\n      throw new Error('FSMs must be DFAs');\n    }\n\n    if (fsmA.alphabet.length !== fsmB.alphabet.length ||\n        !(noam.util.containsAll(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error('FSM alphabets must be the same');\n    }\n\n    if (!(noam.util.contains(fsmA.states, stateA)) ||\n        !(noam.util.contains(fsmB.states, stateB))) {\n      throw new Error('FSMs must contain states');\n    }\n\n    function doBothStatesHaveSameAcceptance(fsmX, stateX, fsmY, stateY) {\n      var stateXAccepting = noam.util.contains(fsmX.acceptingStates, stateX);\n      var stateYAccepting = noam.util.contains(fsmY.acceptingStates, stateY);\n\n      return (stateXAccepting && stateYAccepting) ||\n             (!(stateXAccepting) && !(stateYAccepting));\n    }\n\n    var unprocessedPairs = [[stateA, stateB]];\n    var processedPairs = [], i, j;\n\n    while (unprocessedPairs.length !== 0) {\n      var currentPair = unprocessedPairs.pop();\n\n      if (!(doBothStatesHaveSameAcceptance(fsmA, currentPair[0], fsmB, currentPair[1]))) {\n          return false;\n        }\n\n      processedPairs.push(currentPair);\n\n      for (j=0; j<fsmA.alphabet.length; j++) {\n        var pair = [noam.fsm.makeTransition(fsmA, [currentPair[0]], fsmA.alphabet[j])[0],\n                    noam.fsm.makeTransition(fsmB, [currentPair[1]], fsmA.alphabet[j])[0]];\n\n        if (!(noam.util.contains(processedPairs, pair)) &&\n            !(noam.util.contains(unprocessedPairs, pair))) {\n          unprocessedPairs.push(pair);\n        }\n      }\n    }\n\n    return true;\n  };\n\n  // determines if two fsms are equivalent by testing equivalence of starting states\n  noam.fsm.areEquivalentFSMs = function(fsmA, fsmB) {\n    return noam.fsm.areEquivalentStates(fsmA, fsmA.initialState, fsmB, fsmB.initialState);\n  };\n\n  // finds and removes equivalent states\n  noam.fsm.removeEquivalentStates = function(fsm) {\n    if (noam.fsm.determineType(fsm) !== noam.fsm.dfaType) {\n      throw new Error('FSM must be DFA');\n    }\n\n    var equivalentPairs = [], i, j, k;\n\n    for (i=0; i<fsm.states.length; i++) {\n      for (j=i+1; j<fsm.states.length; j++) {\n        if (noam.fsm.areEquivalentStates(fsm, fsm.states[i], fsm, fsm.states[j])) {\n          var pair = [fsm.states[i], fsm.states[j]];\n\n          for (k=0; k<equivalentPairs.length; k++) {\n            if (noam.util.areEquivalent(equivalentPairs[k][1], pair[0])) {\n              pair[0] = equivalentPairs[k][1];\n              break;\n            }\n          }\n\n          if (!(noam.util.contains(equivalentPairs, pair))) {\n            equivalentPairs.push(pair);\n          }\n        }\n      }\n    }\n\n    var newFsm = {\n      states : [],\n      alphabet : noam.util.clone(fsm.alphabet),\n      initialState : [],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    function isOneOfEquivalentStates(s) {\n      for (var i=0; i<equivalentPairs.length; i++) {\n        if (noam.util.areEquivalent(equivalentPairs[i][1], s)) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    function getEquivalentState(s) {\n      for (var i=0; i<equivalentPairs.length; i++) {\n        if (noam.util.areEquivalent(equivalentPairs[i][1], s)) {\n          return equivalentPairs[i][0];\n        }\n      }\n\n      return s;\n    }\n\n    for (i=0; i<fsm.states.length; i++) {\n      if (!(isOneOfEquivalentStates(fsm.states[i]))) {\n        newFsm.states.push(noam.util.clone(fsm.states[i]));\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      if (!(isOneOfEquivalentStates(fsm.acceptingStates[i]))) {\n        newFsm.acceptingStates.push(noam.util.clone(fsm.acceptingStates[i]));\n      }\n    }\n\n    newFsm.initialState = noam.util.clone(getEquivalentState(fsm.initialState));\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = noam.util.clone(fsm.transitions[i]);\n\n      if (isOneOfEquivalentStates(transition.fromState)) {\n        continue;\n      }\n\n      for (j=0; j<transition.toStates.length; j++) {\n        transition.toStates[j] = getEquivalentState(transition.toStates[j]);\n      }\n\n      newFsm.transitions.push(transition);\n    }\n\n    return newFsm;\n  };\n\n  // minimizes the fsm by removing unreachable and equivalent states\n  noam.fsm.minimize = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    var fsmWithoutUnreachableStates = noam.fsm.removeUnreachableStates(newFsm);\n    var minimalFsm = noam.fsm.removeEquivalentStates(fsmWithoutUnreachableStates);\n    return minimalFsm;\n  };\n\n  noam.fsm.convertStatesToNumbers = function(fsm) {\n    var newFsm = noam.fsm.makeNew();\n    var mapping = {};\n\n    for (i=0; i<fsm.states.length; i++) {\n      mapping[fsm.states[i].toString()] = i;\n    }\n\n    newFsm.alphabet = noam.util.clone(fsm.alphabet);\n\n    for (i=0; i<fsm.states.length; i++) {\n      noam.fsm.addState(newFsm, mapping[fsm.states[i].toString()]);\n    }\n\n    noam.fsm.setInitialState(newFsm, mapping[fsm.initialState.toString()]);\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      noam.fsm.addAcceptingState(newFsm, mapping[fsm.acceptingStates[i].toString()]);\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var newToStates = [];\n\n      for (j=0; j<fsm.transitions[i].toStates.length; j++) {\n        newToStates.push(mapping[fsm.transitions[i].toStates[j].toString()]);\n      }\n\n      noam.fsm.addTransition(newFsm,\n        mapping[fsm.transitions[i].fromState.toString()],\n        newToStates,\n        fsm.transitions[i].symbol);\n    }\n\n    return newFsm;\n  }\n\n  // generate random fsm\n  noam.fsm.createRandomFsm = function(fsmType, numStates, numAlphabet, maxNumToStates) {\n    var newFsm = {}, i, j, k;\n\n    function prefix(ch, num, str) {\n      var retStr = str;\n\n      for (var i=0; i<str.length - num; i++) {\n        retStr = ch + str;\n      }\n\n      return retStr;\n    }\n\n    newFsm.states = [];\n    for (i=0, len=numStates.toString().length; i<numStates; i++) {\n      newFsm.states.push(\"s\" + prefix(\"0\", len, i.toString()));\n    }\n\n    newFsm.alphabet = [];\n\n    if (numAlphabet > 26) {\n      for (i=0, len=numAlphabet.toString().length; i<numAlphabet; i++) {\n        newFsm.alphabet.push(\"a\" + prefix(\"0\", len, i.toString()));\n      }\n    } else {\n      newFsm.alphabet = \"abcdefghijklmnopqrstuvwxyz\".substr(0,numAlphabet).split(\"\");\n    }\n\n    newFsm.initialState = newFsm.states[0];\n\n    newFsm.acceptingStates = [];\n    for (i=0; i<numStates; i++) {\n      if (Math.round(Math.random())) {\n        newFsm.acceptingStates.push(newFsm.states[i]);\n      }\n    }\n\n    if (fsmType === noam.fsm.enfaType) {\n      newFsm.alphabet.push(noam.fsm.epsilonSymbol);\n    }\n\n    newFsm.transitions = [];\n    for (i=0; i<numStates; i++) {\n      for (j=0; j<newFsm.alphabet.length; j++) {\n        var numToStates = 1;\n\n        if (fsmType !== noam.fsm.dfaType) {\n          numToStates = Math.floor(Math.random()*maxNumToStates);\n        }\n\n        if (numToStates > 0) {\n          var toStates = [];\n          for (k=0; k<newFsm.states.length && toStates.length < numToStates; k++) {\n            var diff = (newFsm.states.length-k)-(numToStates-toStates.length) + 1;\n\n            if (diff <= 0) {\n              diff = 1;\n            } else {\n              diff = 1/diff;\n            }\n\n            if (Math.random() <= diff) {\n              toStates.push(newFsm.states[k]);\n            }\n          }\n\n          newFsm.transitions.push({fromState : newFsm.states[i], symbol : newFsm.alphabet[j], toStates : toStates});\n        }\n      }\n    }\n\n    if (fsmType === noam.fsm.enfaType) {\n      newFsm.alphabet.pop();\n    }\n\n    return newFsm;\n  };\n\n  noam.fsm.convertNfaToDfa = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    if (fsmType === noam.fsm.enfaType) {\n      throw new Error('FSM must be an NFA');\n    }\n\n    if (fsmType === noam.fsm.dfaType) {\n      return fsm; // no need to convert it\n    }\n\n    var newFsm = {}, i, j, k, transition;\n\n    newFsm.alphabet = noam.util.clone(fsm.alphabet);\n    newFsm.states = [];\n    newFsm.acceptingStates = [];\n    newFsm.initialState = [noam.util.clone(fsm.initialState)];\n    newFsm.transitions = [];\n\n    for (i=0; i<fsm.states.length; i++) {\n      newFsm.states.push([noam.util.clone(fsm.states[i])]);\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      newFsm.acceptingStates.push([noam.util.clone(fsm.acceptingStates[i])]);\n    }\n\n    var newStates = [];\n    var multiStates = [];\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      transition = noam.util.clone(fsm.transitions[i]);\n      transition.fromState = [transition.fromState];\n\n      transition.toStates = [transition.toStates];\n\n      if (transition.toStates[0].length > 1) {\n        if (!(noam.util.containsSet(newStates, transition.toStates[0]))) {\n          newStates.push(transition.toStates[0]);\n        }\n      }\n\n      newFsm.transitions.push(transition);\n    }\n\n    while (newStates.length !== 0) {\n      var state = newStates.pop();\n\n      newFsm.states.push(state);\n\n      if (noam.util.containsAny(fsm.acceptingStates, state)) {\n        newFsm.acceptingStates.push(state);\n      }\n\n      for (i=0; i<newFsm.alphabet.length; i++) {\n        var ts = noam.fsm.makeTransition(fsm, state, newFsm.alphabet[i]).sort();\n\n        for (j=0; j<newFsm.states.length; j++) {\n          if (noam.util.areEqualSets(ts, newFsm.states[j])) {\n            ts = newFsm.states[j];\n            break;\n          }\n        }\n\n        for (j=0; j<newStates.length; j++) {\n          if (noam.util.areEqualSets(ts, newStates[j])) {\n            ts = newStates[j];\n            break;\n          }\n        }\n\n        if (ts.length > 0) {\n          newFsm.transitions.push({fromState : state, symbol : newFsm.alphabet[i], toStates : [ts]});\n        }\n\n        if (!(noam.util.containsSet(newFsm.states, ts)) && !(noam.util.containsSet(newStates, ts)) && ts.length > 1) {\n          newStates.push(ts);\n        }\n      }\n    }\n\n    var errorAdded = false;\n    var errorState = \"ERROR\";\n\n    for (i=0; i<newFsm.states.length; i++) {\n      for (j=0; j<newFsm.alphabet.length; j++) {\n        var found = false;\n        for (k=0; k<newFsm.transitions.length; k++) {\n          transition = newFsm.transitions[k];\n\n          if (noam.util.areEquivalent(transition.symbol, newFsm.alphabet[j]) &&\n              noam.util.areEquivalent(transition.fromState, newFsm.states[i])) {\n            found = true;\n            break;\n          }\n        }\n\n        if (found === false) {\n          if (errorAdded === false) {\n            newFsm.states.push([errorState]);\n            errorAdded = true;\n          }\n\n          newFsm.transitions.push({fromState : newFsm.states[i], symbol : newFsm.alphabet[j], toStates : [[errorState]]});\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  noam.fsm.convertEnfaToNfa = function(fsm) {\n    if (noam.fsm.determineType(fsm) !== noam.fsm.enfaType) {\n      return fsm; // this is already an NFA (or a DFA which is also an NFA)\n    }\n\n    var newFsm = noam.util.clone(fsm), i, j;\n\n    var initialEpsilon = noam.fsm.computeEpsilonClosure(fsm, [fsm.initialState]);\n\n    if (noam.util.containsAny(newFsm.acceptingStates, initialEpsilon) &&\n        !(noam.util.contains(newFsm.acceptingStates, newFsm.initialState))) {\n      newFsm.acceptingStates.push(newFsm.initialState);\n    }\n\n    var newTransitions = [];\n\n    for (i=0; i<newFsm.states.length; i++) {\n      for (j=0; j<newFsm.alphabet.length; j++) {\n        var toStates = noam.fsm.makeTransition(newFsm, [newFsm.states[i]], newFsm.alphabet[j]).sort();\n\n        if (toStates.length > 0) {\n          newTransitions.push({\n            fromState : newFsm.states[i],\n            toStates : toStates,\n            symbol : newFsm.alphabet[j]\n          });\n        }\n      }\n    }\n\n    newFsm.transitions = newTransitions;\n\n    var multiStateTransitions = [];\n\n    for (i=0; i<newFsm.transitions.length; i++) {\n      var transition = newFsm.transitions[i];\n\n      if (transition.toStates.length > 1) {\n        var existing = false;\n\n        for (j=0; j<multiStateTransitions.length; j++) {\n          if (noam.util.areEqualSets(transition.toStates, multiStateTransitions[j])) {\n            transition.toStates = multiStateTransitions[j];\n            existing = true;\n            break;\n          }\n        }\n\n        if (existing === false) {\n          multiStateTransitions.push(transition.toStates);\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // test whether if the language accepted by the fsm contains at least one string\n  noam.fsm.isLanguageNonEmpty = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    return newFsm.acceptingStates.length > 0;\n  };\n\n  noam.fsm.isLanguageInfinite = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    var deadState = null, i, reachable;\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (noam.util.contains(newFsm.acceptingStates, newFsm.states[i])) {\n        continue;\n      }\n\n      reachable = noam.fsm.getReachableStates(newFsm, newFsm.states[i], true);\n\n      if (noam.util.containsAny(newFsm.acceptingStates, reachable)) {\n        continue;\n      }\n\n      deadState = newFsm.states[i];\n      break;\n    }\n\n    if (deadState === null) {\n      return true;\n    }\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (noam.util.areEquivalent(deadState, newFsm.states[i])) {\n        continue;\n      }\n\n      reachable = noam.fsm.getReachableStates(newFsm, newFsm.states[i], false);\n\n      if (noam.util.contains(reachable, newFsm.states[i])) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // generate a random string which the fsm accepts\n  noam.fsm.randomStringInLanguage = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    if (newFsm.acceptingStates.length === 0) {\n      return null;\n    }\n\n    var currentState = newFsm.acceptingStates[Math.floor(Math.random()*newFsm.acceptingStates.length)];\n    var trail = [];\n\n    while (true) {\n      if (noam.util.areEquivalent(currentState, newFsm.initialState) === true) {\n        if (Math.round(Math.random())) {\n          break;\n        }\n      }\n\n      var transitions = [], i;\n\n      for (i=0; i<newFsm.transitions.length; i++) {\n        if (noam.util.areEquivalent(newFsm.transitions[i].toStates[0], currentState)) {\n          transitions.push(newFsm.transitions[i]);\n        }\n      }\n\n      if (transitions.length === 0) {\n        break;\n      }\n\n      var transition = transitions[Math.floor(Math.random()*transitions.length)];\n\n      trail.push(transition.symbol);\n      currentState = transition.fromState;\n    }\n\n    trail.reverse();\n\n    return trail;\n  };\n\n  // generate a random string which the fsm doest accept\n  noam.fsm.randomStringNotInLanguage = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    var nonAcceptingStates = [], i;\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (!(noam.util.contains(newFsm.acceptingStates, newFsm.states[i]))) {\n        nonAcceptingStates.push(newFsm.states[i]);\n      }\n    }\n\n    if (nonAcceptingStates.length === 0) {\n      return null;\n    }\n\n    var currentState = nonAcceptingStates[Math.floor(Math.random()*nonAcceptingStates.length)];\n    var trail = [];\n\n    while (true) {\n      if (noam.util.areEquivalent(currentState, newFsm.initialState) === true) {\n        if (Math.round(Math.random())) {\n          break;\n        }\n      }\n\n      var transitions = [];\n\n      for (i=0; i<newFsm.transitions.length; i++) {\n        if (noam.util.areEquivalent(newFsm.transitions[i].toStates[0], currentState)) {\n          transitions.push(newFsm.transitions[i]);\n        }\n      }\n\n      if (transitions.length === 0) {\n        break;\n      }\n\n      var transition = transitions[Math.floor(Math.random()*transitions.length)];\n\n      trail.push(transition.symbol);\n      currentState = transition.fromState;\n    }\n\n    trail.reverse();\n\n    return trail;\n  };\n\n  // get a new fsm which accepts the language L=L1+L2 (set union) where\n  // L1 is the language accepted by fsma and\n  // L2 is the language accepted by fsmB\n  noam.fsm.union = function(fsmA, fsmB) {\n    if (!(noam.util.areEquivalent(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error(\"Alphabets must be the same\");\n    }\n\n    var newFsm = {\n      alphabet : noam.util.clone(fsmA.alphabet),\n      states : [],\n      initialState : [noam.util.clone(fsmA.initialState), noam.util.clone(fsmB.initialState)],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    var i, j, k;\n\n    for (i=0; i<fsmA.states.length; i++) {\n      for (j=0; j<fsmB.states.length; j++) {\n        var newState = [noam.util.clone(fsmA.states[i]), noam.util.clone(fsmB.states[j])];\n        newFsm.states.push(newState);\n\n        if (noam.util.contains(fsmA.acceptingStates, fsmA.states[i]) ||\n            noam.util.contains(fsmB.acceptingStates, fsmB.states[j])) {\n          newFsm.acceptingStates.push(newState);\n        }\n\n        for (k=0; k<newFsm.alphabet.length; k++) {\n          newFsm.transitions.push({\n            fromState : newState,\n            symbol : newFsm.alphabet[k],\n            toStates : [[noam.fsm.makeTransition(fsmA, [fsmA.states[i]], newFsm.alphabet[k])[0],\n                        noam.fsm.makeTransition(fsmB, [fsmB.states[j]], newFsm.alphabet[k])[0]]]\n          });\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L=L1/L2 (set intersection) where\n  // L1 is the language accepted by fsma and\n  // L2 is the language accepted by fsmB\n  noam.fsm.intersection = function(fsmA, fsmB) {\n    var new_alphabet = noam.util.clone(noam.util.setIntersection(fsmA.alphabet, fsmB.alphabet));\n\n    var newFsm = {\n      alphabet : new_alphabet,\n      states : [],\n      initialState : [noam.util.clone(fsmA.initialState), noam.util.clone(fsmB.initialState)],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    var i, j, k;\n\n    for (i=0; i<fsmA.states.length; i++) {\n      for (j=0; j<fsmB.states.length; j++) {\n        var newState = [noam.util.clone(fsmA.states[i]), noam.util.clone(fsmB.states[j])];\n        newFsm.states.push(newState);\n\n        if (noam.util.contains(fsmA.acceptingStates, fsmA.states[i]) &&\n            noam.util.contains(fsmB.acceptingStates, fsmB.states[j])) {\n          newFsm.acceptingStates.push(newState);\n        }\n\n        for (k=0; k<newFsm.alphabet.length; k++) {\n          newFsm.transitions.push({\n            fromState : newState,\n            symbol : newFsm.alphabet[k],\n            toStates : [[noam.fsm.makeTransition(fsmA, [fsmA.states[i]], newFsm.alphabet[k])[0],\n                        noam.fsm.makeTransition(fsmB, [fsmB.states[j]], newFsm.alphabet[k])[0]]]\n          });\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L=L1-L2 (set difference) where\n  // L1 is the language accepted by fsma and\n  // L2 is the language accepted by fsmB\n  noam.fsm.difference = function(fsmA, fsmB) {\n    if (!(noam.util.areEquivalent(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error(\"Alphabets must be the same\");\n    }\n\n    var newFsm = {\n      alphabet : noam.util.clone(fsmA.alphabet),\n      states : [],\n      initialState : [noam.util.clone(fsmA.initialState), noam.util.clone(fsmB.initialState)],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    var i, j, k;\n\n    for (i=0; i<fsmA.states.length; i++) {\n      for (j=0; j<fsmB.states.length; j++) {\n        var newState = [noam.util.clone(fsmA.states[i]), noam.util.clone(fsmB.states[j])];\n        newFsm.states.push(newState);\n\n        if (noam.util.contains(fsmA.acceptingStates, fsmA.states[i]) &&\n            !(noam.util.contains(fsmB.acceptingStates, fsmB.states[j]))) {\n          newFsm.acceptingStates.push(newState);\n        }\n\n        for (k=0; k<newFsm.alphabet.length; k++) {\n          newFsm.transitions.push({\n            fromState : newState,\n            symbol : newFsm.alphabet[k],\n            toStates : [[noam.fsm.makeTransition(fsmA, [fsmA.states[i]], newFsm.alphabet[k])[0],\n                        noam.fsm.makeTransition(fsmB, [fsmB.states[j]], newFsm.alphabet[k])[0]]]\n          });\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the complement language of the\n  // langauge accepted by the input fsm\n  noam.fsm.complement = function(fsm) {\n    var newFsm = noam.util.clone(fsm);\n\n    var newAccepting = [], i;\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (!(noam.util.contains(newFsm.acceptingStates, newFsm.states[i]))) {\n        newAccepting.push(newFsm.states[i]);\n      }\n    }\n\n    newFsm.acceptingStates = newAccepting;\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L1L2 where\n  // L1 is the language accepted by fsmA and L2 is the\n  // langauge accepted by fsmB\n  noam.fsm.concatenation = function(fsmA, fsmB) {\n    if (!(noam.util.areEquivalent(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error(\"Alphabets must be the same\");\n    }\n\n    if (noam.util.containsAny(fsmA.states, fsmB.states)) {\n      throw new Error(\"States must not overlap\");\n    }\n\n    var newFsm = {\n      alphabet : noam.util.clone(fsmA.alphabet),\n      states : noam.util.clone(fsmA.states).concat(noam.util.clone(fsmB.states)),\n      initialState : noam.util.clone(fsmA.initialState),\n      acceptingStates : noam.util.clone(fsmB.acceptingStates),\n      transitions : noam.util.clone(fsmA.transitions).concat(noam.util.clone(fsmB.transitions))\n    };\n\n    for (var i=0; i<fsmA.acceptingStates.length; i++) {\n      newFsm.transitions.push({\n        fromState : noam.util.clone(fsmA.acceptingStates[i]),\n        toStates : [noam.util.clone(fsmB.initialState)],\n        symbol : noam.fsm.epsilonSymbol\n      });\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L*, where L is\n  // accepted by the input fsm and * is the kleene operator\n  noam.fsm.kleene = function(fsm) {\n    var newFsm = noam.util.clone(fsm);\n\n    var newInitial = \"NEW_INITIAL\";\n\n    newFsm.states.push(newInitial);\n    newFsm.transitions.push({\n      fromState : newInitial,\n      toStates : [newFsm.initialState],\n      symbol : noam.fsm.epsilonSymbol\n    });\n    newFsm.initialState = newInitial;\n\n    for (var i=0; i<newFsm.acceptingStates.length; i++) {\n      newFsm.transitions.push({\n        fromState : newFsm.acceptingStates[i],\n        toStates : [newInitial],\n        symbol : noam.fsm.epsilonSymbol\n      });\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the reverse language of the input fsm\n  noam.fsm.reverse = function(fsm) {\n    var newFsm = noam.util.clone(fsm);\n\n    var newTransitions = [];\n\n    for (var i=0; i<newFsm.transitions.length; i++) {\n      for (var j=0; j<newFsm.transitions[i].toStates.length; j++) {\n        newTransitions.push({\n          fromState : newFsm.transitions[i].toStates[j],\n          toStates : [newFsm.transitions[i].fromState],\n          symbol : newFsm.transitions[i].symbol\n        });\n      }\n    }\n\n    newFsm.transitions = newTransitions;\n\n    var oldAcceptingStates = newFsm.acceptingStates;\n\n    newFsm.acceptingStates = [newFsm.initialState];\n\n    var newInitialState = \"NEW_INITIAL\";\n    newFsm.states.push(newInitialState);\n    newFsm.initialState = newInitialState;\n\n    newFsm.transitions.push({\n      fromState : newInitialState,\n      toStates : oldAcceptingStates,\n      symbol : noam.fsm.epsilonSymbol\n    });\n\n    return newFsm;\n  };\n\n  // check whether the language accepted by fsmB is a subset of\n  // the language accepted by fsmA\n  noam.fsm.isSubset = function(fsmA, fsmB) {\n    var fsmIntersection = noam.fsm.intersection(fsmA, fsmB);\n\n    return noam.fsm.areEquivalentFSMs(fsmB, fsmIntersection);\n  };\n\n  // convert the fsm into a regular grammar\n  noam.fsm.grammar = function(fsm) {\n    var grammar = {\n      nonterminals : noam.util.clone(fsm.states),\n      terminals : noam.util.clone(fsm.alphabet),\n      initialNonterminal : noam.util.clone(fsm.initialState),\n      productions : []\n    };\n\n    var i;\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      if (fsm.transitions[i].symbol === noam.fsm.epsilonSymbol) {\n        grammar.productions.push({\n          left : [noam.util.clone(fsm.transitions[i].fromState)],\n          right : noam.util.clone(fsm.transitions[i].toStates)\n        });\n      } else {\n        grammar.productions.push({\n          left : [noam.util.clone(fsm.transitions[i].fromState)],\n          right : [noam.util.clone(fsm.transitions[i].symbol)].concat(\n            noam.util.clone(fsm.transitions[i].toStates))\n        });\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      grammar.productions.push({\n        left : [noam.util.clone(fsm.acceptingStates[i])],\n        right : [noam.grammar.epsilonSymbol]\n      });\n    }\n\n    return grammar;\n  };\n\n  noam.fsm.symbolsForTransitions = function(fsm, stateA, stateB) {\n    var res = [];\n\n    for (var i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (noam.util.areEquivalent(transition.fromState, stateA) &&\n          noam.util.contains(transition.toStates, stateB)) {\n        res.push(transition.symbol);\n      }\n    }\n\n    return res;\n  };\n\n  noam.fsm.toRegex = function(fsm) {\n    var r = [];\n    var n = fsm.states.length;\n\n    var i, j, k, z;\n\n    for (k=0; k<n+1; k++) {\n      r[k] = [];\n      for (i=0; i<n; i++) {\n        r[k][i] = [];\n      }\n    }\n\n    for (i=0; i<n; i++) {\n      for (j=0; j<n; j++) {\n        var symbols = noam.fsm.symbolsForTransitions(fsm, fsm.states[i], fsm.states[j]);\n\n        for (z=0; z<symbols.length; z++) {\n          symbols[z] = noam.re.tree.makeLit(symbols[z]);\n        }\n\n        if (i === j) {\n          symbols.push(noam.re.tree.makeEps());\n        }\n\n        r[0][i][j] = noam.re.tree.makeAlt(symbols);\n      }\n    }\n\n    for (k=1; k<n+1; k++) {\n      for (i=0; i<n; i++) {\n        for (j=0; j<n; j++) {\n          var t1 = ((typeof r[k-1][i][k-1].choices !== \"undefined\" && r[k-1][i][k-1].choices.length === 0) ||\n              (typeof r[k-1][k-1][j].choices !== \"undefined\" && r[k-1][k-1][j].choices.length === 0) ||\n              (typeof r[k-1][k-1][k-1].choices !== \"undefined\" && r[k-1][k-1][k-1].choices.length === 0));\n          var t2 =  (typeof r[k-1][i][j].choices !== \"undefined\" && r[k-1][i][j].choices.length === 0);\n\n          var seq = null\n\n          if (r[k-1][k-1][k-1].tag === noam.re.tree.tags.EPS) {\n            seq = noam.re.tree.makeSeq([r[k-1][i][k-1], r[k-1][k-1][j]]);\n          } else {\n            seq = noam.re.tree.makeSeq([r[k-1][i][k-1], noam.re.tree.makeKStar(r[k-1][k-1][k-1]), r[k-1][k-1][j]]);\n          }\n\n          var alt = [];\n\n          if (!t2) {\n            alt.push(r[k-1][i][j]);\n          }\n\n          if (!t1) {\n            alt.push(seq);\n          }\n\n          alt = noam.re.tree.makeAlt(alt);\n\n          r[k][i][j] = alt;\n        }\n      }\n    }\n\n    var startStateIndex = -1;\n    var acceptableStatesIndexes = [];\n\n    for (i=0; i<fsm.states.length; i++) {\n      if (noam.util.areEquivalent(fsm.states[i], fsm.initialState)) {\n        startStateIndex = i;\n      }\n\n      if (noam.util.contains(fsm.acceptingStates, fsm.states[i])) {\n        acceptableStatesIndexes.push(i);\n      }\n    }\n\n    var elements = [];\n\n    for (i=0; i<acceptableStatesIndexes.length; i++) {\n      elements.push(r[n][startStateIndex][acceptableStatesIndexes[i]]);\n    }\n\n    return noam.re.tree.makeAlt(elements);\n  };\n\n  noam.grammar = {};\n\n  noam.grammar.epsilonSymbol = '$';\n  noam.grammar.regType = 'regular';\n  noam.grammar.cfgType = 'context-free';\n  noam.grammar.csgType = 'context-sensitive';\n  noam.grammar.unrestrictedType = 'unrestricted';\n\n  // validate the grammar\n  noam.grammar.validate = function(grammar) {\n    if (!(typeof grammar !== 'undefined' &&\n        Array.isArray(grammar.nonterminals) &&\n        Array.isArray(grammar.terminals) &&\n        typeof grammar.initialNonterminal !== 'undefined' && grammar.initialNonterminal !== null &&\n        Array.isArray(grammar.productions))) {\n      throw new Error('Grammar must be defined and have nonterminals, terminals, initialNonterminal and productions array properties!');\n    }\n    \n    var i, j;\n\n    if (grammar.nonterminals.length < 1) {\n      throw new Error('Set of nonterminals must not be empty.');\n    }\n\n    if (grammar.terminals.length < 1) {\n      throw new Error('Set of terminals must not be empty.');\n    }\n\n    for (i=0; i<grammar.nonterminals.length; i++) {\n      if (noam.util.contains(grammar.nonterminals, grammar.nonterminals[i], i+1)) {\n        throw new Error('Equivalent nonterminals');\n      }\n    }\n\n    for (i=0; i<grammar.terminals.length; i++) {\n      if (noam.util.contains(grammar.terminals, grammar.terminals[i], i+1)) {\n        throw new Error('Equivalent terminals');\n      }\n    }\n\n    for (i=0; i<grammar.terminals.length; i++) {\n      if (noam.util.contains(grammar.nonterminals, grammar.terminals[i])) {\n        throw new Error('Terminals and nonterminals must not overlap');\n      }\n    }\n\n    if (!(noam.util.contains(grammar.nonterminals, grammar.initialNonterminal))) {\n      throw new Error('InitialNonterminal must be in nonterminals');\n    }\n\n    for (i=0; i<grammar.productions.length; i++) {\n      var production = grammar.productions[i];\n\n      if (!(Array.isArray(production.left))) {\n        throw new Error('Left side of production must be an array');\n      }\n\n      if (production.left.length === 0) {\n        throw new Error('Left side of production must have at least one terminal or nonterminal');\n      }\n\n      for (j=0; j<production.left.length; j++) {\n        if (!(noam.util.contains(grammar.nonterminals, production.left[j])) &&\n            !(noam.util.contains(grammar.terminals, production.left[j]))) {\n          throw new Error('Left side of production must be in nonterminals or terminals');\n        }\n      }\n\n      if (!(Array.isArray(production.right))) {\n        throw new Error('Right side of production must be an array');\n      }\n\n      if (production.right.length === 1 && production.right[0] === noam.grammar.epsilonSymbol) {\n        \n      } else {\n        if (production.right.length === 0) {\n          throw new Error('Right side of production must have at least one terminal or nonterminal or epsilon symbol');\n        }\n\n        for (j=0; j<production.right.length; j++) {\n          if (!(noam.util.contains(grammar.nonterminals, production.right[j])) &&\n              !(noam.util.contains(grammar.terminals, production.right[j]))) {\n            throw new Error('Right side of production must be in nonterminals or terminals');\n          }\n        }\n      }\n\n      if (noam.util.contains(grammar.productions, production, i+1)) {\n        throw new Error('Grammar must not have duplicate productions');\n      }\n    }\n\n    return true;\n  };\n\n  // determine whether the grammar is regular, context-free, \n  // context-sensitive or unrestricted\n  noam.grammar.determineType = function(grammar) {\n    var type = noam.grammar.regType;\n    var isRightRegular = null;\n    var i, j, indexOfNonterminal;\n\n    for (i=0; i<grammar.productions.length; i++) {\n      var production = grammar.productions[i];\n\n      // handle both left-regular and right-regular\n      if (type === noam.grammar.regType) {\n        if (production.left.length !== 1 || !(noam.util.contains(grammar.nonterminals, production.left[0]))) {\n          type = noam.grammar.cfgType;\n        } else {\n          if (production.right.length === 1) {\n            continue;\n          } else {\n            var rightNonTerminalCount = 0;\n            indexOfNonterminal = -1;\n\n            for (j=0; j<production.right.length; j++) {\n              if (noam.util.contains(grammar.nonterminals, production.right[j])) {\n                rightNonTerminalCount += 1;\n                indexOfNonterminal = j;\n              }\n            }\n\n            if (rightNonTerminalCount > 1) {\n              type = noam.grammar.cfgType;\n            } else if (rightNonTerminalCount === 0) {\n              continue;\n            } else {\n              if (indexOfNonterminal === 0) {\n                if (isRightRegular === null) {\n                  isRightRegular = false;\n                  continue;\n                } else if (isRightRegular === false) {\n                  continue;\n                } else if (isRightRegular === true) {\n                  type = noam.grammar.cfgType;\n                }\n              } else if (indexOfNonterminal === production.right.length - 1) {\n                if (isRightRegular === null) {\n                  isRightRegular = true;\n                  continue;\n                } else if (isRightRegular === true) {\n                  continue;\n                } else if (isRightRegular === false) {\n                  type = noam.grammar.cfgType;\n                }\n              } else {\n                type = noam.grammar.cfgType;\n              }\n            }\n          }\n        }\n      }\n\n      if (type === noam.grammar.cfgType) {\n        if (production.left.length !== 1 || !(noam.util.contains(grammar.nonterminals, production.left[0]))) {\n          type = noam.grammar.csgType;\n        }\n      }\n\n      if (type === noam.grammar.csgType) {\n        var leftNonTerminalCount = 0;\n        indexOfNonterminal = -1;\n\n        for (j=0; j<production.left.length; j++) {\n          if (noam.util.contains(grammar.nonterminals, production.left[j])) {\n            leftNonTerminalCount += 1;\n            indexOfNonterminal = j;\n          }\n        }\n\n        if (leftNonTerminalCount > 1) {\n          return noam.grammar.unrestrictedType;\n        }\n\n        var prefix = production.left.slice(0, indexOfNonterminal-1);\n        var sufix = production.left.slice(indexOfNonterminal);\n\n        for (j=0; j<prefix.length; j++) {\n          if (!(noam.util.areEquivalent(prefix[j], production.right[j]))) {\n            return noam.grammar.unrestrictedType;\n          }\n        }\n\n        for (j=0; j<sufix.length; j++) {\n          if (!(noam.util.areEquivalent(sufix[sufix.length-j-1], production.right[production.right.length-j-1]))) {\n            return noam.grammar.unrestrictedType;\n          }\n        }\n\n        if (production.right.length <= prefix.length + sufix.length) {\n          return noam.grammar.unrestrictedType;\n        }\n      }\n    }\n\n    return type;\n  };\n\n  // print the grammar in a human-readable condensed ascii format\n  noam.grammar.printAscii = function(grammar) {\n    var str = [];\n\n    str.push(\"Initial nonterminal: \" + \"<\" + grammar.initialNonterminal + \">\");\n\n    var slimProds = [], i, j, k;\n\n    for (i=0; i<grammar.productions.length; i++) {\n      var foundSlim = -1;\n\n      for (j=0; j<slimProds.length; j++) {\n        if (noam.util.areEquivalent(slimProds[j][0], grammar.productions[i].left)) {\n          foundSlim = j;\n          break;\n        }\n      }\n\n      if (foundSlim === -1) {\n        slimProds[slimProds.length] = [grammar.productions[i].left, [grammar.productions[i].right]];\n      } else {\n        slimProds[foundSlim][1].push(grammar.productions[i].right);\n      }\n    }\n\n    for (i=0; i<slimProds.length; i++) {\n      var prod = [];\n\n      for (j=0; j<slimProds[i][0].length; j++) {\n        if (noam.util.contains(grammar.nonterminals, slimProds[i][0][j])) {\n          prod.push(\"<\" + slimProds[i][0][j].toString() + \">\");\n        } else {\n          if (slimProds[i][0][j] === noam.grammar.epsilonSymbol) {\n            prod.push(slimProds[i][0][j].toString());\n          } else {\n            prod.push('\"' + slimProds[i][0][j].toString() + '\"');\n          }\n        }\n      }\n\n      prod.push(\"->\");\n\n      for (j=0; j<slimProds[i][1].length; j++) {\n        for (k=0; k<slimProds[i][1][j].length; k++) {\n          if (noam.util.contains(grammar.nonterminals, slimProds[i][1][j][k])) {\n            prod.push(\"<\" + slimProds[i][1][j][k].toString() + \">\");\n          } else {\n            if (slimProds[i][1][j][k] === noam.grammar.epsilonSymbol) {\n              prod.push(slimProds[i][1][j][k].toString());\n            } else {\n              prod.push('\"' + slimProds[i][1][j][k].toString() + '\"');\n            }\n          }\n        }\n\n        if (j < slimProds[i][1].length - 1) {\n          prod.push(\"|\");\n        }\n      }\n\n      str.push(prod.join(\" \"));\n    }\n\n    return str.join(\"\\n\");\n  };\n\n  /*\n   * Regular expressions module.\n   *\n   * Parsed regular expressions are represented by a syntax tree. Tools for working with that\n   * representation are accessible through noam.re.tree.\n   *\n   * Two linear representations are also available and provide a convenient way to specify\n   * some languages, but are not composable like the tree representation. The array representation\n   * is available through noam.re.array and supports arbitrarily complex literals. If all the\n   * literals are characters, the string representation should be more convenient. It is\n   * available through noam.re.string. These linear representations are only useful for specifying\n   * languages and should usually be converted to a tree representation or to an automaton immediately.\n   */\n  noam.re = (function() {\n\n    /*\n     * Tools for creating and manipulating parsed regular expressions.\n     *\n     * The make* functions are a minimal API that can be used to create arbitrarily complex\n     * regular expressions programatically.\n     */\n    var tree = (function() {\n      var tags = {\n        ALT: 'alt',\n        SEQ: 'sequence',\n        KSTAR: 'kleene_star',\n        LIT: 'literal',\n        EPS: 'epsilon'\n      };\n\n      function copyAndDeleteProperties(o1, o2) {\n        var p;\n\n        for (p in o1) {\n          if (o1.hasOwnProperty(p)) {\n            delete o1[p];\n          }\n        }\n\n        for (p in o2) {\n          if (o2.hasOwnProperty(p)) {\n            o1[p] = o2[p];\n          }\n        }\n      }\n\n      /*\n        Simplifies the regular expression @a tree (a noam.re.tree object).\n        The goal of simplification is to obtain a regular expression which\n        defines the same language but has a smaller number of elements in\n        the tree structure and therefore less elements in array or string\n        form. Simplification is performed by iteratively transforming the\n        tree using a set of known algebraic equivalences in Kleene algebra.\n        If specified, the @a numIterations integer limits the number of\n        transformations that will be performed. Furthermore, if specified,\n        the @a appliedPatterns array will be filled with objects that\n        describe which patterns were applied, i.e. which transformations\n        were performed. The original tree @a tree is not modified; a new\n        tree is returned as a result.\n\n        The current set of patterns that are checked are (small alphabet\n        letters represent any regular expression):\n\n          # (a) => a (sequence of 1 element)\n          # (a) => a (choices with 1 element)\n          # $* => $\n          # (a*)* => a*\n          # (a+b*)* => (a+b)*\n          # $+a* => a*\n          # (a*b*c*)* => (a*+b*+c*)*\n          # $a => a\n          # (a+(b+c)) => a+b+c\n          # ab(cd) => abcd\n          # a+b+a => b+a\n          # a+b+a* => b+a*\n          # a*a* => a*\n          # (aa+a)* => a*\n          # (a+$)* => a*\n          # (ab+ac) => a(b+c)\n          # a*aa* => aa*\n          # (ab+cb) => (a+c)b\n          # a*($+b(a+b)*) => (a+b)*\n          # ($+(a+b)*a)b* => (a+b)*\n          # (a()) => ()\n          # ()* => ()\n\n        If none of these \"simple\" patterns can be applied, the simplification\n        process tries to apply patterns based on language subset (via\n        transformations to fsms):\n\n          # L1+L2 => L2, if L1 is subset of L2\n          # (L1+L2)* => L2, if L1* is subset of L2*\n          # L1*L2* => L2, if L1* is subset of L2*\n          # $+L => L, if L contains $\n          # (L1+$)(L2)* => (L2)* if L1 is subset of L2\n\n        The tree transformation process is stopped after no transformation\n        can be applied to the tree.\n      */\n\n      var _regex_simplification_patterns = [];\n\n      // (a) => a (sequence)\n      function _regex_simplify_1(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length === 1){\n          tree.tag = tree.elements[0].tag;\n\n          copyAndDeleteProperties(tree, tree.elements[0]);\n          return true;\n        }\n\n        return false;\n      }\n\n      // (a) => a (choices)\n      function _regex_simplify_2(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length === 1) {\n          tree.tag = tree.choices[0].tag;\n\n          copyAndDeleteProperties(tree, tree.choices[0]);\n          return true;\n        }\n\n        return false;\n      }\n\n      // $* => $\n      function _regex_simplify_3(tree, fsmCache) {\n         if (tree.tag === tags.KSTAR && tree.expr.tag === tags.EPS) {\n           tree.tag = tree.expr.tag;\n           delete tree.expr;\n           return true;\n         }\n\n         return false;\n      }\n\n      // (a*)* => a*\n      function _regex_simplify_4(tree, fsmCache) {\n         if (tree.tag === tags.KSTAR && tree.expr.tag === tags.KSTAR) {\n           tree.expr = tree.expr.expr;\n           return true;\n         }\n\n         return false;\n      }\n\n      // (a+b*)* => (a+b)*\n      function _regex_simplify_5(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT) {\n          var changed = false;\n          for (var i=0; i<tree.expr.choices.length; i++) {\n            if (tree.expr.choices[i].tag === tags.KSTAR) {\n              tree.expr.choices[i] = tree.expr.choices[i].expr;\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // $+a* => a*\n      function _regex_simplify_6(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          var epsIndex = -1;\n          var kstarIndex = -1;\n\n          for (var i=0; i<tree.choices.length; i++) {\n            if (tree.choices[i].tag === tags.EPS) {\n              epsIndex = i;\n            } else if (tree.choices[i].tag === tags.KSTAR) {\n              kstarIndex = i;\n            }\n          }\n\n          if (epsIndex >= 0 && kstarIndex >= 0) {\n            tree.choices.splice(epsIndex, 1);\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // (a*b*)* => (a*+b*)*\n      function _regex_simplify_7(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.SEQ && tree.expr.elements.length > 0) {\n          var check = true;\n          for (var i=0; i<tree.expr.elements.length; i++) {\n            if (tree.expr.elements[i].tag !== tags.KSTAR) {\n              check = false;\n              break;\n            }\n          }\n\n          if (check) {\n            tree.expr.tag = tags.ALT;\n            tree.expr.choices = tree.expr.elements;\n            delete tree.expr.elements;\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // $a => a\n      function _regex_simplify_8(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var epsIndex = -1;\n\n          for (var i=0; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.EPS) {\n              epsIndex = i;\n            }\n          }\n\n          if (epsIndex >= 0) {\n            tree.elements.splice(epsIndex, 1);\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // (a+(b+c)) => a+b+c\n      function _regex_simplify_9(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          var found = -1, i;\n          for (i=0; i<tree.choices.length; i++) {\n            if (tree.choices[i].tag === tags.ALT) {\n              found = i;\n            }\n          }\n\n          if (found >= 0) {\n            var node = tree.choices[found];\n            tree.choices.splice(found, 1);\n\n            for (i=0; i<node.choices.length; i++) {\n              tree.choices.splice(found+i, 0, node.choices[i]);\n            }\n\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // ab(cd) => abcd\n      function _regex_simplify_10(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var found = -1, i;\n          for (i=0; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.SEQ) {\n              found = i;\n              break;\n            }\n          }\n\n          if (found >= 0) {\n            var node = tree.elements[i];\n            tree.elements.splice(i, 1);\n\n            for (i=0; i<node.elements.length; i++) {\n              tree.elements.splice(found+i, 0, node.elements[i]);\n            }\n\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // a+a => a\n      function _regex_simplify_11(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            var found = -1;\n            for (var j=i+1; j<tree.choices.length; j++) {\n              if (noam.util.areEquivalent(tree.choices[i], tree.choices[j])) {\n                found = j;\n                break;\n              }\n            }\n\n            if (found >= 0) {\n              tree.choices.splice(found, 1);\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a+a* => a*\n      function _regex_simplify_12(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            var found = -1;\n            for (var j=i+1; j<tree.choices.length; j++) {\n              if (tree.choices[j].tag === tags.KSTAR && noam.util.areEquivalent(tree.choices[j].expr, tree.choices[i])) {\n                found = i;\n                break;\n              }\n\n              else if (tree.choices[i].tag === tags.KSTAR && noam.util.areEquivalent(tree.choices[i].expr, tree.choices[j])) {\n                found = j;\n                break;\n              }\n            }\n\n            if (found >= 0) {\n              tree.choices.splice(found, 1);\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a*a* => a*\n      function _regex_simplify_13(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var found = -1;\n\n          for (var i=0; i<tree.elements.length-1; i++) {\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i+1].tag === tags.KSTAR && noam.util.areEquivalent(tree.elements[i], tree.elements[i+1])) {\n              found = i;\n              break;\n            }\n          }\n\n          if (found >= 0) {\n            tree.elements.splice(found+1, 1);\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // (aa+a)* => (a)*\n      function _regex_simplify_14(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT && tree.expr.choices.length >= 2) {\n          for (var i=0; i<tree.expr.choices.length; i++) {\n            for (var j=0; j<tree.expr.choices.length; j++) {\n              if (i !== j && tree.expr.choices[j].tag === tags.SEQ && tree.expr.choices[j].elements.length >= 2) {\n                var found = true;\n\n                for (var k=0; k<tree.expr.choices[j].elements.length; k++) {\n                  if (!(noam.util.areEquivalent(tree.expr.choices[i], tree.expr.choices[j].elements[k]))) {\n                    found = false;\n                    break;\n                  }\n                }\n\n                if (found) {\n                  tree.expr.choices.splice(j, 1);\n                  return true;\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (a + $)* => (a)*\n      function _regex_simplify_15(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT && tree.expr.choices.length >= 2) {\n          for (var i=0; i<tree.expr.choices.length; i++) {\n            if (tree.expr.choices[i].tag === tags.EPS) {\n              tree.expr.choices.splice(i, 1);\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (ab+ac) => a(b+c)\n      function _regex_simplify_16(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >=2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            if (tree.choices[i].tag === tags.SEQ && tree.choices[i].elements.length >= 2) {\n              for (var j=i+1; j<tree.choices.length; j++) {\n                if (tree.choices[j].tag === tags.SEQ && tree.choices[j].elements.length >= 2) {\n                  if (noam.util.areEquivalent(tree.choices[j].elements[0], tree.choices[i].elements[0])) {\n                    var first = tree.choices[i].elements[0];\n                    var rest1 = makeSeq(tree.choices[i].elements.slice(1));\n                    var rest2 = makeSeq(tree.choices[j].elements.slice(1));\n\n                    var _alt = makeAlt([rest1, rest2]);\n                    var _seq = makeSeq([first, _alt]);\n\n                    tree.choices[i] = _seq;\n                    tree.choices.splice(j, 1);\n\n                    return true;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a*aa* => aa*\n      function _regex_simplify_17(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >=3) {\n          for (var i=1; i<tree.elements.length-1; i++) {\n            if (tree.elements[i-1].tag === tags.KSTAR && tree.elements[i+1].tag === tags.KSTAR) {\n              if (noam.util.areEquivalent(tree.elements[i-1], tree.elements[i+1]) &&\n                  noam.util.areEquivalent(tree.elements[i-1].expr, tree.elements[i])) {\n                tree.elements.splice(i-1, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (ab+cb) => (a+c)b\n      function _regex_simplify_18(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >=2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            if (tree.choices[i].tag === tags.SEQ && tree.choices[i].elements.length >= 2) {\n              for (var j=i+1; j<tree.choices.length; j++) {\n                if (tree.choices[j].tag === tags.SEQ && tree.choices[j].elements.length >= 2) {\n                  if (noam.util.areEquivalent(tree.choices[j].elements[tree.choices[j].elements.length-1],\n                                              tree.choices[i].elements[tree.choices[i].elements.length-1])) {\n                    var last = tree.choices[i].elements[tree.choices[i].elements.length-1];\n                    var rest1 = makeSeq(tree.choices[i].elements.slice(0, tree.choices[i].elements.length-1));\n                    var rest2 = makeSeq(tree.choices[j].elements.slice(0, tree.choices[j].elements.length-1));\n\n                    var _alt = makeAlt([rest1, rest2]);\n                    var _seq = makeSeq([_alt, last]);\n\n                    tree.choices[i] = _seq;\n                    tree.choices.splice(j, 1);\n\n                    return true;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // L1+L2 => L2, if L1 is subset of L2\n      function _regex_simplify_19(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          var fsms = [];\n\n          fsms.push(getFromCacheOrCreateFsm(tree.choices[0], fsmCache));\n\n          var found = -1;\n\n          for (var i=0; i<tree.choices.length-1; i++) {\n            for (var j=i+1; j<tree.choices.length; j++) {\n              if (fsms.length <= j) {\n                fsms.push(getFromCacheOrCreateFsm(tree.choices[j], fsmCache));\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[i], fsms[j]) ) {\n                  found = j;\n                }\n              } catch (e) {\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[j], fsms[i]) ) {\n                  found = i;\n                }\n              } catch (e) {\n              }\n\n              if (found >= 0) {\n                tree.choices.splice(found, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n          return false;\n      }\n\n      // (L1+L2)* => L2*, if L1* is subset of L2*\n      function _regex_simplify_20(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT && tree.expr.choices.length >= 2) {\n          var fsms = [];\n\n          fsms.push(getFromCacheOrCreateFsm(makeKStar(tree.expr.choices[0]), fsmCache));\n\n          var found = -1;\n\n          for (var i=0; i<tree.expr.choices.length-1; i++) {\n            for (var j=i+1; j<tree.expr.choices.length; j++) {\n              if (fsms.length <= j) {\n                fsms.push(getFromCacheOrCreateFsm(makeKStar(tree.expr.choices[j]), fsmCache));\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[i], fsms[j]) ) {\n                  found = j;\n                }\n              } catch (e) {\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[j], fsms[i]) ) {\n                  found = i;\n                }\n              } catch (e) {\n              }\n\n              if (found >= 0) {\n                tree.expr.choices.splice(found, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      function getFromCacheOrCreateFsm(key, ht) {\n        var fsm = ht.get(key);\n\n        if (!(fsm)) {\n          fsm = noam.fsm.minimize(noam.re.tree.toAutomaton(key));\n          ht.put(key, fsm);\n        }\n\n        return fsm;\n      }\n\n      // L1*L2* => L2, if L1* is subset of L2*\n      function _regex_simplify_21(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var fsms = [];\n          fsms.push(getFromCacheOrCreateFsm(tree.elements[0], fsmCache));\n\n          var found = -1;\n\n          for (var i=0; i<tree.elements.length-1; i++) {\n            fsms.push(getFromCacheOrCreateFsm(tree.elements[i+1], fsmCache));\n\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i+1].tag === tags.KSTAR) {\n              try {\n                if (noam.fsm.isSubset(fsms[i], fsms[i+1]) ) {\n                  found = i+1;\n                }\n              } catch (e) {\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[i+1], fsms[i]) ) {\n                  found = i;\n                }\n              } catch (e) {\n              }\n\n              if (found >= 0) {\n                tree.elements.splice(found, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // $+L => L, if L contains $\n      function _regex_simplify_22(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length > 1) {\n          var index_eps = noam.util.index(tree.choices, makeEps());\n\n          if (index_eps >= 0) {\n            for (var i=0; i<tree.choices.length; i++) {\n              if (tree.choices[i].tag !== tags.EPS) {\n                var fsm = getFromCacheOrCreateFsm(tree.choices[i], fsmCache);\n\n                if (noam.fsm.isAcceptingState(fsm, fsm.initialState)) {\n                  tree.choices.splice(index_eps, 1);\n                  return true;\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a*($+b(a+b)*) => (a+b)*\n      function _regex_simplify_23(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length > 1) {\n          for (var i=0; i<tree.elements.length-1; i++) {\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i+1].tag === tags.ALT &&\n              tree.elements[i+1].choices.length === 2) {\n\n              var index_eps = noam.util.index(tree.elements[i+1].choices, makeEps());\n\n              if (index_eps >= 0) {\n                var internal = index_eps === 0 ? tree.elements[i+1].choices[1] : tree.elements[i+1].choices[0];\n\n                if (internal.tag === tags.SEQ && internal.elements.length === 2) {\n                  if (internal.elements[1].tag === tags.KSTAR && internal.elements[1].expr.tag === tags.ALT &&\n                      internal.elements[1].expr.choices.length === 2 && noam.util.contains(internal.elements[1].expr.choices, tree.elements[i].expr)) {\n                    if (noam.util.contains(internal.elements[1].expr.choices, internal.elements[0])) {\n                      tree.elements[i+1] = internal.elements[1];\n                      tree.elements.splice(i, 1);\n                      return true;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // ($+(a+b)*a)b* => (a+b)*\n      function _regex_simplify_24(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length > 1) {\n          for (var i=1; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i-1].tag === tags.ALT &&\n              tree.elements[i-1].choices.length === 2) {\n\n              var index_eps = noam.util.index(tree.elements[i-1].choices, makeEps());\n\n              if (index_eps >= 0) {\n                var internal = index_eps === 0 ? tree.elements[i-1].choices[1] : tree.elements[i-1].choices[0];\n\n                if (internal.tag === tags.SEQ && internal.elements.length === 2) {\n                  if (internal.elements[0].tag === tags.KSTAR && internal.elements[0].expr.tag === tags.ALT &&\n                      internal.elements[0].expr.choices.length === 2 && noam.util.contains(internal.elements[0].expr.choices, tree.elements[i].expr)) {\n                    if (noam.util.contains(internal.elements[0].expr.choices, internal.elements[1])) {\n                      tree.elements[i-1] = internal.elements[0];\n                      tree.elements.splice(i, 1);\n                      return true;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (L1+$)(L2)* => (L2)* if L1 is subset of L2\n      function _regex_simplify_27(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length > 1) {\n          for (var i=0; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.KSTAR) {\n              if (i > 0 && tree.elements[i-1].tag === tags.ALT && tree.elements[i-1].choices.length > 1) {\n                var index_eps = noam.util.index(tree.elements[i-1].choices, makeEps());\n\n                if (index_eps >= 0) {\n                  var eps = tree.elements[i-1].choices.splice(index_eps, 1)[0];\n\n                  var fsm_kstar = getFromCacheOrCreateFsm(tree.elements[i], fsmCache);\n                  var fsm_other = getFromCacheOrCreateFsm(tree.elements[i-1], fsmCache);\n\n                  var found = false;\n\n                  try {\n                    if (noam.fsm.isSubset(fsm_kstar, fsm_other)) {\n                      found = true;\n                    }\n                  } catch (e) {\n                  }\n\n                  if (found) {\n                    tree.elements.splice(i-1, 1);\n                    return true;\n                  } else {\n                    tree.elements[i-1].choices.splice(index_eps, 0, eps);\n                  }\n                }\n              } else if (i < tree.elements.length-1 && tree.elements[i+1].tag === tags.ALT && tree.elements[i+1].choices.length > 1) {\n                var index_eps = noam.util.index(tree.elements[i+1].choices, makeEps());\n\n                if (index_eps >= 0) {\n                  var eps = tree.elements[i+1].choices.splice(index_eps, 1)[0];\n\n                  var fsm_kstar = getFromCacheOrCreateFsm(tree.elements[i], fsmCache);\n                  var fsm_other = getFromCacheOrCreateFsm(tree.elements[i+1], fsmCache);\n\n                  var found = false;\n\n                  try {\n                    if (noam.fsm.isSubset(fsm_kstar, fsm_other)) {\n                      found = true;\n                    }\n                  } catch (e) {\n                  }\n\n                  if (found) {\n                    tree.elements.splice(i+1, 1);\n                    return true;\n                  } else {\n                    tree.elements[i+1].choices.splice(index_eps, 0, eps);\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      // (a()) => ()\n      function _regex_simplify_25(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 1) {\n          for (var i=0; i<tree.elements.length; i++) {\n            if ((tree.elements[i].tag === tags.SEQ && tree.elements[i].elements.length === 0) ||\n                (tree.elements[i].tag === tags.ALT && tree.elements[i].choices.length === 0)) {\n              tree.elements = [];\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // ()* => ()\n      function _regex_simplify_26(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.SEQ && tree.expr.elements.length === 0) {\n          tree.tag = tags.SEQ;\n          delete tree.expr;\n          tree.elements = [];\n          return true;\n        }\n\n        return false;\n      }\n\n      _regex_simplification_patterns.push({ 'pattern' : \"(a()) => ()\", 'type' : 'structure', 'function' : _regex_simplify_25});\n      _regex_simplification_patterns.push({ 'pattern' : \"()* => ()\", 'type' : 'structure', 'function' : _regex_simplify_26});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a) => a\", 'type' : 'structure', 'function' : _regex_simplify_1 });\n      _regex_simplification_patterns.push({ 'pattern' : \"(a) => a\", 'type' : 'structure', 'function' : _regex_simplify_2 });\n      _regex_simplification_patterns.push({ 'pattern' : \"$* => $\", 'type' : 'structure', 'function' : _regex_simplify_3});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a*)* => a*\", 'type' : 'structure', 'function' : _regex_simplify_4});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a+b*)* => (a+b)*\", 'type' : 'structure', 'function' : _regex_simplify_5});\n      _regex_simplification_patterns.push({ 'pattern' : \"$+a* => a*\", 'type' : 'structure', 'function' : _regex_simplify_6});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a*b*)* => (a*+b*)*\", 'type' : 'structure', 'function' : _regex_simplify_7});\n      _regex_simplification_patterns.push({ 'pattern' : \"$a => a\", 'type' : 'structure', 'function' : _regex_simplify_8});\n      _regex_simplification_patterns.push({ 'pattern' : \"a+a => a\", 'type' : 'structure', 'function' : _regex_simplify_11});\n      _regex_simplification_patterns.push({ 'pattern' : \"a+a* => a*\", 'type' : 'structure', 'function' : _regex_simplify_12});\n      _regex_simplification_patterns.push({ 'pattern' : \"a*a* => a*\", 'type' : 'structure', 'function' : _regex_simplify_13});\n      _regex_simplification_patterns.push({ 'pattern' : \"(aa+a)* => (a)*\", 'type' : 'structure', 'function' : _regex_simplify_14});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a + $)* => (a)*\", 'type' : 'structure', 'function' : _regex_simplify_15});\n      _regex_simplification_patterns.push({ 'pattern' : \"(ab+ac) => a(b+c)\", 'type' : 'structure', 'function' : _regex_simplify_16});\n      _regex_simplification_patterns.push({ 'pattern' : \"a*aa* => aa*\", 'type' : 'structure', 'function' : _regex_simplify_17});\n      _regex_simplification_patterns.push({ 'pattern' : \"(ab+cb) => (a+c)b\", 'type' : 'structure', 'function' : _regex_simplify_18});\n      _regex_simplification_patterns.push({ 'pattern' : \"a*($+b(a+b)*) => (a+b)*\", 'type' : 'structure', 'function' : _regex_simplify_23});\n      _regex_simplification_patterns.push({ 'pattern' : \"($+(a+b)*a)b* => (a+b)*\", 'type' : 'structure', 'function' : _regex_simplify_24});\n      _regex_simplification_patterns.push({ 'pattern' : \"$+L => L, if L contains $\", 'type' : 'fsm', 'function' : _regex_simplify_22});\n      _regex_simplification_patterns.push({ 'pattern' : \"L1+L2 => L2, if L1 is subset of L2\", 'type' : 'fsm', 'function' : _regex_simplify_19});\n      _regex_simplification_patterns.push({ 'pattern' : \"(L1+L2)* => L2, if L1* is subset of L2*\", 'type' : 'fsm', 'function' : _regex_simplify_20});\n      _regex_simplification_patterns.push({ 'pattern' : \"L1*L2* => L2, if L1* is subset of L2*\", 'type' : 'fsm', 'function' : _regex_simplify_21});\n      _regex_simplification_patterns.push({ 'pattern' : \"(L1+$)(L2)* => (L2)* if L1 is subset of L2\", 'type' : 'fsm', 'function' : _regex_simplify_27});\n      _regex_simplification_patterns.push({ 'pattern' : \"ab(cd) => abcd\", 'type' : 'structure', 'function' : _regex_simplify_10});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a+(b+c)) => a+b+c\", 'type' : 'structure', 'function' : _regex_simplify_9});\n\n      function simplify(tree, config) {\n        var treeClone = noam.util.clone(tree);\n\n        if (typeof config === \"undefined\") {\n          config = {};\n        }\n\n        var opts = noam.util.clone(config);\n\n        if (typeof opts.numIterations === \"undefined\") {\n          opts.numIterations = null;\n        }\n\n        if (typeof opts.appliedPatterns === 'undefined') {\n          opts.appliedPatterns = null;\n        } else {\n          opts.appliedPatterns = config.appliedPatterns;\n        }\n\n        if (typeof opts.useFsmPatterns === \"undefined\") {\n          opts.useFsmPatterns = true;\n        }\n\n        var appliedPattern = \"temp\";\n        var iterCount = 0;\n        var fsmCache = new noam.util.HashTable();\n\n        while (appliedPattern !== null && (opts.numIterations === null || iterCount < opts.numIterations)) {\n          appliedPattern = _simplify_iteration(treeClone, fsmCache, opts.useFsmPatterns);\n\n          if (appliedPattern !== null && opts.appliedPatterns !== null) {\n            opts.appliedPatterns.push(appliedPattern);\n          }\n\n          iterCount += 1;\n        }\n\n        return treeClone;\n      }\n\n      function _simplify_iteration(tree, fsmCache, useFsmPatterns) {\n        var pattern = null;\n        var result = null;\n\n        for (var i=0; i<_regex_simplification_patterns.length; i++) {\n          pattern = _regex_simplification_patterns[i];\n\n          if (useFsmPatterns === false && pattern.type === \"fsm\") {\n            continue;\n          }\n\n          result = _simplify_recursion(tree, pattern['function'], fsmCache);\n\n          if (result) {\n            return pattern.pattern;\n          }\n        }\n\n        return null;\n      }\n\n      function _simplify_recursion(tree, patternFunction, fsmCache) {\n        var appliedPattern = patternFunction(tree, fsmCache);\n\n        if (appliedPattern) {\n          return appliedPattern;\n        }\n\n        var children = [];\n\n        if (tree.tag === tags.ALT) {\n          children = tree.choices;\n        } else if (tree.tag === tags.SEQ) {\n          children = tree.elements;\n        } else if (tree.tag === tags.KSTAR) {\n          children = [tree.expr];\n        }\n\n        for (var i=0; i<children.length; i++) {\n          appliedPattern = _simplify_recursion(children[i], patternFunction, fsmCache);\n          if (appliedPattern) {\n            return appliedPattern;\n          }\n        }\n\n        return false;\n      }\n\n      // The choices parameter must be an array of expression trees.\n      // Returns the root of a new tree that represents the expression that is the union of\n      // all the choices.\n      function makeAlt(choices) {\n        return {\n          tag: tags.ALT,\n          choices: choices\n        };\n      }\n\n      // The elements parameter must be an array of expression trees.\n      // Returns the root of a new tree that represents the expression that is the sequence\n      // of all the elements.\n      function makeSeq(elements) {\n        return {\n          tag: tags.SEQ,\n          elements: elements\n        };\n      }\n\n      // Wraps the given expressin tree unde a Kleene star operator.\n      // Returns the root of the new tree.\n      function makeKStar(expr) {\n        return {\n          tag: tags.KSTAR,\n          expr: expr\n        };\n      }\n\n      // Creates a node that represents the literal obj.\n      function makeLit(obj) {\n        return {\n          tag: tags.LIT,\n          obj: obj\n        };\n      }\n\n      var epsNode = {\n        tag: tags.EPS\n      };\n      // Returns a node representing the empty string regular expression.\n      function makeEps() {\n        return epsNode;\n      }\n\n      function _altToAutomaton(regex, automaton, stateCounter) {\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        for (var i=0; i<regex.choices.length; i++) {\n          var statePair = _dispatchToAutomaton(regex.choices[i], automaton, stateCounter);\n          noam.fsm.addEpsilonTransition(automaton, l, [statePair[0]]);\n          noam.fsm.addEpsilonTransition(automaton, statePair[1], [r]);\n        }\n        return [l, r];\n      }\n\n      function _seqToAutomaton(regex, automaton, stateCounter) {\n        // Create the parts for the sequence elements and connect them via epsilon transitions.\n        var l, r, statePair;\n        for (var i=0; i<regex.elements.length; i++) {\n          statePair = _dispatchToAutomaton(regex.elements[i], automaton, stateCounter);\n          if (i === 0) { // this is the first element\n            l = statePair[0];\n          } else { // this is a later element that needs to be connected to the previous elements\n            noam.fsm.addEpsilonTransition(automaton, r, [statePair[0]]);\n          }\n          r = statePair[1];\n        }\n\n        if (l === undefined) { // empty language\n          l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n          r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        }\n\n        return [l, r];\n      }\n\n      function _KStarToAutomaton(regex, automaton, stateCounter) {\n        // The $ sign in the following drawing represents an epsilon transition.\n        //\n        //    ----------------$>----------------\n        //   /                                  \\\n        // |l|-$>-|ll|...(regex.expr)...|rr|-$>-|r|\n        //          \\_________<$_________/\n        //\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var inner = _dispatchToAutomaton(regex.expr, automaton, stateCounter);\n        var ll = inner[0];\n        var rr = inner[1];\n        noam.fsm.addEpsilonTransition(automaton, l, [r]); // zero times\n        noam.fsm.addEpsilonTransition(automaton, l, [ll]); // once or more times\n        noam.fsm.addEpsilonTransition(automaton, rr, [ll]); // repeat\n        noam.fsm.addEpsilonTransition(automaton, rr, [r]); // continue after one or more repetitions\n\n        return [l, r];\n      }\n\n      function _litToAutomaton(regex, automaton, stateCounter) {\n        // Generate the \"left\" and \"right\" states and connect them with the appropriate\n        // transition symbol.\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        try {\n          noam.fsm.addSymbol(automaton, regex.obj);\n        } catch (err) {\n            // addSymbol can throw if the symbol already exists - that's ok but\n            // would like to be able to avoid catching other exceptions\n            // TODO: use a custom exception class instead of Error\n        }\n        noam.fsm.addTransition(automaton, l, [r], regex.obj);\n        return [l, r];\n      }\n\n      function _epsToAutomaton(regex, automaton, stateCounter) {\n        // Generate the \"left\" and \"right\" states and connect them with an epsilon transition.\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        noam.fsm.addEpsilonTransition(automaton, l, [r]);\n        return [l, r];\n      }\n\n      var _toAutomatonFuns = {};\n      _toAutomatonFuns[tags.ALT] = _altToAutomaton;\n      _toAutomatonFuns[tags.SEQ] = _seqToAutomaton;\n      _toAutomatonFuns[tags.KSTAR] = _KStarToAutomaton;\n      _toAutomatonFuns[tags.LIT] = _litToAutomaton;\n      _toAutomatonFuns[tags.EPS] = _epsToAutomaton;\n\n      // Calls the appropriate *ToAutomaton function to handle the various kinds of regular expressions.\n      // @a stateCounter holds the number of the next state to be added to the automaton.\n      // Every *ToAutomaton function modifies @a automaton and returns a pair of states (as a two element array).\n      // The first state is the start state and the second state is the accepting state of the part of the\n      // automaton that accepts the language defined by @a regex.\n      function _dispatchToAutomaton(regex, automaton, stateCounter) {\n        return _toAutomatonFuns[regex.tag](regex, automaton, stateCounter);\n      }\n\n      // Returns the equivalent FSM for the specified regular expression in the tree representation.\n      function toAutomaton(regex) {\n        var automaton = noam.fsm.makeNew();\n        var statePair = _dispatchToAutomaton(regex, automaton, noam.util.makeCounter(0));\n        noam.fsm.setInitialState(automaton, statePair[0]);\n        noam.fsm.addAcceptingState(automaton, statePair[1]);\n        return automaton;\n      }\n\n\n      // \"Operator\" precedence lookup. This is used when determining if we need to\n      // insert parentheses to preserve the meaning of the regex when converting from\n      // the tree representation to the array representation.\n      var _prec = {};\n      _prec[tags.ALT] = 0;\n      _prec[tags.SEQ] = 1;\n      _prec[tags.KSTAR] = 2;\n      // these two are not operators, but it's convenient to assign them a precedence\n      // for uniformity... since they are just atoms (i.e. can't be \"regrouped\"), their\n      // precedence is higher than all the operators\n      _prec[tags.LIT] = 3;\n      _prec[tags.EPS] = 3;\n\n      // Returns true if parantheses are needed around the child expression\n      // when it is embedded into the parent expression, false otherwise.\n      function _needParens(par, child) {\n        return _prec[par.tag] >= _prec[child.tag];\n      }\n\n      // Add child to the array representation, and surround it with parentheses\n      // if necessary.\n      function _optParenToArray(par, child, arr) {\n        var parens = _needParens(par, child);\n        if (parens) {\n            arr.push(noam.re.array.specials.LEFT_PAREN);\n        }\n        _dispatchToArray(child, arr);\n        if (parens) {\n            arr.push(noam.re.array.specials.RIGHT_PAREN);\n        }\n      }\n\n      // Common implementation for _altToArray and _seqToArray.\n      function _binOpToArray(regex, arr, parts, operand) {\n        for (var i=0; i<parts.length; i++) {\n          if (operand!==undefined && i>0) {\n            arr.push(operand);\n          }\n          _optParenToArray(regex, parts[i], arr);\n        }\n      }\n\n      function _altToArray(regex, arr) {\n        _binOpToArray(regex, arr, regex.choices, noam.re.array.specials.ALT);\n      }\n\n      function _seqToArray(regex, arr) {\n        _binOpToArray(regex, arr, regex.elements);\n      }\n\n      function _KStarToArray(regex, arr) {\n        _optParenToArray(regex, regex.expr, arr);\n        arr.push(noam.re.array.specials.KSTAR);\n      }\n\n      function _litToArray(regex, arr) {\n        arr.push(regex.obj);\n      }\n\n      function _epsToArray(regex, arr) {\n        arr.push(noam.re.array.specials.EPS);\n      }\n\n      var _toArrayFuns = {};\n      _toArrayFuns[tags.ALT] = _altToArray;\n      _toArrayFuns[tags.SEQ] = _seqToArray;\n      _toArrayFuns[tags.KSTAR] = _KStarToArray;\n      _toArrayFuns[tags.LIT] = _litToArray;\n      _toArrayFuns[tags.EPS] = _epsToArray;\n\n      // Calls the appropriate *ToArray function to handle the various kinds of regular expressions.\n      // @a arr acts as an accumulator for all *ToArray functions.\n      function _dispatchToArray(regex, arr) {\n        return _toArrayFuns[regex.tag](regex, arr);\n      }\n\n      // Returns the array representation (i.e. noam.re.array) of @a regex which must\n      // be in the tree (i.e. noam.re.tree) representation.\n      // Parentheses are inserted into the array to preserve the meaning of the\n      // regex. However, this does not really lead to minimal parenthesization because\n      // it doesn't consider any rewriting rules. More specifically, if there were\n      // parentheses that modify associativity of alteration or sequencing in the\n      // original regex that was parsed into this tree, they will be preserved\n      // even though they are not necessary.\n      function toArray(regex) {\n        var arr = [];\n        _dispatchToArray(regex, arr);\n        return arr;\n      }\n\n      // Returns the string representation of @a regex which must be in the tree\n      // (i.e. noam.re.tree) representation. This is not always possible, so\n      // this function throws when the regex contains some symbols which are not\n      // single-character strings.\n      //\n      // Semantically equivalent to first calling toArray and then calling\n      // noam.re.array.toString on the result.\n      function toString(regex) {\n        return noam.re.array.toString(toArray(regex));\n      }\n\n      // Returns a random regex containing at most @a numSymbols symbols from the\n      // specified array of possible symbols @a alphabet. The probability distribution\n      // of symbol selection is uniform and can be skewed by repeating elements in\n      // alphabet. The parameter @a cfg is optional and can contain the following\n      // fields:\n      //   ALT_PROB    - the probability that alteration is used between two subexpressions\n      //                 instead of sequencing (default 0.5)\n      //   KLEENE_PROB - the probability that any subexpression is put under the Kleene\n      //                 star operator (default 0.1)\n      //   EPS_PROB    - the probability that epsilon is added as an alteration choice\n      //                 (default 0.1)\n      function random(numSymbols, alphabet, cfg) {\n        var altp = 0.5;\n        var kleenep = 0.1;\n        var epsp = 0.1;\n        if (cfg) {\n          if (cfg.ALT_PROB) {\n            altp = cfg.ALT_PROB;\n          }\n          if (cfg.KLEENE_PROB) {\n            kleenep = cfg.KLEENE_PROB;\n          }\n          if (cfg.EPS_PROB) {\n            epsp = cfg.EPS_PROB;\n          }\n        }\n\n        return _randomKleene(numSymbols, alphabet, altp, kleenep, epsp);\n      }\n\n      function _randomKleene(numSymbols, alphabet, altp, kleenep, epsp) {\n        var expr = _randomExpr(numSymbols, alphabet, altp, kleenep, epsp);\n        if (Math.random() <= kleenep) {\n          expr = makeKStar(expr);\n        }\n        return expr;\n      }\n\n      function _randomExpr(numSymbols, alphabet, altp, kleenep, epsp) {\n        if (numSymbols === 0) {\n          return makeEps();\n        } else if (numSymbols == 1) {\n          return makeLit(alphabet[noam.util.randint(0, alphabet.length-1)]);\n        } else if (Math.random() <= epsp) {\n          return makeAlt([makeEps(),\n              _randomKleene(numSymbols, alphabet, altp, kleenep, epsp)]);\n        } else {\n          var left_sz = noam.util.randint(1, numSymbols-1);\n          var left = _randomKleene(left_sz, alphabet, altp, kleenep, epsp);\n          var right = _randomKleene(numSymbols - left_sz, alphabet, altp, kleenep, epsp);\n          if (Math.random() <= altp) {\n            return makeAlt([left, right]);\n          } else {\n            return makeSeq([left, right]);\n          }\n        }\n      }\n\n      return {\n        tags: tags,\n\n        makeAlt: makeAlt,\n        makeSeq: makeSeq,\n        makeKStar: makeKStar,\n        makeLit: makeLit,\n        makeEps: makeEps,\n\n        toAutomaton: toAutomaton,\n        toArray: toArray,\n        toString: toString,\n\n        random: random,\n        simplify: simplify\n      };\n    })();\n\n    /*\n     * A linear representation of regular expressions.\n     * Every symbol can be an arbitrary object.\n     *\n     * Regular expression operators, parentheses and epsilon must be represented using\n     * the array.specials constants.\n     *\n     * Concatenation is implicit when there are no operators between two subexpressions.\n     * The default operator precedence is Kleene star > concatenation > alteration, and\n     * can be modified using parentheses.\n     */\n    var array = (function() {\n      // This is based on object identity, i.e. each of these constants will be different\n      // from any other object that can be inserted into the regex array.\n      var specials = {\n        ALT: {},\n        KSTAR: {},\n        LEFT_PAREN: {},\n        RIGHT_PAREN: {},\n        EPS: {}\n      };\n\n      // give objects their usual string representation\n      specials.ALT.toString = function() { return \"+\"; };\n      specials.KSTAR.toString = function() { return \"*\"; };\n      specials.LEFT_PAREN.toString = function() { return \"(\"; };\n      specials.RIGHT_PAREN.toString = function() { return \")\"; };\n      specials.EPS.toString = function() { return \"$\"; };\n\n      /* Custom Error constructor for regular expression errors.\n       *\n       * Every RegexError object has the following properties:\n       *  - name: the string \"RegexError\"\n       *  - message: a string description of the error\n       *  - position: a number specifying the 0-based index of the position where the error\n       *              was found (note that this might not be where the error actually is, i.e.\n       *              this number is a hint rather than a definite answer)\n       */\n      function RegexError(message, position) {\n        this.name = \"RegexError\";\n        this.message = message;\n        this.position = position;\n      }\n\n      // We do this to get the stack trace when RegexError objects are thrown.\n      RegexError.prototype = new Error();\n\n      // The next three functions are used to make a convenient array wrapper\n      // used in the parsing code.\n      //\n      // This peek method relies on the fact that accessing \"out of bounds\"\n      // will return undefined.\n      function _peek() {\n        return this.arr[this.idx];\n      }\n      function _advance() {\n        ++this.idx;\n      }\n      function _makeInputSeq(arr) {\n        return {\n          arr: arr,\n          idx: 0,\n          peek: _peek,\n          advance: _advance\n        };\n      }\n\n      // Returns the tree representation of the regex given by @a arr.\n      function toTree(arr) {\n        // special case for the empty language\n        // empty subexpressions are not allowed except when defining the empty language\n        if (arr.length === 0) {\n          return noam.re.tree.makeSeq([]);\n        }\n        var input = _makeInputSeq(arr);\n        var result = _parseExpr(input);\n\n        // should be at end of input\n        if (input.peek() !== undefined) {\n          throw new RegexError(\"Malformed regex array: successfully parsed up to position \" + input.idx, input.idx);\n        }\n        return result;\n      }\n\n      // Returns the replacement string for objects in noam.re.array.specials or\n      // undefined if @a obj doesn't match any of them.\n      function _replacementStr(obj) {\n        // This can't be done with a dict because objects are not hashable...\n        if (obj === specials.ALT || obj === specials.KSTAR ||\n            obj === specials.LEFT_PAREN || obj === specials.RIGHT_PAREN ||\n            obj === specials.EPS) {\n          return obj.toString();\n        } else {\n          return undefined;\n        }\n      }\n\n      // If @a chr is one of the escapable characters\n      // in the string representation (i.e. element of noam.re.string.escapable),\n      // returns it prefixed by a backslash (i.e. escaped).\n      // Otherwise returns chr unchanged.\n      function _escape(chr) {\n        var escapable = noam.re.string.escapable;\n        for (var i=0; i<escapable.length; i++) {\n          if (chr === escapable[i]) {\n            return \"\\\\\" + chr;\n          }\n        }\n        return chr;\n      }\n\n      // Returns the string representation of the regex given by @a arr.\n      //\n      // Throws if the regex contains any symbols which are not one-character strings\n      // and special symbols from noam.re.array.specials.\n      function toString(arr) {\n        var res = [];\n        var elem;\n        var failed = false;\n        for (var i=0; i<arr.length; i++) {\n          elem = arr[i];\n          if (typeof(elem) === \"string\") {\n            if (elem.length !== 1) {\n              failed = true;\n            } else {\n              elem = _escape(elem);\n            }\n          } else {\n            elem = _replacementStr(elem);\n            if (elem === undefined) {\n              failed = true;\n            }\n          }\n          if (failed) {\n            throw new RegexError(\"Array regex not convertible to string representation:\" +\n                \" failed at position \" + i, i);\n          }\n          res.push(elem);\n        }\n        return res.join(\"\");\n      }\n\n      // Returns the automaton accepting the language represented by the regex @a arr.\n      //\n      // Semantically equivalent to first calling toTree on @a arr and then converting\n      // the result to an automaton via noam.re.tree.toAutomaton.\n      function toAutomaton(arr) {\n        var tree = noam.re.array.toTree(arr);\n        return noam.re.tree.toAutomaton(tree);\n      }\n\n      // <expr> ::= <concat> (\"|\" <concat>)*\n      function _parseExpr(input) {\n        var concats = [];\n        while (true) {\n          concats.push(_parseConcat(input));\n          if (input.peek() === specials.ALT) {\n            input.advance();\n          } else {\n            break;\n          }\n        }\n\n        return noam.re.tree.makeAlt(concats);\n      }\n\n      // <concat> ::= <katom>+\n      function _parseConcat(input) {\n        var katoms = [];\n        var katom;\n        while (true) {\n          katom = _parseKatom(input);\n          if (katom === undefined) {\n            break;\n          }\n          katoms.push(katom);\n        }\n        if (katoms.length === 0) {\n          throw new RegexError(\"Malformed regex array: empty choice subexpression at index \" +\n              input.idx, input.idx);\n        }\n\n        return noam.re.tree.makeSeq(katoms);\n      }\n\n      // <katom> ::= <atom> (\"*\" | eps)\n      function _parseKatom(input) {\n        var atom = _parseAtom(input);\n        if (input.peek() === specials.KSTAR) {\n          input.advance();\n          atom = noam.re.tree.makeKStar(atom);\n        }\n        return atom;\n      }\n\n      // <atom> ::= \"(\" <expr> \")\" | eps | symbol\n      function _parseAtom(input) {\n        if (input.peek() === specials.LEFT_PAREN) {\n          input.advance(); // skip the left parenthesis\n          var expr = _parseExpr(input);\n          if (input.peek() !== specials.RIGHT_PAREN) {\n            throw new RegexError(\"Malformed regex array: missing matching right parenthesis at index \" +\n                input.idx, input.idx);\n          }\n          input.advance(); // skip the right parenthesis\n          return expr;\n        } else if (input.peek() === specials.EPS) {\n          input.advance();\n          return noam.re.tree.makeEps();\n        } else if (input.peek()===undefined || input.peek()===specials.ALT ||\n              input.peek()===specials.RIGHT_PAREN) {\n          return undefined; // this will stop the parsing of <concat>\n        } else if (input.peek() === specials.KSTAR) {\n            throw new RegexError(\"Malformed regex array: empty subexpression before Kleene star at index \" +\n                input.idx, input.idx);\n        } else {\n          var sym = noam.re.tree.makeLit(input.peek());\n          input.advance();\n          return sym;\n        }\n      }\n\n      // Returns a random regex in the array representation.\n      // See noam.re.tree.random for further information.\n      function random(numSymbols, alphabet, cfg) {\n        return noam.re.tree.toArray(noam.re.tree.random(numSymbols, alphabet, cfg));\n      }\n\n      function simplify(arr, numIterations, appliedPatterns) {\n        var tree = noam.re.array.toTree(arr);\n        var treeSimplified = noam.re.tree.simplify(tree, numIterations, appliedPatterns);\n        return noam.re.tree.toArray(treeSimplified);\n      }\n\n      return {\n        specials: specials,\n\n        toTree: toTree,\n        toString: toString,\n        toAutomaton: toAutomaton,\n\n        random: random,\n        simplify: simplify\n      };\n    })();\n\n\n    /*\n     * A string representation of regular expressions.\n     *\n     * The alphabet is limited to string characters, i.e. every character in the string is an input\n     * symbol in the language except:\n     *    - the dollar symbol ($) which is used as epsilon, i.e. the empty string\n     *    - the plus character (+) which is used as the alteration operator\n     *    - the star character (*) which is used as the Kleene star\n     *    - parentheses which are used for grouping\n     *    - the backslash character (\\) which is used for escaping the special meaning of all\n     *      the listed characters, including backslash itself; for example, the regex\n     *      \"(a+b)*\\\\+\" represents the language of all strings of as and bs ending in one\n     *      plus character (notice that due to the fact that backslash also escapes in\n     *      JavaScript strings, we need two backslashes to get the two-character\n     *      sequence \\+ that we want)\n     */\n    var string = (function() {\n\n      var escapable = \"$+*()\\\\\";\n\n      // Returns the array representation of the regex represented by @a str.\n      //\n      // Throws an Error if @a str contains illegal escape sequences.\n      function toArray(str) {\n        var arr = [];\n        var escaped = false;\n        var specials = noam.re.array.specials;\n        var chr;\n        for (var i=0; i<str.length; ++i) {\n          if (escaped) {\n            if (escapable.indexOf(str[i]) === -1) {\n              throw new RegexError(\"Malformed string regex: illegal escape sequence \\\\\" + str[i], i);\n            }\n            arr.push(str[i]); // the result of the escape sequence is the escaped character itself\n            escaped = false;\n          } else if (str[i] === '\\\\') {\n            escaped = true;\n          } else {\n            chr = str[i];\n            switch (chr) {\n              case \"$\": chr = specials.EPS; break;\n              case \"+\": chr = specials.ALT; break;\n              case \"*\": chr = specials.KSTAR; break;\n              case \"(\": chr = specials.LEFT_PAREN; break;\n              case \")\": chr = specials.RIGHT_PAREN; break;\n            }\n            arr.push(chr);\n          }\n        }\n        if (escaped) {\n          throw new RegexError(\"Malformed string regex: unfinished escape sequence at end of string\", str.length-1);\n        }\n\n        return arr;\n      }\n\n      // Returns the tree representation of the regex represented by @a str.\n      //\n      // Semantically equivalent to first converting the @a str to the array\n      // representation via noam.re.string.toArray and then converting the\n      // result to a tree via noam.re.array.toTree.\n      function toTree(str) {\n        var arr = noam.re.string.toArray(str);\n        return noam.re.array.toTree(arr);\n      }\n\n      // Returns an FSM accepting the language of the regex represented by @a str.\n      //\n      // Semantically equivalent to first converting the @a str to the array\n      // representation via noam.re.string.toArray, then converting the\n      // result to a tree via noam.re.array.toTree and finally converting the result\n      // of that to an automaton via noam.re.tree.toAutomaton.\n      function toAutomaton(str) {\n        var tree = noam.re.string.toTree(str);\n        return noam.re.tree.toAutomaton(tree);\n      }\n\n      // Returns a random regex string. @a alphabet must be a string. The other\n      // parameters have exactly the same role as in noam.re.tree.random.\n      function random(numSymbols, alphabet, cfg) {\n        var arr = [];\n        for (var i=0; i<alphabet.length; i++) {\n          arr.push(alphabet.charAt(i));\n        }\n        return noam.re.tree.toString(noam.re.tree.random(numSymbols, arr, cfg));\n      }\n\n      function simplify(str, numIterations, appliedPatterns) {\n        var tree = noam.re.string.toTree(str);\n        var treeSimplified = noam.re.tree.simplify(tree, numIterations, appliedPatterns);\n        return noam.re.tree.toString(treeSimplified);\n      }\n\n      return {\n        escapable: escapable,\n\n        toArray: toArray,\n        toTree: toTree,\n        toAutomaton: toAutomaton,\n\n        random: random,\n        simplify: simplify\n      };\n\n    })();\n\n    return {\n      tree: tree,\n      array: array,\n      string: string\n    };\n  })();\n\n  return noam;\n}())));\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? function(obj) { return Object.getPrototypeOf(obj); } : function(obj) { return obj.__proto__; };\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach(function(key) { def[key] = function() { return value[key]; }; });\n\t}\n\tdef['default'] = function() { return value; };\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + \"webfontloader\" + \".\" + \"02ff9497\" + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"dfa-regex:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkdfa_regex\"] = self[\"webpackChunkdfa_regex\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(6784); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","id","module","exports","class","_createVNode","_component_v_app","_component_v_main","_component_v_sheet","width","_component_AlphabetLister","_component_v_divider","_component_StateHelper","_createElementVNode","_hoisted_1","height","color","elevation","_component_v_btn_toggle","$setup","m","$event","mandatory","rounded","_createElementBlock","_Fragment","_renderList","tools","t","_createBlock","_component_v_btn","key","name","value","text","_component_v_tooltip","activator","contentClass","_hoisted_2","_toDisplayString","hotkey","_hoisted_3","onClick","_cache","mainStore","deleteAll","_component_FSMVisualizer","_component_v_text_field","regex","label","hideDetails","variant","onKeydown","_withKeys","genDFA","target","_component_TransitionFab","InputProcessorKeyboardEvent","ipkey","this","_ipkey","replace","InputProcessor","seperator","activeKeys","ip","states","filter","v","map","ipkeySet","Set","altKey","ctrlKey","shiftKey","split","splitter","at","constructor","ev","_defineProperty","Object","assign","getModifierState","mouse","InputProcessorMouseEvent","cursor","client","structuredClone","screen","lastClick","isDragging","dragDiff","x","y","EventEmitter","__evs__","__any__","has","event","undefined","on","cb","push","onAny","off","i","findIndex","toString","splice","emit","args","forEach","renameEvent","oldEvent","newEvent","InputProcessorConfig","recognize","capKey","toUpperCase","match","length","charCode","charCodeAt","serialize","Array","isArray","sort","nonModifierIndex","k","MODIFIERS","includes","join","element","config","super","MouseInputModule","c","String","fromCharCode","n","monitor","el","__built_listeners__","bl","removeEventListener","fn","captureMouse","tagName","tabIndex","captureKey","addEventListener","bind","console","warn","__onKeyDown","__onKeyUp","__onFocusOut","toLowerCase","entries","check","every","direction","u","d","l","r","reset","focus","release","_processKeyBoardEvent","ALT","CONTROL","SHIFT","keyprop","active_keys","unshift","combined","ipev","preventDefault","repeat","Coordinate","difference","coord","sum","clone","arr","_monitor","__onClick","__onAuxClick","__onDblClick","__onContextMenu","__onMouseDown","__onMouseUp","__onMouseEnter","__onMouseOver","__onMouseLeave","__onMouseOut","__onMouseMove","processor","_ip","__processMouseEvent__","rect","getBoundingClientRect","screenX","screenY","clientX","left","clientY","top","type","ipmouse","buttons","Util","genString","len","Math","random","substring","FindHits","s","hits","drawArcFromTwoPoints","ctx","fx","fy","tx","ty","arcAngle","cw","f","Victor","a2","mix","distance","ti","cos","deg2Rad","center","subtract","rotateDeg","norm","multiplyScalar","coa","add","strokeStyle","sa","invert","angle","ea","beginPath","arc","toArray","stroke","closePath","ctd","ct","start","end","line","moveTo","lineTo","drawArrow","arrowAngle","goIn","o","a","fill","deg","PI","rad","StateOptions","deg360","State","options","defOptions","pos","sq","radius","draw","border","borderColor","bg","fullWidth","isFinish","fillStyle","ellipse","textAlign","font","fillText","isStart","Transition","from","to","equalWith","equals","other","addValue","removeValue","transitionStore","useTransitionStore","removeTransition","str","vdir","vnorm","arrAngle","textPos","tw","measureText","getTransitionIndex","arcLoc","tmp","maxArc","minArc","distanceSq","rotateBy","useStateStore","defineStore","useMainStore","reactive","addState","state","genRegex","getStateIndex","getState","find","removeState","froms","getTransitionsFrom","tos","getTransitionsTo","selected","select","savedStart","ref","setStart","accepting","computed","stateStore","transitions","addTransition","labels","getTransition","MAX_ALHPABET","useAlphabetStore","alphabet","removeAlphabet","indexOf","removeAll","ap","addAlphabet","trim","resetAlphabet","Drawables","register","instances","isRegistered","gfx","remove","useMouseStore","set","nx","ny","useModeStore","mousestore","linkingArrow","linkStart","lineWidth","normalize","mode","watch","linkReset","linkEnd","openTransitionDialog","HAS_INITIALIZED","initCanvas","mouseStore","modeStore","canvas","getContext","defineProperty","get","style","origin","selectedOrigin","ox","oy","clicked","hovering","window","getMonitor","alphabetStore","processInput","clientWidth","clientHeight","inputFocus","checkForValidity","transition","initial","noam","string","toAutomaton","convertEnfaToNfa","convertNfaToDfa","minimize","convertStatesToNumbers","err","log","st","al","acceptingStates","acc","initialState","ini","trs","h","w","hand","gens","fromState","symbol","toStates","toStateArr","toState","regexResult","parseFsmFromString","tree","simplify","setup","ctxRef","rafID","animate","clearRect","requestAnimationFrame","mounted","beforeUnmount","cancelAnimationFrame","emits","__exports__","resetAble","density","_component_v_container","_component_v_row","align","justify","noGutters","_component_v_col","cols","_component_v_chip","closable","size","_hoisted_4","placeholder","temp","maxLength","clearable","store","_component_v_dialog","cancel","open","_component_v_autocomplete","chips","items","multiple","selectedItems","disabled","block","ex","_hoisted_5","_component_v_switch","tempIsStart","_hoisted_6","_hoisted_7","transArr","index","_hoisted_8","setSelectedState","_hoisted_9","updateTransition","vs","_hoisted_10","_hoisted_11","_hoisted_12","stateList","tempLabel","_hoisted_13","tempTransitions","associatedTransitions","updateTransArr","ts","components","FSMVisualizer","AlphabetLister","TransitionFab","StateHelper","render","createVuetify","directives","theme","defaultTheme","async","loadFonts","webFontLoader","load","google","families","pinia","createPinia","createApp","App","use","vuetify","mount","define","util","areEquivalent","object1","object2","Date","getTime","RegExp","source","global","multiline","lastIndex","ignoreCase","p","contains","obj","startIndex","containsAll","arr1","arr2","containsAny","areEqualSets","containsSet","setUnion","res","setIntersection","JSON","parse","stringify","makeCounter","getAndAdvance","init","randint","floor","structure","CAPACITY_CHOICES","DEFAULT_INITIAL_CAPACITY_IDX","HASH_MASK","LF_HIGH","LF_LOW","_isArray","prototype","call","_get_capacity_index","wanted","max","min","mid","lo","hi","_defaultHash","props","hasOwnProperty","_defaultEquals","_HashChainNode","_HashChain","_HashChainIterator","chain","node","head","_resize","H","to_cap_idx","old_cap","capacity","old_slots","slots","capacity_index","chain_iter","iterator","hasNext","_putNodeRsz","next","_getSlotIndex","hash","isEmpty","insertHead","removeSuccessor","put","iter","prev","retval","HashTable","cfg","initial_capacity","numkeys","loadFactor","slot","clear","containsKey","it","keyIterator","values","valueIterator","keyValueIterator","Iterator","cur_chain_iterator","idx","slotval","_next","err_msg","extract_next","each","iterator_func","context","_KeyIterator","_ValueIterator","_KeyValueIterator","create","fsm","epsilonSymbol","dfaType","nfaType","enfaType","makeNew","_addStateOrSymbol","undefErrorMsg","existsErrorMsg","stateObj","addSymbol","symObj","addAcceptingState","setInitialState","_addTransition","transitionSymbol","added","addEpsilonTransition","validate","j","isAcceptingState","determineType","fsmType","computeEpsilonClosure","unprocessedStates","targetStates","currentState","pop","makeSimpleTransition","makeTransition","readString","inputSymbolStream","transitionTrail","trail","isStringInLanguage","printTable","Table","require","colHeads","concat","table","chars","truncate","tableRows","colNum","rowNum","serializeFsmToString","lines","fsm_string","parseState","parseCounts","substr","ac","state_rest","parts","left_right","al_t","st_t","printHtmlTable","headers","htmlString","printDotFormat","trans","result","accStates","initStateArrow","newTransitions","found","newTransition","getReachableStates","shouldIncludeInitialState","reachableStates","removeUnreachableStates","newFsm","areEquivalentStates","fsmA","stateA","fsmB","stateB","doBothStatesHaveSameAcceptance","fsmX","stateX","fsmY","stateY","stateXAccepting","stateYAccepting","unprocessedPairs","processedPairs","currentPair","pair","areEquivalentFSMs","removeEquivalentStates","equivalentPairs","isOneOfEquivalentStates","getEquivalentState","fsmWithoutUnreachableStates","minimalFsm","mapping","newToStates","createRandomFsm","numStates","numAlphabet","maxNumToStates","prefix","ch","num","retStr","round","numToStates","diff","newStates","errorAdded","errorState","initialEpsilon","multiStateTransitions","existing","isLanguageNonEmpty","isLanguageInfinite","reachable","deadState","randomStringInLanguage","reverse","randomStringNotInLanguage","nonAcceptingStates","union","newState","intersection","new_alphabet","complement","newAccepting","concatenation","kleene","newInitial","oldAcceptingStates","newInitialState","isSubset","fsmIntersection","grammar","nonterminals","terminals","initialNonterminal","productions","right","symbolsForTransitions","toRegex","z","symbols","re","makeLit","makeEps","makeAlt","t1","choices","t2","seq","tag","tags","EPS","makeSeq","makeKStar","alt","startStateIndex","acceptableStatesIndexes","elements","regType","cfgType","csgType","unrestrictedType","production","indexOfNonterminal","isRightRegular","rightNonTerminalCount","leftNonTerminalCount","slice","sufix","printAscii","slimProds","foundSlim","prod","SEQ","KSTAR","LIT","copyAndDeleteProperties","o1","o2","_regex_simplification_patterns","_regex_simplify_1","fsmCache","_regex_simplify_2","_regex_simplify_3","expr","_regex_simplify_4","_regex_simplify_5","_regex_simplify_6","epsIndex","kstarIndex","_regex_simplify_7","_regex_simplify_8","_regex_simplify_9","_regex_simplify_10","_regex_simplify_11","_regex_simplify_12","_regex_simplify_13","_regex_simplify_14","_regex_simplify_15","_regex_simplify_16","first","rest1","rest2","_alt","_seq","_regex_simplify_17","_regex_simplify_18","last","_regex_simplify_19","fsms","getFromCacheOrCreateFsm","_regex_simplify_20","ht","_regex_simplify_21","_regex_simplify_22","index_eps","_regex_simplify_23","internal","_regex_simplify_24","_regex_simplify_27","eps","fsm_kstar","fsm_other","_regex_simplify_25","_regex_simplify_26","treeClone","opts","numIterations","appliedPatterns","useFsmPatterns","appliedPattern","iterCount","_simplify_iteration","pattern","_simplify_recursion","patternFunction","children","epsNode","_altToAutomaton","automaton","stateCounter","statePair","_dispatchToAutomaton","_seqToAutomaton","_KStarToAutomaton","inner","ll","rr","_litToAutomaton","_epsToAutomaton","_toAutomatonFuns","_prec","_needParens","par","child","_optParenToArray","parens","array","specials","LEFT_PAREN","_dispatchToArray","RIGHT_PAREN","_binOpToArray","operand","_altToArray","_seqToArray","_KStarToArray","_litToArray","_epsToArray","_toArrayFuns","numSymbols","altp","kleenep","epsp","ALT_PROB","KLEENE_PROB","EPS_PROB","_randomKleene","_randomExpr","left_sz","RegexError","message","position","_peek","_advance","_makeInputSeq","peek","advance","toTree","input","_parseExpr","_replacementStr","_escape","chr","escapable","elem","failed","concats","_parseConcat","katom","katoms","_parseKatom","atom","_parseAtom","sym","treeSimplified","escaped","charAt","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","deferred","O","chunkIds","priority","notFulfilled","Infinity","fulfilled","getter","__esModule","leafPrototypes","getProto","getPrototypeOf","__proto__","then","ns","def","current","getOwnPropertyNames","definition","enumerable","chunkId","Promise","all","reduce","promises","miniCssF","g","globalThis","Function","prop","inProgress","dataWebpackPrefix","url","done","script","needAttach","scripts","document","getElementsByTagName","getAttribute","createElement","charset","timeout","nc","setAttribute","src","onScriptComplete","onerror","onload","clearTimeout","doneFns","parentNode","removeChild","setTimeout","appendChild","Symbol","toStringTag","installedChunks","installedChunkData","promise","reject","error","loadingEnded","errorType","realSrc","request","webpackJsonpCallback","parentChunkLoadingFunction","data","moreModules","runtime","some","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}