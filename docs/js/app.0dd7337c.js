(function(){var t={1585:function(t){function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=function(){return[]},e.resolve=e,e.id=1585,t.exports=e},9914:function(t,e,n){"use strict";var i=n(9242),a=n(3396),s=n(7139),r=n(7718),o=n(5101),l=n(3748),c=n(3601),u=n(4075),h=n(3289),f=n(3140),p=n(4286),m=n(165),d=n(678);const g={class:"flex flex-grow"},v={class:"flex flex-col gap-2"},S={class:"capitalize"},b={class:"flex-col gap-2"},y={class:"pt-1"},_=(0,a._)("span",{class:"capitalize"},"Delete All",-1),w={class:"pt-1"},x={class:"pt-1"},T=(0,a._)("span",{class:"capitalize"},"Import",-1),E=(0,a._)("span",{class:"capitalize"},"Export",-1),A={class:"absolute right-0 p-4"};function k(t,e,n,k,R,F){const L=(0,a.up)("AlphabetLister"),M=(0,a.up)("StateHelper"),O=(0,a.up)("SaveFile"),D=(0,a.up)("FSMVisualizer"),C=(0,a.up)("SettingsMenu"),N=(0,a.up)("TransitionFab");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(r.q,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f.O,{class:"flex h-screen w-screen min-h-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(p.C,{width:"400px",class:"p-3 flex flex-col gap-2 overflow-auto"},{default:(0,a.w5)((()=>[(0,a.Wm)(L),(0,a.Wm)(u.J),(0,a.Wm)(M)])),_:1}),(0,a.Wm)(p.C,{class:"flex-grow bg-neutral-900 flex flex-col"},{default:(0,a.w5)((()=>[(0,a._)("div",g,[(0,a.Wm)(p.C,{height:"100%",width:"50px",color:"#252525",elevation:"3",class:"flex flex-col gap-2 p-2 justify-between",id:"toolbar"},{default:(0,a.w5)((()=>[(0,a._)("div",v,[(0,a.Wm)(l.fF,{modelValue:k.m,"onUpdate:modelValue":e[0]||(e[0]=t=>k.m=t),class:"flex-col gap-2 items-center w-full h-auto",mandatory:"",rounded:"0"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(k.tools,(t=>((0,a.wg)(),(0,a.j4)(o.T,{key:t.name,value:t.name},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.text)+" ",1),(0,a.Wm)(d.N,{activator:"parent",class:"p-0",contentClass:"hotkey-tooltip"},{default:(0,a.w5)((()=>[(0,a._)("span",S,(0,s.zw)(t.name),1),(0,a.Uk)(" Mode ["+(0,s.zw)(t.hotkey)+"] ",1)])),_:2},1024)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])]),(0,a._)("div",b,[(0,a._)("div",y,[(0,a.Wm)(o.T,{onClick:e[1]||(e[1]=t=>k.mainStore.deleteAll())},{default:(0,a.w5)((()=>[(0,a.Uk)(" 🗑️ "),(0,a.Wm)(d.N,{activator:"parent",class:"p-0","content-class":"hotkey-tooltip"},{default:(0,a.w5)((()=>[_])),_:1})])),_:1})]),(0,a._)("div",w,[(0,a._)("div",x,[(0,a._)("input",{type:"file",class:"sr-only",ref:"fileinput",onChange:e[2]||(e[2]=(...t)=>k.loadJSON&&k.loadJSON(...t))},null,544),(0,a.Wm)(o.T,{onClick:e[3]||(e[3]=t=>k.fileinput.click())},{default:(0,a.w5)((()=>[(0,a.Wm)(h.t,{size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)("mdi-import")])),_:1}),(0,a.Wm)(d.N,{activator:"parent",class:"p-0","content-class":"hotkey-tooltip"},{default:(0,a.w5)((()=>[T])),_:1})])),_:1})]),(0,a.Wm)(o.T,null,{default:(0,a.w5)((()=>[(0,a.Wm)(h.t,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi-export")])),_:1}),(0,a.Wm)(d.N,{activator:"parent",class:"p-0","content-class":"hotkey-tooltip"},{default:(0,a.w5)((()=>[E])),_:1}),(0,a.Wm)(c.B,{activator:"parent"},{default:(0,a.w5)((()=>[(0,a.Wm)(O)])),_:1})])),_:1})])])])),_:1}),(0,a.Wm)(D,{class:"flex-grow"})]),(0,a.Wm)(p.C,{class:"flex items-center",color:"#2A2A2A"},{default:(0,a.w5)((()=>[(0,a.Wm)(m.h,{modelValue:k.regex,"onUpdate:modelValue":e[4]||(e[4]=t=>k.regex=t),label:"Regex",hideDetails:"",rounded:"0",variant:"solo-filled",onKeydown:e[5]||(e[5]=(0,i.D2)((t=>k.mainStore.genDFA(t.target.value)),["enter"]))},null,8,["modelValue"])])),_:1})])),_:1}),(0,a._)("div",A,[(0,a.Wm)(C)])])),_:1})])),_:1}),(0,a.Wm)(N)],64)}var R=n(4870),F=n(7327);n(7658),n(541),n(2801),n(1295);class L{get ipkey(){return this._ipkey.replace(C.seperator,"+")}set ipkey(t){this._ipkey=t}get activeKeys(){return this.ip.states.filter((t=>t[1])).map((t=>t[0]))}get ipkeySet(){return new Set([this.altKey?"ALT":null,this.ctrlKey?"CONTROL":null,this.shiftKey?"SHIFT":null,this._ipkey.split(C.splitter).at(-1)].filter((t=>null!==t)))}constructor(t,e,n){(0,F.Z)(this,"_ipkey",""),(0,F.Z)(this,"ip",void 0),(0,F.Z)(this,"mouse",void 0),(0,F.Z)(this,"key",""),(0,F.Z)(this,"code",""),(0,F.Z)(this,"location",""),(0,F.Z)(this,"repeat",!1),(0,F.Z)(this,"isComposing",!1),(0,F.Z)(this,"altKey",!1),(0,F.Z)(this,"ctrlKey",!1),(0,F.Z)(this,"shiftKey",!1),(0,F.Z)(this,"getModifierState",""),Object.assign(this,t),this.getModifierState=t.getModifierState,this._ipkey=e,this.ip=n,this.mouse=new M(n.cursor)}}class M{constructor(t){(0,F.Z)(this,"client",{}),(0,F.Z)(this,"screen",{}),(0,F.Z)(this,"lastClick",{}),(0,F.Z)(this,"dragDiff",{}),(0,F.Z)(this,"isDragging",!1),this.client=structuredClone(t.client),this.screen=structuredClone(t.screen),this.lastClick=structuredClone(t.lastClick),this.isDragging=t.isDragging,t.isDragging&&(this.dragDiff.x=t.client.x-t.lastClick.x,this.dragDiff.y=t.client.y-t.lastClick.y)}}class O{constructor(){this.__evs__={},this.__any__=[]}has(t){return void 0!==this.__evs__[t]}on(t,e){this.__evs__[t]=this.__evs__[t]||[],this.__evs__[t].push(e)}onAny(t){this.__any__.push(t)}off(t,e){if(!this.has(t))return;const n=this.__evs__[t].findIndex((t=>t===e||t.toString()===e.toString()));-1!==n&&this.__evs__[t].splice(n,1)}emit(t,...e){this.__any__.forEach((n=>n(t,...e))),this.has(t)&&this.__evs__[t].forEach((t=>t(...e)))}renameEvent(t,e){this.has(t)&&e!==t&&(this.oldEvent=this.newEvent,delete this.oldEvent)}}class D{constructor(){(0,F.Z)(this,"monitor",void 0),(0,F.Z)(this,"captureKey",!0),(0,F.Z)(this,"captureMouse",!1),(0,F.Z)(this,"string",void 0)}}class C extends O{static recognize(t,e){const n=t.toUpperCase();if(e){if(e.match(/key(?!_)/gim))return e.replace(/key/gim,"KEY_");if(e.match(/numpad(?!_)/gim))return e.replace(/numpad/gim,"NUM_");if(e.match(/digit(?!_)/gim))return e.replace(/digit/gim,"DIG_")}if(1===n.length){const t=n.charCodeAt(0);if(65<=t&&90>=t)return`KEY_${n}`;if(48<=t&&57>=t)return`NUM_${n}`;switch(n){case"+":return"NUM_ADD";case"-":return"NUM_SUB";case"*":return"NUM_MUL";case"/":return"SLASH_FORWARD";case"\\":return"SLASH_BACKWARD";case" ":return"SPACE"}}return n}static serialize(t){Array.isArray(t)||"string"!==typeof t||(t=this.split(t)),t.sort();const e=t.findIndex((t=>!this.MODIFIERS.includes(t)));return-1!==e&&t.push(t.splice(e,1)[0]),t.map((t=>this.recognize(t,""))).join(this.seperator)}static get MODIFIERS(){return["ALT","CONTROL","SHIFT"]}static split(t){return t.split(this.splitter).join(this.seperator).split(this.seperator)}constructor(t,e){super(),(0,F.Z)(this,"ARROW_UP",!1),(0,F.Z)(this,"ARROW_DOWN",!1),(0,F.Z)(this,"ARROW_LEFT",!1),(0,F.Z)(this,"ARROW_RIGHT",!1),(0,F.Z)(this,"CONTROL",!1),(0,F.Z)(this,"SHIFT",!1),(0,F.Z)(this,"ALT",!1),(0,F.Z)(this,"SPACE",!1),(0,F.Z)(this,"TAB",!1),(0,F.Z)(this,"cursor",new P(this)),(0,F.Z)(this,"config",void 0);for(let n=0;n<26;n++)this[`KEY_${String.fromCharCode(65+n)}`]=!1;for(let n=0;n<10;n++)this[`NUM_${n}`]=!1,this[`DIG_${n}`]=!1;this.config=e||new D,t&&(this.monitor=t)}get monitor(){return this.config.monitor}set monitor(t){this.monitor&&this.__built_listeners__.forEach((t=>this.monitor.removeEventListener(t.event,t.fn))),void 0!==t&&null!==t?(this.config.captureMouse&&(this.cursor.monitor=t),"CANVAS"===t.tagName&&(t.tabIndex=1),this.config.captureKey&&this.__built_listeners__.forEach((e=>t.addEventListener(e.event,e.fn.bind(this)))),this.config.monitor=t):console.warn("Element set to monitor is undefined")}get __built_listeners__(){return[this.__onKeyDown,this.__onKeyUp,this.__onFocusOut].map((t=>({event:t.name.replace("__on","").toLowerCase(),fn:t})))}get states(){return Object.entries(this).filter((t=>"boolean"===typeof t[1]))}check(t){"+"===t&&(t=[t]);const e=Array.isArray(t)?t:"string"===typeof t?C.split(t):t;return e.every((t=>this[C.recognize(t,"")]))}direction(t=["ARROW_UP","ARROW_RIGHT","ARROW_DOWN","ARROW_LEFT"]){if(4!==t.length)throw new Error("Directional Key Array length must be exactly 4");const e=this.check(t[0]),n=this.check(t[2]),i=this.check(t[3]),a=this.check(t[1]),s=i||a?!i&&a?1:-1:0,r=e||n?!e&&n?1:-1:0;return[s,r]}reset(){Object.entries((([t,e])=>{!0===e&&(this[t]=!1)}))}focus(){this.monitor.focus()}on(t,e,n=!1){if(""!==t){switch(t){case"keydown":case"keyup":break;case"mousemove":case"click":case"auxclick":case"dblclick":case"contextmenu":case"mousedown":case"mouseup":case"mouseenter":case"mouseover":case"mouseleave":case"mouseout":case"dragstart":case"dragend":case"drag":break;default:t=t.replace("CTRL","CONTROL"),t=C.serialize(t)}n&&(t=`UP:${t}`),super.on(t,e)}}off(t,e,n=!1){if(""!==t){switch(t){case"keydown":case"keyup":break;case"mousemove":case"click":case"auxclick":case"dblclick":case"contextmenu":case"mousedown":case"mouseup":case"mouseenter":case"mouseover":case"mouseleave":case"mouseout":case"dragstart":case"dragend":case"drag":break;default:t=t.replace("CTRL","CONTROL"),t=C.serialize(t)}n&&(t=`UP:${t}`),super.off(t,e)}}_processKeyBoardEvent(t){const e=t.key.replace(/ARROW/gi,"ARROW_");this.ALT=t.altKey,this.CONTROL=t.ctrlKey,this.SHIFT=t.shiftKey;const n=C.recognize(e,t.code),i=[e.toUpperCase()];this.ALT&&"ALT"!==n&&i.unshift("ALT"),this.CONTROL&&"CONTROL"!==n&&i.unshift("CONTROL"),this.SHIFT&&"SHIFT"!==n&&i.unshift("SHIFT");const a=C.serialize(i),s=new L(t,a,this);return{keyprop:n,combined:a,ipev:s}}__onKeyDown(t){t.preventDefault();const{keyprop:e,combined:n,ipev:i}=this._processKeyBoardEvent(t);this[e]=!0,t.repeat||this.emit(n,i),t.repeat||n===e||this.emit(e,i),this.emit("keydown",i)}__onKeyUp(t){t.preventDefault();const{keyprop:e,combined:n,ipev:i}=this._processKeyBoardEvent(t);this[e]=!1,this.emit(`UP:${n}`,i),n!==e&&this.emit(`UP:${e}`,i),this.emit("keyup",i)}__onFocusOut(){Object.entries((([t,e])=>{"boolean"===typeof this[t]&&e&&this.emit(`UP:${t}`)}))}}(0,F.Z)(C,"seperator","§"),(0,F.Z)(C,"splitter",/\+(?<=[^+].)/gim);class N{constructor(t,e){(0,F.Z)(this,"x",void 0),(0,F.Z)(this,"y",void 0),this.x=t,this.y=e}difference(t){return new N(this.x-t.x,this.y-t.y)}sum(t){return new N(this.x+t.x,this.y+t.y)}get clone(){return new N(this.x,this.y)}get arr(){return[this.x,this.y]}}class P{get monitor(){return this._monitor}set monitor(t){this.monitor&&this.__built_listeners__.forEach((t=>this.monitor.removeEventListener(t.event,t.fn))),this.__built_listeners__.forEach((e=>t.addEventListener(e.event,e.fn.bind(this)))),this._monitor=t}get __built_listeners__(){return[this.__onClick,this.__onAuxClick,this.__onDblClick,this.__onContextMenu,this.__onMouseDown,this.__onMouseUp,this.__onMouseEnter,this.__onMouseOver,this.__onMouseLeave,this.__onMouseOut,this.__onMouseMove,this.__onFocusOut].map((t=>({event:t.name.replace("__on","").toLowerCase(),fn:t})))}constructor(t){(0,F.Z)(this,"client",new N(0,0)),(0,F.Z)(this,"screen",new N(0,0)),(0,F.Z)(this,"lastClick",void 0),(0,F.Z)(this,"_monitor",void 0),(0,F.Z)(this,"isDragging",!1),(0,F.Z)(this,"_ip",void 0),this._ip=t}emit(t,...e){this._ip.emit(t,...e)}__processMouseEvent__(t){const e=this.monitor.getBoundingClientRect();this.screen.x=t.screenX,this.screen.y=t.screenY,this.client.x=t.clientX-e.left,this.client.y=t.clientY-e.top,"mousedown"===t.type&&(this.lastClick=this.client.clone);const n=new M(this);return n}__onMouseMove(t){const e=this.__processMouseEvent__(t);this.isDragging&&this.emit("drag",e),this.emit("mousemove",e)}__onClick(t){const e=this.__processMouseEvent__(t);this.emit("click",e)}__onAuxClick(t){const e=this.__processMouseEvent__(t);this.emit("auxclick",e)}__onDblClick(t){const e=this.__processMouseEvent__(t);this.emit("dblclick",e)}__onContextMenu(t){const e=this.__processMouseEvent__(t);this.emit("contextmenu",e)}__onMouseDown(t){this.isDragging=!0;const e=this.__processMouseEvent__(t);this.emit("dragstart",e),this.emit("mousedown",e)}__onMouseUp(t){this.isDragging=!1,this.lastClick=null;const e=this.__processMouseEvent__(t);this.emit("dragend",e),this.emit("mouseup",e)}__onMouseOver(t){const e=this.__processMouseEvent__(t);this.emit("mouseover",e)}__onMouseEnter(t){const e=this.__processMouseEvent__(t);this.isDragging&&0===t.buttons&&(this.isDragging=!1,this.lastClick=null),this.emit("mouseenter",e)}__onMouseOut(t){const e=this.__processMouseEvent__(t);this.emit("mouseout",e)}__onMouseLeave(t){const e=this.__processMouseEvent__(t);this.emit("mouseleave",e)}__onFocusOut(){this.isDragging=!1,this.lastClick=null}}var I=n(1020),q=n(7661),H=n.n(q);class j{static genString(t){return Math.random().toString(36).substring(2,t+2)}static FindHits(t,e,n){return t.filter((t=>t.hits(e,n)))}static drawArcFromTwoPoints(t,e,n,i,a,s,r=!1){const o=new(H())(e,n),l=new(H())(i,a),c=s/2,u=(o.clone().mix(l,.5),o.distance(l)),h=90-c,f=u/(2*Math.cos(this.deg2Rad(h))),p=l.clone().subtract(o).rotateDeg(r?h:-h).norm().multiplyScalar(f),m=p.clone().add(o);t.strokeStyle="#999";const d=p.clone().invert().angle(),g=d-this.deg2Rad(s);t.beginPath(),t.arc(...p.clone().add(o).toArray(),f,d,g,!r),t.stroke(),t.closePath();const v=l.clone().subtract(m).rotateDeg(-90).invert(),S=o.clone().subtract(m),b=p.clone().invert().rotateDeg(-c),y=b.clone().add(b.norm().multiplyScalar(15)).add(m);return{start:S,end:v,center:y}}static line(t,e,n,i,a){t.beginPath(),t.moveTo(e,n),t.lineTo(i,a),t.stroke(),t.closePath()}static drawArrow(t,e,n,i,a=25,s=25,r=!0){const o=new(H())(e,n),l=i instanceof H()?i.clone().norm():new(H())(1,0).rotateByDeg(i);l.clone().multiplyScalar(s);t.beginPath(),l.rotateDeg(-a/2).multiplyScalar(s),t.moveTo(...o.toArray()),t.lineTo(...o.clone().add(l).toArray()),l.rotateDeg(a),t.lineTo(...o.clone().add(l).toArray()),t.lineTo(...o.toArray()),t.fill(),t.closePath(),t.beginPath(),t.closePath()}}(0,F.Z)(j,"deg360",2*Math.PI),(0,F.Z)(j,"deg90",Math.PI/2),(0,F.Z)(j,"deg2Rad",(t=>Math.PI*t/180)),(0,F.Z)(j,"rad2Deg",(t=>180*t/Math.PI)),(0,F.Z)(j,"copyToClipboard",(t=>{navigator.clipboard.writeText(t)}));class K{constructor(){(0,F.Z)(this,"radius",15),(0,F.Z)(this,"border",2),(0,F.Z)(this,"borderColor","#888"),(0,F.Z)(this,"bg","#444"),(0,F.Z)(this,"labelColor","#999"),(0,F.Z)(this,"selected_bg","#888"),(0,F.Z)(this,"selected_labelColor","#fff")}}const W=2*Math.PI;class Z{constructor(t,e,n,i={}){(0,F.Z)(this,"pos",void 0),(0,F.Z)(this,"label",void 0),(0,F.Z)(this,"options",void 0),(0,F.Z)(this,"isFinish",!1),(0,F.Z)(this,"isStart",!1);const a=new K;Object.assign(a,i),this.pos=new(H())(t,e),this.label=n||j.genString(3),this.options=a,Math.sq}hits(t,e){const n=this.pos.distance(new(H())(t,e));return this.options.radius>=n}draw(t){const e=ft(),{pos:n,options:i,label:a}=this,{x:s,y:r}=n,{radius:o,border:l,borderColor:c,bg:u,labelColor:h,selected_bg:f,selected_labelColor:p}=i,m=o+l;this.isFinish&&(t.beginPath(),t.fillStyle=c,t.arc(s,r,m+6,0,W),t.fill(),t.closePath(),t.beginPath(),t.fillStyle="#171717",t.arc(s,r,m+4,0,W),t.fill(),t.closePath()),t.beginPath(),t.fillStyle=c,t.ellipse(s,r,m,m,0,0,W),t.fill(),t.closePath(),t.beginPath(),t.fillStyle=e.selected?.label===this.label?f:u,t.ellipse(s,r,o,o,0,0,W),t.fill(),t.closePath(),t.fillStyle=e.selected?.label===this.label?p:h,t.textAlign="center",t.textBaseline="middle",t.font="12px Roboto",t.fillText(a,s,r+1),t.fillStyle=c,this.isStart&&j.drawArrow(t,s-o,r,180,90)}}const U=(0,I.Q_)("state",(()=>{const t=z(),e=ft(),n=(0,R.qj)([]),i=t=>{n.push(t),e.genRegex()},s=t=>n.findIndex((e=>e.label===t)),r=t=>n.find((e=>e.label===t)),o=i=>{const a=s(i);if(-1===a)return;const r=t.getTransitionsFrom(i);r.forEach((e=>t.removeTransition(e.from.label,e.to.label)));const o=t.getTransitionsTo(i);o.forEach((e=>t.removeTransition(e.from.label,e.to.label))),e.selected.label===i&&e.select(void 0),n.splice(a,1),e.genRegex()},l=(0,R.iH)(void 0),c=t=>{const n=r(t);void 0===l.value||(l.value.isStart=!1),l.value=n,n.isStart=!0,e.genRegex()},u=(0,a.Fl)((()=>n.filter((t=>t.isFinish))));return{states:n,addState:i,getStateIndex:s,getState:r,removeState:o,setStart:c,savedStart:l,accepting:u}}));class V{constructor(t,e,...n){(0,F.Z)(this,"from",void 0),(0,F.Z)(this,"to",void 0),(0,F.Z)(this,"v",[]),this.from=t,this.to=e,this.v=n.sort()}equalWith(t,e){return this.from.label===t&&this.to.label===e}equals(t){return t.from.label===this.from.label&&t.to.label===this.to.label}addValue(...t){this.v.push(...t.sort())}removeValue(t){const e=this.v.findIndex((e=>e===t));if(-1===e)return;if(this.v.splice(e,1),this.v.length>0)return;const n=z();n.removeTransition(this.from.label,this.to.label)}str(){return this.v.map((t=>`${this.from.label}:${t}>${this.to.label}`)).join("\n")}draw(t){const e=this.to.pos.clone().subtract(this.from.pos),n=e.clone().norm(),i=n.clone().multiplyScalar(this.from.options.radius+7);let a=this.to.pos.clone().subtract(i),s=this.from.pos.clone().add(i);const r=z(),o=U();let l=null;t.strokeStyle="#999",t.textAlign="center";const c=t.measureText(this.v.join(", ")).width;t.fillStyle="#999";let u=20;if(-1===r.getTransitionIndex(this.to.label,this.from.label))t.beginPath(),t.moveTo(...s.toArray()),t.lineTo(...a.clone().subtract(i).toArray()),t.stroke(),t.closePath(),n.invert(),l=this.from.pos.clone().mix(this.to.pos,.5).add(e.clone().rotateDeg(-90).norm().multiplyScalar(c)).toArray();else if(this.from.label===this.to.label){const e=new Set;r.transitions.forEach((t=>{t.from.label===this.from.label&&t.to.label===this.to.label||(t.from.label===this.from.label?e.add(t.to.label):t.to.label===this.from.label&&e.add(t.from.label))}));const i=[];e.forEach((t=>i.push(o.getState(t))));const s=new(H())(0,0===e.size?1:0);i.forEach((t=>{s.add(t.pos.clone().subtract(this.from.pos).norm())})),s.norm().invert();const c=60,h=s.angleDeg(),f=15,p=this.from.options.radius+7,m=new(H())(p,0).rotateDeg(h+c/2),d=m.clone().rotateDeg(-c),g=m.clone().rotateDeg(-c/2).norm(),v=m.clone().add(g.clone().multiplyScalar(f)),S=d.clone().add(g.clone().multiplyScalar(f));l=this.from.pos.clone().add(g.multiplyScalar(p+f+20)).toArray(),j.line(t,...this.from.pos.clone().add(m).toArray(),...this.from.pos.clone().add(v).toArray()),j.line(t,...this.from.pos.clone().add(d).toArray(),...this.from.pos.clone().add(S).toArray());const{end:b}=j.drawArcFromTwoPoints(t,...this.from.pos.clone().add(v).toArray(),...this.from.pos.clone().add(S).toArray(),180);a.copy(this.from.pos.clone().add(d)),u=15,n.copy(b)}else{const e=150,i=15,r=e**2/this.from.pos.distanceSq(this.to.pos),{start:o,end:c,center:u}=j.drawArcFromTwoPoints(t,...s.toArray(),...a.toArray(),r>1?e:e*r<i?i:e*r);n.copy(c),l=u.toArray()}const h=20;j.drawArrow(t,...a.toArray(),n,h,u),t.fillText(this.v.join(", "),...l)}}const z=(0,I.Q_)("transition",(()=>{const t=U(),e=ft(),n=(0,R.qj)([]),i=({labels:i,from:s,to:r})=>{const o=a(s,r);if(-1===o){const e=t.getState(s),a=t.getState(r);n.push(new V(e,a,...i))}else n[o].v.splice(0),n[o].addValue(...i),0===i.length&&l(s,r);e.genRegex()},a=(t,e)=>n.findIndex((n=>n.equalWith(t,e))),s=(t,e)=>n.find((n=>n.equalWith(t,e))),r=t=>n.filter((e=>e.from.label===t)),o=t=>n.filter((e=>e.to.label===t)),l=(t,i)=>{const s=a(t,i);-1!==s&&(n[s].v.splice(0),n.splice(s,1),e.genRegex())};return{addTransition:i,getTransitionIndex:a,getTransition:s,removeTransition:l,transitions:n,getTransitionsFrom:r,getTransitionsTo:o}})),$=10,Q=(0,I.Q_)("alphabet",(()=>{const t=(0,R.qj)(["a","b"]),e=z(),n=ft(),i=i=>{const a=t.indexOf(i);-1!==a&&(t.splice(a,1),e.transitions.forEach((t=>t.removeValue(i))),n.genRegex())},a=()=>{t.forEach((t=>i(t)))},s=e=>{if(t.length>=$)return;if(e=e.trim(),""===e)return;const i=t.indexOf(e);-1===i&&(t.push(e),n.genRegex())},r=()=>{t.splice(0),t.push("a","b"),n.genRegex()};return{alphabet:t,addAlphabet:s,removeAlphabet:i,resetAlphabet:r,removeAll:a}}));class B{static register(t){const e=this.instances.findIndex((e=>e.id===t.id));-1===e&&(this.instances.push(t),t.isRegistered=!0)}constructor(t,e){(0,F.Z)(this,"id",void 0),(0,F.Z)(this,"gfx",void 0),(0,F.Z)(this,"isRegistered",!1),this.gfx=t,this.id=e||j.genString(8)}remove(){const t=B.instances.findIndex((t=>t.id===this.id));-1!==t&&(B.instances.splice(t,1),this.isRegistered=!1)}register(){this.isRegistered||B.register(this)}draw(t){this.gfx(t)}}(0,F.Z)(B,"instances",[]);const G=(0,I.Q_)("mouse",(()=>{const t=(0,R.iH)(0),e=(0,R.iH)(0),n=(n,i)=>{t.value=n,e.value=i};return{x:t,y:e,set:n}})),Y=(0,I.Q_)("mode",(()=>{const t=U(),e=G(),n=new B((n=>{const{x:i,y:a}=e,r=t.getState(s.value);if(void 0===r)return;n.lineWidth=2,n.strokeStyle="#999999",n.fillStyle="#999",n.beginPath(),n.moveTo(...r.pos.toArray()),n.lineTo(i,a),n.stroke(),n.closePath();const o=new(H())(i,a).subtract(r.pos).normalize().multiplyScalar(25).invert();j.drawArrow(n,i,a,o),n.beginPath(),n.arc(...r.pos.toArray(),15,0,2*Math.PI),n.fill(),n.closePath()}),"link-arrow"),i=(0,R.iH)("default");(0,a.YP)(i,(t=>{o(),"linking"===t?n.register():n.remove()}));const s=(0,R.iH)(""),r=(0,R.iH)(""),o=()=>{s.value="",r.value=""},l=(0,R.iH)(!1);return(0,a.YP)(r,(t=>{l.value=""!==t})),{linkStart:s,linkEnd:r,linkReset:o,mode:i,openTransitionDialog:l}})),J=new C(null,{captureKey:!0,captureMouse:!0});function X(t){J.monitor=t}let tt=!1;function et(){if(tt)return;tt=!0;Q(),z();const t=U(),e=G(),n=Y(),i=ft(),{monitor:a}=J,s=(a.getContext("2d"),{});Object.defineProperty(s,"cursor",{get:()=>a.style.cursor,set:t=>a.style.cursor=t}),J.on("dblclick",(e=>{const{x:i,y:a}=e.client;"default"===n.mode&&(t.addState(new Z(i,a)),s.cursor="pointer")})),J.on("drag",(t=>{const{x:e,y:a}=t.dragDiff,s=i.selected,r=i.selectedOrigin;if("default"!==n.mode)return;if(void 0===s||!(s instanceof Z))return;const{x:o,y:l}=r;s.pos.x=o+e,s.pos.y=l+a})),J.on("dragend",(t=>{i.selected&&(s.cursor="pointer")})),J.on("mousedown",(e=>{const{x:a,y:s}=e.client,r=j.FindHits(t.states,a,s)[0];i.select(r),"linking"===n.mode&&(r instanceof Z?n.linkStart?n.linkEnd=r.label:n.linkStart=r.label:n.linkStart=""),void 0!==r&&"delete"===n.mode&&t.removeState(r.label)})),J.on("mousemove",(a=>{const{x:r,y:o}=a.client,l=i.selected;e.set(r,o);const c=j.FindHits(t.states,r,o)[0];let u="default";switch(n.mode){case"default":l&&a.isDragging?u="grabbing":c&&(u="pointer");break;case"linking":n.linkStart?u="crosshair":c instanceof Z&&(u="copy");break;case"delete":c&&(u="crosshair");break}s.cursor=u})),J.on("mouseup",(t=>{})),window.ip=J,J.on("C",(()=>{n.mode="linking"})),J.on("V",(()=>{n.mode="default"})),J.on("D",(()=>{n.mode="delete"}))}function nt(){J.focus(),J.monitor.focus()}function it(){return J.monitor}var at,st=n(4430),rt=n.n(st);const ot="DFAREGEX";class lt{}at=lt,(0,F.Z)(lt,"get",((t,e)=>{const n=localStorage.getItem(`${ot}${t}`);if(null===n)return e||null;let i;try{i=JSON.parse(n)}catch{i=n}return i})),(0,F.Z)(lt,"set",((t,e)=>{try{"string"!==typeof e&&(e=JSON.stringify(e)),localStorage.setItem(`${ot}${t}`,e)}catch(n){alert(`Session Storage Error: ${n}`)}})),(0,F.Z)(lt,"has",(t=>null!==at.get(t))),(0,F.Z)(lt,"remove",(t=>localStorage.removeItem(t)));const ct=(t,e)=>{const n=document.createElement("a");if(n.setAttribute("href",`data:text/plain;charset-utf-8,${encodeURIComponent(t)}`),n.setAttribute("download",e),document.createEvent){const t=document.createEvent("MouseEvent");t.initEvent("click",!0,!0),n.dispatchEvent(t)}else n.click()},ut=(0,I.Q_)("file",(()=>{const t=Q(),e=U(),n=z(),i=ft(),a=()=>{const i=[...t.alphabet],a=e.states.map((t=>({label:t.label,x:t.pos.x,y:t.pos.y}))),s=n.transitions.map((t=>({values:[...t.v],from:t.from.label,to:t.to.label}))),r=e.savedStart?.label,o=e.accepting.map((t=>t.label));return{alphabet:i,states:a,transitions:s,start:r,final:o}},s=t=>{const{alphabet:e,states:n,start:i,transitions:s,final:r}=a();ct(JSON.stringify({alphabet:e,states:n,transitions:s,start:i,final:r}),`${t}.json`)},r=a=>{if(void 0===a)return;const{alphabet:s,final:r,states:o,transitions:l,start:c}=a;console.log("Imported Data: ",a),i.deleteAll(),t.removeAll();try{s.forEach((e=>t.addAlphabet(e))),o.forEach((t=>{const n=new Z(t.x,t.y);n.label=t.label,r.includes(t.label)&&(n.isFinish=!0),e.addState(n)})),c&&o.includes(c)&&e.setStart(c),l.forEach((t=>{const{values:e,from:i,to:a}=t;n.addTransition({labels:e,from:i,to:a})})),i.genRegex()}catch(u){console.log(u),alert("Please import a correct file")}};return{saveDFA:s,loadDFA:r,getFSMAsJSON:a}})),ht=(0,I.Q_)("setting",(()=>{const t=ft(),e=ut(),n=(0,R.iH)(!0),i=(0,R.iH)(!1);(0,a.YP)(n,(()=>{t.genRegex()}));const s=()=>{const t=lt.get("config");null!==t&&(n.value=t.simplifyDFARegex,i.value=t.saveFSMOnExit,i.value&&e.loadDFA(t.fsmData),window.addEventListener("beforeunload",(()=>r())))},r=()=>{const t=i.value?e.getFSMAsJSON():null;lt.set("config",{simplifyDFARegex:n.value,saveFSMOnExit:i.value,fsmData:t})};return{simplifyDFARegex:n,saveFSMOnExit:i,sync:s}})),ft=(0,I.Q_)("main",(()=>{const t=U(),e=z(),n=Q(),i=ht(),s=(0,R.iH)(void 0),r=(0,R.iH)({x:0,y:0}),o=t=>{t.width=t.clientWidth,t.height=t.clientHeight,X(t),et()},l=t=>{s.value=t,t instanceof Z&&(r.value.x=t.pos?.x,r.value.y=t.pos?.y)},c=()=>nt(),u=()=>{l(void 0),t.states.splice(0),e.transitions.splice(0)},h=()=>{const n=t.states,i=e.transitions,a=t.savedStart,s=t.accepting;return void 0!==a&&0!==n.length&&0!==i.length&&0!==s.length},f=i=>{let a;u();try{a=rt().re.string.toAutomaton(i),a=rt().fsm.convertEnfaToNfa(a),a=rt().fsm.convertNfaToDfa(a),a=rt().fsm.minimize(a),a=rt().fsm.convertStatesToNumbers(a)}catch(d){console.log(d)}const{states:s,alphabet:r,acceptingStates:o,initialState:l,transitions:c}=a,{clientHeight:h,clientWidth:f}=it(),p=new(H())(0,250),m=new(H())(f/2,h/2);n.removeAll(),r.forEach((t=>n.addAlphabet(t))),s.forEach(((e,n)=>{const i=new Z(...p.clone().add(m).toArray(),`q${e}`);t.addState(i),e===l&&(i.isStart=!0),p.rotateDeg(360/s.length),o.includes(e)&&(i.isFinish=!0)})),c.forEach((t=>{const{fromState:n,symbol:i,toStates:a}=t,s=a[0];e.addTransition({labels:[i],from:`q${n}`,to:`q${s}`})}))},p=(0,R.iH)(""),m=(0,a.Fl)((()=>{const i=t.states,a=e.transitions,s=t.savedStart,r=t.accepting;return`#states\n${i.map((t=>t.label)).join("\n")}\n#initial\n${s?.label}\n#accepting\n${r.map((t=>t.label)).join("\n")}\n#alphabet\n${n.alphabet.join("\n")}\n#transitions\n${a.map((t=>t.str())).join("\n")}`})),d=()=>{if(!h())return;const t=m.value;let e,n;try{e=rt().fsm.parseFsmFromString(t),e=rt().fsm.minimize(e),e=rt().fsm.toRegex(e),e=rt().re.tree.simplify(e,{useFsmPatterns:i.simplifyDFARegex}),n=rt().re.tree.toString(e)}catch(a){p.value="",console.log(a)}p.value=n};return{processInput:o,inputFocus:c,selected:s,selectedOrigin:r,select:l,deleteAll:u,checkForValidity:h,genDFA:f,genRegex:d,regexResult:p,formal_specs:m}})),pt={ref:"c"};function mt(t,e,n,i,s,r){return(0,a.wg)(),(0,a.iD)("canvas",pt,null,512)}window.Drawables=B;var dt={setup(){const t=(0,R.iH)(null),e=(0,a.Fl)((()=>t.value.getContext("2d"))),n=ft(),i=(Q(),z()),s=U(),r=(0,R.iH)(0),o=(0,a.Fl)((()=>s.states)),l=(0,a.Fl)((()=>i.transitions)),c=()=>{const{clientHeight:n,clientWidth:i}=t.value,a=e.value;a.clearRect(0,0,i,n),o.value.forEach((t=>t.draw(a))),l.value.forEach((t=>t.draw(a))),B.instances.forEach((t=>t.draw(a))),r.value=requestAnimationFrame(c)};return{c:t,mainStore:n,rafID:r,animate:c}},mounted(){this.mainStore.processInput(this.c),this.animate()},beforeUnmount(){cancelAnimationFrame(this.rafID)},emits:["select:node"]},gt=n(89);const vt=(0,gt.Z)(dt,[["render",mt]]);var St=vt,bt=n(1037),yt=n(3369),_t=n(6824),wt=n(8521);const xt={class:"flex flex-col gap-2"},Tt={class:"flex justify-between"},Et=(0,a._)("div",{class:"text-2xl"},"Alphabet",-1),At={class:""};function kt(t,e,n,r,l,c){return(0,a.wg)(),(0,a.iD)("div",xt,[(0,a._)("div",Tt,[Et,r.resetAble?((0,a.wg)(),(0,a.j4)(o.T,{key:0,color:"red",density:"comfortable",onClick:r.resetAlphabet},{default:(0,a.w5)((()=>[(0,a.Uk)("Reset")])),_:1},8,["onClick"])):(0,a.kq)("",!0)]),(0,a.Wm)(yt.K,{class:"p-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(_t.o,{align:"center",justify:"start",noGutters:"",class:"gap-x-1 gap-y-0.5"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.alphabet,(t=>((0,a.wg)(),(0,a.j4)(wt.D,{key:t+""+Math.random(),cols:"auto"},{default:(0,a.w5)((()=>[(0,a.Wm)(bt.v,{closable:"","onClick:close":e=>r.removeAlphabet(t),size:"small"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t),1)])),_:2},1032,["onClick:close"])])),_:2},1024)))),128))])),_:1})])),_:1}),(0,a._)("div",At,[(0,a.Wm)(m.h,{label:"Add alphabet",variant:"solo-filled",placeholder:"Press Enter to add",modelValue:r.temp,"onUpdate:modelValue":e[0]||(e[0]=t=>r.temp=t),maxLength:"1",clearable:"",hideDetails:"",onKeydown:e[1]||(e[1]=(0,i.D2)((t=>{r.addAlphabet(r.temp),r.temp=""}),["enter"]))},null,8,["modelValue"])])])}var Rt={setup(){const t=Q(),e=(0,a.Fl)((()=>t.alphabet)),n=(0,R.iH)(""),i=(0,a.Fl)((()=>2!==e.value.length||!e.value.every((t=>"a"===t||"b"===t))));return{temp:n,alphabet:e,resetAlphabet:()=>t.resetAlphabet(),removeAlphabet:e=>t.removeAlphabet(e),addAlphabet:e=>t.addAlphabet(e),resetAble:i}}};const Ft=(0,gt.Z)(Rt,[["render",kt]]);var Lt=Ft;const Mt={class:"text-2xl pb-1"},Ot={class:"text-subtitle-1 text-neutral-400"};function Dt(t,e,n,i,r,u){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(c.B,{"onClick:outside":i.cancel,modelValue:i.open,"onUpdate:modelValue":e[1]||(e[1]=t=>i.open=t),width:"auto","min-width":"300px"},{default:(0,a.w5)((()=>[(0,a.Wm)(p.C,{class:"flex gap-2 p-4 pt-3 flex-col"},{default:(0,a.w5)((()=>[(0,a._)("div",Mt,[(0,a.Uk)("Create Transition "),(0,a._)("div",Ot,(0,s.zw)(i.modeStore.linkStart)+" → "+(0,s.zw)(i.modeStore.linkEnd),1)]),(0,a.Wm)(l.fF,{multiple:"",class:"flex-col h-auto",rounded:"0",modelValue:i.selectedItems,"onUpdate:modelValue":e[0]||(e[0]=t=>i.selectedItems=t)},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.alphabet,(t=>((0,a.wg)(),(0,a.j4)(o.T,{key:t,style:{height:"36px"},value:t},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"]),(0,a._)("div",null,[(0,a.Wm)(o.T,{disabled:0===i.selectedItems.length,block:"",color:"success",onClick:i.add},{default:(0,a.w5)((()=>[(0,a.Uk)(" Add ")])),_:1},8,["disabled","onClick"])])])),_:1})])),_:1},8,["onClick:outside","modelValue"])])}var Ct={setup(){const t=Y(),e=Q(),n=z(),i=ft(),s=(0,a.Fl)({get:()=>t.openTransitionDialog,set:e=>t.openTransitionDialog=e});(0,a.YP)(s,(e=>{const{linkStart:a,linkEnd:s}=t,r=n.getTransition(a,s);void 0!==r&&(o.value.push(...r.v),i.inputFocus())}));const r=(0,a.Fl)((()=>e.alphabet)),o=(0,R.iH)([]),l=()=>{t.linkReset(),o.value.splice(0)},c=()=>{n.addTransition({labels:[...o.value],from:t.linkStart,to:t.linkEnd}),o.value.splice(0),s.value=!1,t.linkReset()};return{open:s,alphabet:r,modeStore:t,selectedItems:o,cancel:l,add:c,transitionStore:n,modeStore:t}}};const Nt=(0,gt.Z)(Ct,[["render",Dt],["__scopeId","data-v-2a8447b3"]]);var Pt=Nt,It=n(2650),qt=n(3104);const Ht={key:0,class:"flex flex-grow flex-col gap-2"},jt={class:"flex justify-between items-end"},Kt=(0,a._)("div",{class:"text-2xl"},"State",-1),Wt={class:"text-caption text-neutral-500"},Zt={class:"px-2"},Ut=(0,a._)("div",{class:"text-subtitle-1"}," Transitions ",-1),Vt={class:"flex flex-col flex-grow gap-2"},zt={class:"text-button w-12 flex justify-center items-center overflow-hidden"},$t={class:"flex-grow"},Qt={class:"flex flex-col gap-2"},Bt={class:"flex flex-col gap-2 pt-3"},Gt={class:""},Yt={class:"flex-grow"};function Jt(t,e,n,i,r,l){return void 0!==i.state?((0,a.wg)(),(0,a.iD)("div",Ht,[(0,a._)("div",jt,[Kt,(0,a._)("span",Wt,"["+(0,s.zw)(i.state.pos.x.toFixed(0))+", "+(0,s.zw)(i.state.pos.y.toFixed(0))+"]",1)]),(0,a._)("div",null,[(0,a.Wm)(m.h,{modelValue:i.state.label,"onUpdate:modelValue":e[0]||(e[0]=t=>i.state.label=t),"hide-details":"",variant:"solo-filled",label:"State Label",density:"compact",clearable:""},null,8,["modelValue"])]),(0,a._)("div",null,[(0,a.Wm)(o.T,{block:"",color:"#DC143C",onClick:e[1]||(e[1]=t=>i.stateStore.removeState(i.label))},{default:(0,a.w5)((()=>[(0,a.Uk)(" Delete State ")])),_:1})]),(0,a._)("div",Zt,[(0,a._)("div",null,[(0,a.Wm)(qt.G,{"hide-details":"",density:"compact","true-value":!0,"false-value":!1,modelValue:i.tempIsStart,"onUpdate:modelValue":e[2]||(e[2]=t=>i.tempIsStart=t),onChange:i.changeStartStatus,label:"Starting State"},null,8,["modelValue","onChange"])]),(0,a._)("div",null,[(0,a.Wm)(qt.G,{"hide-details":"",density:"compact",modelValue:i.state.isFinish,"onUpdate:modelValue":e[3]||(e[3]=t=>i.state.isFinish=t),label:"Ending State",onChange:e[4]||(e[4]=t=>i.mainStore.genRegex())},null,8,["modelValue"])])]),Ut,(0,a._)("div",Vt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.transArr,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{key:t.to,class:"flex gap-2"},[(0,a._)("div",zt,[(0,a.Wm)(o.T,{onClick:e=>i.setSelectedState(t.to)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.to),1)])),_:2},1032,["onClick"])]),(0,a._)("div",$t,[(0,a.Wm)(It.f,{clearable:"",chips:"",label:"Labels",items:i.alphabet,multiple:"","hide-details":"",variant:"outlined","onUpdate:modelValue":[n=>i.updateTransition(t.to,n,e),e=>t.vs=e],modelValue:t.vs,density:"compact"},null,8,["items","onUpdate:modelValue","modelValue"])])])))),128))]),(0,a._)("div",Qt,[(0,a.Wm)(u.J),(0,a._)("div",Bt,[(0,a._)("div",Gt,[(0,a.Wm)(It.f,{"hide-details":"",density:"compact","append-icon":"",variant:"outlined",label:"Destination State",items:i.stateList,modelValue:i.tempLabel,"onUpdate:modelValue":e[5]||(e[5]=t=>i.tempLabel=t)},null,8,["items","modelValue"])]),(0,a._)("div",Yt,[(0,a.Wm)(It.f,{clearable:"",chips:"",label:"Transition",items:i.alphabet,"append-icon":"",multiple:"","hide-details":"",variant:"outlined",modelValue:i.tempTransitions,"onUpdate:modelValue":e[6]||(e[6]=t=>i.tempTransitions=t),density:"compact"},null,8,["items","modelValue"])])]),(0,a._)("div",null,[(0,a.Wm)(o.T,{block:"",color:"success",onClick:i.addTransition},{default:(0,a.w5)((()=>[(0,a.Uk)(" Add Transition ")])),_:1},8,["onClick"])])])])):(0,a.kq)("",!0)}var Xt={setup(){const t=ft(),e=z(),n=Q(),i=U(),s=(0,a.Fl)((()=>t.selected)),r=(0,a.Fl)((()=>s.value?.label)),o=(0,a.Fl)((()=>n.alphabet)),l=(0,R.qj)([]),c=(0,a.Fl)((()=>e.getTransitionsFrom(r.value))),u=(0,a.Fl)((()=>i.states.map((t=>t.label)))),h=(0,R.iH)(""),f=(0,R.iH)([]);function p(){l.splice(0),c.value.forEach((t=>{l.push({to:t.to.label,vs:[...t.v]})}))}const m=(0,R.iH)(!1),d=()=>{const t=m.value;t?i.setStart(r.value):s.value&&(s.value.isStart=!1)};(0,a.YP)(r,(t=>{l.splice(0),m.value=!1,void 0!==t&&(p(),m.value=s.value.isStart)}));const g=(t,n,i)=>{if(0===n.length)return e.removeTransition(r.value,t),void l.splice(i,1);e.addTransition({labels:[...n],from:r.value,to:t})},v=e=>{const n=i.getState(e);t.select(n)},S=()=>{e.addTransition({labels:[...f.value],from:r.value,to:h.value}),p()};return(0,a.YP)(s,(()=>{void 0===s.value&&(h.value="",f.value.splice(0))})),{state:s,label:r,associatedTransitions:c,alphabet:o,updateTransition:g,transArr:l,setSelectedState:v,stateStore:i,stateList:u,tempLabel:h,tempTransitions:f,addTransition:S,tempIsStart:m,mainStore:t,changeStartStatus:d}}};const te=(0,gt.Z)(Xt,[["render",Jt]]);var ee=te;const ne=(0,a._)("div",{class:"text-2xl"}," Settings ",-1),ie={class:"flex-grow overflow-y-auto flex flex-col gap-2 pt-2"},ae=(0,a._)("div",{class:"text-caption"},"Conversion",-1),se={class:"pl-5 flex flex-col gap-2"},re={class:"ml-1 bg-neutral-500/50 rounded-full w-5 h-5 flex justify-center items-center"},oe=(0,a._)("br",null,null,-1),le=(0,a._)("div",{class:"text-caption"},"Miscellaneous",-1),ce={class:"px-5 flex flex-col gap-2"};var ue={__name:"SettingsMenu",setup(t){const e=ft(),n=ht(),i=(0,R.iH)(!1),s=()=>{const t=e.formal_specs;j.copyToClipboard(t)};return(t,e)=>((0,a.wg)(),(0,a.j4)(o.T,{variant:"tonal",size:"small",icon:""},{default:(0,a.w5)((()=>[(0,a.Wm)(h.t,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi-cog")])),_:1}),(0,a.Wm)(c.B,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=t=>i.value=t),activator:"parent",width:"500px","max-height":"80vh"},{default:(0,a.w5)((()=>[(0,a.Wm)(p.C,{class:"px-3 p-2 flex flex-col pb-4"},{default:(0,a.w5)((()=>[ne,(0,a._)("div",ie,[ae,(0,a._)("div",se,[(0,a._)("div",null,[(0,a.Wm)(qt.G,{modelValue:(0,R.SU)(n).simplifyDFARegex,"onUpdate:modelValue":e[0]||(e[0]=t=>(0,R.SU)(n).simplifyDFARegex=t),"hide-details":"",density:"compact"},{label:(0,a.w5)((()=>[(0,a.Uk)(" Simplified DFA-Regex "),(0,a._)("span",re,[(0,a.Wm)(h.t,{size:"xs"},{default:(0,a.w5)((()=>[(0,a.Uk)("mdi-help")])),_:1}),(0,a.Wm)(d.N,{activator:"parent"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Optimizes the result conversion to its most minimized version. "),oe,(0,a.Uk)(" $ - symbolizes the empty string ")])),_:1})])])),_:1},8,["modelValue"])])]),le,(0,a._)("div",ce,[(0,a._)("div",null,[(0,a.Wm)(qt.G,{modelValue:(0,R.SU)(n).saveFSMOnExit,"onUpdate:modelValue":e[1]||(e[1]=t=>(0,R.SU)(n).saveFSMOnExit=t),"hide-details":"",density:"compact",label:"Save FSM on exit"},null,8,["modelValue"])]),(0,a._)("div",null,[(0,a.Wm)(o.T,{elevation:"3",block:"",onClick:s},{default:(0,a.w5)((()=>[(0,a.Uk)(" Copy current machine formal specifications ")])),_:1})])])])])),_:1})])),_:1},8,["modelValue"])])),_:1}))}};const he=ue;var fe=he;const pe={class:"flex justify-center"},me=(0,a._)("div",{class:"text-xl"},"Save File As",-1);var de={__name:"SaveFile",setup(t){const e=ut(),n=(0,R.iH)(""),i=()=>{e.saveDFA(n.value)};return(t,e)=>((0,a.wg)(),(0,a.iD)("div",pe,[(0,a.Wm)(p.C,{class:"px-4 p-2 pb-4 gap-2 d-flex flex-col",rounded:"","min-width":"300px"},{default:(0,a.w5)((()=>[me,(0,a._)("div",null,[(0,a.Wm)(m.h,{variant:"outlined",label:"Filename",modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=t=>n.value=t),rules:[t=>!!t||"Please assign a file name"]},null,8,["modelValue","rules"])]),(0,a._)("div",null,[(0,a.Wm)(o.T,{color:"success",block:"",disabled:""===n.value||null===n.value,onClick:i},{default:(0,a.w5)((()=>[(0,a.Uk)("Save")])),_:1},8,["disabled"])])])),_:1})]))}};const ge=de;var ve=ge,Se={name:"App",components:{FSMVisualizer:St,AlphabetLister:Lt,TransitionFab:Pt,StateHelper:ee,SettingsMenu:fe,SaveFile:ve},setup(){const t=ft(),e=Y(),n=(Q(),z(),U(),ht()),i=ut(),s=(0,R.qj)([{name:"default",text:"➕",hotkey:"V"},{name:"linking",text:"🔗",hotkey:"C"},{name:"delete",text:"❌",hotkey:"D"}]),r=(0,R.iH)(null),o=(0,R.iH)(""),l=(0,a.Fl)((()=>t.regexResult));(0,a.YP)(l,(t=>{""!==t&&(o.value=l.value)}));const c=(0,a.Fl)({get:()=>e.mode,set:t=>e.mode=t}),u=async()=>{const t=0===r.value.files.length?null:await r.value.files[0].text();null!==t&&i.loadDFA(JSON.parse(t))};return n.sync(),{mainStore:t,m:c,tools:s,regex:o,fileinput:r,loadJSON:u}}};const be=(0,gt.Z)(Se,[["render",k]]);var ye=be,_e=(n(9773),n(8727)),we=n(8600),xe=n(4030),Te=(0,_e.Rd)({directives:we,components:xe,theme:{defaultTheme:"dark"}});async function Ee(){const t=await n.e(461).then(n.t.bind(n,3657,23));t.load({google:{families:["Roboto:100,300,400,500,700,900&display=swap"]}})}const Ae=(0,I.WB)();Ee(),(0,i.ri)(ye).use(Ae).use(Te).mount("#app")},4430:function(t,e,n){var a,s;n(7658),function(n){"undefined"!==typeof t.exports&&(t.exports=n),e.noam=n,a=[],s=function(){return n}.apply(e,a),void 0===s||(t.exports=s),"undefined"!==typeof window&&(window.noam=n)}(function(){var t={util:{}};t.util.areEquivalent=function(e,n){if(e===n)return!0;if(e instanceof Date&&n instanceof Date)return e.getTime()===n.getTime();if(e instanceof RegExp&&n instanceof RegExp)return e.source===n.source&&e.global===n.global&&e.multiline===n.multiline&&e.lastIndex===n.lastIndex&&e.ignoreCase===n.ignoreCase;if(!(e instanceof Object)||!(n instanceof Object))return!1;if("undefined"===typeof e||"undefined"===typeof n)return!1;if(e.constructor!==n.constructor)return!1;for(var i in e){if(!(i in n))return!1;if(e[i]!==n[i]){if("object"!==typeof e[i])return!1;if(!t.util.areEquivalent(e[i],n[i]))return!1}}for(i in n)if(!(i in e))return!1;return!0},t.util.contains=function(e,n,i){i=i||0;for(var a=i;a<e.length;a++)if(t.util.areEquivalent(e[a],n))return!0;return!1},t.util.index=function(e,n,i){var a=i||0;while(a<e.length){if(t.util.areEquivalent(e[a],n))return a;a++}return-1},t.util.containsAll=function(e,n){for(var i=0;i<n.length;i++)if(!t.util.contains(e,n[i]))return!1;return!0},t.util.containsAny=function(e,n){for(var i=0;i<n.length;i++)if(t.util.contains(e,n[i]))return!0;return!1},t.util.areEqualSets=function(e,n){if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(!t.util.contains(n,e[i]))return!1;return!0},t.util.containsSet=function(e,n){for(var i=0;i<e.length;i++)if(t.util.areEqualSets(e[i],n))return!0;return!1},t.util.setUnion=function(e,n){var i,a=[];for(i=0;i<e.length;i++)t.util.contains(a,e[i])||a.push(e[i]);for(i=0;i<n.length;i++)t.util.contains(a,n[i])||a.push(n[i]);return a},t.util.setIntersection=function(e,n){var i,a=[];for(i=0;i<e.length;i++)t.util.contains(n,e[i])&&a.push(e[i]);return a},t.util.clone=function(t){return JSON.parse(JSON.stringify(t))},t.util.makeCounter=function(){function t(){return this.value++}function e(e){return{value:e,getAndAdvance:t}}return e}(),t.util.randint=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};var e={};return function(){var t=[5,11,23,47,97,197,397,797,1597,3203,6421,12853,25717,51437,102877,205759,411527,823117,1646237,3292489,6584983,13169977,26339969,52679969,105359939],n=0,i=(1<<31)-1,a=.75,s=.25;function r(t){return"[object Array]"===Object.prototype.toString.call(t)}function o(e){e=Math.max(e,t[0]),e=Math.min(e,t[t.length-1]);var n,i=0,a=t.length-1;while(i<a)n=i+Math.floor((a-i)/2),t[n]>=e?a=n:i=n+1;return i}function l(t){var e,n;if(void 0===t)return 12345;if(null===t)return 54321;if("boolean"===typeof t||"number"===typeof t)return t&i;if("string"===typeof t){for(e=5381,n=0;n<t.length;n++)e=(33*e^t.charCodeAt(n))&i;return e}if(r(t)){for(e=6421,n=0;n<t.length;n++)e=(37*e^l(t[n]))&i;return e}var a=[];for(n in t)t.hasOwnProperty(n)&&a.push(n);for(a.sort(),e=3203,n=0;n<a.length;n++)e=(43*(39*e^l(a[n]))^l(t[a[n]]))&i;return e}function c(t,e){if(t===e)return!0;if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(t instanceof RegExp&&e instanceof RegExp)return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(!(t instanceof Object)||!(e instanceof Object))return!1;if("undefined"===typeof t||"undefined"===typeof e)return!1;if(t.constructor!==e.constructor)return!1;for(var n in t){if(!(n in e))return!1;if(t[n]!==e[n]){if("object"!==typeof t[n])return!1;if(!c(t[n],e[n]))return!1}}for(n in e)if(!(n in t))return!1;return!0}function u(t,e){this.key=t,this.value=e}function h(){}function f(t){this.node=t.head}function p(e,n){if(n>=t.length)throw new Error("Capacity of HashTable can't grow beyond "+t[t.length-1]);if(n>=0){var i=e.capacity,a=e.slots;e.capacity_index=n,e.capacity=t[n],e.slots=[];for(var s=0;s<i;s++)if(void 0!==a[s]){var r=a[s].iterator();while(r.hasNext())e._putNodeRsz(r.next())}}}function m(t,e){return t.hash(e)%t.capacity}h.prototype.isEmpty=function(){return void 0===this.head},h.prototype.insertHead=function(t){t.next=this.head,this.head=t},h.prototype.removeSuccessor=function(t){void 0===t?this.head=this.head.next:t.next=t.next.next},h.prototype.put=function(t,e,n){var i=this.iterator();while(i.hasNext()){var a=i.next();if(t.equals(e,a.key))return a.value=n,!1}return this.insertHead(new u(e,n)),!0},h.prototype.get=function(t,e){var n=this.iterator();while(n.hasNext()){var i=n.next();if(t.equals(e,i.key))return i.value}},h.prototype.remove=function(t,e){var n,i=this.iterator();while(i.hasNext()){var a=i.next();if(t.equals(e,a.key))return this.removeSuccessor(n),!0;n=a}return!1},f.prototype.hasNext=function(){return void 0!==this.node},f.prototype.next=function(){if(!this.hasNext())throw new Error("HashTable internal error: called _HashChainIterator.next on exhausted iterator");var t=this.node;return this.node=t.next,t},h.prototype.iterator=function(){return new f(this)},e.HashTable=function(e){this.capacity_index=n,e&&(e.initial_capacity&&(this.capacity_index=o(e.initial_capacity)),e.hash&&(this.hash=e.hash),e.equals&&(this.equals=e.equals)),this.capacity=t[this.capacity_index],this.numkeys=0,this.slots=[]},e.HashTable.prototype.hash=l,e.HashTable.prototype.equals=c,e.HashTable.prototype.loadFactor=function(){return this.numkeys/this.capacity},e.HashTable.prototype.put=function(t,e){if(void 0===t)throw new Error("called HashTable.put with key === undefined");if(void 0===e)throw new Error("called HashTable.put with value === undefined");var n=m(this,t);void 0===this.slots[n]&&(this.slots[n]=new h),this.slots[n].put(this,t,e)&&(++this.numkeys,this.loadFactor()>a&&p(this,this.capacity_index+1))},e.HashTable.prototype._putNodeRsz=function(t){var e=m(this,t.key);void 0===this.slots[e]&&(this.slots[e]=new h),this.slots[e].insertHead(t)},e.HashTable.prototype.get=function(t){if(void 0===t)throw new Error("called HashTable.get with key === undefined");var e=m(this,t),n=this.slots[e];return void 0===n?void 0:n.get(this,t)},e.HashTable.prototype.remove=function(t){if(void 0===t)throw new Error("called HashTable.remove with key === undefined");var e=m(this,t),n=this.slots[e];void 0!==n&&n.remove(this,t)&&(--this.numkeys,this.loadFactor()<s&&p(this,this.capacity_index-1))},e.HashTable.prototype.isEmpty=function(){return 0===this.numkeys},e.HashTable.prototype.clear=function(){this.capacity_index=n,this.capacity=t[this.capacity_index],this.numkeys=0,this.slots=[]},e.HashTable.prototype.size=function(){return this.numkeys},e.HashTable.prototype.containsKey=function(t){if(void 0===t)throw new Error("called HashTable.containsKey with key === undefined");return void 0!==this.get(t)},e.HashTable.prototype.keys=function(){for(var t=[],e=this.keyIterator();e.hasNext();)t.push(e.next());return t},e.HashTable.prototype.values=function(){for(var t=[],e=this.valueIterator();e.hasNext();)t.push(e.next());return t},e.HashTable.prototype.entries=function(){for(var t=[],e=this.keyValueIterator();e.hasNext();)t.push(e.next());return t};var d={hasNext:function(){if(void 0!==this.cur_chain_iterator&&this.cur_chain_iterator.hasNext())return!0;void 0!==this.cur_chain_iterator&&++this.idx;while(this.idx<this.H.capacity&&(void 0===this.H.slots[this.idx]||this.H.slots[this.idx].isEmpty()))++this.idx;var t=this.H.slots[this.idx];return void 0===t?(this.cur_chain_iterator=void 0,!1):(this.cur_chain_iterator=t.iterator(),!0)},_next:function(t,e){if(!this.hasNext())throw new Error(t);var n=e(this);return n},each:function(t,e){if(void 0===t)throw new Error("called iterator.each with iterator_func === undefined");for(var n=0;this.hasNext();n++)t.call(e,this.next(),n,this.H)}};function g(t){this.idx=0,this.H=t}function v(t){this.idx=0,this.H=t}function S(t){this.idx=0,this.H=t}g.prototype=Object.create(d),g.prototype.next=function(){return this._next("KeyIterator.next called on empty iterator",(function(t){return t.cur_chain_iterator.next().key}))},v.prototype=Object.create(d),v.prototype.next=function(){return this._next("ValueIterator.next called on empty iterator",(function(t){return t.cur_chain_iterator.next().value}))},S.prototype=Object.create(d),S.prototype.next=function(){return this._next("KeyValueIterator.next called on empty iterator",(function(t){var e=t.cur_chain_iterator.next();return[e.key,e.value]}))},e.HashTable.prototype.keyIterator=function(){return new g(this)},e.HashTable.prototype.valueIterator=function(){return new v(this)},e.HashTable.prototype.keyValueIterator=function(){return new S(this)}}(),t.util.HashTable=e.HashTable,delete e,t.fsm={},t.fsm.epsilonSymbol="$",t.fsm.dfaType="DFA",t.fsm.nfaType="NFA",t.fsm.enfaType="eNFA",t.fsm.makeNew=function(){return{states:[],alphabet:[],acceptingStates:[],initialState:void 0,transitions:[]}},t.fsm._addStateOrSymbol=function(e,n,i,a){if(void 0===n)throw new Error(i);if(t.util.contains(e,n))throw new Error(a);return e.push(n),n},t.fsm.addState=function(e,n){return t.fsm._addStateOrSymbol(e.states,n,"No state object specified","State already exists")},t.fsm.addSymbol=function(e,n){if(t.util.areEquivalent(n,t.fsm.epsilonSymbol))throw new Error("Can't add the epsilon symbol to the alphabet");return t.fsm._addStateOrSymbol(e.alphabet,n,"No symbol object specified","Symbol already exists")},t.fsm.addAcceptingState=function(e,n){if(!t.util.contains(e.states,n))throw new Error("The specified object is not a state of the FSM");t.fsm._addStateOrSymbol(e.acceptingStates,n,"","The specified state is already accepting")},t.fsm.setInitialState=function(e,n){if(!t.util.contains(e.states,n))throw new Error("The specified object is not a state of the FSM");e.initialState=n},t.fsm._addTransition=function(e,n,i,a){if(!Array.isArray(i))throw new Error("The toStates argument must be an array");if(!t.util.contains(e.states,n)||!t.util.containsAll(e.states,i))throw new Error("One of the specified objects is not a state of the FSM");var s,r=!1;for(s=0;s<e.transitions.length;s++)if(t.util.areEquivalent(n,e.transitions[s].fromState)&&t.util.areEquivalent(a,e.transitions[s].symbol)){e.transitions[s].toStates=t.util.setUnion(e.transitions[s].toStates,i),r=!0;break}r||e.transitions.push({fromState:n,toStates:i,symbol:a})},t.fsm.addTransition=function(e,n,i,a){if(!t.util.contains(e.alphabet,a))throw new Error("The specified object is not an alphabet symbol of the FSM");t.fsm._addTransition(e,n,i,a)},t.fsm.addEpsilonTransition=function(e,n,i){t.fsm._addTransition(e,n,i,t.fsm.epsilonSymbol)},t.fsm.validate=function(e){var n,i,a;if(!("undefined"!==typeof e&&Array.isArray(e.states)&&Array.isArray(e.alphabet)&&Array.isArray(e.acceptingStates)&&"undefined"!==typeof e.initialState&&null!==e.initialState&&Array.isArray(e.transitions)))throw new Error("FSM must be defined and have states, alphabet, acceptingStates, initialState and transitions array properties!");if(e.states.length<1)throw new Error("Set of states must not be empty.");for(n=0;n<e.states.length;n++)if(t.util.contains(e.states,e.states[n],n+1))throw new Error("Equivalent states");if(e.alphabet.length<1)throw new Error("Alphabet must not be empty.");for(n=0;n<e.alphabet.length;n++)if(t.util.contains(e.alphabet,e.alphabet[n],n+1))throw new Error("Equivalent alphabet symbols");if(t.util.contains(e.alphabet,t.fsm.epsilonSymbol))throw new Error("FSM alphabet must not contain the epsilon symbol");for(n=0;n<e.alphabet.length;n++)if(t.util.contains(e.states,e.alphabet[n]))throw new Error("States and alphabet symbols must not overlap");for(n=0;n<e.acceptingStates.length;n++){if(t.util.contains(e.acceptingStates,e.acceptingStates[n],n+1))throw new Error("Equivalent acceptingStates");if(!t.util.contains(e.states,e.acceptingStates[n]))throw new Error("Each accepting state must be in states")}if(!t.util.contains(e.states,e.initialState))throw new Error("Initial state must be in states");for(n=0;n<e.transitions.length;n++){var s=e.transitions[n];if("undefined"===typeof s.fromState||"undefined"===typeof s.toStates||"undefined"===typeof s.symbol)throw new Error("Transitions must have fromState, toState and symbol");if(!t.util.contains(e.states,s.fromState))throw new Error("Transition fromState must be in states.");if(!t.util.contains(e.alphabet,s.symbol)&&s.symbol!==t.fsm.epsilonSymbol)throw new Error("Transition symbol must be in alphabet.");for(a=0;a<s.toStates.length;a++){if(!t.util.contains(e.states,s.toStates[a]))throw new Error("Transition toStates must be in states.");if(t.util.contains(s.toStates,s.toStates[a],a+1))throw new Error("Transition toStates must not contain duplicates.")}}for(n=0;n<e.transitions.length;n++)for(i=n+1;i<e.transitions.length;i++)if(e.transitions[n].fromState===e.transitions[i].fromState&&e.transitions[n].symbol===e.transitions[i].symbol)throw new Error("Transitions for the same fromState and symbol must be defined in a single trainsition.");return!0},t.fsm.isAcceptingState=function(e,n){return t.util.contains(e.acceptingStates,n)},t.fsm.determineType=function(e){for(var n=t.fsm.dfaType,i=0;i<e.transitions.length;i++){var a=e.transitions[i];if(a.symbol===t.fsm.epsilonSymbol){n=t.fsm.enfaType;break}(0===a.toStates.length||a.toStates.length>1)&&(n=t.fsm.nfaType)}return n===t.fsm.dfaType&&e.transitions.length<e.states.length*e.alphabet.length&&(n=t.fsm.nfaType),n},t.fsm.computeEpsilonClosure=function(e,n){if(!t.util.containsAll(e.states,n))throw new Error("FSM must contain all states for which epsilon closure is being computed");var i=n,a=[];while(0!==i.length){var s=i.pop();a.push(s);for(var r=0;r<e.transitions.length;r++){var o=e.transitions[r];if(o.symbol===t.fsm.epsilonSymbol&&t.util.areEquivalent(o.fromState,s))for(var l=0;l<o.toStates.length;l++)t.util.contains(a,o.toStates[l])||t.util.contains(i,o.toStates[l])||i.push(o.toStates[l])}}return a},t.fsm.makeSimpleTransition=function(e,n,i){if(!t.util.containsAll(e.states,n))throw new Error("FSM must contain all states for which the transition is being computed");if(!t.util.contains(e.alphabet,i))throw new Error("FSM must contain input symbol for which the transition is being computed");for(var a=[],s=0;s<e.transitions.length;s++){var r=e.transitions[s];if(t.util.areEquivalent(e.transitions[s].symbol,i)&&t.util.contains(n,r.fromState))for(var o=0;o<r.toStates.length;o++)t.util.contains(a,r.toStates[o])||a.push(r.toStates[o])}return a},t.fsm.makeTransition=function(e,n,i){if(!t.util.containsAll(e.states,n))throw new Error("FSM must contain all states for which the transition is being computed");if(!t.util.contains(e.alphabet,i))throw new Error("FSM must contain input symbol for which the transition is being computed");var a=t.util.clone(n);return a=t.fsm.computeEpsilonClosure(e,a),a=t.fsm.makeSimpleTransition(e,a,i),a=t.fsm.computeEpsilonClosure(e,a),a},t.fsm.readString=function(e,n){if(!t.util.containsAll(e.alphabet,n))throw new Error("FSM must contain all symbols for which the transition is being computed");for(var i=t.fsm.computeEpsilonClosure(e,[e.initialState]),a=0;a<n.length;a++)i=t.fsm.makeTransition(e,i,n[a]);return i},t.fsm.transitionTrail=function(e,n,i){if(!t.util.containsAll(e.alphabet,i))throw new Error("FSM must contain all symbols for which the transition is being computed");for(var a=[n],s=[t.util.clone(a)],r=0;r<i.length;r++)a=t.fsm.makeTransition(e,a,i[r]),s.push(t.util.clone(a));return s},t.fsm.isStringInLanguage=function(e,n){var i=t.fsm.readString(e,n);return t.util.containsAny(e.acceptingStates,i)},t.fsm.printTable=function(e){var i=n(4896),a=[""].concat(e.alphabet);t.fsm.determineType(e)===t.fsm.enfaType&&a.push(t.fsm.epsilonSymbol),a.push("");var s,r,o=new i({head:a,chars:{top:"-","top-mid":"+","top-left":"+","top-right":"+",bottom:"-","bottom-mid":"+","bottom-left":"+","bottom-right":"+",left:"|","left-mid":"+",mid:"-","mid-mid":"+",right:"|","right-mid":"+"},truncate:"~"}),l=[];for(s=0;s<e.states.length;s++){for(l.push(new Array(a.length)),r=0;r<a.length;r++)l[s][r]="";l[s][0]=e.states[s].toString(),l[s][a.length-1]=t.util.contains(e.acceptingStates,e.states[s])?"1":"0",o.push(l[s])}for(s=0;s<e.transitions.length;s++){var c=e.transitions[s],u=null,h=null;for(r=0;r<e.states.length;r++)if(t.util.areEquivalent(e.states[r],c.fromState)){h=r;break}if(c.symbol===t.fsm.epsilonSymbol)u=a.length-2;else for(r=0;r<e.alphabet.length;r++)if(t.util.areEquivalent(e.alphabet[r],c.symbol)){u=r+1;break}"undefined"===typeof l[h][u].text&&(l[h][u]={text:[]}),l[h][u].text.push(c.toStates)}return o.toString()},t.fsm.serializeFsmToString=function(t){var e=[];e.push("#states");for(var n=0;n<t.states.length;n++)e.push(t.states[n].toString());e.push("#initial"),e.push(t.initialState.toString()),e.push("#accepting");for(n=0;n<t.acceptingStates.length;n++)e.push(t.acceptingStates[n].toString());e.push("#alphabet");for(n=0;n<t.alphabet.length;n++)e.push(t.alphabet[n].toString());e.push("#transitions");for(n=0;n<t.transitions.length;n++)e.push(t.transitions[n].fromState.toString()+":"+t.transitions[n].symbol.toString()+">"+t.transitions[n].toStates.join(","));return e.join("\n")},t.fsm.parseFsmFromString=function(e){for(var n,i=e.split(/\r?\n/),a=[],s=[],r=[],o=[],l=null,c={states:0,initial:0,accepting:0,alphabet:0,transitions:0},u=0;u<i.length;u++){var h=i[u].replace(/\s/g,"");if(0!==h.length)if("#"===h[0]){if(l=h.substr(1),"undefined"===typeof c[l])throw new Error("Line "+(u+1).toString()+": invalid section name "+l+". Must be one of: states, initial,                            accepting, alphabet, transitions.");if(c[l]+=1,c[l]>1)throw new Error("Line "+(u+1).toString()+": duplicate section name "+l+".")}else{if(null==l)throw new Error("Line "+(u+1).toString()+": no #section declared.                           Add one section: states, initial, accepting,                           alphabet, transitions.");if("states"===l){var f=h.split(";");a=a.concat(f)}else if("initial"==l)n=h;else if("accepting"==l){var p=h.split(";");s=s.concat(p)}else if("alphabet"==l){var m=h.split(";");r=r.concat(m)}else if("transitions"==l){for(var d=h.split(":"),g=d[0].split(","),v=d[1].split(";"),S=0;S<v.length;S++)var b=v[S].split(">"),y=b[0].split(","),_=b[1].split(",");o.push([g,y,_])}}}for(var w in c)if(1!==c[w])throw new Error("Specification missing #"+c[w]+" section.");var x=t.fsm.makeNew();for(u=a.length-1;u>=0;u--)t.fsm.addState(x,a[u]);for(u=r.length-1;u>=0;u--)t.fsm.addSymbol(x,r[u]);for(u=0;u<s.length;u++)t.fsm.addAcceptingState(x,s[u]);t.fsm.setInitialState(x,n);for(u=0;u<o.length;u++){var T=o[u];for(S=0;S<T[0].length;S++)for(w=0;w<T[1].length;w++)T[1][w]===t.fsm.epsilonSymbol?t.fsm.addEpsilonTransition(x,T[0][S],T[2]):t.fsm.addTransition(x,T[0][S],T[2],T[1][w])}return t.fsm.validate(x),x},t.fsm.printHtmlTable=function(e){var n=[""].concat(e.alphabet);t.fsm.determineType(e)===t.fsm.enfaType&&n.push(t.fsm.epsilonSymbol),n.push("");var i,a,s=[];for(i=0;i<e.states.length;i++){for(s.push(new Array(n.length)),a=0;a<n.length;a++)s[i][a]={text:[]};s[i][0]={text:e.states[i].toString()},s[i][n.length-1]=t.util.contains(e.acceptingStates,e.states[i])?{text:["1"]}:{text:["0"]}}for(i=0;i<e.transitions.length;i++){var r=e.transitions[i],o=null,l=null;for(a=0;a<e.states.length;a++)if(t.util.areEquivalent(e.states[a],r.fromState)){l=a;break}if(r.symbol===t.fsm.epsilonSymbol)o=n.length-2;else for(a=0;a<e.alphabet.length;a++)if(t.util.areEquivalent(e.alphabet[a],r.symbol)){o=a+1;break}"undefined"===typeof s[l][o].text&&(s[l][o]={text:[]}),s[l][o].text.push(r.toStates)}var c=[];for(c.push("<table border='1'>"),c.push("  <tr>"),i=0;i<n.length;i++)c.push("    <th>"+n[i].toString()+"</th>");for(c.push("  </tr>"),i=0;i<s.length;i++){for(c.push("  <tr>"),a=0;a<s[i].length;a++)c.push("    <td>"+s[i][a].text+"</td>");c.push("  </tr>")}return c.push("</table>"),c.join("\n")},t.fsm.printDotFormat=function(e){var n,i,a,s,r=["digraph finite_state_machine {","  rankdir=LR;"],o=["  node [shape = doublecircle];"];for(n=0;n<e.acceptingStates.length;n++)o.push(e.acceptingStates[n].toString());o.push(";"),o.length>2&&r.push(o.join(" ")),r.push("  node [shape = circle];"),r.push("  secret_node [style=invis, shape=point];");var l=["  secret_node ->"];l.push(e.initialState.toString()),l.push("[style=bold];"),r.push(l.join(" "));var c=[];for(n=0;n<e.transitions.length;n++)for(i=0;i<e.transitions[n].toStates.length;i++){var u=null;for(a=0;a<c.length;a++)t.util.areEquivalent(c[a].fromState,e.transitions[n].fromState)&&t.util.areEquivalent(c[a].toStates,[e.transitions[n].toStates[i]])&&(u=c[a]);if(null===u){var h=t.util.clone(e.transitions[n]);h.toStates=[h.toStates[i]],h.symbol=[h.symbol],c.push(h)}else u.symbol.push(e.transitions[n].symbol)}for(n=0;n<c.length;n++)t.util.areEquivalent(c[n].toStates[0],e.initialState)?(s=[" "],s.push(c[n].toStates[0].toString()),s.push("->"),s.push(c[n].fromState.toString()),s.push("["),s.push("label ="),s.push('"'+c[n].symbol.toString()+'"'),s.push(" dir = back];"),r.push(s.join(" "))):(s=[" "],s.push(c[n].fromState.toString()),s.push("->"),s.push(c[n].toStates[0].toString()),s.push("["),s.push("label ="),s.push('"'+c[n].symbol.toString()+'"'),s.push(" ];"),r.push(s.join(" ")));return r.push("}"),r.join("\n").replace(/\$/g,"$")},t.fsm.getReachableStates=function(e,n,i){var a,s,r=[n],o=i?[n]:[];while(0!==r.length){var l=r.pop();for(a=0;a<e.transitions.length;a++){var c=e.transitions[a];if(t.util.areEquivalent(l,c.fromState))for(s=0;s<c.toStates.length;s++)t.util.contains(o,c.toStates[s])||(o.push(c.toStates[s]),t.util.contains(r,c.toStates[s])||r.push(c.toStates[s]))}}return o},t.fsm.removeUnreachableStates=function(e){var n,i=t.fsm.getReachableStates(e,e.initialState,!0),a=t.util.clone(e);for(a.states=[],a.acceptingStates=[],a.transitions=[],n=0;n<e.states.length;n++)t.util.contains(i,e.states[n])&&a.states.push(t.util.clone(e.states[n]));for(n=0;n<e.acceptingStates.length;n++)t.util.contains(i,e.acceptingStates[n])&&a.acceptingStates.push(t.util.clone(e.acceptingStates[n]));for(n=0;n<e.transitions.length;n++)t.util.contains(i,e.transitions[n].fromState)&&a.transitions.push(t.util.clone(e.transitions[n]));return a},t.fsm.areEquivalentStates=function(e,n,i,a){if(t.fsm.determineType(e)!==t.fsm.dfaType||t.fsm.determineType(i)!==t.fsm.dfaType)throw new Error("FSMs must be DFAs");if(e.alphabet.length!==i.alphabet.length||!t.util.containsAll(e.alphabet,i.alphabet))throw new Error("FSM alphabets must be the same");if(!t.util.contains(e.states,n)||!t.util.contains(i.states,a))throw new Error("FSMs must contain states");function s(e,n,i,a){var s=t.util.contains(e.acceptingStates,n),r=t.util.contains(i.acceptingStates,a);return s&&r||!s&&!r}var r,o=[[n,a]],l=[];while(0!==o.length){var c=o.pop();if(!s(e,c[0],i,c[1]))return!1;for(l.push(c),r=0;r<e.alphabet.length;r++){var u=[t.fsm.makeTransition(e,[c[0]],e.alphabet[r])[0],t.fsm.makeTransition(i,[c[1]],e.alphabet[r])[0]];t.util.contains(l,u)||t.util.contains(o,u)||o.push(u)}}return!0},t.fsm.areEquivalentFSMs=function(e,n){return t.fsm.areEquivalentStates(e,e.initialState,n,n.initialState)},t.fsm.removeEquivalentStates=function(e){if(t.fsm.determineType(e)!==t.fsm.dfaType)throw new Error("FSM must be DFA");var n,i,a,s=[];for(n=0;n<e.states.length;n++)for(i=n+1;i<e.states.length;i++)if(t.fsm.areEquivalentStates(e,e.states[n],e,e.states[i])){var r=[e.states[n],e.states[i]];for(a=0;a<s.length;a++)if(t.util.areEquivalent(s[a][1],r[0])){r[0]=s[a][1];break}t.util.contains(s,r)||s.push(r)}var o={states:[],alphabet:t.util.clone(e.alphabet),initialState:[],acceptingStates:[],transitions:[]};function l(e){for(var n=0;n<s.length;n++)if(t.util.areEquivalent(s[n][1],e))return!0;return!1}function c(e){for(var n=0;n<s.length;n++)if(t.util.areEquivalent(s[n][1],e))return s[n][0];return e}for(n=0;n<e.states.length;n++)l(e.states[n])||o.states.push(t.util.clone(e.states[n]));for(n=0;n<e.acceptingStates.length;n++)l(e.acceptingStates[n])||o.acceptingStates.push(t.util.clone(e.acceptingStates[n]));for(o.initialState=t.util.clone(c(e.initialState)),n=0;n<e.transitions.length;n++){var u=t.util.clone(e.transitions[n]);if(!l(u.fromState)){for(i=0;i<u.toStates.length;i++)u.toStates[i]=c(u.toStates[i]);o.transitions.push(u)}}return o},t.fsm.minimize=function(e){var n=t.fsm.determineType(e),i=e;n===t.fsm.nfaType?i=t.fsm.convertNfaToDfa(e):n===t.fsm.enfaType&&(i=t.fsm.convertEnfaToNfa(e),i=t.fsm.convertNfaToDfa(i));var a=t.fsm.removeUnreachableStates(i),s=t.fsm.removeEquivalentStates(a);return s},t.fsm.convertStatesToNumbers=function(e){var n=t.fsm.makeNew(),a={};for(i=0;i<e.states.length;i++)a[e.states[i].toString()]=i;for(n.alphabet=t.util.clone(e.alphabet),i=0;i<e.states.length;i++)t.fsm.addState(n,a[e.states[i].toString()]);for(t.fsm.setInitialState(n,a[e.initialState.toString()]),i=0;i<e.acceptingStates.length;i++)t.fsm.addAcceptingState(n,a[e.acceptingStates[i].toString()]);for(i=0;i<e.transitions.length;i++){var s=[];for(j=0;j<e.transitions[i].toStates.length;j++)s.push(a[e.transitions[i].toStates[j].toString()]);t.fsm.addTransition(n,a[e.transitions[i].fromState.toString()],s,e.transitions[i].symbol)}return n},t.fsm.createRandomFsm=function(e,n,i,a){var s,r,o,l={};function c(t,e,n){for(var i=n,a=0;a<n.length-e;a++)i=t+n;return i}for(l.states=[],s=0,len=n.toString().length;s<n;s++)l.states.push("s"+c("0",len,s.toString()));if(l.alphabet=[],i>26)for(s=0,len=i.toString().length;s<i;s++)l.alphabet.push("a"+c("0",len,s.toString()));else l.alphabet="abcdefghijklmnopqrstuvwxyz".substr(0,i).split("");for(l.initialState=l.states[0],l.acceptingStates=[],s=0;s<n;s++)Math.round(Math.random())&&l.acceptingStates.push(l.states[s]);for(e===t.fsm.enfaType&&l.alphabet.push(t.fsm.epsilonSymbol),l.transitions=[],s=0;s<n;s++)for(r=0;r<l.alphabet.length;r++){var u=1;if(e!==t.fsm.dfaType&&(u=Math.floor(Math.random()*a)),u>0){var h=[];for(o=0;o<l.states.length&&h.length<u;o++){var f=l.states.length-o-(u-h.length)+1;f=f<=0?1:1/f,Math.random()<=f&&h.push(l.states[o])}l.transitions.push({fromState:l.states[s],symbol:l.alphabet[r],toStates:h})}}return e===t.fsm.enfaType&&l.alphabet.pop(),l},t.fsm.convertNfaToDfa=function(e){var n=t.fsm.determineType(e);if(n===t.fsm.enfaType)throw new Error("FSM must be an NFA");if(n===t.fsm.dfaType)return e;var i,a,s,r,o={};for(o.alphabet=t.util.clone(e.alphabet),o.states=[],o.acceptingStates=[],o.initialState=[t.util.clone(e.initialState)],o.transitions=[],i=0;i<e.states.length;i++)o.states.push([t.util.clone(e.states[i])]);for(i=0;i<e.acceptingStates.length;i++)o.acceptingStates.push([t.util.clone(e.acceptingStates[i])]);var l=[];for(i=0;i<e.transitions.length;i++)r=t.util.clone(e.transitions[i]),r.fromState=[r.fromState],r.toStates=[r.toStates],r.toStates[0].length>1&&(t.util.containsSet(l,r.toStates[0])||l.push(r.toStates[0])),o.transitions.push(r);while(0!==l.length){var c=l.pop();for(o.states.push(c),t.util.containsAny(e.acceptingStates,c)&&o.acceptingStates.push(c),i=0;i<o.alphabet.length;i++){var u=t.fsm.makeTransition(e,c,o.alphabet[i]).sort();for(a=0;a<o.states.length;a++)if(t.util.areEqualSets(u,o.states[a])){u=o.states[a];break}for(a=0;a<l.length;a++)if(t.util.areEqualSets(u,l[a])){u=l[a];break}u.length>0&&o.transitions.push({fromState:c,symbol:o.alphabet[i],toStates:[u]}),!t.util.containsSet(o.states,u)&&!t.util.containsSet(l,u)&&u.length>1&&l.push(u)}}var h=!1,f="ERROR";for(i=0;i<o.states.length;i++)for(a=0;a<o.alphabet.length;a++){var p=!1;for(s=0;s<o.transitions.length;s++)if(r=o.transitions[s],t.util.areEquivalent(r.symbol,o.alphabet[a])&&t.util.areEquivalent(r.fromState,o.states[i])){p=!0;break}!1===p&&(!1===h&&(o.states.push([f]),h=!0),o.transitions.push({fromState:o.states[i],symbol:o.alphabet[a],toStates:[[f]]}))}return o},t.fsm.convertEnfaToNfa=function(e){if(t.fsm.determineType(e)!==t.fsm.enfaType)return e;var n,i,a=t.util.clone(e),s=t.fsm.computeEpsilonClosure(e,[e.initialState]);t.util.containsAny(a.acceptingStates,s)&&!t.util.contains(a.acceptingStates,a.initialState)&&a.acceptingStates.push(a.initialState);var r=[];for(n=0;n<a.states.length;n++)for(i=0;i<a.alphabet.length;i++){var o=t.fsm.makeTransition(a,[a.states[n]],a.alphabet[i]).sort();o.length>0&&r.push({fromState:a.states[n],toStates:o,symbol:a.alphabet[i]})}a.transitions=r;var l=[];for(n=0;n<a.transitions.length;n++){var c=a.transitions[n];if(c.toStates.length>1){var u=!1;for(i=0;i<l.length;i++)if(t.util.areEqualSets(c.toStates,l[i])){c.toStates=l[i],u=!0;break}!1===u&&l.push(c.toStates)}}return a},t.fsm.isLanguageNonEmpty=function(e){var n=t.fsm.determineType(e),i=e;return n===t.fsm.nfaType?i=t.fsm.convertNfaToDfa(e):n===t.fsm.enfaType&&(i=t.fsm.convertEnfaToNfa(e),i=t.fsm.convertNfaToDfa(i)),i=t.fsm.minimize(i),i.acceptingStates.length>0},t.fsm.isLanguageInfinite=function(e){var n=t.fsm.determineType(e),i=e;n===t.fsm.nfaType?i=t.fsm.convertNfaToDfa(e):n===t.fsm.enfaType&&(i=t.fsm.convertEnfaToNfa(e),i=t.fsm.convertNfaToDfa(i)),i=t.fsm.minimize(i);var a,s,r=null;for(a=0;a<i.states.length;a++)if(!t.util.contains(i.acceptingStates,i.states[a])&&(s=t.fsm.getReachableStates(i,i.states[a],!0),!t.util.containsAny(i.acceptingStates,s))){r=i.states[a];break}if(null===r)return!0;for(a=0;a<i.states.length;a++)if(!t.util.areEquivalent(r,i.states[a])&&(s=t.fsm.getReachableStates(i,i.states[a],!1),t.util.contains(s,i.states[a])))return!0;return!1},t.fsm.randomStringInLanguage=function(e){var n=t.fsm.determineType(e),i=e;if(n===t.fsm.nfaType?i=t.fsm.convertNfaToDfa(e):n===t.fsm.enfaType&&(i=t.fsm.convertEnfaToNfa(e),i=t.fsm.convertNfaToDfa(i)),i=t.fsm.minimize(i),0===i.acceptingStates.length)return null;var a=i.acceptingStates[Math.floor(Math.random()*i.acceptingStates.length)],s=[];while(1){if(!0===t.util.areEquivalent(a,i.initialState)&&Math.round(Math.random()))break;var r,o=[];for(r=0;r<i.transitions.length;r++)t.util.areEquivalent(i.transitions[r].toStates[0],a)&&o.push(i.transitions[r]);if(0===o.length)break;var l=o[Math.floor(Math.random()*o.length)];s.push(l.symbol),a=l.fromState}return s.reverse(),s},t.fsm.randomStringNotInLanguage=function(e){var n=t.fsm.determineType(e),i=e;n===t.fsm.nfaType?i=t.fsm.convertNfaToDfa(e):n===t.fsm.enfaType&&(i=t.fsm.convertEnfaToNfa(e),i=t.fsm.convertNfaToDfa(i)),i=t.fsm.minimize(i);var a,s=[];for(a=0;a<i.states.length;a++)t.util.contains(i.acceptingStates,i.states[a])||s.push(i.states[a]);if(0===s.length)return null;var r=s[Math.floor(Math.random()*s.length)],o=[];while(1){if(!0===t.util.areEquivalent(r,i.initialState)&&Math.round(Math.random()))break;var l=[];for(a=0;a<i.transitions.length;a++)t.util.areEquivalent(i.transitions[a].toStates[0],r)&&l.push(i.transitions[a]);if(0===l.length)break;var c=l[Math.floor(Math.random()*l.length)];o.push(c.symbol),r=c.fromState}return o.reverse(),o},t.fsm.union=function(e,n){if(!t.util.areEquivalent(e.alphabet,n.alphabet))throw new Error("Alphabets must be the same");var i,a,s,r={alphabet:t.util.clone(e.alphabet),states:[],initialState:[t.util.clone(e.initialState),t.util.clone(n.initialState)],acceptingStates:[],transitions:[]};for(i=0;i<e.states.length;i++)for(a=0;a<n.states.length;a++){var o=[t.util.clone(e.states[i]),t.util.clone(n.states[a])];for(r.states.push(o),(t.util.contains(e.acceptingStates,e.states[i])||t.util.contains(n.acceptingStates,n.states[a]))&&r.acceptingStates.push(o),s=0;s<r.alphabet.length;s++)r.transitions.push({fromState:o,symbol:r.alphabet[s],toStates:[[t.fsm.makeTransition(e,[e.states[i]],r.alphabet[s])[0],t.fsm.makeTransition(n,[n.states[a]],r.alphabet[s])[0]]]})}return r},t.fsm.intersection=function(e,n){var i,a,s,r=t.util.clone(t.util.setIntersection(e.alphabet,n.alphabet)),o={alphabet:r,states:[],initialState:[t.util.clone(e.initialState),t.util.clone(n.initialState)],acceptingStates:[],transitions:[]};for(i=0;i<e.states.length;i++)for(a=0;a<n.states.length;a++){var l=[t.util.clone(e.states[i]),t.util.clone(n.states[a])];for(o.states.push(l),t.util.contains(e.acceptingStates,e.states[i])&&t.util.contains(n.acceptingStates,n.states[a])&&o.acceptingStates.push(l),s=0;s<o.alphabet.length;s++)o.transitions.push({fromState:l,symbol:o.alphabet[s],toStates:[[t.fsm.makeTransition(e,[e.states[i]],o.alphabet[s])[0],t.fsm.makeTransition(n,[n.states[a]],o.alphabet[s])[0]]]})}return o},t.fsm.difference=function(e,n){if(!t.util.areEquivalent(e.alphabet,n.alphabet))throw new Error("Alphabets must be the same");var i,a,s,r={alphabet:t.util.clone(e.alphabet),states:[],initialState:[t.util.clone(e.initialState),t.util.clone(n.initialState)],acceptingStates:[],transitions:[]};for(i=0;i<e.states.length;i++)for(a=0;a<n.states.length;a++){var o=[t.util.clone(e.states[i]),t.util.clone(n.states[a])];for(r.states.push(o),t.util.contains(e.acceptingStates,e.states[i])&&!t.util.contains(n.acceptingStates,n.states[a])&&r.acceptingStates.push(o),s=0;s<r.alphabet.length;s++)r.transitions.push({fromState:o,symbol:r.alphabet[s],toStates:[[t.fsm.makeTransition(e,[e.states[i]],r.alphabet[s])[0],t.fsm.makeTransition(n,[n.states[a]],r.alphabet[s])[0]]]})}return r},t.fsm.complement=function(e){var n,i=t.util.clone(e),a=[];for(n=0;n<i.states.length;n++)t.util.contains(i.acceptingStates,i.states[n])||a.push(i.states[n]);return i.acceptingStates=a,i},t.fsm.concatenation=function(e,n){if(!t.util.areEquivalent(e.alphabet,n.alphabet))throw new Error("Alphabets must be the same");if(t.util.containsAny(e.states,n.states))throw new Error("States must not overlap");for(var i={alphabet:t.util.clone(e.alphabet),states:t.util.clone(e.states).concat(t.util.clone(n.states)),initialState:t.util.clone(e.initialState),acceptingStates:t.util.clone(n.acceptingStates),transitions:t.util.clone(e.transitions).concat(t.util.clone(n.transitions))},a=0;a<e.acceptingStates.length;a++)i.transitions.push({fromState:t.util.clone(e.acceptingStates[a]),toStates:[t.util.clone(n.initialState)],symbol:t.fsm.epsilonSymbol});return i},t.fsm.kleene=function(e){var n=t.util.clone(e),i="NEW_INITIAL";n.states.push(i),n.transitions.push({fromState:i,toStates:[n.initialState],symbol:t.fsm.epsilonSymbol}),n.initialState=i;for(var a=0;a<n.acceptingStates.length;a++)n.transitions.push({fromState:n.acceptingStates[a],toStates:[i],symbol:t.fsm.epsilonSymbol});return n},t.fsm.reverse=function(e){for(var n=t.util.clone(e),i=[],a=0;a<n.transitions.length;a++)for(var s=0;s<n.transitions[a].toStates.length;s++)i.push({fromState:n.transitions[a].toStates[s],toStates:[n.transitions[a].fromState],symbol:n.transitions[a].symbol});n.transitions=i;var r=n.acceptingStates;n.acceptingStates=[n.initialState];var o="NEW_INITIAL";return n.states.push(o),n.initialState=o,n.transitions.push({fromState:o,toStates:r,symbol:t.fsm.epsilonSymbol}),n},t.fsm.isSubset=function(e,n){var i=t.fsm.intersection(e,n);return t.fsm.areEquivalentFSMs(n,i)},t.fsm.grammar=function(e){var n,i={nonterminals:t.util.clone(e.states),terminals:t.util.clone(e.alphabet),initialNonterminal:t.util.clone(e.initialState),productions:[]};for(n=0;n<e.transitions.length;n++)e.transitions[n].symbol===t.fsm.epsilonSymbol?i.productions.push({left:[t.util.clone(e.transitions[n].fromState)],right:t.util.clone(e.transitions[n].toStates)}):i.productions.push({left:[t.util.clone(e.transitions[n].fromState)],right:[t.util.clone(e.transitions[n].symbol)].concat(t.util.clone(e.transitions[n].toStates))});for(n=0;n<e.acceptingStates.length;n++)i.productions.push({left:[t.util.clone(e.acceptingStates[n])],right:[t.grammar.epsilonSymbol]});return i},t.fsm.symbolsForTransitions=function(e,n,i){for(var a=[],s=0;s<e.transitions.length;s++){var r=e.transitions[s];t.util.areEquivalent(r.fromState,n)&&t.util.contains(r.toStates,i)&&a.push(r.symbol)}return a},t.fsm.toRegex=function(e){var n,i,a,s,r=[],o=e.states.length;for(a=0;a<o+1;a++)for(r[a]=[],n=0;n<o;n++)r[a][n]=[];for(n=0;n<o;n++)for(i=0;i<o;i++){var l=t.fsm.symbolsForTransitions(e,e.states[n],e.states[i]);for(s=0;s<l.length;s++)l[s]=t.re.tree.makeLit(l[s]);n===i&&l.push(t.re.tree.makeEps()),r[0][n][i]=t.re.tree.makeAlt(l)}for(a=1;a<o+1;a++)for(n=0;n<o;n++)for(i=0;i<o;i++){var c="undefined"!==typeof r[a-1][n][a-1].choices&&0===r[a-1][n][a-1].choices.length||"undefined"!==typeof r[a-1][a-1][i].choices&&0===r[a-1][a-1][i].choices.length||"undefined"!==typeof r[a-1][a-1][a-1].choices&&0===r[a-1][a-1][a-1].choices.length,u="undefined"!==typeof r[a-1][n][i].choices&&0===r[a-1][n][i].choices.length,h=null;h=r[a-1][a-1][a-1].tag===t.re.tree.tags.EPS?t.re.tree.makeSeq([r[a-1][n][a-1],r[a-1][a-1][i]]):t.re.tree.makeSeq([r[a-1][n][a-1],t.re.tree.makeKStar(r[a-1][a-1][a-1]),r[a-1][a-1][i]]);var f=[];u||f.push(r[a-1][n][i]),c||f.push(h),f=t.re.tree.makeAlt(f),r[a][n][i]=f}var p=-1,m=[];for(n=0;n<e.states.length;n++)t.util.areEquivalent(e.states[n],e.initialState)&&(p=n),t.util.contains(e.acceptingStates,e.states[n])&&m.push(n);var d=[];for(n=0;n<m.length;n++)d.push(r[o][p][m[n]]);return t.re.tree.makeAlt(d)},t.grammar={},t.grammar.epsilonSymbol="$",t.grammar.regType="regular",t.grammar.cfgType="context-free",t.grammar.csgType="context-sensitive",t.grammar.unrestrictedType="unrestricted",t.grammar.validate=function(e){if(!("undefined"!==typeof e&&Array.isArray(e.nonterminals)&&Array.isArray(e.terminals)&&"undefined"!==typeof e.initialNonterminal&&null!==e.initialNonterminal&&Array.isArray(e.productions)))throw new Error("Grammar must be defined and have nonterminals, terminals, initialNonterminal and productions array properties!");var n,i;if(e.nonterminals.length<1)throw new Error("Set of nonterminals must not be empty.");if(e.terminals.length<1)throw new Error("Set of terminals must not be empty.");for(n=0;n<e.nonterminals.length;n++)if(t.util.contains(e.nonterminals,e.nonterminals[n],n+1))throw new Error("Equivalent nonterminals");for(n=0;n<e.terminals.length;n++)if(t.util.contains(e.terminals,e.terminals[n],n+1))throw new Error("Equivalent terminals");for(n=0;n<e.terminals.length;n++)if(t.util.contains(e.nonterminals,e.terminals[n]))throw new Error("Terminals and nonterminals must not overlap");if(!t.util.contains(e.nonterminals,e.initialNonterminal))throw new Error("InitialNonterminal must be in nonterminals");for(n=0;n<e.productions.length;n++){var a=e.productions[n];if(!Array.isArray(a.left))throw new Error("Left side of production must be an array");if(0===a.left.length)throw new Error("Left side of production must have at least one terminal or nonterminal");for(i=0;i<a.left.length;i++)if(!t.util.contains(e.nonterminals,a.left[i])&&!t.util.contains(e.terminals,a.left[i]))throw new Error("Left side of production must be in nonterminals or terminals");if(!Array.isArray(a.right))throw new Error("Right side of production must be an array");if(1===a.right.length&&a.right[0]===t.grammar.epsilonSymbol);else{if(0===a.right.length)throw new Error("Right side of production must have at least one terminal or nonterminal or epsilon symbol");for(i=0;i<a.right.length;i++)if(!t.util.contains(e.nonterminals,a.right[i])&&!t.util.contains(e.terminals,a.right[i]))throw new Error("Right side of production must be in nonterminals or terminals")}if(t.util.contains(e.productions,a,n+1))throw new Error("Grammar must not have duplicate productions")}return!0},t.grammar.determineType=function(e){var n,i,a,s=t.grammar.regType,r=null;for(n=0;n<e.productions.length;n++){var o=e.productions[n];if(s===t.grammar.regType)if(1===o.left.length&&t.util.contains(e.nonterminals,o.left[0])){if(1===o.right.length)continue;var l=0;for(a=-1,i=0;i<o.right.length;i++)t.util.contains(e.nonterminals,o.right[i])&&(l+=1,a=i);if(l>1)s=t.grammar.cfgType;else{if(0===l)continue;if(0===a){if(null===r){r=!1;continue}if(!1===r)continue;!0===r&&(s=t.grammar.cfgType)}else if(a===o.right.length-1){if(null===r){r=!0;continue}if(!0===r)continue;!1===r&&(s=t.grammar.cfgType)}else s=t.grammar.cfgType}}else s=t.grammar.cfgType;if(s===t.grammar.cfgType&&(1===o.left.length&&t.util.contains(e.nonterminals,o.left[0])||(s=t.grammar.csgType)),s===t.grammar.csgType){var c=0;for(a=-1,i=0;i<o.left.length;i++)t.util.contains(e.nonterminals,o.left[i])&&(c+=1,a=i);if(c>1)return t.grammar.unrestrictedType;var u=o.left.slice(0,a-1),h=o.left.slice(a);for(i=0;i<u.length;i++)if(!t.util.areEquivalent(u[i],o.right[i]))return t.grammar.unrestrictedType;for(i=0;i<h.length;i++)if(!t.util.areEquivalent(h[h.length-i-1],o.right[o.right.length-i-1]))return t.grammar.unrestrictedType;if(o.right.length<=u.length+h.length)return t.grammar.unrestrictedType}}return s},t.grammar.printAscii=function(e){var n=[];n.push("Initial nonterminal: <"+e.initialNonterminal+">");var i,a,s,r=[];for(i=0;i<e.productions.length;i++){var o=-1;for(a=0;a<r.length;a++)if(t.util.areEquivalent(r[a][0],e.productions[i].left)){o=a;break}-1===o?r[r.length]=[e.productions[i].left,[e.productions[i].right]]:r[o][1].push(e.productions[i].right)}for(i=0;i<r.length;i++){var l=[];for(a=0;a<r[i][0].length;a++)t.util.contains(e.nonterminals,r[i][0][a])?l.push("<"+r[i][0][a].toString()+">"):r[i][0][a]===t.grammar.epsilonSymbol?l.push(r[i][0][a].toString()):l.push('"'+r[i][0][a].toString()+'"');for(l.push("->"),a=0;a<r[i][1].length;a++){for(s=0;s<r[i][1][a].length;s++)t.util.contains(e.nonterminals,r[i][1][a][s])?l.push("<"+r[i][1][a][s].toString()+">"):r[i][1][a][s]===t.grammar.epsilonSymbol?l.push(r[i][1][a][s].toString()):l.push('"'+r[i][1][a][s].toString()+'"');a<r[i][1].length-1&&l.push("|")}n.push(l.join(" "))}return n.join("\n")},t.re=function(){var e=function(){var e={ALT:"alt",SEQ:"sequence",KSTAR:"kleene_star",LIT:"literal",EPS:"epsilon"};function n(t,e){var n;for(n in t)t.hasOwnProperty(n)&&delete t[n];for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}var i=[];function a(t,i){return t.tag===e.SEQ&&1===t.elements.length&&(t.tag=t.elements[0].tag,n(t,t.elements[0]),!0)}function s(t,i){return t.tag===e.ALT&&1===t.choices.length&&(t.tag=t.choices[0].tag,n(t,t.choices[0]),!0)}function r(t,n){return t.tag===e.KSTAR&&t.expr.tag===e.EPS&&(t.tag=t.expr.tag,delete t.expr,!0)}function o(t,n){return t.tag===e.KSTAR&&t.expr.tag===e.KSTAR&&(t.expr=t.expr.expr,!0)}function l(t,n){if(t.tag===e.KSTAR&&t.expr.tag===e.ALT)for(var i=0;i<t.expr.choices.length;i++)if(t.expr.choices[i].tag===e.KSTAR)return t.expr.choices[i]=t.expr.choices[i].expr,!0;return!1}function c(t,n){if(t.tag===e.ALT&&t.choices.length>=2){for(var i=-1,a=-1,s=0;s<t.choices.length;s++)t.choices[s].tag===e.EPS?i=s:t.choices[s].tag===e.KSTAR&&(a=s);if(i>=0&&a>=0)return t.choices.splice(i,1),!0}return!1}function u(t,n){if(t.tag===e.KSTAR&&t.expr.tag===e.SEQ&&t.expr.elements.length>0){for(var i=!0,a=0;a<t.expr.elements.length;a++)if(t.expr.elements[a].tag!==e.KSTAR){i=!1;break}if(i)return t.expr.tag=e.ALT,t.expr.choices=t.expr.elements,delete t.expr.elements,!0}return!1}function h(t,n){if(t.tag===e.SEQ&&t.elements.length>=2){for(var i=-1,a=0;a<t.elements.length;a++)t.elements[a].tag===e.EPS&&(i=a);if(i>=0)return t.elements.splice(i,1),!0}return!1}function f(t,n){if(t.tag===e.ALT&&t.choices.length>=2){var i,a=-1;for(i=0;i<t.choices.length;i++)t.choices[i].tag===e.ALT&&(a=i);if(a>=0){var s=t.choices[a];for(t.choices.splice(a,1),i=0;i<s.choices.length;i++)t.choices.splice(a+i,0,s.choices[i]);return!0}}return!1}function p(t,n){if(t.tag===e.SEQ&&t.elements.length>=2){var i,a=-1;for(i=0;i<t.elements.length;i++)if(t.elements[i].tag===e.SEQ){a=i;break}if(a>=0){var s=t.elements[i];for(t.elements.splice(i,1),i=0;i<s.elements.length;i++)t.elements.splice(a+i,0,s.elements[i]);return!0}}return!1}function m(n,i){if(n.tag===e.ALT&&n.choices.length>=2)for(var a=0;a<n.choices.length-1;a++){for(var s=-1,r=a+1;r<n.choices.length;r++)if(t.util.areEquivalent(n.choices[a],n.choices[r])){s=r;break}if(s>=0)return n.choices.splice(s,1),!0}return!1}function d(n,i){if(n.tag===e.ALT&&n.choices.length>=2)for(var a=0;a<n.choices.length-1;a++){for(var s=-1,r=a+1;r<n.choices.length;r++){if(n.choices[r].tag===e.KSTAR&&t.util.areEquivalent(n.choices[r].expr,n.choices[a])){s=a;break}if(n.choices[a].tag===e.KSTAR&&t.util.areEquivalent(n.choices[a].expr,n.choices[r])){s=r;break}}if(s>=0)return n.choices.splice(s,1),!0}return!1}function g(n,i){if(n.tag===e.SEQ&&n.elements.length>=2){for(var a=-1,s=0;s<n.elements.length-1;s++)if(n.elements[s].tag===e.KSTAR&&n.elements[s+1].tag===e.KSTAR&&t.util.areEquivalent(n.elements[s],n.elements[s+1])){a=s;break}if(a>=0)return n.elements.splice(a+1,1),!0}return!1}function v(n,i){if(n.tag===e.KSTAR&&n.expr.tag===e.ALT&&n.expr.choices.length>=2)for(var a=0;a<n.expr.choices.length;a++)for(var s=0;s<n.expr.choices.length;s++)if(a!==s&&n.expr.choices[s].tag===e.SEQ&&n.expr.choices[s].elements.length>=2){for(var r=!0,o=0;o<n.expr.choices[s].elements.length;o++)if(!t.util.areEquivalent(n.expr.choices[a],n.expr.choices[s].elements[o])){r=!1;break}if(r)return n.expr.choices.splice(s,1),!0}return!1}function S(t,n){if(t.tag===e.KSTAR&&t.expr.tag===e.ALT&&t.expr.choices.length>=2)for(var i=0;i<t.expr.choices.length;i++)if(t.expr.choices[i].tag===e.EPS)return t.expr.choices.splice(i,1),!0;return!1}function b(n,i){if(n.tag===e.ALT&&n.choices.length>=2)for(var a=0;a<n.choices.length-1;a++)if(n.choices[a].tag===e.SEQ&&n.choices[a].elements.length>=2)for(var s=a+1;s<n.choices.length;s++)if(n.choices[s].tag===e.SEQ&&n.choices[s].elements.length>=2&&t.util.areEquivalent(n.choices[s].elements[0],n.choices[a].elements[0])){var r=n.choices[a].elements[0],o=P(n.choices[a].elements.slice(1)),l=P(n.choices[s].elements.slice(1)),c=N([o,l]),u=P([r,c]);return n.choices[a]=u,n.choices.splice(s,1),!0}return!1}function y(n,i){if(n.tag===e.SEQ&&n.elements.length>=3)for(var a=1;a<n.elements.length-1;a++)if(n.elements[a-1].tag===e.KSTAR&&n.elements[a+1].tag===e.KSTAR&&t.util.areEquivalent(n.elements[a-1],n.elements[a+1])&&t.util.areEquivalent(n.elements[a-1].expr,n.elements[a]))return n.elements.splice(a-1,1),!0;return!1}function _(n,i){if(n.tag===e.ALT&&n.choices.length>=2)for(var a=0;a<n.choices.length-1;a++)if(n.choices[a].tag===e.SEQ&&n.choices[a].elements.length>=2)for(var s=a+1;s<n.choices.length;s++)if(n.choices[s].tag===e.SEQ&&n.choices[s].elements.length>=2&&t.util.areEquivalent(n.choices[s].elements[n.choices[s].elements.length-1],n.choices[a].elements[n.choices[a].elements.length-1])){var r=n.choices[a].elements[n.choices[a].elements.length-1],o=P(n.choices[a].elements.slice(0,n.choices[a].elements.length-1)),l=P(n.choices[s].elements.slice(0,n.choices[s].elements.length-1)),c=N([o,l]),u=P([c,r]);return n.choices[a]=u,n.choices.splice(s,1),!0}return!1}function w(n,i){if(n.tag===e.ALT&&n.choices.length>=2){var a=[];a.push(T(n.choices[0],i));for(var s=-1,r=0;r<n.choices.length-1;r++)for(var o=r+1;o<n.choices.length;o++){a.length<=o&&a.push(T(n.choices[o],i));try{t.fsm.isSubset(a[r],a[o])&&(s=o)}catch(l){}try{t.fsm.isSubset(a[o],a[r])&&(s=r)}catch(l){}if(s>=0)return n.choices.splice(s,1),!0}}return!1}function x(n,i){if(n.tag===e.KSTAR&&n.expr.tag===e.ALT&&n.expr.choices.length>=2){var a=[];a.push(T(I(n.expr.choices[0]),i));for(var s=-1,r=0;r<n.expr.choices.length-1;r++)for(var o=r+1;o<n.expr.choices.length;o++){a.length<=o&&a.push(T(I(n.expr.choices[o]),i));try{t.fsm.isSubset(a[r],a[o])&&(s=o)}catch(l){}try{t.fsm.isSubset(a[o],a[r])&&(s=r)}catch(l){}if(s>=0)return n.expr.choices.splice(s,1),!0}}return!1}function T(e,n){var i=n.get(e);return i||(i=t.fsm.minimize(t.re.tree.toAutomaton(e)),n.put(e,i)),i}function E(n,i){if(n.tag===e.SEQ&&n.elements.length>=2){var a=[];a.push(T(n.elements[0],i));for(var s=-1,r=0;r<n.elements.length-1;r++)if(a.push(T(n.elements[r+1],i)),n.elements[r].tag===e.KSTAR&&n.elements[r+1].tag===e.KSTAR){try{t.fsm.isSubset(a[r],a[r+1])&&(s=r+1)}catch(o){}try{t.fsm.isSubset(a[r+1],a[r])&&(s=r)}catch(o){}if(s>=0)return n.elements.splice(s,1),!0}}return!1}function A(n,i){if(n.tag===e.ALT&&n.choices.length>1){var a=t.util.index(n.choices,j());if(a>=0)for(var s=0;s<n.choices.length;s++)if(n.choices[s].tag!==e.EPS){var r=T(n.choices[s],i);if(t.fsm.isAcceptingState(r,r.initialState))return n.choices.splice(a,1),!0}}return!1}function k(n,i){if(n.tag===e.SEQ&&n.elements.length>1)for(var a=0;a<n.elements.length-1;a++)if(n.elements[a].tag===e.KSTAR&&n.elements[a+1].tag===e.ALT&&2===n.elements[a+1].choices.length){var s=t.util.index(n.elements[a+1].choices,j());if(s>=0){var r=0===s?n.elements[a+1].choices[1]:n.elements[a+1].choices[0];if(r.tag===e.SEQ&&2===r.elements.length&&r.elements[1].tag===e.KSTAR&&r.elements[1].expr.tag===e.ALT&&2===r.elements[1].expr.choices.length&&t.util.contains(r.elements[1].expr.choices,n.elements[a].expr)&&t.util.contains(r.elements[1].expr.choices,r.elements[0]))return n.elements[a+1]=r.elements[1],n.elements.splice(a,1),!0}}return!1}function R(n,i){if(n.tag===e.SEQ&&n.elements.length>1)for(var a=1;a<n.elements.length;a++)if(n.elements[a].tag===e.KSTAR&&n.elements[a-1].tag===e.ALT&&2===n.elements[a-1].choices.length){var s=t.util.index(n.elements[a-1].choices,j());if(s>=0){var r=0===s?n.elements[a-1].choices[1]:n.elements[a-1].choices[0];if(r.tag===e.SEQ&&2===r.elements.length&&r.elements[0].tag===e.KSTAR&&r.elements[0].expr.tag===e.ALT&&2===r.elements[0].expr.choices.length&&t.util.contains(r.elements[0].expr.choices,n.elements[a].expr)&&t.util.contains(r.elements[0].expr.choices,r.elements[1]))return n.elements[a-1]=r.elements[0],n.elements.splice(a,1),!0}}return!1}function F(n,i){if(n.tag===e.SEQ&&n.elements.length>1)for(var a=0;a<n.elements.length;a++)if(n.elements[a].tag===e.KSTAR)if(a>0&&n.elements[a-1].tag===e.ALT&&n.elements[a-1].choices.length>1){var s=t.util.index(n.elements[a-1].choices,j());if(s>=0){var r=n.elements[a-1].choices.splice(s,1)[0],o=T(n.elements[a],i),l=T(n.elements[a-1],i),c=!1;try{t.fsm.isSubset(o,l)&&(c=!0)}catch(u){}if(c)return n.elements.splice(a-1,1),!0;n.elements[a-1].choices.splice(s,0,r)}}else if(a<n.elements.length-1&&n.elements[a+1].tag===e.ALT&&n.elements[a+1].choices.length>1){s=t.util.index(n.elements[a+1].choices,j());if(s>=0){r=n.elements[a+1].choices.splice(s,1)[0],o=T(n.elements[a],i),l=T(n.elements[a+1],i),c=!1;try{t.fsm.isSubset(o,l)&&(c=!0)}catch(u){}if(c)return n.elements.splice(a+1,1),!0;n.elements[a+1].choices.splice(s,0,r)}}}function L(t,n){if(t.tag===e.SEQ&&t.elements.length>=1)for(var i=0;i<t.elements.length;i++)if(t.elements[i].tag===e.SEQ&&0===t.elements[i].elements.length||t.elements[i].tag===e.ALT&&0===t.elements[i].choices.length)return t.elements=[],!0;return!1}function M(t,n){return t.tag===e.KSTAR&&t.expr.tag===e.SEQ&&0===t.expr.elements.length&&(t.tag=e.SEQ,delete t.expr,t.elements=[],!0)}function O(e,n){var i=t.util.clone(e);"undefined"===typeof n&&(n={});var a=t.util.clone(n);"undefined"===typeof a.numIterations&&(a.numIterations=null),"undefined"===typeof a.appliedPatterns?a.appliedPatterns=null:a.appliedPatterns=n.appliedPatterns,"undefined"===typeof a.useFsmPatterns&&(a.useFsmPatterns=!0);var s="temp",r=0,o=new t.util.HashTable;while(null!==s&&(null===a.numIterations||r<a.numIterations))s=D(i,o,a.useFsmPatterns),null!==s&&null!==a.appliedPatterns&&a.appliedPatterns.push(s),r+=1;return i}function D(t,e,n){for(var a=null,s=null,r=0;r<i.length;r++)if(a=i[r],(!1!==n||"fsm"!==a.type)&&(s=C(t,a["function"],e),s))return a.pattern;return null}function C(t,n,i){var a=n(t,i);if(a)return a;var s=[];t.tag===e.ALT?s=t.choices:t.tag===e.SEQ?s=t.elements:t.tag===e.KSTAR&&(s=[t.expr]);for(var r=0;r<s.length;r++)if(a=C(s[r],n,i),a)return a;return!1}function N(t){return{tag:e.ALT,choices:t}}function P(t){return{tag:e.SEQ,elements:t}}function I(t){return{tag:e.KSTAR,expr:t}}function q(t){return{tag:e.LIT,obj:t}}i.push({pattern:"(a()) => ()",type:"structure",function:L}),i.push({pattern:"()* => ()",type:"structure",function:M}),i.push({pattern:"(a) => a",type:"structure",function:a}),i.push({pattern:"(a) => a",type:"structure",function:s}),i.push({pattern:"$* => $",type:"structure",function:r}),i.push({pattern:"(a*)* => a*",type:"structure",function:o}),i.push({pattern:"(a+b*)* => (a+b)*",type:"structure",function:l}),i.push({pattern:"$+a* => a*",type:"structure",function:c}),i.push({pattern:"(a*b*)* => (a*+b*)*",type:"structure",function:u}),i.push({pattern:"$a => a",type:"structure",function:h}),i.push({pattern:"a+a => a",type:"structure",function:m}),i.push({pattern:"a+a* => a*",type:"structure",function:d}),i.push({pattern:"a*a* => a*",type:"structure",function:g}),i.push({pattern:"(aa+a)* => (a)*",type:"structure",function:v}),i.push({pattern:"(a + $)* => (a)*",type:"structure",function:S}),i.push({pattern:"(ab+ac) => a(b+c)",type:"structure",function:b}),i.push({pattern:"a*aa* => aa*",type:"structure",function:y}),i.push({pattern:"(ab+cb) => (a+c)b",type:"structure",function:_}),i.push({pattern:"a*($+b(a+b)*) => (a+b)*",type:"structure",function:k}),i.push({pattern:"($+(a+b)*a)b* => (a+b)*",type:"structure",function:R}),i.push({pattern:"$+L => L, if L contains $",type:"fsm",function:A}),i.push({pattern:"L1+L2 => L2, if L1 is subset of L2",type:"fsm",function:w}),i.push({pattern:"(L1+L2)* => L2, if L1* is subset of L2*",type:"fsm",function:x}),i.push({pattern:"L1*L2* => L2, if L1* is subset of L2*",type:"fsm",function:E}),i.push({pattern:"(L1+$)(L2)* => (L2)* if L1 is subset of L2",type:"fsm",function:F}),i.push({pattern:"ab(cd) => abcd",type:"structure",function:p}),i.push({pattern:"(a+(b+c)) => a+b+c",type:"structure",function:f});var H={tag:e.EPS};function j(){return H}function K(e,n,i){for(var a=t.fsm.addState(n,i.getAndAdvance()),s=t.fsm.addState(n,i.getAndAdvance()),r=0;r<e.choices.length;r++){var o=$(e.choices[r],n,i);t.fsm.addEpsilonTransition(n,a,[o[0]]),t.fsm.addEpsilonTransition(n,o[1],[s])}return[a,s]}function W(e,n,i){for(var a,s,r,o=0;o<e.elements.length;o++)r=$(e.elements[o],n,i),0===o?a=r[0]:t.fsm.addEpsilonTransition(n,s,[r[0]]),s=r[1];return void 0===a&&(a=t.fsm.addState(n,i.getAndAdvance()),s=t.fsm.addState(n,i.getAndAdvance())),[a,s]}function Z(e,n,i){var a=t.fsm.addState(n,i.getAndAdvance()),s=t.fsm.addState(n,i.getAndAdvance()),r=$(e.expr,n,i),o=r[0],l=r[1];return t.fsm.addEpsilonTransition(n,a,[s]),t.fsm.addEpsilonTransition(n,a,[o]),t.fsm.addEpsilonTransition(n,l,[o]),t.fsm.addEpsilonTransition(n,l,[s]),[a,s]}function U(e,n,i){var a=t.fsm.addState(n,i.getAndAdvance()),s=t.fsm.addState(n,i.getAndAdvance());try{t.fsm.addSymbol(n,e.obj)}catch(r){}return t.fsm.addTransition(n,a,[s],e.obj),[a,s]}function V(e,n,i){var a=t.fsm.addState(n,i.getAndAdvance()),s=t.fsm.addState(n,i.getAndAdvance());return t.fsm.addEpsilonTransition(n,a,[s]),[a,s]}var z={};function $(t,e,n){return z[t.tag](t,e,n)}function Q(e){var n=t.fsm.makeNew(),i=$(e,n,t.util.makeCounter(0));return t.fsm.setInitialState(n,i[0]),t.fsm.addAcceptingState(n,i[1]),n}z[e.ALT]=K,z[e.SEQ]=W,z[e.KSTAR]=Z,z[e.LIT]=U,z[e.EPS]=V;var B={};function G(t,e){return B[t.tag]>=B[e.tag]}function Y(e,n,i){var a=G(e,n);a&&i.push(t.re.array.specials.LEFT_PAREN),st(n,i),a&&i.push(t.re.array.specials.RIGHT_PAREN)}function J(t,e,n,i){for(var a=0;a<n.length;a++)void 0!==i&&a>0&&e.push(i),Y(t,n[a],e)}function X(e,n){J(e,n,e.choices,t.re.array.specials.ALT)}function tt(t,e){J(t,e,t.elements)}function et(e,n){Y(e,e.expr,n),n.push(t.re.array.specials.KSTAR)}function nt(t,e){e.push(t.obj)}function it(e,n){n.push(t.re.array.specials.EPS)}B[e.ALT]=0,B[e.SEQ]=1,B[e.KSTAR]=2,B[e.LIT]=3,B[e.EPS]=3;var at={};function st(t,e){return at[t.tag](t,e)}function rt(t){var e=[];return st(t,e),e}function ot(e){return t.re.array.toString(rt(e))}function lt(t,e,n){var i=.5,a=.1,s=.1;return n&&(n.ALT_PROB&&(i=n.ALT_PROB),n.KLEENE_PROB&&(a=n.KLEENE_PROB),n.EPS_PROB&&(s=n.EPS_PROB)),ct(t,e,i,a,s)}function ct(t,e,n,i,a){var s=ut(t,e,n,i,a);return Math.random()<=i&&(s=I(s)),s}function ut(e,n,i,a,s){if(0===e)return j();if(1==e)return q(n[t.util.randint(0,n.length-1)]);if(Math.random()<=s)return N([j(),ct(e,n,i,a,s)]);var r=t.util.randint(1,e-1),o=ct(r,n,i,a,s),l=ct(e-r,n,i,a,s);return Math.random()<=i?N([o,l]):P([o,l])}return at[e.ALT]=X,at[e.SEQ]=tt,at[e.KSTAR]=et,at[e.LIT]=nt,at[e.EPS]=it,{tags:e,makeAlt:N,makeSeq:P,makeKStar:I,makeLit:q,makeEps:j,toAutomaton:Q,toArray:rt,toString:ot,random:lt,simplify:O}}(),n=function(){var e={ALT:{},KSTAR:{},LEFT_PAREN:{},RIGHT_PAREN:{},EPS:{}};function n(t,e){this.name="RegexError",this.message=t,this.position=e}function i(){return this.arr[this.idx]}function a(){++this.idx}function s(t){return{arr:t,idx:0,peek:i,advance:a}}function r(e){if(0===e.length)return t.re.tree.makeSeq([]);var i=s(e),a=h(i);if(void 0!==i.peek())throw new n("Malformed regex array: successfully parsed up to position "+i.idx,i.idx);return a}function o(t){return t===e.ALT||t===e.KSTAR||t===e.LEFT_PAREN||t===e.RIGHT_PAREN||t===e.EPS?t.toString():void 0}function l(e){for(var n=t.re.string.escapable,i=0;i<n.length;i++)if(e===n[i])return"\\"+e;return e}function c(t){for(var e,i=[],a=!1,s=0;s<t.length;s++){if(e=t[s],"string"===typeof e?1!==e.length?a=!0:e=l(e):(e=o(e),void 0===e&&(a=!0)),a)throw new n("Array regex not convertible to string representation: failed at position "+s,s);i.push(e)}return i.join("")}function u(e){var n=t.re.array.toTree(e);return t.re.tree.toAutomaton(n)}function h(n){var i=[];while(1){if(i.push(f(n)),n.peek()!==e.ALT)break;n.advance()}return t.re.tree.makeAlt(i)}function f(e){var i,a=[];while(1){if(i=p(e),void 0===i)break;a.push(i)}if(0===a.length)throw new n("Malformed regex array: empty choice subexpression at index "+e.idx,e.idx);return t.re.tree.makeSeq(a)}function p(n){var i=m(n);return n.peek()===e.KSTAR&&(n.advance(),i=t.re.tree.makeKStar(i)),i}function m(i){if(i.peek()===e.LEFT_PAREN){i.advance();var a=h(i);if(i.peek()!==e.RIGHT_PAREN)throw new n("Malformed regex array: missing matching right parenthesis at index "+i.idx,i.idx);return i.advance(),a}if(i.peek()===e.EPS)return i.advance(),t.re.tree.makeEps();if(void 0!==i.peek()&&i.peek()!==e.ALT&&i.peek()!==e.RIGHT_PAREN){if(i.peek()===e.KSTAR)throw new n("Malformed regex array: empty subexpression before Kleene star at index "+i.idx,i.idx);var s=t.re.tree.makeLit(i.peek());return i.advance(),s}}function d(e,n,i){return t.re.tree.toArray(t.re.tree.random(e,n,i))}function g(e,n,i){var a=t.re.array.toTree(e),s=t.re.tree.simplify(a,n,i);return t.re.tree.toArray(s)}return e.ALT.toString=function(){return"+"},e.KSTAR.toString=function(){return"*"},e.LEFT_PAREN.toString=function(){return"("},e.RIGHT_PAREN.toString=function(){return")"},e.EPS.toString=function(){return"$"},n.prototype=new Error,{specials:e,toTree:r,toString:c,toAutomaton:u,random:d,simplify:g}}(),i=function(){var e="$+*()\\";function n(n){for(var i,a=[],s=!1,r=t.re.array.specials,o=0;o<n.length;++o)if(s){if(-1===e.indexOf(n[o]))throw new RegexError("Malformed string regex: illegal escape sequence \\"+n[o],o);a.push(n[o]),s=!1}else if("\\"===n[o])s=!0;else{switch(i=n[o],i){case"$":i=r.EPS;break;case"+":i=r.ALT;break;case"*":i=r.KSTAR;break;case"(":i=r.LEFT_PAREN;break;case")":i=r.RIGHT_PAREN;break}a.push(i)}if(s)throw new RegexError("Malformed string regex: unfinished escape sequence at end of string",n.length-1);return a}function i(e){var n=t.re.string.toArray(e);return t.re.array.toTree(n)}function a(e){var n=t.re.string.toTree(e);return t.re.tree.toAutomaton(n)}function s(e,n,i){for(var a=[],s=0;s<n.length;s++)a.push(n.charAt(s));return t.re.tree.toString(t.re.tree.random(e,a,i))}function r(e,n,i){var a=t.re.string.toTree(e),s=t.re.tree.simplify(a,n,i);return t.re.tree.toString(s)}return{escapable:e,toArray:n,toTree:i,toAutomaton:a,random:s,simplify:r}}();return{tree:e,array:n,string:i}}(),t}())}},e={};function n(i){var a=e[i];if(void 0!==a)return a.exports;var s=e[i]={exports:{}};return t[i].call(s.exports,s,s.exports,n),s.exports}n.m=t,function(){var t=[];n.O=function(e,i,a,s){if(!i){var r=1/0;for(u=0;u<t.length;u++){i=t[u][0],a=t[u][1],s=t[u][2];for(var o=!0,l=0;l<i.length;l++)(!1&s||r>=s)&&Object.keys(n.O).every((function(t){return n.O[t](i[l])}))?i.splice(l--,1):(o=!1,s<r&&(r=s));if(o){t.splice(u--,1);var c=a();void 0!==c&&(e=c)}}return e}s=s||0;for(var u=t.length;u>0&&t[u-1][2]>s;u--)t[u]=t[u-1];t[u]=[i,a,s]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){var t,e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__};n.t=function(i,a){if(1&a&&(i=this(i)),8&a)return i;if("object"===typeof i&&i){if(4&a&&i.__esModule)return i;if(16&a&&"function"===typeof i.then)return i}var s=Object.create(null);n.r(s);var r={};t=t||[null,e({}),e([]),e(e)];for(var o=2&a&&i;"object"==typeof o&&!~t.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach((function(t){r[t]=function(){return i[t]}}));return r["default"]=function(){return i},n.d(s,r),s}}(),function(){n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){n.f={},n.e=function(t){return Promise.all(Object.keys(n.f).reduce((function(e,i){return n.f[i](t,e),e}),[]))}}(),function(){n.u=function(t){return"js/webfontloader.02ff9497.js"}}(),function(){n.miniCssF=function(t){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="dfa-regex:";n.l=function(i,a,s,r){if(t[i])t[i].push(a);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==e+s){o=h;break}}o||(l=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",e+s),o.src=i),t[i]=[a];var f=function(e,n){o.onerror=o.onload=null,clearTimeout(p);var a=t[i];if(delete t[i],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((function(t){return t(n)})),e)return e(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=f.bind(null,o.onerror),o.onload=f.bind(null,o.onload),l&&document.head.appendChild(o)}}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.p=""}(),function(){var t={143:0};n.f.j=function(e,i){var a=n.o(t,e)?t[e]:void 0;if(0!==a)if(a)i.push(a[2]);else{var s=new Promise((function(n,i){a=t[e]=[n,i]}));i.push(a[2]=s);var r=n.p+n.u(e),o=new Error,l=function(i){if(n.o(t,e)&&(a=t[e],0!==a&&(t[e]=void 0),a)){var s=i&&("load"===i.type?"missing":i.type),r=i&&i.target&&i.target.src;o.message="Loading chunk "+e+" failed.\n("+s+": "+r+")",o.name="ChunkLoadError",o.type=s,o.request=r,a[1](o)}};n.l(r,l,"chunk-"+e,e)}},n.O.j=function(e){return 0===t[e]};var e=function(e,i){var a,s,r=i[0],o=i[1],l=i[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(l)var u=l(n)}for(e&&e(i);c<r.length;c++)s=r[c],n.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return n.O(u)},i=self["webpackChunkdfa_regex"]=self["webpackChunkdfa_regex"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var a=n.O(void 0,[998],(function(){return n(9914)}));a=n.O(a)})();
//# sourceMappingURL=app.0dd7337c.js.map