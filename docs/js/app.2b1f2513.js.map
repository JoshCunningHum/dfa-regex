{"version":3,"file":"js/app.2b1f2513.js","mappings":"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","sources":["webpack://dfa-regex/./node_modules/cli-table/node_modules/colors/lib/ sync","webpack://dfa-regex/./src/App.vue","webpack://dfa-regex/./src/commons/input/InputProcessorEvent.js","webpack://dfa-regex/./src/commons/input/InputProcessor.js","webpack://dfa-regex/./src/commons/Util.js","webpack://dfa-regex/./src/commons/graph/State.js","webpack://dfa-regex/./src/stores/forceStore.js","webpack://dfa-regex/./src/stores/stateStore.js","webpack://dfa-regex/./src/commons/Local.js","webpack://dfa-regex/./src/stores/fileStore.js","webpack://dfa-regex/./src/stores/settingsStore.js","webpack://dfa-regex/./src/commons/graph/Transition.js","webpack://dfa-regex/./src/stores/transitionStore.js","webpack://dfa-regex/./src/stores/alphabetStore.js","webpack://dfa-regex/./src/commons/canvas/Drawables.js","webpack://dfa-regex/./src/stores/mouseStore.js","webpack://dfa-regex/./src/stores/modeStore.js","webpack://dfa-regex/./src/commons/canvas/CanvasInit.js","webpack://dfa-regex/./src/commons/graph/Converter.js","webpack://dfa-regex/./src/stores/mainStore.js","webpack://dfa-regex/./src/components/FSMVisualizer.vue","webpack://dfa-regex/./src/components/FSMVisualizer.vue?05df","webpack://dfa-regex/./src/components/AlphabetLister.vue","webpack://dfa-regex/./src/components/AlphabetLister.vue?6bc6","webpack://dfa-regex/./src/components/TransitionFab.vue","webpack://dfa-regex/./src/components/TransitionFab.vue?3a33","webpack://dfa-regex/./src/components/StateHelper.vue","webpack://dfa-regex/./src/components/StateHelper.vue?1035","webpack://dfa-regex/./src/components/SettingsMenu.vue","webpack://dfa-regex/./src/components/SettingsMenu.vue?6704","webpack://dfa-regex/./src/components/SaveFile.vue","webpack://dfa-regex/./src/components/SaveFile.vue?ad0d","webpack://dfa-regex/./src/App.vue?7ccd","webpack://dfa-regex/./src/plugins/vuetify.js","webpack://dfa-regex/./src/plugins/webfontloader.js","webpack://dfa-regex/./src/main.js","webpack://dfa-regex/./src/plugins/noam.js","webpack://dfa-regex/webpack/bootstrap","webpack://dfa-regex/webpack/runtime/chunk loaded","webpack://dfa-regex/webpack/runtime/compat get default export","webpack://dfa-regex/webpack/runtime/create fake namespace object","webpack://dfa-regex/webpack/runtime/define property getters","webpack://dfa-regex/webpack/runtime/ensure chunk","webpack://dfa-regex/webpack/runtime/get javascript chunk filename","webpack://dfa-regex/webpack/runtime/get mini-css chunk filename","webpack://dfa-regex/webpack/runtime/global","webpack://dfa-regex/webpack/runtime/hasOwnProperty shorthand","webpack://dfa-regex/webpack/runtime/load script","webpack://dfa-regex/webpack/runtime/make namespace object","webpack://dfa-regex/webpack/runtime/publicPath","webpack://dfa-regex/webpack/runtime/jsonp chunk loading","webpack://dfa-regex/webpack/startup"],"sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 1585;\nmodule.exports = webpackEmptyContext;","<template>\n  <v-app>\n    <v-main class=\"flex h-screen w-screen min-h-0\">\n        <!-- Options / Settings -->\n        <v-sheet width=\"400px\" class=\"p-3 flex flex-col gap-2 overflow-auto\">\n\n          <!-- Alphabet -->\n          <AlphabetLister />\n\n          <v-divider></v-divider>\n\n          <!-- Node Selector -->\n          <StateHelper />\n\n        </v-sheet>\n\n        <!-- DFA Visualizer -->\n        <v-sheet class=\"flex-grow bg-neutral-900 flex flex-col\">\n\n          <div class=\"flex flex-grow\">\n            <!-- Controls -->\n            <v-sheet height=\"100%\" width=\"50px\" color=\"#252525\" elevation=\"3\" class=\"flex flex-col gap-2 p-2 justify-between\" id=\"toolbar\">\n\n              <div class=\"flex flex-col gap-2\">\n                \n                <v-btn-toggle v-model=\"m\" class=\"flex-col gap-2 items-center w-full h-auto\" mandatory rounded=\"0\">\n\n                  <v-btn v-for=\"t in tools\" :key=\"t.name\" :value=\"t.name\">\n                    {{ t.text }}\n                    <v-tooltip\n                      activator=\"parent\"\n                      class=\"p-0\"\n                      contentClass=\"hotkey-tooltip\"\n                      >\n                      <span class=\"capitalize\">{{t.name}}</span> Mode [{{ t.hotkey }}]\n                    </v-tooltip>\n                  </v-btn>\n\n                </v-btn-toggle>\n\n              </div>\n\n              <div class=\"flex-col gap-2\">\n                <!-- Delete All -->\n                <div class=\"pt-1\">\n                  <v-btn @click=\"mainStore.deleteAll()\"> 🗑️ \n                    <v-tooltip\n                      activator=\"parent\"\n                      class=\"p-0\"\n                      content-class=\"hotkey-tooltip\">\n                        <span class=\"capitalize\">Delete All</span>\n                    </v-tooltip>\n                  </v-btn>\n                </div>\n\n                <!-- Import/Export -->\n                <div class=\"pt-1\">\n                <div class=\"pt-1\">\n                  <input type=\"file\" class=\"sr-only\" ref=\"fileinput\" @change=\"loadJSON\" >\n                  <v-btn\n                    @click=\"fileinput.click()\">\n                    <v-icon size=\"large\">mdi-import</v-icon>\n                    <v-tooltip\n                      activator=\"parent\"\n                      class=\"p-0\"\n                      content-class=\"hotkey-tooltip\">\n                        <span class=\"capitalize\">Import</span>\n                    </v-tooltip>\n                  </v-btn>\n                </div>\n                  <v-btn>\n                    <v-icon >mdi-export</v-icon>\n                    <v-tooltip\n                      activator=\"parent\"\n                      class=\"p-0\"\n                      content-class=\"hotkey-tooltip\">\n                        <span class=\"capitalize\">Export</span>\n                    </v-tooltip>\n                    <v-dialog\n                      activator=\"parent\">\n\n                        <SaveFile />\n\n                    </v-dialog>\n                  </v-btn>\n                </div>\n              </div>\n            </v-sheet>\n\n            <FSMVisualizer class=\"flex-grow\" />\n\n          </div>\n\n          <v-sheet class=\"flex items-center\" color=\"#2A2A2A\">\n\n            <v-text-field v-model=\"regex\" label=\"Regex\" hideDetails rounded=\"0\" variant=\"solo-filled\" @keydown.enter=\"e => mainStore.genDFA(e.target.value)\"/>\n\n          </v-sheet>\n        </v-sheet>\n\n        <div class=\"absolute right-0 p-4\">\n          <SettingsMenu />\n        </div>\n\n    </v-main>\n  </v-app>\n  <!-- Dialog -->\n  <TransitionFab />\n</template>\n\n<script>\n\nimport { computed, ref } from 'vue';\nimport { watch } from 'vue';\nimport { reactive } from 'vue';\nimport { onMounted } from 'vue';\n\n// Stores\nimport { useMainStore } from './stores/mainStore';\nimport { useModeStore } from './stores/modeStore';\nimport { useAlphabetStore } from './stores/alphabetStore';\nimport { useTransitionStore } from './stores/transitionStore';\nimport { useStateStore } from './stores/stateStore';\nimport { useFileStore } from './stores/fileStore';\nimport { useSettingStore } from './stores/settingsStore';\n\n// Components\nimport FSMVisualizer from './components/FSMVisualizer.vue';\nimport AlphabetLister from './components/AlphabetLister.vue';\nimport TransitionFab from './components/TransitionFab.vue';\nimport StateHelper from './components/StateHelper.vue';\nimport SettingsMenu from './components/SettingsMenu.vue';\nimport SaveFile from './components/SaveFile.vue';\nimport noam from './plugins/noam';\n\nexport default {\n  name: 'App',\n  components: {\n    FSMVisualizer,\n    AlphabetLister,\n    TransitionFab,\n    StateHelper,\n    SettingsMenu,\n    SaveFile\n  },\n  setup() {\n\n    // Initialize Store Modules\n    const mainStore = useMainStore(),\n      modeStore = useModeStore(),\n      alphabetStore = useAlphabetStore(),\n      transitionStore = useTransitionStore(),\n      stateStore = useStateStore(),\n      settingsStore = useSettingStore(),\n      fileStore = useFileStore();\n\n    const tools = reactive([\n      {\n        name: 'default',\n        text: '➕',\n        hotkey: 'V',\n      },\n      {\n        name: 'linking',\n        text: '🔗',\n        hotkey: 'C',\n      },\n      {\n        name: 'delete',\n        text: '❌',\n        hotkey: 'D',\n      }\n    ]);\n\n    const fileinput = ref(null);\n    const regex = ref('');\n    const regexResult = computed(() => mainStore.regexResult);\n\n      watch(regexResult, v => {\n        if(v === '') return;\n\n        regex.value = regexResult.value;\n      })\n\n    const m = computed({\n      get: () => modeStore.mode,\n      set: v => modeStore.mode = v\n    });\n\n    const loadJSON = async () => {\n      const file = fileinput.value.files.length === 0 ? null : await fileinput.value.files[0].text();\n\n      if(file === null) return;\n      \n      fileStore.loadDFA(JSON.parse(file));\n    }\n    \n    // onMounted(() => {\n    //   const epsilon = 'ε';\n\n    //   noam.fsm.epsilonSymbol = epsilon;\n    //   noam.grammar.epsilonSymbol = epsilon;\n    // })\n\n    // Load settings on local storage\n    settingsStore.sync();\n\n    return {\n      mainStore,\n      m,\n      tools,\n      regex,\n      fileinput,\n      loadJSON\n    }\n  },\n}\n</script>\n\n<style lang=\"scss\">\n* {\n  box-sizing: border-box;\n}\n\nhtml,\nbody {\n  overflow-y: auto;\n}\n\nhtml {\n  overflow-y: hidden !important;\n}\n\n.v-btn.smolbtn {\n  padding-left: 0;\n  padding-right: 0;\n  min-width: 0;\n}\n\n#toolbar {\n  button {\n    @apply p-2 rounded;\n\n    min-width: 0;\n\n  }\n}\n\n.hotkey-tooltip {\n  padding: 2px 10px !important;\n  border-radius: 2px !important;\n  background: #252525 !important;\n  color: #aaa !important;\n}\n</style>\n","// eslint-disable-next-line no-unused-vars\nimport { InputProcessor, MouseInputModule } from \"./InputProcessor\";\n\n/**\n * @typedef Coordinate\n * @property {Number} x\n * @property {Number} y\n */\n\nclass InputProcessorKeyboardEvent{\n    /**\n     * Contains the key along with active modifiers. Ex: SHIFT+A, CTRL+SHIFT+C.\n     * \n     * Modifers follow alphabetical order. Although this is not needed when adding listeners to the input processor.\n     * \n     * CTRL and CONTROL are the same when adding a listener, however, ipkey will use CONTROL.\n     */\n    _ipkey = \"\";\n    /**\n     * @type {InputProcessor}\n     */\n    ip;\n    /**@type {InputProcessorMouseEvent} */\n    mouse;\n\n    get ipkey(){\n        return this._ipkey.replace(InputProcessor.seperator, '+');\n    }\n\n    set ipkey(value){\n        this._ipkey = value; \n    }\n\n    /**\n     * List of currently active keys (key with states true)\n     */\n    get activeKeys(){\n        return this.ip.states.filter(v => v[1]).map(v => v[0])\n    }\n\n    get ipkeySet(){\n        return new Set([\n            this.altKey ? \"ALT\" : null,\n            this.ctrlKey ? \"CONTROL\" : null,\n            this.shiftKey ? \"SHIFT\" : null,\n            this._ipkey.split(InputProcessor.splitter).at(-1)\n        ].filter(v => v !== null))\n    }\n\n    // Native KeyboardEvent Properties\n    // I can't extend this to a keyboard event since there's no such thing. However, there is a KeyboardEventInit but that requires native data straight from the browser (can't imitate that data)\n    key = \"\";\n    code = \"\";\n    location = \"\";\n    repeat = false;\n    isComposing = false;\n\n    altKey = false;\n    ctrlKey = false;\n    shiftKey = false;\n    getModifierState = \"\";\n\n    /**\n     *  \n     * @param {KeyboardEvent} ev \n     * @param {String} ipkey Input Processor Key\n     * @param {InputProcessor} ip\n     */\n    constructor(ev, ipkey, ip){\n        Object.assign(this, ev);\n        this.getModifierState = ev.getModifierState;\n        this._ipkey = ipkey;\n        this.ip = ip;\n        this.mouse = new InputProcessorMouseEvent(ip.cursor);\n    }\n}\n\n\nclass InputProcessorMouseEvent{\n    /**@type {Coordinate} */\n    client = {};\n    /**@type {Coordinate} */\n    screen = {};\n    /**@type {Coordinate} */\n    lastClick = {};\n    /**@type {Coordinate} */\n    dragDiff = {};\n\n    isDragging = false;\n\n    /**\n     * \n     * @param {MouseInputModule} ip \n     */\n    constructor(ip){\n        this.client = structuredClone(ip.client);\n        this.screen = structuredClone(ip.screen);\n        this.lastClick = structuredClone(ip.lastClick);\n\n        this.isDragging = ip.isDragging;\n\n        if(!ip.isDragging) return;\n        \n        this.dragDiff.x = ip.client.x - ip.lastClick.x;\n        this.dragDiff.y = ip.client.y - ip.lastClick.y;\n\n    }\n}\n\nexport {\n    InputProcessorKeyboardEvent,\n    InputProcessorMouseEvent\n}","import { InputProcessorKeyboardEvent, InputProcessorMouseEvent } from \"./InputProcessorEvent\";\n\n//#region baseclass\nclass EventEmitter{\n\n    constructor(){\n        /**\n         * @protected\n         */\n        this.__evs__ = {};\n        this.__any__ = [];\n    }\n    \n    has(event){\n        return this.__evs__[event] !== undefined;\n    }\n    \n    on(event, cb){\n        this.__evs__[event] = this.__evs__[event] || [];\n        this.__evs__[event].push(cb);\n    }\n\n    onAny(cb){\n        this.__any__.push(cb);\n    }\n\n    off(event, cb){\n        if(!this.has(event)) return;\n        // Added a check where even if two functions don't belong to the same part in the memory, as long as they do the same thing, they will be removed\n        const i = this.__evs__[event].findIndex(ev => ev === cb || ev.toString() === cb.toString());\n        if(i === -1) return;\n        this.__evs__[event].splice(i, 1);\n    }\n\n    emit(event, ...args){\n        this.__any__.forEach(ev => ev(event, ...args));\n        if(!this.has(event)) return;\n        this.__evs__[event].forEach(ev => ev(...args));\n    }\n\n    renameEvent(oldEvent, newEvent){\n        if(!this.has(oldEvent)) return;\n        if(newEvent === oldEvent) return;\n        this.oldEvent = this.newEvent;\n        delete this.oldEvent;\n    }\n}\n//#endregion\n\n\n/**\n * @callback InputProcessorEventCallback\n * @param {(InputProcessorKeyboardEvent | InputProcessorMouseEvent)} ev\n */\n\n/**\n * @typedef {Ojbect} BuildInFunctionFormat\n * @property {String} event\n * @property {Function} fn\n */\n\n/**\n * @typedef KeyboardEventType\n * @property {string} keydown\n * @property {string} keyup\n */\n\n/**\n * @typedef MouseEventType\n * @property {string} mousemove\n * @property {string} click\n * @property {string} auxclick\n * @property {string} dblclick\n * @property {string} contextmenu\n * @property {string} mousedown\n * @property {string} mouseup\n * @property {string} mouseenter\n * @property {string} mouseover\n * @property {string} mouseleave\n * @property {string} mouseout\n * @property {string} drag\n * @property {string} dragstart\n * @property {string} dragend\n */\n\nclass InputProcessorConfig {\n    /**\n     * @type {HTMLElement}\n     */\n    monitor;\n    /**Determines wether capture KeyEvents is enabled. */\n    captureKey = true;\n    /**Determines wether the MouseInputModule is used */\n    captureMouse = false;\n    \n    // Future Options --- Not yet implemented\n    string; // prevent defaults and other stuff\n}\n\nclass InputProcessor extends EventEmitter{\n    \n    /**\n     * Recognizes keycodes to be used as property in instances. Used in tandem with check().\n     * \n     * Can also accept basic keys to be converted into property in instances of this class. (e.g. a -> KEY_A, + -> NUM_ADD)\n     * \n     * @param {String} key the key property of a KeyBoard Event\n     * @param {String} code the code property of a KeyBoard Event\n     * @returns {String} the appropriate property of this InputProcessor instance\n     */\n    static recognize(key, code){\n        const capKey = key.toUpperCase();\n\n        // If this came from an HTML Keyboard Event\n        if(code){\n            // If an alphabet key\n            if(code.match((/key(?!_)/igm))) return code.replace(/key/igm, \"KEY_\");\n            // If a numpad key\n            if(code.match(/numpad(?!_)/igm)) return code.replace(/numpad/igm, \"NUM_\");\n            // if a digit key\n            if(code.match(/digit(?!_)/igm)) return code.replace(/digit/igm, \"DIG_\");\n        }\n\n\n        // TODO: Create a more concise processing of exceptions\n        // Sing Characters, usually uses outside the KeyBoard Event\n        if(capKey.length === 1){\n            const charCode = capKey.charCodeAt(0);\n            if(65 <= charCode && 90 >= charCode) return `KEY_${capKey}`;\n            if(48 <= charCode && 57 >= charCode) return `NUM_${capKey}`;\n            switch(capKey){\n                case '+':\n                    return \"NUM_ADD\";\n                case '-':\n                    return 'NUM_SUB';\n                case '*':\n                    return 'NUM_MUL';\n                case '/':\n                    return 'SLASH_FORWARD';\n                case '\\\\':\n                    return 'SLASH_BACKWARD';\n                case ' ':\n                    return 'SPACE';\n            }\n        }\n        \n        return capKey;\n    }\n\n    /**\n     * Serializes combinational keys (if ever it has modifier keys) for a more consistent event type on emitting and listening events.\n     * @param {String[] | String} keys \n     */\n    static serialize(keys){\n        if(!Array.isArray(keys) && typeof keys === 'string'){\n            // Split by the plus sign, if there's a two consecutive plus signs, only split the first occurent (results from CTRL and '+' making CTRL++)\n            keys = this.split(keys);\n        }\n        keys.sort(); // Sort before anything else\n\n        // Find any Non-Modifier Key (if any) and put it on the last\n        const nonModifierIndex = keys.findIndex(k => !this.MODIFIERS.includes(k));\n        if(nonModifierIndex !== -1) keys.push(keys.splice(nonModifierIndex, 1)[0]); \n        \n        return keys.map(k => this.recognize(k, '')).join(this.seperator);\n    }\n\n    static get MODIFIERS(){\n        return [\"ALT\", \"CONTROL\", \"SHIFT\"];\n    }\n\n    static seperator = '§';\n    static splitter = /\\+(?<=[^+].)/igm;\n\n    static split(keys){\n        return keys.split(this.splitter).join(this.seperator).split(this.seperator);\n    }\n    \n    //#region --- KEY STATES ---\n    \n    // Directional keys\n    ARROW_UP = false;\n    ARROW_DOWN = false;\n    ARROW_LEFT = false;\n    ARROW_RIGHT = false;\n\n    // Alphabet Keys: --- Initialized in the constructor\n    // Numpad Keys: --- Initialized in the constructor\n    // Digital Keys: --- Initialized in the constructor\n\n    // Modifier Keys\n    CONTROL = false;\n    SHIFT = false;\n    ALT = false;\n\n    // Miscellaneous Keys\n    SPACE = false;\n    TAB = false;\n    \n    //#endregion\n\n    //#region --- MOUSE STATES ---\n\n    cursor = new MouseInputModule(this);\n    \n    //#endregion\n\n    /**\n     * \n     * @param {HTMLElement} element the element to monitor inputs\n     * @param {InputProcessorConfig} config\n     */\n    constructor(element, config){\n        super();\n\n        // Set Alphabet keys\n        for(let c = 0; c < 26; c++){\n            this[`KEY_${String.fromCharCode(65 + c)}`] = false;\n        }\n        // Set Digital and Numpad Keys\n        for(let n = 0; n < 10; n++){\n            this[`NUM_${n}`] = false; // Numpad (Right Side of Keyboard)\n            this[`DIG_${n}`] = false; // Digital (Above the alphabet keys)\n        }\n\n        this.config = config || new InputProcessorConfig();\n\n        if(element) this.monitor = element;\n    }\n\n    /**\n     * @type {InputProcessorConfig}\n     */\n    config;\n\n    get monitor(){\n        return this.config.monitor;\n    }\n\n    set monitor(el){\n        // Remove listeners from the previous monitored element\n        if(this.monitor){\n            this.__built_listeners__.forEach(bl => this.monitor.removeEventListener(bl.event, bl.fn));\n        }\n            \n        if(el === undefined || el === null){\n            console.warn(`Element set to monitor is undefined`);\n            return;\n        }else if(this.config.captureMouse) this.cursor.monitor = el;\n        if(el.tagName === 'CANVAS') el.tabIndex = 1;\n\n        if(this.config.captureKey) this.__built_listeners__.forEach(bl => el.addEventListener(bl.event, bl.fn.bind(this)));\n        this.config.monitor = el;\n    }\n\n    /**\n     * @type {BuildInFunctionFormat[]}\n     */\n    get __built_listeners__(){\n        return [\n            this.__onKeyDown, \n            this.__onKeyUp,\n            this.__onFocusOut\n        ].map(fn => {\n            return {\n                // Formats the name to something that can be applied on html events\n                event: fn.name.replace('__on', '').toLowerCase(),\n                fn: fn\n            } \n        })\n    }\n\n    /**\n     * TODO: Make this more secure. Prepare a comprehensive list of actual keyboard and mouse codes\n     * @type {Array<[String, Boolean]>}\n     */\n    get states(){\n        return Object.entries(this).filter(v => typeof v[1] === 'boolean');\n    }\n\n\n    check(key){\n        if(key === '+') key = [key];\n        const keys = Array.isArray(key) ? key : typeof key === 'string' ? InputProcessor.split(key) : key;\n        return keys.every(k => this[InputProcessor.recognize(k, \"\")]);\n    }\n\n    /**\n     * \n     * @param {String[]} keys Key properties in clockwise order (e.g. up, right, down, left)\n     * @returns \n     */\n    direction(keys = ['ARROW_UP', 'ARROW_RIGHT', 'ARROW_DOWN', 'ARROW_LEFT']){\n        if(keys.length !== 4) throw new Error(`Directional Key Array length must be exactly 4`);\n\n        const u = this.check(keys[0]),\n              d = this.check(keys[2]),\n              l = this.check(keys[3]),\n              r = this.check(keys[1]);\n\n        const x = !l && !r ? 0 : !l && r ? 1 : -1,\n              y = !u && !d ? 0 : !u && d ? 1 : -1;\n\n        return [x, y];\n    }\n\n    reset(){\n        // Make all boolean true property false\n        Object.entries(([k, v]) => {\n            if(v === true) this[k] = false;\n        });\n    }\n\n    focus(){\n        this.monitor.focus();\n    }\n\n    /**\n     * Override the on and off event for any combinational hotkeys\n     * @param {(keyof KeyboardEventType | keyof MouseEventType | Array)} event A key or key combination. Put a '+' for added modifiers, order does not matter. e.g. SHIFT+CTRL+C is equal to CTRL+SHIFT+C. CTRL and CONTROL are the same however, the InputProcessorEvent uses CONTROL.\n     * @param {InputProcessorEventCallback} cb \n     * @param {Boolean} release Set to true if the callback is only invoked when releasing the said key\n     */\n    on(event, cb, release = false){\n        if(event === '') return;\n        switch(event){\n            case 'keydown':\n            case 'keyup':\n                break;\n            // Mouse events starts here\n            case 'mousemove':\n            case 'click': \n            case 'auxclick':\n            case 'dblclick':\n            case 'contextmenu':\n            case 'mousedown':\n            case 'mouseup':\n            case 'mouseenter':\n            case 'mouseover':\n            case 'mouseleave':\n            case 'mouseout':\n            case 'dragstart':\n            case 'dragend':\n            case 'drag':\n                break;\n            default:\n                event = event.replace('CTRL', 'CONTROL');\n                event = InputProcessor.serialize(event);\n        }\n        // Modify event to properly recognize if its a release event\n        if(release) event = `UP:${event}`;\n        super.on(event, cb);\n    }\n\n    /**\n     * Override the on and off event for any combinational hotkeys\n     * @param {(keyof KeyboardEventType | keyof MouseEventType | Array)} event A key or key combination\n     * @param {InputProcessorEventCallback} cb \n     * @param {Boolean} release Set to true if the callback is only invoked when releasing the said key\n     */\n    off(event, cb, release = false){\n        if(event === '') return;\n        switch(event){\n            case 'keydown':\n            case 'keyup':\n                break;\n            // Mouse events starts here\n            case 'mousemove':\n            case 'click': \n            case 'auxclick':\n            case 'dblclick':\n            case 'contextmenu':\n            case 'mousedown':\n            case 'mouseup':\n            case 'mouseenter':\n            case 'mouseover':\n            case 'mouseleave':\n            case 'mouseout':\n            case 'dragstart':\n            case 'dragend':\n            case 'drag':\n                break;\n            default:\n                event = event.replace('CTRL', 'CONTROL');\n                event = InputProcessor.serialize(event);\n        }\n        // Modify event to properly recognize if its a release event\n        if(release) event = `UP:${event}`;\n        super.off(event, cb);\n    }\n\n    /**\n     * @private\n     * @param {KeyboardEvent} e \n     * @returns \n     */\n    _processKeyBoardEvent(e){\n\n        const key = e.key.replace(/ARROW/gi, \"ARROW_\");\n\n        // Modifier Key States\n        this.ALT = e.altKey;\n        this.CONTROL = e.ctrlKey;\n        this.SHIFT = e.shiftKey;\n        \n        const keyprop = InputProcessor.recognize(key, e.code);\n        const active_keys = [key.toUpperCase()];\n        if(this.ALT && keyprop !== 'ALT') active_keys.unshift('ALT');\n        if(this.CONTROL && keyprop !== 'CONTROL') active_keys.unshift('CONTROL');\n        if(this.SHIFT && keyprop !== 'SHIFT') active_keys.unshift('SHIFT');\n\n        // Modified KeyboardEvent\n        const combined = InputProcessor.serialize(active_keys);\n        const ipev = new InputProcessorKeyboardEvent(e, combined, this);\n\n        return {\n            keyprop,\n            combined,\n            ipev,\n        }\n    }\n\n    //#region --- PreBuilt Listeners ---\n\n    /**\n     * \n     * @param {KeyboardEvent} e \n     */\n    __onKeyDown(e){\n        e.preventDefault();\n\n        const {keyprop, combined, ipev} = this._processKeyBoardEvent(e);\n        this[keyprop] = true;\n\n        // Emit Hotkey listeners (If not on repeat)\n        if(!e.repeat) this.emit(combined, ipev);\n        // Emit Also the simple/not-combined listener\n        if(!e.repeat && combined !== keyprop) this.emit(keyprop, ipev);\n        // Emit basic onkeydown (if any)\n        this.emit(`keydown`, ipev);\n    }\n\n    /**\n     * \n     * @param {KeyboardEvent} e \n     */\n    __onKeyUp(e){\n        e.preventDefault();\n        \n        const {keyprop, combined, ipev} = this._processKeyBoardEvent(e);\n        this[keyprop] = false;\n\n        // Emit hotkey listeners for release type\n        this.emit(`UP:${combined}`, ipev);\n        // Emit Also the simple/not-combined listener\n        if(combined !== keyprop) this.emit(`UP:${keyprop}`, ipev);\n        // Emit basic onkeyup (if any)\n        this.emit(`keyup`, ipev);\n\n    }\n    __onFocusOut(){\n        // Emit all keyup emitters if a key state is true\n        Object.entries(([k, v]) => {\n            if(typeof this[k] === \"boolean\" && v){\n                this.emit(`UP:${k}`);\n            }\n        })\n    }\n\n    //#endregion\n}\n\nclass Coordinate{\n    /**\n     * @type {Number}\n     */\n    x;\n    /**\n     * @type {Number}\n     */\n    y;\n\n    constructor(x, y){\n        this.x = x;\n        this.y = y;\n    }\n\n    /**\n     * \n     * @param {Coordinate} coord \n     * @returns {Coordinate}\n     */\n    difference(coord){\n        return new Coordinate(\n            this.x - coord.x,\n            this.y - coord.y\n        )\n    }\n\n    sum(coord){\n        return new Coordinate(\n            this.x + coord.x,\n            this.y + coord.y\n        )\n    }\n\n    /**@type {Coordinate} */\n    get clone(){\n        return new Coordinate(this.x, this.y);\n    }\n\n    /**\n     * Returns the array form of the coordinate\n     * @type {Number[]}\n     */\n    get arr(){\n        return [this.x, this.y];\n    }\n}\n\nclass MouseInputModule{\n    client = new Coordinate(0, 0);\n    screen = new Coordinate(0, 0);\n    /**\n     * The coordinate when the dragging starts. Can be used to determine the change of coordinate from the first drag starts and to the current.\n     * @type {Coordinate}\n     */\n    lastClick;\n\n    /**\n     * @type {HTMLElement}\n     */\n    _monitor;\n\n    isDragging = false;\n\n    get monitor(){\n        return this._monitor;\n    }\n\n    set monitor(el){\n        if(this.monitor){\n            this.__built_listeners__.forEach(bl => this.monitor.removeEventListener(bl.event, bl.fn));\n        }\n            \n        this.__built_listeners__.forEach(bl => el.addEventListener(bl.event, bl.fn.bind(this)));\n        this._monitor = el;\n    }\n\n    get __built_listeners__(){\n        return [\n            this.__onClick,\n            this.__onAuxClick,\n            this.__onDblClick,\n            this.__onContextMenu,\n            this.__onMouseDown,\n            this.__onMouseUp,\n            this.__onMouseEnter,\n            this.__onMouseOver,\n            this.__onMouseLeave,\n            this.__onMouseOut,\n            this.__onMouseMove,\n            this.__onFocusOut\n        ].map(fn => {\n            return {\n                event: fn.name.replace('__on', '').toLowerCase(),\n                fn: fn\n            }\n        })\n    }\n\n    /**\n     * @type {InputProcessor}\n     */\n    _ip;\n\n    /**\n     * \n     * @param {InputProcessor} processor \n     */\n    constructor(processor){\n        this._ip = processor;\n    }\n\n    /**\n     * \n     * @param {keyof MouseEventType} event \n     * @param  {...any} args \n     */\n    emit(event, ...args){\n        this._ip.emit(event, ...args);\n    }\n\n    /**@param {MouseEvent} e*/\n    __processMouseEvent__(e){\n        const rect = this.monitor.getBoundingClientRect();\n\n        this.screen.x = e.screenX;\n        this.screen.y = e.screenY;\n        this.client.x = e.clientX - rect.left;\n        this.client.y = e.clientY - rect.top;\n\n        if(e.type === 'mousedown') this.lastClick = this.client.clone;\n\n        const ipmouse = new InputProcessorMouseEvent(this);\n\n        return ipmouse;\n    }\n\n    //#region Built In Listeners\n\n    /**@param {MouseEvent} e*/\n    __onMouseMove(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        if(this.isDragging) this.emit('drag', ipmouse);\n\n        this.emit('mousemove', ipmouse);\n    }\n\n    //\n\n    /**@param {MouseEvent} e*/\n    __onClick(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('click', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onAuxClick(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('auxclick', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onDblClick(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('dblclick', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onContextMenu(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('contextmenu', ipmouse);\n    }\n\n    //\n\n    /**@param {MouseEvent} e*/\n    __onMouseDown(e){\n        this.isDragging = true;\n        const ipmouse = this.__processMouseEvent__(e);\n        this.emit('dragstart', ipmouse);\n        this.emit('mousedown', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseUp(e){\n        this.isDragging = false;\n        this.lastClick = null;\n        const ipmouse = this.__processMouseEvent__(e);\n        this.emit('dragend', ipmouse);\n        this.emit('mouseup', ipmouse);\n    }\n\n    //\n\n    /**@param {MouseEvent} e*/\n    __onMouseOver(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('mouseover', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseEnter(e){\n        const ipmouse = this.__processMouseEvent__(e);\n        if(this.isDragging && e.buttons === 0){\n            this.isDragging = false;\n            this.lastClick = null;\n        }\n        this.emit('mouseenter', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseOut(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('mouseout', ipmouse);\n    }\n\n    /**@param {MouseEvent} e*/\n    __onMouseLeave(e){\n        const ipmouse = this.__processMouseEvent__(e);\n\n        this.emit('mouseleave', ipmouse);\n    }\n\n    __onFocusOut(){\n        this.isDragging = false;\n        this.lastClick = null;\n    }\n}\n\nexport {\n    InputProcessor,\n    MouseInputModule\n}","import Victor from \"victor\";\r\nimport State from \"./graph/State\";\r\nimport Transition from \"./graph/Transition\";\r\n\r\nexport default class Util {\r\n    static genString(len){\r\n        return Math.random().toString(36).substring(2,len+2);\r\n    }\r\n\r\n    static deg360 = Math.PI * 2;\r\n    static deg90 = Math.PI / 2;\r\n    static deg2Rad = deg => Math.PI * deg / 180;\r\n    static rad2Deg = rad => rad * 180 / Math.PI;\r\n\r\n    /**\r\n     *  \r\n     * @param  {(State[]|Transition[])} states \r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @returns {(State[]|Transition[])}\r\n     */\r\n    static FindHits(states, x, y){\r\n        return states.filter(s => s.hits(x, y));\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     * @param {Number} fx From X \r\n     * @param {Number} fy From Y\r\n     * @param {Number} tx To X\r\n     * @param {Number} ty To Y\r\n     * @param {Number} arcAngle Arc Angle to be shown in degrees\r\n     * @param {Boolean} cw Clockwise\r\n     */\r\n    static drawArcFromTwoPoints(ctx, fx, fy, tx, ty, arcAngle, cw = false){\r\n        const f = new Victor(fx, fy),\r\n            t = new Victor(tx, ty),\r\n            a2 = arcAngle / 2,\r\n            m = f.clone().mix(t, 0.5),\r\n            l = f.distance(t);\r\n\r\n        // Calculations\r\n        const ti = 90 - a2, // Theta Inner\r\n            r = l / (2 * Math.cos(this.deg2Rad(ti))); // radius\r\n\r\n        const center = t.clone().subtract(f)\r\n        .rotateDeg(cw ? ti : -ti) // change this according to cw\r\n        .norm().multiplyScalar(r);\r\n\r\n        const coa = center.clone().add(f);\r\n\r\n        // ctx.strokeStyle = 'crimson';\r\n        // this.line(ctx, ...f.toArray(), ...t.toArray());\r\n        // ctx.strokeStyle = 'blue';\r\n        // this.line(ctx, ...f.toArray(), ...coa.toArray());\r\n        // this.line(ctx, ...coa.toArray(), ...t.toArray());\r\n\r\n        ctx.strokeStyle = '#999';\r\n        const sa = center.clone().invert().angle(),\r\n            ea = sa - this.deg2Rad(arcAngle);\r\n        \r\n        ctx.beginPath();\r\n        ctx.arc(...center.clone().add(f).toArray(), r, sa, ea, !cw);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        const endTangent = t.clone().subtract(coa).rotateDeg(-90).invert(),\r\n            startTangent = f.clone().subtract(coa);\r\n\r\n        const ctd = center.clone().invert().rotateDeg(-a2);\r\n        const ct = ctd.clone().add(ctd.norm().multiplyScalar(15)).add(coa);\r\n\r\n        // ctx.strokeStyle = 'green';\r\n        // this.line(ctx, ...coa.toArray(), ...ct.toArray());\r\n\r\n        return {\r\n            start: startTangent,\r\n            end: endTangent,\r\n            center: ct\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     * @param {Number} fx \r\n     * @param {Number} fy \r\n     * @param {Number} tx \r\n     * @param {Number} ty \r\n     */\r\n    static line(ctx, fx, fy, tx, ty){\r\n        ctx.beginPath();\r\n        ctx.moveTo(fx, fy);\r\n        ctx.lineTo(tx, ty);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {(Number|Victor)} angle \r\n     * @param {Boolean} goIn \r\n     */\r\n    static drawArrow(ctx, x, y, angle, arrowAngle = 25, arrowSize = 25, goIn = true){\r\n        const o = new Victor(x, y),\r\n            a = angle instanceof Victor ? \r\n            angle.clone().norm() : \r\n            (new Victor(1, 0)).rotateByDeg(angle);\r\n\r\n        const orig_a = a.clone().multiplyScalar(arrowSize);\r\n\r\n        ctx.beginPath();\r\n\r\n        a.rotateDeg(-arrowAngle/2).multiplyScalar(arrowSize);\r\n        ctx.moveTo(...o.toArray());\r\n        ctx.lineTo(...o.clone().add(a).toArray());\r\n        a.rotateDeg(arrowAngle);\r\n        ctx.lineTo(...o.clone().add(a).toArray());\r\n        ctx.lineTo(...o.toArray());\r\n        ctx.fill();\r\n\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n\r\n        // ctx.strokeStyle = 'red';\r\n        // ctx.moveTo(...o.toArray());\r\n        // ctx.lineTo(...o.add(orig_a).toArray());\r\n        // ctx.stroke();\r\n\r\n        ctx.closePath();\r\n    }\r\n\r\n    static copyToClipboard = text => {\r\n        // I thought I have to do the input trick\r\n        navigator.clipboard.writeText(text);\r\n    }\r\n}","import Victor from \"victor\";\r\nimport Util from \"../Util\";\r\nimport { useMainStore } from \"@/stores/mainStore\";\r\n\r\nclass StateOptions{\r\n    // Put more here\r\n    radius = 15;\r\n    border = 2;\r\n    borderColor = '#888';\r\n    bg = '#444';\r\n    labelColor = '#999';\r\n    selected_bg = '#888';\r\n    selected_labelColor = '#fff';\r\n}\r\n\r\n/**Constants */\r\nconst deg360 = Math.PI * 2;\r\n\r\nexport default class State{\r\n    /**@type {Victor} */\r\n    pos;\r\n    /**@type {String} */\r\n    label;\r\n    /**@type {StateOptions} */\r\n    options;\r\n    isFinish = false;\r\n    isStart = false;\r\n\r\n    //#region D3 Force Directive Layout\r\n\r\n    get x(){\r\n        return this.pos.x;\r\n    }\r\n\r\n    get y(){\r\n        return this.pos.y;\r\n    }\r\n\r\n    set x(v){\r\n        this.pos.x = v;\r\n    }\r\n\r\n    set y(v){\r\n        this.pos.y = v;\r\n    }\r\n\r\n    _isDragging = false;\r\n\r\n    get fx(){\r\n        return this._isDragging ? this.x : undefined;\r\n    }\r\n\r\n    get fy(){\r\n        return this._isDragging ? this.y : undefined;\r\n    }\r\n\r\n    //#endregion\r\n\r\n    /**\r\n     * \r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {String} label \r\n     * @param {StateOptions} options \r\n     */\r\n    constructor(x, y, label, options = {}){\r\n        const defOptions = new StateOptions();\r\n        Object.assign(defOptions, options);\r\n\r\n        this.pos = new Victor(x, y);\r\n        this.label = label || Util.genString(3);\r\n        this.options = defOptions;\r\n\r\n        Math.sq\r\n    }\r\n\r\n    /**\r\n     * Checks if a coordinate is inside this state\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @returns {Boolean}\r\n     */\r\n    hits(x, y){\r\n        const d = this.pos.distance(new Victor(x, y));\r\n        return this.options.radius >= d;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasRenderingContext2D} ctx \r\n     */\r\n    draw(ctx){\r\n        const mainStore = useMainStore();\r\n\r\n        const { pos, options, label } = this;\r\n        const { x, y } = pos;\r\n        const { radius, \r\n            border, borderColor, \r\n            bg, labelColor,\r\n            selected_bg, selected_labelColor } = options;\r\n        const fullWidth = radius + border;\r\n\r\n        if(this.isFinish){\r\n            ctx.beginPath();\r\n            ctx.fillStyle = borderColor;\r\n            ctx.arc(x, y, fullWidth + 6, 0, deg360);\r\n            ctx.fill();\r\n            ctx.closePath()\r\n            \r\n            ctx.beginPath();\r\n            ctx.fillStyle = \"#171717\";\r\n            ctx.arc(x, y, fullWidth + 4, 0, deg360);\r\n            ctx.fill();\r\n            ctx.closePath()\r\n        }\r\n\r\n        ctx.beginPath();\r\n        // Fill first using the border\r\n        ctx.fillStyle = borderColor;\r\n        ctx.ellipse(x, y, fullWidth, fullWidth, 0, 0, deg360);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        // Then the inner part\r\n        ctx.fillStyle = mainStore.selected?.label === this.label ? selected_bg : bg;\r\n        ctx.ellipse(x, y, radius, radius, 0, 0, deg360);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.fillStyle = mainStore.selected?.label === this.label ? selected_labelColor : labelColor;\r\n        ctx.textAlign = 'center';\r\n        ctx.textBaseline = 'middle';\r\n        ctx.font = '12px Roboto';\r\n        ctx.fillText(label, x, y + 1);\r\n\r\n        ctx.fillStyle = borderColor;\r\n        if(this.isStart) Util.drawArrow(ctx, x - radius, y, 180, 90);\r\n    }\r\n}","import { defineStore } from \"pinia\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport * as d3 from 'd3';\r\n\r\nexport const useForceStore = defineStore('force', () => {\r\n\r\n    const stateStore = useStateStore(),\r\n        transitionStore = useTransitionStore();\r\n\r\n    const centerForce = d3.forceCenter(100, 100).strength(0.05);\r\n\r\n    const simulation = d3.forceSimulation()\r\n        .stop()\r\n        .alphaDecay(0)\r\n        .alpha(.5)\r\n        .alphaTarget(0.7)\r\n        .force('repel', d3.forceCollide(d => 20))\r\n        .force('center', centerForce);\r\n\r\n\r\n    const tick = () => {\r\n        simulation.restart();\r\n        simulation.tick(1);\r\n    }\r\n\r\n    window.s = simulation;\r\n\r\n\r\n    const update = () => {\r\n        // Get all states\r\n        const states = stateStore.states,\r\n            transitions = transitionStore.transitions;\r\n\r\n        simulation.nodes([...states])\r\n            .force('link', \r\n            d3.forceLink(\r\n                [...transitions.filter(t => t.from.label !== t.to.label)])\r\n            .distance(() => 150)\r\n            );\r\n    }   \r\n\r\n    const setDimensions = (x, y) => {\r\n        centerForce.x(x / 2);\r\n        centerForce.y(y / 2);\r\n    }\r\n\r\n    const stop = () => simulation.stop();\r\n\r\n    return {\r\n        tick,\r\n        update,\r\n        stop,\r\n        setDimensions\r\n    }\r\n})","import State from \"@/commons/graph/State\";\r\nimport { defineStore } from \"pinia\";\r\nimport { computed, reactive, ref } from \"vue\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport { useMainStore } from \"./mainStore\";\r\nimport { useForceStore } from \"./forceStore\";\r\n\r\nexport const useStateStore = defineStore('state', () => {\r\n\r\n    const transitionStore = useTransitionStore(),\r\n        forceStore = useForceStore(),\r\n        mainStore = useMainStore();\r\n\r\n    /**@type {State[]} */\r\n    const states = reactive([]);\r\n\r\n    /**\r\n     * @param {State} state \r\n     */\r\n    const addState = (state) => {\r\n        states.push(state);\r\n        mainStore.genRegex();\r\n        forceStore.update();\r\n    };\r\n\r\n    const getStateIndex = label => states.findIndex(s => s.label === label),\r\n        getState = label => states.find(s => s.label === label);\r\n\r\n    const removeState = (label) => {\r\n        const i = getStateIndex(label);\r\n        if(i === -1) return;\r\n\r\n        // Find all transitions that is connected to this state\r\n        const froms = transitionStore.getTransitionsFrom(label);\r\n        froms.forEach(f => transitionStore.removeTransition(f.from.label, f.to.label));\r\n\r\n        const tos = transitionStore.getTransitionsTo(label);\r\n        tos.forEach(t => transitionStore.removeTransition(t.from.label, t.to.label));\r\n\r\n        if(mainStore.selected.label === label) mainStore.select(undefined);\r\n\r\n        states.splice(i , 1);\r\n        forceStore.update();\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const savedStart = ref(undefined);\r\n\r\n    const setStart = (c) => {\r\n        const t = getState(c);\r\n\r\n        if(savedStart.value === undefined) {\r\n            savedStart.value = t;\r\n        } else {\r\n            savedStart.value.isStart = false;\r\n            savedStart.value = t;\r\n        }\r\n\r\n        t.isStart = true;\r\n\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const accepting = computed(() => states.filter(s => s.isFinish));\r\n\r\n    return {\r\n        states,\r\n        addState,\r\n        getStateIndex,\r\n        getState,\r\n        removeState,\r\n        setStart,\r\n        savedStart,\r\n        accepting\r\n    }\r\n})","const project = 'DFAREGEX';\r\n\r\nexport default class Local {\r\n    static get = (item, def) => {\r\n        const value = localStorage.getItem(`${project}${item}`);\r\n        \r\n        if(value === null) return def || null;\r\n        \r\n        let parsed;\r\n\r\n        try { parsed = JSON.parse(value) }\r\n        catch{ parsed = value }\r\n\r\n        return parsed;\r\n    }\r\n\r\n    static set = (item, value) => {\r\n        try {\r\n            if(typeof value !== 'string') value = JSON.stringify(value)\r\n            localStorage.setItem(`${project}${item}`, value);\r\n        }catch(e){\r\n            alert(`Session Storage Error: ${e}`);\r\n        }\r\n    }\r\n\r\n    static has = item => this.get(item) !== null;\r\n\r\n    static remove = item => localStorage.removeItem(item);\r\n}","import { defineStore } from \"pinia\";\r\nimport { useAlphabetStore } from \"./alphabetStore\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport { useMainStore } from \"./mainStore\";\r\nimport State from \"@/commons/graph/State\";\r\n\r\nconst saveAsFile = (data, filename) => {\r\n    const pom = document.createElement('a');\r\n    pom.setAttribute('href', `data:text/plain;charset-utf-8,${encodeURIComponent(data)}`);\r\n    pom.setAttribute(\"download\", filename);\r\n\r\n    if(document.createEvent){\r\n        const ev = document.createEvent(\"MouseEvent\");\r\n        ev.initEvent('click', true, true);\r\n        pom.dispatchEvent(ev);\r\n    }else{\r\n        pom.click();\r\n    }\r\n}\r\n\r\nexport const useFileStore = defineStore('file', () => {\r\n    \r\n    const alphabetStore = useAlphabetStore(),\r\n        stateStore = useStateStore(),\r\n        transitionStore = useTransitionStore(),\r\n        mainStore = useMainStore();\r\n\r\n    const getFSMAsJSON = () => {\r\n        // Get all alphabet\r\n        const alphabet = [...alphabetStore.alphabet];\r\n        // Get all states, and their positions, and configurations (start/end)\r\n        const states = stateStore.states.map(s => {\r\n            return {\r\n                label: s.label,\r\n                x: s.pos.x,\r\n                y: s.pos.y\r\n            }\r\n        })\r\n        // Get all transitions\r\n        const transitions = transitionStore.transitions.map(t => {\r\n            return {\r\n                values: [...t.v],\r\n                from: t.from.label,\r\n                to: t.to.label\r\n            }\r\n        })\r\n        // Get DFA Information\r\n        const start = stateStore.savedStart?.label,\r\n            final = stateStore.accepting.map(s => s.label);\r\n\r\n        return {\r\n            alphabet: alphabet,\r\n            states: states,\r\n            transitions: transitions,\r\n            start: start,\r\n            final: final\r\n        }\r\n    }\r\n\r\n    const saveDFA = filename => {\r\n        const { alphabet, states, start, transitions, final } = getFSMAsJSON();\r\n\r\n        // Save as json string\r\n        saveAsFile(JSON.stringify({\r\n            alphabet: alphabet,\r\n            states: states,\r\n            transitions: transitions,\r\n            start: start,\r\n            final: final\r\n        }), `${filename}.json`);\r\n    }\r\n\r\n    const loadDFA = data => {\r\n        if(data === undefined) return;\r\n\r\n        const { alphabet, final, states, transitions, start } = data;\r\n\r\n        console.log(\"Imported Data: \", data);\r\n\r\n        mainStore.deleteAll();\r\n        alphabetStore.removeAll();\r\n\r\n        try {\r\n            // Add alphabet\r\n            alphabet.forEach(a => alphabetStore.addAlphabet(a));\r\n\r\n            // Generate States\r\n            states.forEach(s => {\r\n                const gen = new State(s.x, s.y);\r\n                gen.label = s.label;\r\n\r\n                if(final.includes(s.label)) gen.isFinish = true;\r\n                stateStore.addState(gen);\r\n            })\r\n\r\n            if(start && states.includes(start)) stateStore.setStart(start);\r\n\r\n            // Generate Transitions\r\n            transitions.forEach(t => {\r\n                const { values, from, to } = t;\r\n\r\n                transitionStore.addTransition({\r\n                    labels: values,\r\n                    from: from,\r\n                    to: to\r\n                })\r\n            })\r\n\r\n            mainStore.genRegex();\r\n        }catch(err){\r\n            console.log(err);\r\n            alert(\"Please import a correct file\");\r\n        }\r\n    }\r\n\r\n    return {\r\n        saveDFA,\r\n        loadDFA,\r\n        getFSMAsJSON\r\n    }\r\n})","import { defineStore } from \"pinia\";\r\nimport { ref, watch } from \"vue\";\r\nimport { useMainStore } from \"./mainStore\";\r\nimport Local from \"@/commons/Local\";\r\nimport { useFileStore } from \"./fileStore\";\r\n\r\nexport const useSettingStore = defineStore('setting', () => {\r\n    const mainStore = useMainStore(),\r\n        fileStore = useFileStore();\r\n\r\n    const simplifyDFARegex = ref(true);\r\n    const saveFSMOnExit = ref(false);\r\n    const nfaMode = ref(false);\r\n    const hideEpsilon = ref(true);\r\n\r\n    watch(simplifyDFARegex, () => {\r\n        mainStore.genRegex();\r\n    })\r\n\r\n    const startSync = () => {\r\n        // Sync with local storage\r\n        const data = Local.get('config');\r\n\r\n        if(data !== null) {\r\n\r\n            simplifyDFARegex.value = data.simplifyDFARegex;\r\n            saveFSMOnExit.value = data.saveFSMOnExit;\r\n            nfaMode.value = data.nfaMode;\r\n            hideEpsilon.value = data.hideEpsilon;\r\n    \r\n            if(saveFSMOnExit.value) fileStore.loadDFA(data.fsmData);\r\n        }\r\n\r\n        // Listen for when the page closes/refreshes\r\n        window.addEventListener(\"beforeunload\", () => save());\r\n    }\r\n\r\n    const save = () => {\r\n        // Save current settings to local storage\r\n        const fsmData = saveFSMOnExit.value ? fileStore.getFSMAsJSON() : null;\r\n\r\n        Local.set('config', {\r\n            simplifyDFARegex: simplifyDFARegex.value,\r\n            saveFSMOnExit: saveFSMOnExit.value,\r\n            fsmData: fsmData,\r\n            nfaMode: nfaMode.value,\r\n            hideEpsilon: hideEpsilon.value\r\n        })\r\n    }\r\n\r\n    return {\r\n        simplifyDFARegex,\r\n        saveFSMOnExit,\r\n        nfaMode,\r\n        hideEpsilon,\r\n\r\n        sync: startSync\r\n    }\r\n});","import Victor from \"victor\";\r\nimport State from \"./State\";\r\nimport { useTransitionStore } from \"@/stores/transitionStore\";\r\nimport Util from \"../Util\";\r\nimport { useStateStore } from \"@/stores/stateStore\";\r\nimport { useSettingStore } from \"@/stores/settingsStore\";\r\n\r\nexport default class Transition{\r\n    /**@type {State} */\r\n    from;\r\n    /**@type {State} */\r\n    to;\r\n    /**@type {String[]} */\r\n    v = [];\r\n\r\n    //#region D3 Force Directive Layout\r\n\r\n    get source(){\r\n        return this.from;\r\n    }\r\n\r\n    get target(){\r\n        return this.to;\r\n    }\r\n\r\n    //#endregion\r\n\r\n    /**\r\n     * \r\n     * @param {State} from \r\n     * @param {State} to \r\n     * @param {String[]} v\r\n     */\r\n    constructor(from, to, ...v){\r\n        this.from = from;\r\n        this.to = to;\r\n        this.v = v.sort();\r\n    }\r\n    \r\n\r\n    equalWith(from, to){\r\n        return this.from.label === from && this.to.label === to;\r\n    }\r\n\r\n    /**\r\n     * @param {Transition} other \r\n     * @returns {Boolean}\r\n     */\r\n    equals(other){\r\n        return other.from.label === this.from.label && other.to.label === this.to.label;\r\n    }\r\n\r\n    addValue(...v){\r\n        this.v.push(...v.sort());\r\n    }\r\n\r\n    removeValue(v){\r\n        const i = this.v.findIndex(a => a === v);\r\n        if(i === -1) return;\r\n        this.v.splice(i, 1);\r\n\r\n        if(this.v.length > 0) return;\r\n        // If no labels left, then delete the transition\r\n        const transitionStore = useTransitionStore();\r\n        transitionStore.removeTransition(this.from.label, this.to.label);\r\n    }\r\n\r\n    str(){\r\n        return this.v.map(v => `${this.from.label}:${v}>${this.to.label}`).join('\\n');\r\n    }\r\n\r\n    /**\r\n     * @param {CanvasRenderingContext2D} ctx \r\n     */\r\n    draw(ctx){\r\n        const vdir = this.to.pos.clone().\r\n        subtract(this.from.pos);\r\n\r\n        const vnorm = vdir.clone().norm();\r\n\r\n        const v = vnorm.clone().multiplyScalar(this.from.options.radius + 7);\r\n        \r\n        let end = this.to.pos.clone().subtract(v),\r\n            start = this.from.pos.clone().add(v);\r\n\r\n        const transitionStore = useTransitionStore(),\r\n            stateStore = useStateStore(),\r\n            settingsStore = useSettingStore();\r\n\r\n        let textPos = null;\r\n\r\n        // Line\r\n        ctx.strokeStyle = '#999';\r\n\r\n        // Text\r\n        ctx.textAlign = 'center';\r\n        const tw = ctx.measureText(this.v.join(', ')).width;\r\n\r\n        ctx.fillStyle = '#999';\r\n\r\n        let arrowSize = 20;\r\n\r\n        if(transitionStore.getTransitionIndex(this.to.label, this.from.label) === -1){\r\n            ctx.beginPath();\r\n            ctx.moveTo(...start.toArray());\r\n            ctx.lineTo(...end.clone().subtract(v).toArray());\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            vnorm.invert();\r\n\r\n            textPos = this.from.pos.clone().mix(this.to.pos, 0.5)\r\n            .add(vdir.clone().rotateDeg(-90)\r\n            .norm().multiplyScalar(tw)).toArray();\r\n\r\n        }else if(this.from.label === this.to.label){\r\n            // For self referencing\r\n\r\n            // Get all vector directions that connects to this state, and fine the average\r\n            /**@type {Set<State>} */\r\n            const cSet = new Set();\r\n\r\n            transitionStore.transitions.forEach(t => {\r\n                // Skip self\r\n                if(t.from.label === this.from.label\r\n                    && t.to.label === this.to.label) return;\r\n\r\n                if(t.from.label === this.from.label) cSet.add(t.to.label);\r\n                else if(t.to.label === this.from.label) cSet.add(t.from.label);\r\n            })\r\n\r\n            /**@type {State[]} */\r\n            const connected = [];\r\n            cSet.forEach(sLabel => connected.push(stateStore.getState(sLabel)));\r\n\r\n            // this.v.splice(0);\r\n            // this.v.push(...connected.map(s => s.label));\r\n\r\n            const sldir = new Victor(0, cSet.size === 0 ? 1 : 0);\r\n\r\n            // Loop  through all connected states then get the average vector\r\n            connected.forEach(s => {\r\n                sldir.add(s.pos.clone().subtract(this.from.pos).norm())\r\n            })\r\n            if(stateStore.getState(this.from.label).isStart) sldir.add(new Victor(-1.5, 0));\r\n            sldir.norm().invert();\r\n\r\n\r\n            const arcCoverage = 60, \r\n                arcLoc = sldir.angleDeg(), \r\n                len = 15,\r\n                touchPoint = this.from.options.radius + 7,\r\n                ssl = new Victor(touchPoint, 0).rotateDeg(arcLoc + arcCoverage / 2),\r\n                esl = ssl.clone().rotateDeg(-arcCoverage),\r\n                dir = ssl.clone().rotateDeg(-arcCoverage / 2).norm(),\r\n                sel = ssl.clone().add(dir.clone().multiplyScalar(len)),\r\n                eel = esl.clone().add(dir.clone().multiplyScalar(len));\r\n\r\n            textPos = this.from.pos.clone()\r\n                .add(dir.multiplyScalar(touchPoint + len + 20)).toArray();\r\n\r\n            Util.line(ctx,\r\n                ...this.from.pos.clone().add(ssl).toArray(),\r\n                ...this.from.pos.clone().add(sel).toArray());\r\n            Util.line(ctx,\r\n                ...this.from.pos.clone().add(esl).toArray(),\r\n                ...this.from.pos.clone().add(eel).toArray());\r\n\r\n            const { end: ea } = Util.drawArcFromTwoPoints(ctx,\r\n                ...this.from.pos.clone().add(sel).toArray(),\r\n                ...this.from.pos.clone().add(eel).toArray(),\r\n                180);\r\n\r\n            // ctx.strokeStyle = 'green';\r\n            // Util.line(ctx,\r\n            //     ...this.from.pos.toArray(),\r\n            //     ...this.from.pos.clone().add(ssl).toArray())\r\n            \r\n            end.copy(this.from.pos.clone().add(esl));\r\n\r\n            arrowSize = 15;\r\n\r\n            vnorm.copy(ea);\r\n        }else {\r\n            \r\n            const maxArc = 100, minArc = 15,\r\n                arc = maxArc**2 / this.from.pos.distanceSq(this.to.pos);\r\n                \r\n\r\n            const { start: sa, end: ea, center: c } = Util.drawArcFromTwoPoints(ctx, \r\n                ...start.toArray(), ...end.toArray(), \r\n                arc > 1 ? maxArc : maxArc * arc < minArc ? minArc : maxArc * arc\r\n            )\r\n            vnorm.copy(ea);\r\n\r\n            textPos = c.toArray();\r\n        }\r\n\r\n        // Arrow\r\n        const arrowAngle = 20;\r\n        Util.drawArrow(ctx, ...end.toArray(), vnorm, arrowAngle, arrowSize);\r\n\r\n        if(settingsStore.hideEpsilon && this.v.includes('$')) return;\r\n        ctx.fillText(\r\n            this.v.join(', '), \r\n        ...textPos\r\n        );\r\n    }\r\n}","import Transition from \"@/commons/graph/Transition\";\r\nimport { defineStore } from \"pinia\";\r\nimport { reactive } from \"vue\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport { useMainStore } from \"./mainStore\";\r\nimport { useForceStore } from \"./forceStore\";\r\n\r\nexport const useTransitionStore = defineStore('transition', () => {\r\n\r\n    const stateStore = useStateStore(),\r\n        mainStore = useMainStore(),\r\n        forceStore = useForceStore();\r\n\r\n    /**@type {Transition[]} */\r\n    const transitions = reactive([]);\r\n\r\n    const addTransition = ({labels, from, to}) => {\r\n        // Find first if said transition is existing\r\n        const i = getTransitionIndex(from, to);\r\n        if(i === -1){\r\n            // Add transition if not found\r\n            const f = stateStore.getState(from),\r\n                t = stateStore.getState(to);\r\n            transitions.push(new Transition(f, t, ...labels));\r\n        }else{\r\n            // Just add the new labels to the transition\r\n            transitions[i].v.splice(0);\r\n            transitions[i].addValue(...labels);\r\n            \r\n            if(labels.length === 0) removeTransition(from, to);\r\n        }\r\n        \r\n        forceStore.update();\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const getTransitionIndex = (from, to) => {\r\n        return transitions.findIndex(t => t.equalWith(from, to));\r\n    }\r\n\r\n    const getTransition = (from, to) => transitions.find(t => t.equalWith(from, to));\r\n\r\n    const getTransitionsFrom = from => transitions.filter(t => t.from.label === from);\r\n\r\n    const getTransitionsTo = to => transitions.filter(t => t.to.label === to);\r\n\r\n    const removeTransition = (from, to) => {\r\n        const i = getTransitionIndex(from, to);\r\n        if(i === -1) return;\r\n        transitions[i].v.splice(0);\r\n        transitions.splice(i , 1);\r\n        forceStore.update();\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    return {\r\n        addTransition,\r\n        getTransitionIndex,\r\n        getTransition,\r\n        removeTransition,\r\n        transitions,\r\n        getTransitionsFrom,\r\n        getTransitionsTo\r\n    }\r\n})","import { defineStore } from \"pinia\";\r\nimport { reactive } from \"vue\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport { useMainStore } from \"./mainStore\";\r\n\r\n\r\nconst MAX_ALHPABET = 10;\r\n\r\nexport const useAlphabetStore = defineStore('alphabet', () => {\r\n    const alphabet = reactive(['a', 'b']);\r\n\r\n    const transitionStore = useTransitionStore(),\r\n        mainStore = useMainStore();\r\n        \r\n    const removeAlphabet = c => {\r\n        const i = alphabet.indexOf(c);\r\n        if(i === - 1) return;\r\n        alphabet.splice(i, 1);\r\n\r\n        // Remove all occurences in all transition of the said alphabet\r\n        transitionStore.transitions.forEach(t => t.removeValue(c));\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    const removeAll = () => {\r\n        alphabet.forEach(ap => removeAlphabet(ap));\r\n    }\r\n\r\n    const addAlphabet = c => {\r\n        if(alphabet.length >= MAX_ALHPABET) return;\r\n\r\n        c = c.trim();\r\n        if(c === '') return;\r\n        const i = alphabet.indexOf(c);\r\n        if(i === -1) {\r\n            alphabet.push(c);\r\n            mainStore.genRegex();\r\n        }\r\n    }\r\n\r\n    const resetAlphabet = () => {\r\n        alphabet.splice(0);\r\n        alphabet.push('a', 'b');\r\n        mainStore.genRegex();\r\n    }\r\n\r\n    return {\r\n        alphabet,\r\n        addAlphabet,\r\n        removeAlphabet,\r\n        resetAlphabet,\r\n        removeAll\r\n    }\r\n})","/**\r\n * @callback DrawableGFX\r\n * @param {CanvasRenderingContext2D} ctx\r\n */\r\n\r\nimport Util from \"../Util\";\r\n\r\nexport class Drawables{\r\n    /**@type {Drawables[]} */\r\n    static instances = [];\r\n\r\n    /**@type {String} */\r\n    id;\r\n    /**@type {DrawableGFX} */\r\n    gfx;\r\n    /**@type {Boolean} */\r\n    isRegistered = false;\r\n\r\n    /**\r\n     * \r\n     * @param {Drawables} d \r\n     */\r\n    static register(d){\r\n        const i = this.instances.findIndex(n => n.id === d.id);\r\n        if(i !== -1) return;\r\n        this.instances.push(d);\r\n        d.isRegistered = true;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {DrawableGFX} gfx \r\n     * @param {String} id \r\n     */\r\n    constructor(gfx, id){\r\n        this.gfx = gfx;\r\n        this.id = id || Util.genString(8);\r\n    }\r\n\r\n    remove(){\r\n        const i = Drawables.instances.findIndex(d => d.id === this.id);\r\n        if(i === -1) return;\r\n        Drawables.instances.splice(i, 1);\r\n        this.isRegistered = false;\r\n    }\r\n\r\n    register(){\r\n        if(this.isRegistered) return;\r\n        Drawables.register(this);\r\n    }\r\n\r\n    draw(ctx){\r\n        this.gfx(ctx);\r\n    }\r\n}","import { defineStore } from \"pinia\"\r\nimport { ref } from \"vue\";\r\n\r\nexport const useMouseStore = defineStore('mouse', () => {\r\n    \r\n    const x = ref(0),\r\n        y = ref(0),\r\n        set = (nx, ny) => {\r\n            x.value = nx;\r\n            y.value = ny;\r\n        }\r\n\r\n    return {\r\n        x,\r\n        y,\r\n        set\r\n    }\r\n})","import { Drawables } from \"@/commons/canvas/Drawables\";\r\nimport { defineStore } from \"pinia\";\r\nimport { ref, watch } from \"vue\";\r\nimport { useMouseStore } from \"./mouseStore\";\r\nimport State from \"@/commons/graph/State\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport Victor from \"victor\";\r\nimport Util from \"@/commons/Util\";\r\n\r\n\r\nexport const useModeStore = defineStore('mode', () => {\r\n\r\n    //#region Stores and Drawables\r\n    const stateStore = useStateStore();\r\n    const mousestore = useMouseStore();\r\n    \r\n    const linkingArrow = new Drawables(ctx => {\r\n        const { x, y } = mousestore;\r\n        \r\n        /**@type {State} */\r\n        const start = stateStore.getState(linkStart.value);\r\n        if(start === undefined) return;\r\n\r\n        // Line\r\n        ctx.lineWidth = 2;\r\n        ctx.strokeStyle = '#999999';\r\n        ctx.fillStyle = '#999';\r\n        ctx.beginPath();\r\n        ctx.moveTo(...start.pos.toArray());\r\n        ctx.lineTo(x, y);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        // Triangle\r\n        const v = new Victor(x, y).subtract(start.pos).normalize().multiplyScalar(25).invert();\r\n        Util.drawArrow(ctx, x, y, v);\r\n\r\n        // Inner Circle\r\n        ctx.beginPath();\r\n        ctx.arc(...start.pos.toArray(), 15, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n    }, 'link-arrow');\r\n    //#endregion\r\n\r\n    /**@type {('default'|'linking'|'delete')} */\r\n    const mode = ref('default');\r\n\r\n    watch(mode, v => {\r\n        linkReset();\r\n        if(v === 'linking') linkingArrow.register();\r\n        else linkingArrow.remove();\r\n    })\r\n\r\n    const linkStart = ref(''),\r\n        linkEnd = ref(''),\r\n        linkReset = () => {\r\n            linkStart.value = '';\r\n            linkEnd.value = '';\r\n        }\r\n\r\n    const openTransitionDialog = ref(false);\r\n\r\n    watch(linkEnd, v => {\r\n        openTransitionDialog.value = v !== '';\r\n    })\r\n\r\n    return {\r\n        linkStart,\r\n        linkEnd,\r\n        linkReset,\r\n        \r\n        mode,\r\n        openTransitionDialog\r\n    }\r\n})","import { InputProcessor } from \"../input/InputProcessor\";\r\n\r\nimport { useAlphabetStore } from \"@/stores/alphabetStore\";\r\nimport { useTransitionStore } from \"@/stores/transitionStore\";\r\nimport { useStateStore } from \"@/stores/stateStore\";\r\nimport { useMainStore } from \"@/stores/mainStore\";\r\n\r\nimport State from \"../graph/State\";\r\nimport Util from \"../Util\";\r\nimport { useModeStore } from \"@/stores/modeStore\";\r\nimport { Drawables } from \"./Drawables\";\r\nimport { useMouseStore } from \"@/stores/mouseStore\";\r\n\r\nconst ip = new InputProcessor(null, {\r\n    captureKey: true,\r\n    captureMouse: true\r\n})\r\n\r\n/**\r\n * \r\n * @param {HTMLElement} c \r\n */\r\nexport function monitor(c){\r\n    ip.monitor = c;\r\n}\r\n\r\n\r\nlet HAS_INITIALIZED = false;\r\nexport function initCanvas(){\r\n    // To be sure that this function is only run once\r\n    if(HAS_INITIALIZED) return;\r\n    HAS_INITIALIZED = true;\r\n\r\n    const alphabetStore = useAlphabetStore(),\r\n        transitionStore = useTransitionStore(),\r\n        stateStore = useStateStore(),\r\n        mouseStore = useMouseStore(),\r\n        modeStore = useModeStore(),\r\n        mainStore = useMainStore();\r\n\r\n    const { monitor: c } = ip,\r\n        ctx = c.getContext('2d');\r\n\r\n    const canvas = {};\r\n\r\n    Object.defineProperty(canvas, 'cursor', {\r\n        get: () => c.style.cursor,\r\n        set: v => c.style.cursor = v\r\n    })\r\n\r\n    // Add a state on double click\r\n    ip.on('dblclick', ev => {\r\n        const { x, y } = ev.client;\r\n\r\n        // Only add states when mode is default\r\n        if(modeStore.mode !== 'default') return;\r\n        stateStore.addState(new State(x, y));\r\n        // set the cursor to pointer after creating a state\r\n        canvas.cursor = 'pointer';\r\n    })\r\n\r\n    ip.on('drag', ev => {\r\n        const { x, y } = ev.dragDiff,\r\n            selected = mainStore.selected,\r\n            origin = mainStore.selectedOrigin;\r\n\r\n        // Only support drag when default mode\r\n        if(modeStore.mode !== 'default') return;\r\n\r\n        if(selected === undefined || !(selected instanceof State)) return;\r\n\r\n        const { x: ox, y: oy } = origin;\r\n\r\n        // selected._isDragging = true;\r\n        selected.pos.x = ox + x;\r\n        selected.pos.y = oy + y;\r\n    })\r\n\r\n    ip.on('dragend', ev => {\r\n        if(mainStore.selected) {\r\n            canvas.cursor = 'pointer';\r\n            mainStore.selected._isDragging = false;\r\n        }\r\n    })\r\n\r\n    // Monitor on clicks\r\n    ip.on('mousedown', ev => {\r\n        const { x , y } = ev.client;\r\n\r\n        const clicked = Util.FindHits(stateStore.states, x, y)[0];\r\n\r\n        mainStore.select(clicked);\r\n\r\n\r\n        if(modeStore.mode === 'linking'){\r\n            if(clicked instanceof State){\r\n                if(!modeStore.linkStart) modeStore.linkStart = clicked.label;\r\n                else modeStore.linkEnd = clicked.label;\r\n            }else modeStore.linkStart = '';\r\n        } \r\n        if(clicked === undefined) return;\r\n        if(modeStore.mode === 'delete') stateStore.removeState(clicked.label);\r\n    })\r\n\r\n    ip.on('mousemove', ev => {\r\n        const { x, y } = ev.client,\r\n            selected = mainStore.selected;\r\n\r\n        mouseStore.set(x, y);\r\n\r\n        const hovering = Util.FindHits(stateStore.states, x, y )[0];\r\n\r\n        let cursor = 'default';\r\n\r\n        // Manage cursors while moving\r\n        switch(modeStore.mode){\r\n            case 'default':\r\n                // When dragging\r\n                if(selected && ev.isDragging) cursor = 'grabbing'\r\n                else if(hovering) cursor = 'pointer'\r\n                break;\r\n            case 'linking':\r\n                if(modeStore.linkStart) cursor = 'crosshair';\r\n                else if(hovering instanceof State) cursor = 'copy';\r\n                break;\r\n            case 'delete':\r\n                if(hovering) cursor = 'crosshair';\r\n                break;\r\n        }\r\n\r\n\r\n        canvas.cursor = cursor;\r\n    })\r\n\r\n    ip.on('mouseup', ev => {\r\n        // When stopped dragging\r\n    })\r\n\r\n    // Hotkeys \r\n    \r\n    window.ip = ip;\r\n\r\n    ip.on('C', () => {\r\n      modeStore.mode = 'linking';\r\n    })\r\n\r\n    ip.on('V', () => {\r\n        modeStore.mode = 'default';\r\n    })\r\n\r\n    ip.on('D', () => {\r\n        modeStore.mode = 'delete';\r\n    })\r\n}\r\n\r\nexport function focus(){\r\n    ip.focus();\r\n    ip.monitor.focus()\r\n}\r\n\r\nexport function getMonitor(){\r\n    return ip.monitor;\r\n}","import noam from '@/plugins/noam';\r\n\r\nclass FSMTransition{\r\n    /**@type {String} */\r\n    fromState;\r\n    /**@type {String} */\r\n    symbol;\r\n    /**@type {String[]} */\r\n    toStates;\r\n\r\n    constructor(from, value, ...to){\r\n        this.fromState = from;\r\n        this.symbol = value;\r\n        this.toStates = to; \r\n    }\r\n}\r\n\r\nclass FSMData{\r\n    /**@type {String[]} */\r\n    states = [];\r\n    /**@type {String} */\r\n    initialState;\r\n    /**@type {String[]} */\r\n    acceptingStates = [];\r\n    /**@type {FSMTransition[]} */\r\n    transitions = [];\r\n    /**@type {String[]} */\r\n    alphabet;\r\n}\r\n\r\nexport class FSM {\r\n    /**@type {FSMData} */\r\n    data;\r\n\r\n    get states(){\r\n        return this.data.states;\r\n    }\r\n\r\n    get initial(){\r\n        return this.data.initialState;\r\n    }\r\n\r\n    get accepting(){\r\n        return this.data.acceptingStates;\r\n    }\r\n    \r\n    get transitions(){\r\n        return this.data.transitions;\r\n    }\r\n\r\n    get alphabet(){\r\n        return this.data.alphabet;\r\n    }\r\n\r\n    add_t = (from, to, value) => {\r\n        // Check if from and to exists, if not then don't add\r\n        const fi = this.index_s(from),\r\n            ti = this.index_s(to);\r\n\r\n        if(fi === -1 || ti === -1) return;\r\n\r\n        // console.log(from, to, value);\r\n\r\n        // Check if there is already an existing transition\r\n        const i = this.transitions.findIndex(t => t.fromState == from && t.symbol === value);\r\n        const t = i === -1 ? new FSMTransition(from, value, to) : this.transitions[i];\r\n        if (i !== -1) t.toStates = [...t.toStates, to];\r\n        else this.transitions.push(t);\r\n    }\r\n    index_tfrom = from => this.transitions.findIndex(t => t.fromState === from);\r\n    index_tto = to => this.transitions.findIndex(t => t.toStates.includes(to));\r\n    remove_tfrom = from => {\r\n        let n;\r\n        while(n !== -1){\r\n            n = this.index_tfrom(from)\r\n            if(n === -1) break;\r\n            this.transitions.splice(n, 1);\r\n        }\r\n    }\r\n    remove_tto = to => {\r\n        let n;\r\n        while(n !== -1){\r\n            n = this.index_tto(to);\r\n            if(n == -1) break;\r\n            const t = this.transitions[n];\r\n            if(t.toStates.length === 1) this.transitions.splice(n, 1);\r\n            else t.toStates.splice(t.toStates.indexOf(to), 1);\r\n        }\r\n    }\r\n    remove_tall = state => {\r\n        this.remove_tfrom(state);\r\n        this.remove_tto(state);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {String} from \r\n     * @param {String} to \r\n     * @returns {String[]}\r\n     */\r\n    t = (from, to, filter = false) => {\r\n        return this.transitions.filter(t => t.fromState === from && t.toStates.includes(to)).map(t => t.symbol).filter(t => !filter || t !== '');\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {String} label \r\n     * @returns {Array}\r\n     */\r\n    tout = label => {\r\n        return this.transitions.filter(t => t.fromState === label);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {String} label \r\n     * @returns {Array}\r\n     */\r\n    tins = label => {\r\n        return this.transitions.filter(t => t.toStates.includes(label));\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {String} label \r\n     * @returns {Array}\r\n     */\r\n    lout = label => {\r\n        const res = new Set();\r\n        this.tout(label).forEach(t => t.toStates.forEach(l => l !== label && res.add(l)));\r\n        return [...res.values()];\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {String} label \r\n     * @returns {Array}\r\n     */\r\n    lins = label => {\r\n        const res = new Set();\r\n        this.tins(label).forEach(({fromState: from}) => from !== label && res.add(from));\r\n        return [...res.values()];\r\n    }\r\n\r\n    add_s = label => this.states.push(label);\r\n    index_s = label => this.states.findIndex(s => s == label);\r\n    remove_s = label => {\r\n        const n = this.index_s(label);\r\n        if(n === -1) return;\r\n        // Remove all transitions that contains this state\r\n        this.remove_tall(label);\r\n\r\n        this.states.splice(n, 1);\r\n\r\n    }\r\n\r\n\r\n\r\n    constructor(data){\r\n        if(typeof data === 'string') data = noam.fsm.parseFsmFromString(data);\r\n        this.data = data;\r\n    }\r\n\r\n    toRegex(){\r\n        // Do validation \r\n        this.data = noam.fsm.removeUnreachableStates(this.data);\r\n        if(!noam.fsm.validate(this.data)) {\r\n            console.log('FSM Not Valid');\r\n\r\n            return;\r\n        }\r\n\r\n        const { states, accepting, transitions, initial } = this;\r\n\r\n        const start = '__s__',\r\n            end = '__e__';\r\n\r\n        // Add Start and Ending states\r\n        this.add_s(start);\r\n        this.add_s(end);\r\n        this.add_t(start, initial, '');\r\n        accepting.forEach(a => this.add_t(a, end, ''));\r\n        this.data.initialState = start;\r\n        this.data.acceptingStates = [end];\r\n\r\n        let counter = 0; // To avoid infinite loop\r\n        while (states.length > 2 && counter < states.length){\r\n            // Get Intermeddiate of start\r\n            const imd = this.lout(start).filter(l => this.hasPath(l, end));\r\n\r\n            imd.forEach(state => {\r\n                if(state === end) return;\r\n\r\n                const outs = this.lout(state).filter(l => this.hasPath(l, end)),\r\n                    ins = this.lins(state).filter(l => this.hasPath(state, l));\r\n\r\n                // Handle Outgoings\r\n                outs.forEach(s => {\r\n                    if(s === state) return;\r\n                    if(!this.hasPath(s, end)){\r\n                        this.remove_s(s); // Remove Dead State\r\n                        return;\r\n                    };\r\n                    const ft = this.wrap(this.t(start, state), '+');\r\n                    const sl = this.wrap(this.t(state, state), '*');\r\n                    const et = this.wrap(this.t(state, s), '+');\r\n                    this.add_t(start, s, ft + sl + et);\r\n                })\r\n\r\n                // Handle Ingoings\r\n                ins.forEach(s => {\r\n                    if(s === state && s === start) return;\r\n\r\n                    const targets = outs;   \r\n\r\n                    targets.forEach(d => {\r\n                        const ts = this.wrap(this.t(s, state), '+');\r\n                        const sl = this.wrap(this.t(state, state), '*');\r\n                        const sd = this.wrap(this.t(state, d), '+');\r\n\r\n                        this.add_t(s, d, ts + sl + sd);\r\n                    })\r\n                })\r\n\r\n                this.remove_s(state);\r\n                // console.log(state);\r\n                // console.log(structuredClone(this.data));\r\n            })\r\n\r\n            counter++;\r\n        }\r\n\r\n        return this.data.transitions.filter(t => t.fromState === start && t.toStates.includes(end)).map(t => t.symbol === '' ? '$' : t.symbol).join('+');\r\n    }\r\n\r\n    wrap(transitions, operation){\r\n        if(operation === '+'){\r\n            return transitions.length === 1 ? transitions[0] :\r\n                transitions.length > 1 ? this.wrapIfNot(transitions.join(operation)) : '';\r\n        }else if(operation === '*'){\r\n            return transitions.length === 1 ? `${transitions[0].length === 1 ? transitions : `${this.wrapIfNot(transitions[0])}`}*` :\r\n                transitions.length > 1 ? `${this.wrapIfNot(this.wrap(transitions, '+'))}*` : '';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {String} str \r\n     * @returns \r\n     */\r\n    wrapIfNot(str){\r\n         if(str[0] === '(' && str.endsWith(')')) return str;\r\n         else return `(${str})`;\r\n    }\r\n\r\n    hasPath(from, to){\r\n        const nvs = [from], vs = new Set();\r\n\r\n        let counter = 0;\r\n        while(nvs.length > 0){\r\n            const s = nvs.shift();\r\n            if(s === to) return true;\r\n            vs.add(s);\r\n\r\n            const outs = new Set();\r\n\r\n            this.tout(s).forEach(os => os.toStates.forEach(l => !vs.has(l) && outs.add(l)));\r\n\r\n            nvs.push(...outs.values());\r\n            counter++;\r\n\r\n            if(counter > this.states.length ** 2){\r\n                console.log('BROKE PATHFINDING');\r\n                break;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n}","import { focus, getMonitor, initCanvas, monitor } from \"@/commons/canvas/CanvasInit\";\r\nimport State from \"@/commons/graph/State\";\r\nimport Transition from \"@/commons/graph/Transition\";\r\nimport { defineStore } from \"pinia\";\r\nimport { computed, reactive, ref } from \"vue\";\r\nimport { useStateStore } from \"./stateStore\";\r\nimport { useTransitionStore } from \"./transitionStore\";\r\nimport noam from \"@/plugins/noam\";\r\nimport Victor from \"victor\";\r\nimport { useAlphabetStore } from \"./alphabetStore\";\r\nimport { useSettingStore } from \"./settingsStore\";\r\nimport { FSM } from \"@/commons/graph/Converter\";\r\n\r\nexport const useMainStore = defineStore(\"main\", () => {\r\n\r\n    const stateStore = useStateStore(),\r\n        transitionStore = useTransitionStore(),\r\n        alphabetStore = useAlphabetStore(),\r\n        settingsStore = useSettingStore();\r\n\r\n    /**@type {State} */\r\n    const selected = ref(undefined),\r\n        selectedOrigin = ref({x: 0, y: 0});\r\n\r\n    // Input Processor\r\n    const processInput = c => {\r\n        // set height and width;\r\n        c.width = c.clientWidth;\r\n        c.height = c.clientHeight;\r\n\r\n        monitor(c);\r\n        initCanvas();\r\n    }\r\n\r\n    const select = o => {\r\n        selected.value = o;\r\n        if(!(o instanceof State)) return;\r\n        \r\n        selectedOrigin.value.x = o.pos?.x;\r\n        selectedOrigin.value.y = o.pos?.y;\r\n    }\r\n\r\n    const inputFocus = () => focus();\r\n\r\n    const deleteAll = () => {\r\n        select(undefined);\r\n        stateStore.states.splice(0);\r\n        transitionStore.transitions.splice(0);\r\n    }\r\n\r\n    const checkForValidity = () => {\r\n        const states = stateStore.states,\r\n            transition = transitionStore.transitions,\r\n            initial = stateStore.savedStart,\r\n            accepting = stateStore.accepting;\r\n\r\n        if(initial === undefined ||\r\n            states.length === 0 ||\r\n            transition.length === 0 ||\r\n            accepting.length === 0) return false;\r\n\r\n            // TODO: More checks\r\n\r\n        return true;\r\n    }\r\n\r\n    const genDFA = regex => {\r\n        deleteAll();\r\n\r\n        let a;\r\n\r\n        try{\r\n            \r\n            a = noam.re.string.toAutomaton(regex);\r\n            if(!settingsStore.nfaMode){\r\n                a = noam.fsm.convertEnfaToNfa(a);\r\n                a = noam.fsm.convertNfaToDfa(a);\r\n                a = noam.fsm.minimize(a);\r\n                a = noam.fsm.convertStatesToNumbers(a);\r\n            }\r\n            \r\n        }catch(err){\r\n            console.log(err);\r\n        }\r\n\r\n        const { states: st, alphabet: al, acceptingStates: acc, initialState: ini, transitions: trs} = a;\r\n\r\n        const { clientHeight: h, clientWidth: w } = getMonitor();\r\n\r\n        const hand = new Victor(0, 250),\r\n            center = new Victor(w/2, h/2);\r\n\r\n        // Set alphabet\r\n        alphabetStore.removeAll();\r\n        al.forEach(c => alphabetStore.addAlphabet(c));\r\n\r\n        // Generate the states first (circular layout)\r\n        st.forEach((s, i) => {\r\n            const gens = new State(...hand.clone().add(center).toArray(), `q${s}`);\r\n            stateStore.addState(gens)\r\n            if(s === ini) gens.isStart = true;\r\n            hand.rotateDeg(360 / st.length);\r\n            if(acc.includes(s)) gens.isFinish = true;\r\n        })\r\n\r\n        // Set transitions\r\n        trs.forEach(t => {\r\n\r\n            const { fromState, symbol, toStates: toStateArr } = t;\r\n\r\n            toStateArr.forEach(ts => {\r\n                transitionStore.addTransition({\r\n                    labels: [symbol],\r\n                    from: `q${fromState}`,\r\n                    to: `q${ts}`\r\n                })\r\n            })\r\n\r\n        })\r\n    }\r\n\r\n    const regexResult = ref('');\r\n\r\n    const formal_specs = computed(() => {\r\n\r\n        const states = stateStore.states,\r\n            transition = transitionStore.transitions,\r\n            initial = stateStore.savedStart,\r\n            accepting = stateStore.accepting;\r\n\r\n        return `#states\r\n${states.map(s => s.label).join('\\n')}\r\n#initial\r\n${initial?.label}\r\n#accepting\r\n${accepting.map(a => a.label).join('\\n')}\r\n#alphabet\r\n${alphabetStore.alphabet.join('\\n')}\r\n#transitions\r\n${transition.map(t => t.str()).join('\\n')}`;\r\n    });\r\n\r\n    const genRegex = () => {\r\n\r\n        // validate first\r\n        if(!checkForValidity()) return;\r\n\r\n        const str = formal_specs.value;\r\n\r\n        let a, r;\r\n\r\n        try {\r\n            if(!settingsStore.nfaMode && !settingsStore.simplifyDFARegex){\r\n                const fsm = new FSM(formal_specs.value);\r\n                r = fsm.toRegex();\r\n            }else{\r\n                a = noam.fsm.parseFsmFromString(str);\r\n                if(settingsStore.simplifyDFARegex) a = noam.fsm.minimize(a);\r\n                if(!settingsStore.nfaMode) {\r\n                    a = noam.fsm.convertEnfaToNfa(a);\r\n                    a = noam.fsm.convertNfaToDfa(a);\r\n                }\r\n                a = noam.fsm.toRegex(a);\r\n                a = noam.re.tree.simplify(a, {\"useFsmPatterns\": settingsStore.simplifyDFARegex});\r\n                r = noam.re.tree.toString(a);\r\n            }\r\n\r\n\r\n        }catch(err){\r\n            regexResult.value = '';\r\n            console.log(err);\r\n        }\r\n\r\n        regexResult.value = r;\r\n    }\r\n\r\n    return {\r\n        processInput,\r\n        inputFocus,\r\n\r\n        selected,\r\n        selectedOrigin,\r\n        select,\r\n\r\n        deleteAll,\r\n        checkForValidity,\r\n        \r\n        genDFA,\r\n        genRegex,\r\n        regexResult,\r\n        \r\n        formal_specs\r\n    }\r\n}) ","<template>\r\n    <div class=\"flex relative\">\r\n        \r\n        <canvas class=\"flex-grow\"\r\n            ref=\"c\">\r\n\r\n        </canvas>\r\n        <div class=\"absolute right-0 bottom-0 z-50 p-3\">\r\n            <v-btn variant=\"tonal\"\r\n                size=\"small\"\r\n                icon\r\n                @click=\"forceDirectiveEnabled = !forceDirectiveEnabled\">\r\n                <v-icon>mdi-{{ forceDirectiveEnabled ? 'arrow-collapse-all' : 'asterisk'}}</v-icon>\r\n\r\n                <v-tooltip\r\n                    activator=\"parent\">\r\n                    Force Directive Mode : <span :class=\"forceDirectiveEnabled ? 'success' : 'danger'\">{{ forceDirectiveEnabled ? 'ON' : 'OFF' }}</span>\r\n                </v-tooltip>\r\n\r\n            </v-btn>\r\n        </div>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useMainStore } from '@/stores/mainStore';\r\nimport { useForceStore } from '@/stores/forceStore';\r\nimport { useStateStore } from '@/stores/stateStore';\r\nimport { useTransitionStore } from '@/stores/transitionStore';\r\nimport { ref, computed } from 'vue';\r\nimport { Drawables } from '@/commons/canvas/Drawables';\r\n\r\nwindow.Drawables = Drawables;\r\n\r\nexport default {\r\n    setup () {\r\n\r\n        const c = ref(null),\r\n            ctxRef = computed(() => c.value.getContext('2d')),\r\n            mainStore = useMainStore(),\r\n            transitionStore = useTransitionStore(),\r\n            stateStore = useStateStore(),\r\n            forceStore = useForceStore(),\r\n            rafID = ref(0);\r\n\r\n        const forceDirectiveEnabled = ref(false);\r\n\r\n        const states = computed(() => stateStore.states),\r\n            transitions = computed(() => transitionStore.transitions);\r\n\r\n        // Force Directive Layout\r\n\r\n\r\n        const animate = () => {\r\n            const { clientHeight: h, clientWidth: w} = c.value;\r\n            /**@type {CanvasRenderingContext2D} */\r\n            const ctx = ctxRef.value;\r\n            \r\n            // Clear Canvas\r\n            ctx.clearRect(0, 0, w, h);\r\n\r\n            // Force Directive Layout\r\n            if(forceDirectiveEnabled.value) forceStore.tick();\r\n            else forceStore.stop();\r\n\r\n            // Draw States\r\n            states.value.forEach(s => s.draw(ctx));\r\n\r\n            // Draw Transitions\r\n            transitions.value.forEach(t => t.draw(ctx));\r\n\r\n            // Draw Drawables\r\n            Drawables.instances.forEach(d => d.draw(ctx));\r\n\r\n            rafID.value = requestAnimationFrame(animate);\r\n        }\r\n\r\n        return {\r\n            c,\r\n            mainStore,\r\n            forceStore,\r\n            \r\n            rafID,\r\n            animate,\r\n            forceDirectiveEnabled\r\n        }\r\n    },\r\n    mounted(){\r\n        // Set canvas element to process any incoming input\r\n        this.mainStore.processInput(this.c);\r\n        this.forceStore.setDimensions(this.c.clientWidth, this.c.clientHeight);\r\n        this.animate();\r\n    },\r\n    beforeUnmount(){\r\n        cancelAnimationFrame(this.rafID);\r\n    },\r\n    emits: ['select:node']\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.danger {\r\n    @apply text-rose-600;\r\n}\r\n\r\n.success {\r\n    @apply text-lime-800;\r\n}\r\n</style>","import { render } from \"./FSMVisualizer.vue?vue&type=template&id=0f383206&scoped=true\"\nimport script from \"./FSMVisualizer.vue?vue&type=script&lang=js\"\nexport * from \"./FSMVisualizer.vue?vue&type=script&lang=js\"\n\nimport \"./FSMVisualizer.vue?vue&type=style&index=0&id=0f383206&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0f383206\"]])\n\nexport default __exports__","<template>\r\n    <div class=\"flex flex-col gap-2\">\r\n        <!-- Alphabet -->\r\n        <div class=\"flex justify-between\">\r\n          <div class=\"text-2xl\">Alphabet</div>\r\n\r\n          <v-btn \r\n            color=\"red\" \r\n            density=\"comfortable\" \r\n            @click=\"resetAlphabet\"\r\n            v-if=\"resetAble\">Reset</v-btn>\r\n\r\n        </div>\r\n        \r\n        <!-- Alphabet List -->\r\n        <v-container class=\"p-0\">\r\n          <v-row\r\n            align=\"center\"\r\n            justify=\"start\"\r\n            noGutters\r\n            class=\" gap-x-1 gap-y-0.5\">\r\n            <v-col\r\n              v-for=\"c in alphabet\" :key=\"c+''+Math.random()\"\r\n              cols=\"auto\">\r\n              <v-chip\r\n                closable\r\n                @click:close=\"removeAlphabet(c)\"\r\n                size=\"small\">\r\n                {{ c }}\r\n              </v-chip>\r\n            </v-col>\r\n          </v-row>\r\n        </v-container>\r\n\r\n        <div class=\"\">\r\n          <v-text-field \r\n            label=\"Add alphabet\"\r\n            variant=\"solo-filled\"\r\n            placeholder=\"Press Enter to add\" \r\n            v-model=\"temp\"\r\n            maxLength=\"1\"\r\n            clearable\r\n            hideDetails\r\n            @keydown.enter=\"addAlphabet(temp); temp = ''\" />\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useAlphabetStore } from '@/stores/alphabetStore';\r\nimport { computed, ref } from 'vue';\r\n\r\nexport default {\r\n    setup () {\r\n        \r\n        const store = useAlphabetStore(),\r\n            alphabet = computed(() => store.alphabet);\r\n\r\n        const temp = ref('');\r\n\r\n        const resetAble = computed(() => {\r\n\r\n            return alphabet.value.length !== 2 ||\r\n                !alphabet.value.every(v => v === 'a' || v === 'b');\r\n        })\r\n\r\n        return {\r\n            temp,\r\n            alphabet,\r\n            resetAlphabet: () => store.resetAlphabet(),\r\n            removeAlphabet: c => store.removeAlphabet(c),\r\n            addAlphabet: c => store.addAlphabet(c),\r\n\r\n            resetAble\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import { render } from \"./AlphabetLister.vue?vue&type=template&id=3a8c942e\"\nimport script from \"./AlphabetLister.vue?vue&type=script&lang=js\"\nexport * from \"./AlphabetLister.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div>\r\n        <v-dialog\r\n            @click:outside=\"cancel\"\r\n            v-model=\"open\"\r\n            width=\"auto\"\r\n            min-width=\"300px\">\r\n            <v-sheet class=\"flex gap-2 p-4 pt-3 flex-col\">\r\n                <div class=\"text-2xl pb-1\">Create Transition \r\n                    <div class=\"text-subtitle-1 text-neutral-400\">\r\n                        {{ modeStore.linkStart }} → {{ modeStore.linkEnd }}\r\n                    </div>\r\n                </div>\r\n                <v-btn-toggle\r\n                    multiple\r\n                    class=\"flex-col h-auto\"\r\n                    rounded=\"0\"\r\n                    v-model=\"selectedItems\">\r\n                    <v-btn v-for=\"a in alphabet\" :key=\"a\"\r\n                        style=\"height: 36px;\" :value=\"a\">\r\n                        {{  a }}\r\n                    </v-btn>\r\n                </v-btn-toggle>\r\n                <div>\r\n                    <v-btn :disabled=\"selectedItems.length === 0\" block color=\"success\" @click=\"add\">\r\n                        Add\r\n                    </v-btn>\r\n                </div>\r\n            </v-sheet>\r\n        </v-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useAlphabetStore } from '@/stores/alphabetStore';\r\nimport { useModeStore } from '@/stores/modeStore';\r\nimport { useTransitionStore } from '@/stores/transitionStore';\r\nimport { useMainStore } from '@/stores/mainStore';\r\nimport { watch } from 'vue';\r\nimport { ref } from 'vue';\r\nimport { computed } from 'vue';\r\n\r\nexport default {\r\n    setup () {\r\n        const modeStore = useModeStore();\r\n        const alphabetStore = useAlphabetStore();\r\n        const transitionStore = useTransitionStore();\r\n        const mainStore = useMainStore();\r\n\r\n        const open = computed({\r\n            get: () => modeStore.openTransitionDialog,\r\n            set: v => modeStore.openTransitionDialog = v\r\n        });\r\n\r\n        watch(open, v => {\r\n            const { linkStart: start, linkEnd: end } = modeStore;\r\n            // Find existing label\r\n            const ex = transitionStore.getTransition(start, end);\r\n            if(ex === undefined) return;\r\n\r\n            selectedItems.value.push(...ex.v);\r\n\r\n            mainStore.inputFocus();\r\n        })\r\n\r\n        const alphabet = computed(() => alphabetStore.alphabet);\r\n        const selectedItems = ref([]);\r\n\r\n        const cancel = () => {\r\n            modeStore.linkReset();\r\n            selectedItems.value.splice(0);\r\n        }\r\n\r\n        const add = () => {\r\n\r\n            transitionStore.addTransition({\r\n                labels: [...selectedItems.value],\r\n                from: modeStore.linkStart,\r\n                to: modeStore.linkEnd\r\n            })\r\n\r\n            selectedItems.value.splice(0);\r\n            open.value = false;\r\n            modeStore.linkReset();\r\n        }\r\n\r\n        return {\r\n            open,\r\n            alphabet,\r\n            modeStore,\r\n            selectedItems,\r\n            \r\n            cancel,\r\n            add,\r\n\r\n            transitionStore,\r\n            modeStore\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.v-btn-toggle {\r\n    flex-direction: column;\r\n}\r\n</style>","import { render } from \"./TransitionFab.vue?vue&type=template&id=2a8447b3&scoped=true\"\nimport script from \"./TransitionFab.vue?vue&type=script&lang=js\"\nexport * from \"./TransitionFab.vue?vue&type=script&lang=js\"\n\nimport \"./TransitionFab.vue?vue&type=style&index=0&id=2a8447b3&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2a8447b3\"]])\n\nexport default __exports__","<template>\r\n    <div v-if=\"state !== undefined\" class=\"flex flex-grow flex-col gap-2\">\r\n        <div class=\"flex justify-between items-end\">\r\n            <div class=\"text-2xl\">State</div>\r\n            <span class=\"text-caption text-neutral-500\">[{{ state.pos.x.toFixed(0) }}, {{ state.pos.y.toFixed(0) }}]</span>\r\n        </div>\r\n        <div>\r\n            <v-text-field\r\n                v-model=\"state.label\"\r\n                hide-details\r\n                variant=\"solo-filled\"\r\n                label=\"State Label\"\r\n                density=\"compact\"\r\n                clearable>\r\n\r\n            </v-text-field>\r\n        </div>\r\n        <div>\r\n            <v-btn\r\n                block\r\n                color=\"#DC143C\"\r\n                @click=\"stateStore.removeState(label)\">\r\n                Delete State\r\n            </v-btn>\r\n        </div>\r\n\r\n        <div class=\"px-2\">\r\n            <div>\r\n                <v-switch\r\n                    hide-details\r\n                    density=\"compact\"\r\n                    :true-value=\"true\"\r\n                    :false-value=\"false\"\r\n                    v-model=\"tempIsStart\"\r\n                    @change=\"changeStartStatus\"\r\n                    :label=\"'Starting State'\">\r\n                </v-switch>\r\n            </div>\r\n            <div>\r\n            <v-switch\r\n                hide-details\r\n                density=\"compact\"\r\n                v-model=\"state.isFinish\"\r\n                :label=\"'Ending State'\"\r\n                @change=\"mainStore.genRegex()\">\r\n            </v-switch>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"text-subtitle-1\">\r\n            Transitions\r\n        </div>\r\n\r\n        <div class=\"flex flex-col flex-grow gap-2\">\r\n            <div v-for=\"(t, index) in transArr\" :key=\"t.to\"\r\n            class=\"flex gap-2\">\r\n                <div class=\"text-button w-12 flex justify-center items-center overflow-hidden\">\r\n                    <v-btn @click=\"setSelectedState(t.to)\">\r\n                        {{ t.to }}\r\n                    </v-btn>\r\n                </div>\r\n                <div class=\"flex-grow\">\r\n                    <v-autocomplete \r\n                        clearable\r\n                        chips\r\n                        label=\"Labels\"\r\n                        :items=\"alphabet\"\r\n                        multiple\r\n                        hide-details\r\n                        variant=\"outlined\"\r\n                        @update:model-value=\"v => updateTransition(t.to, v, index)\"\r\n                        v-model=\"t.vs\"\r\n                        density=\"compact\"/>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"flex flex-col gap-2\">\r\n\r\n            <v-divider></v-divider>\r\n\r\n            <div class=\"flex flex-col gap-2 pt-3\">\r\n                <div class=\"\">\r\n                    <v-autocomplete \r\n                        hide-details\r\n                        density=\"compact\"\r\n                        append-icon=\"\"\r\n                        variant=\"outlined\"\r\n                        label=\"Destination State\"\r\n                        :items=\"stateList\"\r\n                        v-model=\"tempLabel\"/>\r\n                </div>\r\n                <div class=\"flex-grow\">\r\n                    <v-autocomplete \r\n                        clearable\r\n                        chips\r\n                        label=\"Transition\"\r\n                        :items=\"alphabet\"\r\n                        append-icon=\"\"\r\n                        multiple\r\n                        hide-details\r\n                        variant=\"outlined\"\r\n                        v-model=\"tempTransitions\"\r\n                        density=\"compact\"/>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <v-btn block color=\"success\" @click=\"addTransition\"> \r\n                    Add Transition\r\n                </v-btn>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useAlphabetStore } from '@/stores/alphabetStore';\r\nimport { useMainStore } from '@/stores/mainStore';\r\nimport { useStateStore } from '@/stores/stateStore';\r\nimport { useTransitionStore } from '@/stores/transitionStore';\r\nimport { reactive, onMounted } from 'vue';\r\nimport { ref } from 'vue';\r\nimport { watch } from 'vue';\r\nimport { computed } from 'vue';\r\n\r\nexport default {\r\n    setup () {\r\n        const mainStore = useMainStore(),\r\n            transitionStore = useTransitionStore(),\r\n            alphabetStore = useAlphabetStore(),\r\n            stateStore = useStateStore();\r\n\r\n        const state = computed(() => mainStore.selected),\r\n            label = computed(() => state.value?.label),\r\n            alphabet = computed(() => alphabetStore.alphabet);\r\n\r\n        const transArr = reactive([]);\r\n\r\n        const associatedTransitions = computed(() => transitionStore.getTransitionsFrom(label.value));\r\n\r\n        const stateList = computed(() => stateStore.states.map(v =>  v.label)),\r\n            tempLabel = ref(''), tempTransitions = ref([]);\r\n\r\n        function updateTransArr(){\r\n            transArr.splice(0);\r\n            associatedTransitions.value.forEach(at => {\r\n                transArr.push({\r\n                    to: at.to.label,\r\n                    vs: [...at.v]\r\n                })\r\n            })\r\n        }\r\n\r\n        \r\n        const tempIsStart = ref(false);\r\n\r\n        // watch(tempIsStart, v => {\r\n        //     if(v) stateStore.setStart(label.value);\r\n        //     else if(state.value) state.value.isStart = false;\r\n        // })\r\n\r\n        const changeStartStatus = () => {\r\n            const v = tempIsStart.value;\r\n            if(v) stateStore.setStart(label.value);\r\n            else if(state.value) state.value.isStart = false;\r\n        }\r\n\r\n        watch(label, v => {\r\n            transArr.splice(0);\r\n            tempIsStart.value = false;\r\n            if(v === undefined) return;\r\n            updateTransArr();\r\n            tempIsStart.value = state.value.isStart;\r\n        })\r\n\r\n        const updateTransition = (to, v, index) => {\r\n            if(v.length === 0){\r\n                transitionStore.removeTransition(label.value, to);\r\n                transArr.splice(index, 1);\r\n                return;\r\n            }\r\n\r\n            transitionStore.addTransition({\r\n                labels: [...v],\r\n                from: label.value,\r\n                to: to\r\n            })\r\n        }   \r\n\r\n        const setSelectedState = label => {\r\n            const ts = stateStore.getState(label);\r\n            mainStore.select(ts);\r\n        }\r\n\r\n        const addTransition = () => {\r\n            transitionStore.addTransition({\r\n                labels: [...tempTransitions.value],\r\n                from: label.value,\r\n                to: tempLabel.value\r\n            })\r\n\r\n            updateTransArr();\r\n        }\r\n\r\n        watch(state, () => {\r\n            if(state.value !== undefined) return;\r\n            tempLabel.value = '';\r\n            tempTransitions.value.splice(0);\r\n        })\r\n\r\n        return {\r\n            state,\r\n            label,\r\n            associatedTransitions,\r\n            alphabet,\r\n            updateTransition,\r\n            transArr,\r\n            setSelectedState,\r\n            stateStore,\r\n            stateList,\r\n            tempLabel,\r\n            tempTransitions,\r\n            addTransition,\r\n            tempIsStart,\r\n            mainStore,\r\n            changeStartStatus\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import { render } from \"./StateHelper.vue?vue&type=template&id=621d8f72\"\nimport script from \"./StateHelper.vue?vue&type=script&lang=js\"\nexport * from \"./StateHelper.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <v-btn\r\n        variant=\"tonal\"\r\n        size=\"small\"\r\n        icon>\r\n        \r\n        <v-icon>mdi-cog</v-icon>\r\n\r\n        <v-dialog\r\n            v-model=\"expand\"\r\n            activator=\"parent\"\r\n            width=\"500px\"\r\n            max-height=\"80vh\">\r\n            <v-sheet\r\n            class=\"px-3 p-2 flex flex-col pb-4\">\r\n\r\n                <div class=\"text-2xl\">\r\n                    Settings\r\n                </div>\r\n\r\n                <div class=\"flex-grow overflow-y-auto flex flex-col gap-2 pt-2\">\r\n                    \r\n                    <div class=text-caption>Conversion</div>\r\n                    <div class=\"pl-5 flex flex-col \">\r\n                        <!--  Simplification -->\r\n                        <div>\r\n                            <v-switch\r\n                                v-model=\"settingsStore.simplifyDFARegex\"\r\n                                hide-details\r\n                                density=\"compact\">\r\n\r\n                                <template v-slot:label>\r\n                                    Simplified DFA-Regex\r\n                                    <span class=\"ml-1 bg-neutral-500/50 rounded-full w-5 h-5 flex justify-center items-center\">\r\n                                        \r\n                                        <v-icon size=\"xs\">mdi-help</v-icon>\r\n\r\n                                        <v-tooltip\r\n                                            activator=\"parent\">\r\n                                            Optimizes the result conversion to its most minimized version. <br>\r\n                                            $ - symbolizes the empty string\r\n                                        </v-tooltip>\r\n                                    </span>\r\n                                </template>\r\n\r\n                            </v-switch>\r\n                        </div>\r\n                        <!-- NFA MODE -->\r\n                        <div>\r\n                            <v-switch\r\n                                v-model=\"settingsStore.nfaMode\"\r\n                                hide-details\r\n                                density=\"compact\">\r\n\r\n                                <template v-slot:label>\r\n                                    NFA Mode\r\n                                </template>\r\n\r\n                            </v-switch>\r\n                        </div>\r\n                        <!-- Hide Epsilon -->\r\n                        <div>\r\n                            <v-switch\r\n                                v-model=\"settingsStore.hideEpsilon\"\r\n                                hide-details\r\n                                density=\"compact\">\r\n\r\n                                <template v-slot:label>\r\n                                    Hide Epsilon\r\n                                </template>\r\n\r\n                            </v-switch>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"text-caption\">Miscellaneous</div>\r\n                    <div class=\"px-5 flex flex-col gap-2\">\r\n                        <div>\r\n                            <v-switch\r\n                                v-model=\"settingsStore.saveFSMOnExit\"\r\n                                hide-details\r\n                                density=\"compact\"\r\n                                label=\"Save FSM on exit\">\r\n\r\n                            </v-switch>\r\n                        </div>\r\n                        <div>\r\n                            <v-btn elevation=\"3\" block\r\n                                @click=\"copyFormalSpecs\">\r\n                                Copy current machine formal specifications\r\n                            </v-btn>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <!-- <div class=\"text-caption\">Dev</div>\r\n                    <div class=px-5 flex flex-col gap-2>\r\n                        <div>\r\n                            <v-btn\r\n                                @click=\"log\">\r\n                                Log\r\n                            </v-btn>\r\n                        </div>\r\n                    </div> -->\r\n                </div>\r\n\r\n            </v-sheet>\r\n        </v-dialog>\r\n\r\n    </v-btn>\r\n</template>\r\n\r\n<script setup>\r\nimport { FSM } from '@/commons/graph/Converter';\r\nimport Util from '../commons/Util';\r\nimport { useMainStore } from '@/stores/mainStore';\r\nimport { useSettingStore } from '@/stores/settingsStore';\r\nimport { ref } from 'vue';\r\n\r\n\r\nconst mainStore = useMainStore();\r\n\r\nconst settingsStore = useSettingStore();\r\n\r\nconst expand = ref(false);\r\n\r\nconst copyFormalSpecs = () => {\r\n    const text = mainStore.formal_specs;\r\n    Util.copyToClipboard(text);\r\n}\r\n\r\nconst log = () => {\r\n    const str = mainStore.formal_specs;\r\n    const fsm = new FSM(str);\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import script from \"./SettingsMenu.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SettingsMenu.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n    <div class=\"flex justify-center\">\r\n        <v-sheet class=\"px-4 p-2 pb-4 gap-2 d-flex flex-col\" rounded min-width=\"300px\">\r\n            <div class=\"text-xl\">Save File As</div>\r\n            <div>\r\n                <v-text-field \r\n                    variant=\"outlined\"\r\n                    label=\"Filename\"\r\n                    v-model=\"filename\"\r\n                    :rules=\"[v => !!v || 'Please assign a file name']\"/>\r\n            </div>\r\n            <div>\r\n                <v-btn color=\"success\" block :disabled=\"filename === '' || filename === null\"\r\n                    @click=\"save\">Save</v-btn>\r\n            </div>\r\n        </v-sheet>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue';\r\nimport { useFileStore } from '../stores/fileStore';\r\n\r\nconst fileStore = useFileStore();\r\n\r\nconst filename = ref('');\r\n\r\nconst save = () => {\r\n    fileStore.saveDFA(filename.value);\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import script from \"./SaveFile.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SaveFile.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=4b88bf21\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=4b88bf21&lang=scss\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","// Styles\nimport '@mdi/font/css/materialdesignicons.css'\nimport 'vuetify/styles'\n\n// Vuetify\nimport { createVuetify } from 'vuetify'\nimport * as directives from 'vuetify/directives';\nimport * as components from 'vuetify/components';\n\nexport default createVuetify({\n  directives,\n  components,\n  theme: {\n    defaultTheme: 'dark'\n  }\n})","/**\n * plugins/webfontloader.js\n *\n * webfontloader documentation: https://github.com/typekit/webfontloader\n */\n\nexport async function loadFonts () {\n  const webFontLoader = await import(/* webpackChunkName: \"webfontloader\" */'webfontloader')\n\n  webFontLoader.load({\n    google: {\n      families: ['Roboto:100,300,400,500,700,900&display=swap'],\n    },\n  })\n}\n","import { createApp } from 'vue'\r\nimport App from './App.vue'\r\nimport './index.css';\r\nimport vuetify from './plugins/vuetify'\r\nimport { loadFonts } from './plugins/webfontloader'\r\nimport { createPinia } from 'pinia'\r\n\r\nimport '@mdi/font/css/materialdesignicons.css'\r\n\r\nconst pinia = createPinia()\r\n\r\nloadFonts()\r\n\r\ncreateApp(App)\r\n  .use(pinia)\r\n  .use(vuetify)\r\n  .mount('#app')\r\n","/*\n * noam - JavaScript library for working with automata and grammars for \n *        regular and context-free languages. https://github.com/izuzak/noam\n *\n * Copyright 2012 Ivan Zuzak, Ivan Budiselic\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function (noam) {\n\n  /*\n   * Expose the module to the 'world' when loaded via CommonJS/NodeJS, \n   * AMD and <script> tags.\n   */\n\n  if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n    module.exports = noam; // NodeJS\n  }\n  \n  if (typeof exports !== 'undefined' && typeof exports !== \"function\") {\n    exports.noam = noam; // CommonJs\n  }\n\n  if (typeof define === \"function\" && define.amd) {\n    define('noam', [], function () { return noam; } ); // AMD\n  }\n\n  if (typeof window !== 'undefined') {\n    window.noam = noam;  // <script>\n  }\n\n}((function () {\n\n  var noam = {};\n\n  noam.util = {};\n\n  // \"deep\" compare of two objects\n  // taken from http://stackoverflow.com/questions/1068834/object-comparison-in-javascript\n  noam.util.areEquivalent = function(object1, object2) {\n    if (object1 === object2) {\n      return true;\n    }\n\n    if (object1 instanceof Date && object2 instanceof Date) {\n      return object1.getTime() === object2.getTime();\n    }\n\n    if (object1 instanceof RegExp && object2 instanceof RegExp) {\n      return object1.source === object2.source &&\n             object1.global === object2.global &&\n             object1.multiline === object2.multiline &&\n             object1.lastIndex === object2.lastIndex &&\n             object1.ignoreCase === object2.ignoreCase;\n    }\n\n    if (!(object1 instanceof Object) || !(object2 instanceof Object) ) {\n      return false;\n    }\n\n    if (typeof object1 === 'undefined' || typeof object2 === 'undefined') {\n      return false;\n    }\n\n    if (object1.constructor !== object2.constructor) {\n      return false;\n    }\n\n    for (var p in object1) {\n      if (!(p in object2)) {\n        return false;\n      }\n\n      if (object1[p] === object2[p]) {\n        continue;\n      }\n\n      if (typeof(object1[p]) !== \"object\") {\n        return false;\n      }\n\n      if (!(noam.util.areEquivalent(object1[p], object2[p]))) {\n        return false;\n      }\n    }\n\n    for (p in object2) {\n      if (!(p in object1)) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  // check if array arr contains obj starting from index startIndex\n  noam.util.contains = function(arr, obj, startIndex) {\n    startIndex = startIndex ? startIndex : 0;\n\n    for (var i=startIndex; i<arr.length; i++) {\n      if (noam.util.areEquivalent(arr[i], obj)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // returns the index of the leftmost obj instance in arr starting from startIndex or -1\n  // if no instance of obj is found\n  noam.util.index = function(arr, obj, startIndex) {\n    var i = startIndex || 0;\n    while (i < arr.length) {\n      if (noam.util.areEquivalent(arr[i], obj)) {\n        return i;\n      }\n      i++;\n    }\n    return -1;\n  };\n\n  // check if array arr1 contains all elements from array arr2\n  noam.util.containsAll = function(arr1, arr2) {\n    for (var i=0; i<arr2.length; i++) {\n      if (!(noam.util.contains(arr1, arr2[i]))) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  // check if array arr1 contains any element from array arr2\n  noam.util.containsAny = function(arr1, arr2) {\n    for (var i=0; i<arr2.length; i++) {\n      if (noam.util.contains(arr1, arr2[i])) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // check if arrays arr1 and arr2 contain the same elements\n  noam.util.areEqualSets = function(arr1, arr2) {\n    if (arr1.length !== arr2.length) {\n      return false;\n    }\n\n    for (var i=0; i<arr1.length; i++) {\n      if (!(noam.util.contains(arr2, arr1[i]))) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  // check if array arr1 contains the set obj\n  noam.util.containsSet = function(arr1, obj) {\n    for (var i=0; i<arr1.length; i++) {\n      if (noam.util.areEqualSets(arr1[i], obj)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // returns an unsorted array representation of the union of the two arrays arr1 and arr2\n  // with each element included exactly once, regardless of the count in arr1 and arr2\n  noam.util.setUnion = function(arr1, arr2) {\n    var res = [];\n    var i;\n    for (i=0; i<arr1.length; i++) {\n      // this will not include duplicates from arr1\n      if (!noam.util.contains(res, arr1[i])) {\n        res.push(arr1[i]);\n      }\n    }\n    for (i=0; i<arr2.length; i++) {\n      if (!noam.util.contains(res, arr2[i])) {\n        res.push(arr2[i]);\n      }\n    }\n    return res;\n  };\n\n  // returns an unsorted array representation of the intersection of the two\n  // arrays arr1 and arr2 with each element included exactly once, regardless\n  // of the count in arr1 and arr2\n  noam.util.setIntersection = function(arr1, arr2) {\n    var res = [];\n    var i;\n    for (i=0; i<arr1.length; i++) {\n      if (noam.util.contains(arr2, arr1[i])) {\n        res.push(arr1[i]);\n      }\n    }\n\n    return res;\n  };\n\n  // make a deep clone of an object\n  noam.util.clone = function(obj) {\n    return JSON.parse(JSON.stringify(obj));\n  };\n\n\n  // Returns an object that is basically an integer reference useful for counting\n  // across multiple function calls. The current value can be accessed through the\n  // value property.\n  // See the noam.re.tree.toAutomaton function for a usage example.\n  noam.util.makeCounter = (function() {\n    function getAndAdvance() {\n      return this.value++;\n    }\n\n    function makeCounter(init) {\n      return {\n        value: init,\n        getAndAdvance: getAndAdvance\n      };\n    }\n\n    return makeCounter;\n  })();\n\n\n  // Returns a random integer from the interval [from, to].\n  noam.util.randint = function(from, to) {\n    return Math.floor(Math.random()*(to-from+1)) + from;\n  };\n\n  var structure = {};\n\n  /* General purpose hashtable implementation.\n   * Note that all the performance guarantees assume (as usual for hashtables) that\n   *    1) hashing keys is O(1)\n   *    2) comparing keys for equality is O(1)\n   *    3) array access in JS is O(1)\n   * In other words, the guarantees specify the number of these\n   * three operations for any hashtable operation, rather than\n   * actual time.\n   */\n  (function() {\n    var CAPACITY_CHOICES = [5, 11, 23, 47, 97, 197, 397, 797, 1597, 3203, 6421, 12853,\n        25717, 51437, 102877, 205759, 411527, 823117, 1646237, 3292489, 6584983,\n        13169977, 26339969, 52679969, 105359939];\n\n    var DEFAULT_INITIAL_CAPACITY_IDX = 0;\n    var HASH_MASK = (1<<31) - 1; // keeps everything nonnegative int32\n    var LF_HIGH = 0.75; // load factor upper limit\n    var LF_LOW = 0.25; // load factor lower limit\n\n    // See http://perfectionkills.com/instanceof-considered-harmful-or-how-to-write-a-robust-isarray/\n    function _isArray(obj) {\n      return Object.prototype.toString.call(obj) === \"[object Array]\";\n    }\n\n    function _get_capacity_index(wanted) {\n      wanted = Math.max(wanted, CAPACITY_CHOICES[0]);\n      wanted = Math.min(wanted, CAPACITY_CHOICES[CAPACITY_CHOICES.length-1]);\n      var lo = 0;\n      var hi = CAPACITY_CHOICES.length - 1;\n      var mid;\n      // binary search for the smallest capacity no smaller than wanted\n      while (lo < hi) {\n        mid = lo + Math.floor((hi-lo)/2);\n        if (CAPACITY_CHOICES[mid] >= wanted) {\n          hi = mid;\n        } else {\n          lo = mid + 1;\n        }\n      }\n      return lo;\n    }\n\n    // TODO: needs serious testing\n    function _defaultHash(obj) {\n      var h, i;\n      if (obj === undefined) { // undefined might be a \"value\" of some property\n        return 12345; // arbitrary constant\n      }\n      if (obj === null) {\n        return 54321; // arbitrary constant\n      }\n      if (typeof obj===\"boolean\" || typeof obj===\"number\") {\n        return obj & HASH_MASK;\n      }\n      if (typeof obj===\"string\") {\n        h = 5381;\n        for (i=0; i<obj.length; i++) {\n          h = ((h*33) ^ obj.charCodeAt(i)) & HASH_MASK;\n        }\n        return h;\n      }\n      if (_isArray(obj)) {\n        h = 6421;\n        for (i=0; i<obj.length; i++) {\n          h = ((h*37) ^ _defaultHash(obj[i])) & HASH_MASK;\n        }\n        return h;\n      }\n\n      // objects\n      var props = [];\n      for (i in obj) {\n        if (!(obj.hasOwnProperty(i))) {\n          continue;\n        }\n        props.push(i);\n      }\n      props.sort(); // sort them so that logically equal object get the same hash\n\n      h = 3203;\n      for (i=0; i<props.length; i++) {\n        // hash both the property name and its value\n        h = ((((h*39) ^ _defaultHash(props[i])) * 43) ^ _defaultHash(obj[props[i]])) & HASH_MASK;\n      }\n      return h;\n    }\n\n    // \"deep\" compare of two objects\n    // taken from http://stackoverflow.com/questions/1068834/object-comparison-in-javascript\n    function _defaultEquals(object1, object2) {\n      if (object1 === object2) {\n        return true;\n      }\n\n      if (object1 instanceof Date && object2 instanceof Date) {\n        return object1.getTime() === object2.getTime();\n      }\n\n      if (object1 instanceof RegExp && object2 instanceof RegExp) {\n        return object1.source === object2.source &&\n               object1.global === object2.global &&\n               object1.multiline === object2.multiline &&\n               object1.lastIndex === object2.lastIndex &&\n               object1.ignoreCase === object2.ignoreCase;\n      }\n\n      if (!(object1 instanceof Object) || !(object2 instanceof Object) ) {\n        return false;\n      }\n\n      if (typeof object1 === 'undefined' || typeof object2 === 'undefined') {\n        return false;\n      }\n\n      if (object1.constructor !== object2.constructor) {\n        return false;\n      }\n\n      for (var p in object1) {\n        if (!(p in object2)) {\n          return false;\n        }\n\n        if (object1[p] === object2[p]) {\n          continue;\n        }\n\n        if (typeof(object1[p]) !== \"object\") {\n          return false;\n        }\n\n        if (!(_defaultEquals(object1[p], object2[p]))) {\n          return false;\n        }\n      }\n\n      for (p in object2) {\n        if (!(p in object1)) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    /* Constructor for hash chain nodes.\n     *\n     * Each node has three properties:\n     *  - key: the key of the key-value pair\n     *  - value: the value of the key-value pair\n     *  - next: either another _HashChainNode or undefined if this is the last node\n     *          of the chain\n     */\n    function _HashChainNode(key, value) {\n      this.key = key;\n      this.value = value;\n    }\n\n    /* Constructor for an empty hash chain used for collision resolution.\n     *\n     * Every _HashChain has just one property:\n     *  - head: the first _HashChainNode of the chain or undefined if the chain is\n     *          empty\n     */\n    function _HashChain() {\n      // intentionally empty\n    }\n\n    // Returns true iff the chain is empty.\n    _HashChain.prototype.isEmpty = function() {\n      return this.head === undefined;\n    };\n\n    // Adds the new node to the front of the chain.\n    _HashChain.prototype.insertHead = function(node) {\n      node.next = this.head;\n      this.head = node;\n    };\n\n    /* Removes the successor of @a node from the chain. It is assumed that\n     * the successor exists.\n     *\n     * If @a node equals undefined, removes the head of the chain.\n     */\n    _HashChain.prototype.removeSuccessor = function(node) {\n      if (node === undefined) {\n        this.head = this.head.next;\n      } else {\n        node.next = node.next.next;\n      }\n    };\n\n    /* Inserts the key-value pair into the chain.\n     * @a H is the HashTable that contains this chain.\n     *\n     * Returns true iff @a key is a new key that was not previously in the table.\n     */\n    _HashChain.prototype.put = function(H, key, value) {\n      // first search for the key\n      var iter = this.iterator();\n      while (iter.hasNext()) {\n        var node = iter.next();\n        if (H.equals(key, node.key)) {\n          // old key; just replace the value\n          node.value = value;\n          return false;\n        }\n      }\n      // new key\n      this.insertHead(new _HashChainNode(key, value));\n      return true;\n    };\n\n    /* Returns the value associated with @a key in the chain or undefined\n     * if @a key is not found in the chain.\n     */\n    _HashChain.prototype.get = function(H, key) {\n      var iter = this.iterator();\n      while (iter.hasNext()) {\n        var node = iter.next();\n        if (H.equals(key, node.key)) {\n          return node.value;\n        }\n      }\n      return undefined;\n    };\n\n    /* Removes the key-value pair with the given key from the chain. Does nothing\n     * if there is no key-value pair with the given key in the chain.\n     *\n     * Returns true iff a key-value pair was actually removed.\n     */\n    _HashChain.prototype.remove = function(H, key) {\n      var iter = this.iterator();\n      var prev; // intentionally undefined\n      while (iter.hasNext()) {\n        var node = iter.next();\n        if (H.equals(key, node.key)) {\n          this.removeSuccessor(prev);\n          return true;\n        }\n        prev = node;\n      }\n      return false;\n    };\n\n    /* Constructor for a hash chain iterator.\n     *\n     * Every iterator has two methods:\n     *  - hasNext: returns true iff there is another node in the chain\n     *  - next: returns the next node in the chain or throws if the iterator is\n     *          exhausted\n     *\n     * If the hash chain changes in any way between the construction of the\n     * iterator and a call to one of its methods, the behavior is undefined.\n     */\n    function _HashChainIterator(chain) {\n      this.node = chain.head;\n    }\n    _HashChainIterator.prototype.hasNext = function() {\n      return this.node !== undefined;\n    };\n    _HashChainIterator.prototype.next = function() {\n      if (!this.hasNext()) {\n        throw new Error(\"HashTable internal error: \" +\n            \"called _HashChainIterator.next on exhausted iterator\");\n      }\n      var retval = this.node;\n      this.node = retval.next;\n      return retval;\n    };\n\n    // Returns a new iterator for the hash chain.\n    _HashChain.prototype.iterator = function() {\n      return new _HashChainIterator(this);\n    };\n\n\n    /* Resizes the HashTable @a H to have capacity CAPACITY_CHOICES[to_cap_idx].\n     * Throws if @a to_cap_idx >= CAPACITY_CHOICES.length.\n     * Does nothing if @a to_cap_idx < 0, i.e. the HashTable never decreases below\n     * CAPACITY_CHOICES[0] capacity.\n     *\n     * Takes O(n) time where n is the number of mappings in the HashTable.\n     */\n    function _resize(H, to_cap_idx) {\n      if (to_cap_idx >= CAPACITY_CHOICES.length) {\n        throw new Error(\"Capacity of HashTable can't grow beyond \" + CAPACITY_CHOICES[CAPACITY_CHOICES.length - 1]);\n      }\n      if (to_cap_idx >= 0) {\n        var old_cap = H.capacity;\n        var old_slots = H.slots;\n\n        H.capacity_index = to_cap_idx;\n        H.capacity = CAPACITY_CHOICES[to_cap_idx];\n        H.slots = [];\n        for (var i=0; i<old_cap; i++) {\n          if (old_slots[i] !== undefined) {\n            var chain_iter = old_slots[i].iterator();\n            while (chain_iter.hasNext()) {\n              H._putNodeRsz(chain_iter.next());\n            }\n          }\n        }\n      }\n    }\n\n    // Returns the slot index for @a key in the hashtable @a H.\n    function _getSlotIndex(H, key) {\n      return H.hash(key) % H.capacity; // division method\n    }\n\n    /* Constructor for HashTable. To create an empty HashTable, do something like\n     * var H = new structure.HashTable();\n     *\n     * @a cfg is optional and can contain any or all of the following properties\n     *    - initial_capacity: a number that is a hint for the initial capacity\n     *        - defaults to an implementation defined number\n     *    - hash: a function that takes an object and returns a nonnegative 32-bit integer\n     *        - the usual requirements for this function apply\n     *           - it must be consistent, i.e. return the same value for the same object\n     *             (if the object doesn't change)\n     *           - if two objects are equal by the client's definition of equality,\n     *             this function must return the same value for both of them\n     *        - defaults to _defaultHash\n     *   - equals: a function that takes two objects and returns true iff they are logically equal\n     *        - the usual requirements for this function apply\n     *           - it must be reflexive, symmetric and transitive\n     *           - it must be consistent i.e. return the same value for unchanged arguments every\n     *             time it's called\n     *        - defaults to _defaultEqauls\n     *\n     * If you provide either hash or equals, you probably want to provide both\n     */\n    structure.HashTable = function(cfg) {\n      this.capacity_index = DEFAULT_INITIAL_CAPACITY_IDX;\n      if (cfg) {\n        if (cfg.initial_capacity) {\n          this.capacity_index = _get_capacity_index(cfg.initial_capacity);\n        }\n        if (cfg.hash) { // otherwise we use the prototype one\n          this.hash = cfg.hash;\n        }\n        if (cfg.equals) { // otherwise we use the prototype one\n          this.equals = cfg.equals;\n        }\n      }\n\n      // this is redundan't information, but keeps code somewhat cleaner\n      this.capacity = CAPACITY_CHOICES[this.capacity_index];\n      this.numkeys = 0; // start out empty\n\n      // we will use undefined as the indicator for empty slots so\n      // we don't actually need to \"allocate\" the capacity because\n      // JS arrays don't actually have bounds and a[i] returns\n      // undefined if the ith element is \"out of bounds\"...\n      // however, take care to never use this.slots.length as it will\n      // be meaningless\n      this.slots = [];\n    };\n\n    // defaults for hash and equals\n    structure.HashTable.prototype.hash = _defaultHash;\n    structure.HashTable.prototype.equals = _defaultEquals;\n\n    // Returns the load factor of the HashTable, i.e. the ratio\n    // of occupied slots to the capacity.\n    structure.HashTable.prototype.loadFactor = function() {\n      return this.numkeys / this.capacity;\n    };\n\n    /* Add the key-value pair to the HashTable.\n     * Throws if @a key or @a value equals undefined.\n     *\n     * Takes O(1) time amortized, assuming uniform hashing.\n     *\n     * Only references to the key and value are stored, i.e. the client must do defensive\n     * copies if they are required. If the key is mutable and changes after this operation\n     * is performed, the behavior is undefined (the HashTable will most likely become\n     * invalid and unpredictibly useless).\n     * Changes to the value object are allowed but are in most situations probably\n     * an indicator of bad design.\n     */\n    structure.HashTable.prototype.put = function(key, value) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.put with key === undefined\");\n      }\n\n      if (value === undefined) {\n        throw new Error(\"called HashTable.put with value === undefined\");\n      }\n\n      var h = _getSlotIndex(this, key);\n      if (this.slots[h] === undefined) {\n        this.slots[h] = new _HashChain();\n      }\n      if (this.slots[h].put(this, key, value)) {\n        ++this.numkeys;\n        if (this.loadFactor() > LF_HIGH) {\n          _resize(this, this.capacity_index + 1);\n        }\n      }\n    };\n\n    /* This is an internal put method that reuses existing _HashChainNode objects\n     * to reduce garbage generation when the table gets resized.\n     *\n     * Don't use this outside of resizing functionality!\n     */\n    structure.HashTable.prototype._putNodeRsz = function(node) {\n      // we don't check the validity of node.key and node.value because\n      // it is assumed they are valid as they are already in a preexisting node\n      var h = _getSlotIndex(this, node.key);\n      if (this.slots[h] === undefined) {\n        this.slots[h] = new _HashChain();\n      }\n      // don't need to actually iterate the chain to search for matching keys\n      // because we know that the keys were unique prior to resizing\n      this.slots[h].insertHead(node);\n      // we don't check the load factor because we know that we have just\n      // recently resized so no further resizing will be needed\n    };\n\n    /* Returns the value associated with @a key in the HashTable or\n     * undefined if @a key is not found.\n     *\n     * Throws if @a key equals undefined.\n     *\n     * Takes O(1) time, assuming uniform hashing.\n     */\n    structure.HashTable.prototype.get = function(key) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.get with key === undefined\");\n      }\n\n      var h = _getSlotIndex(this, key);\n      var slot = this.slots[h];\n      return slot===undefined ? undefined : slot.get(this, key);\n    };\n\n    /* Removes @a key from the HashTable. If @a key is not in the HashTable,\n     * this operation does nothing.\n     *\n     * Throws if @a key equals undefined.\n     *\n     * Takes O(1) time ammortized, assuming uniform hashing.\n     */\n    structure.HashTable.prototype.remove = function(key) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.remove with key === undefined\");\n      }\n\n      var h = _getSlotIndex(this, key);\n      var slot = this.slots[h];\n      if (slot === undefined) {\n        return;\n      }\n      if (slot.remove(this, key)) {\n        --this.numkeys;\n        if (this.loadFactor() < LF_LOW) {\n          _resize(this, this.capacity_index - 1);\n        }\n      }\n    };\n\n    // Returns true iff the HashTable is empty.\n    // O(1) time.\n    structure.HashTable.prototype.isEmpty = function() {\n      return this.numkeys === 0;\n    };\n\n    // Clears the HashTable, making it empty.\n    // O(1) time.\n    structure.HashTable.prototype.clear = function() {\n      this.capacity_index = DEFAULT_INITIAL_CAPACITY_IDX;\n      this.capacity = CAPACITY_CHOICES[this.capacity_index];\n      this.numkeys = 0;\n      this.slots = [];\n    };\n\n    // Returns the number of mappings in the HashTable.\n    // O(1) time.\n    structure.HashTable.prototype.size = function() {\n      return this.numkeys;\n    };\n\n    // Returns true iff @a key is in the HashTable.\n    // Equivalent to get(key) !== undefined.\n    structure.HashTable.prototype.containsKey = function(key) {\n      if (key === undefined) {\n        throw new Error(\"called HashTable.containsKey with key === undefined\");\n      }\n\n      return this.get(key) !== undefined;\n    };\n\n    // Returns an array with all the keys in the HashTable\n    structure.HashTable.prototype.keys = function() {\n      var keys = [];\n\n      for (var it = this.keyIterator(); it.hasNext(); ) {\n        keys.push(it.next());\n      }\n\n      return keys;\n    };\n\n    // Returns an array with all the values in the HashTable\n    structure.HashTable.prototype.values = function() {\n      var values = [];\n\n      for (var it = this.valueIterator(); it.hasNext(); ) {\n        values.push(it.next());\n      }\n\n      return values;\n    };\n\n    // Returns an array with all the key-value pairs in the HashTable\n    structure.HashTable.prototype.entries = function() {\n      var entries = [];\n\n      for (var it = this.keyValueIterator(); it.hasNext(); ) {\n        entries.push(it.next());\n      }\n\n      return entries;\n    };\n\n    // Iterators internals. The API is below.\n    var Iterator = {\n      hasNext: function() {\n        // first try the current chain iterator\n        if (this.cur_chain_iterator!==undefined && this.cur_chain_iterator.hasNext()) {\n          return true;\n        }\n        if (this.cur_chain_iterator !== undefined) {\n          ++this.idx; // this chain iterator was exhausted\n        }\n        // try to find another chain\n        while (this.idx<this.H.capacity &&\n            (this.H.slots[this.idx]===undefined || // no chain OR\n             this.H.slots[this.idx].isEmpty())) {  // empty chain\n          ++this.idx;\n        }\n        var slotval = this.H.slots[this.idx];\n        if (slotval === undefined) { // no more chains in the table\n          this.cur_chain_iterator = undefined;\n          return false;\n        }\n        this.cur_chain_iterator = slotval.iterator();\n        return true; // we know this chain isn't empty so just return true\n      },\n      // @a err_msg is the message to throw if the iterator is empty\n      // @a extract_next is a function that takes the iterator as its only\n      // parameter and returns the required item\n      _next: function(err_msg, extract_next) {\n        if (!this.hasNext()) {\n          throw new Error(err_msg);\n        }\n        //assert(this.H.keys[this.idx] !== undefined);\n        var retval = extract_next(this);\n        return retval;\n      },\n      // invoke function @a iterator_func with context @a context on each\n      // element of the iterable collection\n      each: function(iterator_func, context) {\n        if (iterator_func === undefined) {\n          throw new Error(\"called iterator.each with iterator_func === undefined\");\n        }\n\n        for (var i=0, it = this; this.hasNext(); i++) {\n          iterator_func.call(context, this.next(), i, this.H);\n        }\n      }\n    };\n\n    function _KeyIterator(H) {\n      this.idx = 0;\n      this.H = H;\n    }\n    _KeyIterator.prototype = Object.create(Iterator);\n    _KeyIterator.prototype.next = function() {\n      return this._next(\"KeyIterator.next called on empty iterator\", function(it) {\n        return it.cur_chain_iterator.next().key;\n      });\n    };\n\n    function _ValueIterator(H) {\n      this.idx = 0;\n      this.H = H;\n    }\n    _ValueIterator.prototype = Object.create(Iterator);\n    _ValueIterator.prototype.next = function() {\n      return this._next(\"ValueIterator.next called on empty iterator\", function(it) {\n        return it.cur_chain_iterator.next().value;\n      });\n    };\n\n    function _KeyValueIterator(H) {\n      this.idx = 0;\n      this.H = H;\n    }\n    _KeyValueIterator.prototype = Object.create(Iterator);\n    _KeyValueIterator.prototype.next = function() {\n      return this._next(\"KeyValueIterator.next called on empty iterator\", function(it) {\n        var node = it.cur_chain_iterator.next();\n        return [node.key, node.value];\n      });\n    };\n\n    /* Iterator API\n     *\n     * HashTable supports three iterators for iteration over keys, values\n     * and key-value pairs.\n     * The iterator is returned by the appropriate *Iterator\n     * function on the hashtable. All three iterators have two methods\n     *   - hasNext: Returns true iff there is at least one more item to iterate over.\n     *   - next: Returns the next item from the iterator, or throws if the iterator is\n     *           exhausted. It is guaranteed that next does not throw if a preceeding\n     *           call to hasNext returned true.\n     *   - each: Iterates over all elements in the collection, invoking a function on\n     *           each element. The function is passed a reference to the element, the\n     *           index of the element and a reference to the hashtable.\n     *\n     * If the HashTable changes in any way during iteration (e.g. by calling put, remove or clear),\n     * the iterator is invalidated and the behavior of subsequent calls to hasNext or next is undefined.\n     *\n     * All three iterators iterate over the whole HashTable in O(n) time where n is the number of mappings\n     * in the table.\n     *\n     * The KeyValueIterator's next method returns arrays of length two where the first element is the key\n     * and the second element is the value.\n     */\n    structure.HashTable.prototype.keyIterator = function() {\n      return new _KeyIterator(this);\n    };\n    structure.HashTable.prototype.valueIterator = function() {\n      return new _ValueIterator(this);\n    };\n    structure.HashTable.prototype.keyValueIterator = function() {\n      return new _KeyValueIterator(this);\n    };\n\n  })();\n\n  // import structure.HashTable into noam.util\n  noam.util.HashTable = structure.HashTable;\n  delete structure; // don't need structure any more\n\n  noam.fsm = {};\n\n  noam.fsm.epsilonSymbol = '$';\n  noam.fsm.dfaType = 'DFA';\n  noam.fsm.nfaType = 'NFA';\n  noam.fsm.enfaType = 'eNFA';\n\n  // FSM creation API\n\n  // Creates and returns an empty FSM that can then be manipulated through the other\n  // functions in the API.\n  noam.fsm.makeNew = function() {\n    return {\n      states: [],\n      alphabet: [],\n      acceptingStates: [],\n      initialState: undefined,\n      transitions: []\n    };\n  };\n\n  // Common internal implementation for addState and addSymbol.\n  noam.fsm._addStateOrSymbol = function(arr, obj, undefErrorMsg, existsErrorMsg) {\n    // need to check this because undefined would otherwise be added as a state\n    // or symbol which is probably not what you want\n    if (obj === undefined) {\n      throw new Error(undefErrorMsg);\n    }\n    if (noam.util.contains(arr, obj)) {\n      throw new Error(existsErrorMsg);\n    }\n\n    arr.push(obj);\n    return obj;\n  };\n\n  // Adds stateObj as a state to the fsm.\n  // Throws an Error if no stateObj is passed or if the same state already exists.\n  // Returns the added state object.\n  noam.fsm.addState = function(fsm, stateObj) {\n    return noam.fsm._addStateOrSymbol(fsm.states, stateObj,\n        \"No state object specified\", \"State already exists\");\n  };\n\n  // Adds symObj as an alphabet symbol to the fsm.\n  // Throws an Error if no symObj is passed or if the same symbol already exists.\n  // Returns the added symbol object.\n  noam.fsm.addSymbol = function(fsm, symObj) {\n    if (noam.util.areEquivalent(symObj, noam.fsm.epsilonSymbol)) {\n      throw new Error(\"Can't add the epsilon symbol to the alphabet\");\n    }\n    return noam.fsm._addStateOrSymbol(fsm.alphabet, symObj,\n        \"No symbol object specified\", \"Symbol already exists\");\n  };\n\n  // Makes stateObj an accepting state of the fsm.\n  // Throws an Error if stateObj is not a state of the fsm or if it is already\n  // accepting.\n  noam.fsm.addAcceptingState = function(fsm, stateObj) {\n    if (!noam.util.contains(fsm.states, stateObj)) {\n      throw new Error(\"The specified object is not a state of the FSM\");\n    }\n    noam.fsm._addStateOrSymbol(fsm.acceptingStates, stateObj, \"\",\n        \"The specified state is already accepting\");\n  };\n\n  // Sets stateObj as the start state of the fsm.\n  // Throws an Error if stateObj is not a state of the fsm.\n  noam.fsm.setInitialState = function(fsm, stateObj) {\n    if (!noam.util.contains(fsm.states, stateObj)) {\n      throw new Error(\"The specified object is not a state of the FSM\");\n    }\n    fsm.initialState = stateObj;\n  };\n\n  // Common implementation for addTransition and addEpsilonTransition.\n  noam.fsm._addTransition = function(fsm, fromState, toStates, transitionSymbol) {\n    if (!Array.isArray(toStates)) {\n      throw new Error(\"The toStates argument must be an array\");\n    }\n    if (!noam.util.contains(fsm.states, fromState) ||\n        !noam.util.containsAll(fsm.states, toStates)) {\n      throw new Error(\"One of the specified objects is not a state of the FSM\");\n    }\n\n    var i;\n    var added = false;\n    for (i=0; i<fsm.transitions.length; i++) {\n      if (noam.util.areEquivalent(fromState, fsm.transitions[i].fromState) &&\n          noam.util.areEquivalent(transitionSymbol, fsm.transitions[i].symbol)) {\n        fsm.transitions[i].toStates = noam.util.setUnion(fsm.transitions[i].toStates, toStates);\n        added = true;\n        break;\n      }\n    }\n    if (!added) {\n      fsm.transitions.push({fromState: fromState, toStates: toStates, symbol: transitionSymbol});\n    }\n  };\n\n  // Adds a transition from fromState to the set of states represented by the array\n  // toStates, using transitionSymbol.\n  // If a transition for this pair of (fromState, transitionSymbol) already exists,\n  // toStates is added to the existing set of destination states.\n  // Throws an Error if any of the states is not actually in the fsm or if the\n  // transition symbol is not in the fsm's alphabeth.\n  // Note that this means that an Error will be thrown if you try to use this to\n  // specify an epsilon transition. For that, use addEpsilonTransition instead.\n  noam.fsm.addTransition = function(fsm, fromState, toStates, transitionSymbol) {\n    if (!noam.util.contains(fsm.alphabet, transitionSymbol)) {\n      throw new Error(\"The specified object is not an alphabet symbol of the FSM\");\n    }\n    noam.fsm._addTransition(fsm, fromState, toStates, transitionSymbol);\n  };\n\n  // Equivalent to addTransition except that there is no transition symbol, i.e. the\n  // transition can be executed without consuming an input symbol.\n  noam.fsm.addEpsilonTransition = function(fsm, fromState, toStates) {\n    noam.fsm._addTransition(fsm, fromState, toStates, noam.fsm.epsilonSymbol);\n  };\n\n  // end of FSM creation API\n\n  // validates a FSM definition\n  noam.fsm.validate = function(fsm) {\n    var i, j, k;\n\n    if (!(typeof fsm !== 'undefined' &&\n        Array.isArray(fsm.states) &&\n        Array.isArray(fsm.alphabet) &&\n        Array.isArray(fsm.acceptingStates) &&\n        typeof fsm.initialState !== 'undefined' && fsm.initialState !== null &&\n        Array.isArray(fsm.transitions))) {\n      throw new Error('FSM must be defined and have states, alphabet, acceptingStates, initialState and transitions array properties!');\n    }\n\n    if (fsm.states.length < 1) {\n      throw new Error('Set of states must not be empty.');\n    }\n\n    for (i=0; i<fsm.states.length; i++) {\n      if (noam.util.contains(fsm.states, fsm.states[i], i+1)) {\n        throw new Error('Equivalent states');\n      }\n    }\n\n    if (fsm.alphabet.length < 1) {\n      throw new Error('Alphabet must not be empty.');\n    }\n\n    for (i=0; i<fsm.alphabet.length; i++) {\n      if (noam.util.contains(fsm.alphabet, fsm.alphabet[i], i+1)) {\n        throw new Error('Equivalent alphabet symbols');\n      }\n    }\n\n    if (noam.util.contains(fsm.alphabet, noam.fsm.epsilonSymbol)) {\n      throw new Error('FSM alphabet must not contain the epsilon symbol');\n    }\n\n    for (i=0; i<fsm.alphabet.length; i++) {\n      if (noam.util.contains(fsm.states, fsm.alphabet[i])) {\n        throw new Error('States and alphabet symbols must not overlap');\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      if (noam.util.contains(fsm.acceptingStates, fsm.acceptingStates[i], i+1)) {\n        throw new Error('Equivalent acceptingStates');\n      }\n\n      if (!(noam.util.contains(fsm.states, fsm.acceptingStates[i]))) {\n        throw new Error('Each accepting state must be in states');\n      }\n    }\n\n    if (!(noam.util.contains(fsm.states, fsm.initialState))) {\n      throw new Error('Initial state must be in states');\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (typeof transition.fromState === 'undefined' ||\n          typeof transition.toStates === 'undefined' ||\n          typeof transition.symbol === 'undefined') {\n        throw new Error('Transitions must have fromState, toState and symbol');\n      }\n\n      if (!(noam.util.contains(fsm.states, transition.fromState))) {\n        throw new Error('Transition fromState must be in states.');\n      }\n\n      if (!(noam.util.contains(fsm.alphabet, transition.symbol)) &&\n          transition.symbol !== noam.fsm.epsilonSymbol) {\n        throw new Error('Transition symbol must be in alphabet.');\n      }\n\n      for (k=0; k<transition.toStates.length; k++) {\n        if (!(noam.util.contains(fsm.states, transition.toStates[k]))) {\n          throw new Error('Transition toStates must be in states.');\n        }\n\n        if (noam.util.contains(transition.toStates, transition.toStates[k], k+1)) {\n          throw new Error('Transition toStates must not contain duplicates.');\n        }\n      }\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      for (j=i+1; j<fsm.transitions.length; j++) {\n        if (fsm.transitions[i].fromState === fsm.transitions[j].fromState &&\n            fsm.transitions[i].symbol === fsm.transitions[j].symbol) {\n          throw new Error('Transitions for the same fromState and symbol must be defined in a single trainsition.');\n        }\n      }\n    }\n\n    return true;\n  };\n\n  // determine if stateObj is an accepting state in fsm\n  noam.fsm.isAcceptingState = function(fsm, stateObj) {\n    return noam.util.contains(fsm.acceptingStates, stateObj);\n  };\n\n  // determine fsm type based on transition function\n  noam.fsm.determineType = function(fsm) {\n    var fsmType = noam.fsm.dfaType;\n\n    for (var i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (transition.symbol === noam.fsm.epsilonSymbol) {\n        fsmType = noam.fsm.enfaType;\n        break;\n      } else if (transition.toStates.length === 0 ||\n          transition.toStates.length > 1) {\n        fsmType = noam.fsm.nfaType;\n      }\n    }\n\n    if (fsmType === noam.fsm.dfaType) {\n      if (fsm.transitions.length < fsm.states.length * fsm.alphabet.length) {\n        fsmType = noam.fsm.nfaType;\n      }\n    }\n\n    return fsmType;\n  };\n\n  // computes epsilon closure of fsm from states array states\n  noam.fsm.computeEpsilonClosure = function(fsm, states) {\n    if (!(noam.util.containsAll(fsm.states, states))) {\n      throw new Error('FSM must contain all states for which epsilon closure is being computed');\n    }\n\n    var unprocessedStates = states;\n    var targetStates = [];\n\n    while (unprocessedStates.length !== 0) {\n      var currentState = unprocessedStates.pop();\n      targetStates.push(currentState);\n\n      for (var i=0; i<fsm.transitions.length; i++) {\n        var transition = fsm.transitions[i];\n\n        if (transition.symbol === noam.fsm.epsilonSymbol &&\n            noam.util.areEquivalent(transition.fromState, currentState)) {\n          for (var j=0; j<transition.toStates.length; j++) {\n            if (noam.util.contains(targetStates, transition.toStates[j]) ||\n                noam.util.contains(unprocessedStates, transition.toStates[j])) {\n              continue;\n            }\n\n            unprocessedStates.push(transition.toStates[j]);\n          }\n        }\n      }\n    }\n\n    return targetStates;\n  };\n\n  // determines the target states from reading symbol at states array states\n  noam.fsm.makeSimpleTransition = function(fsm, states, symbol) {\n    if (!(noam.util.containsAll(fsm.states, states))) {\n      throw new Error('FSM must contain all states for which the transition is being computed');\n    }\n\n    if (!(noam.util.contains(fsm.alphabet, symbol))) {\n      throw new Error('FSM must contain input symbol for which the transition is being computed');\n    }\n\n    var targetStates = [];\n\n    for (var i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (noam.util.areEquivalent(fsm.transitions[i].symbol, symbol) &&\n          noam.util.contains(states, transition.fromState)) {\n        for (var j=0; j<transition.toStates.length; j++) {\n          if (!(noam.util.contains(targetStates, transition.toStates[j]))) {\n            targetStates.push(transition.toStates[j]);\n          }\n        }\n      }\n    }\n\n    return targetStates;\n  };\n\n  // makes transition from states array states and for input symbol symbol by:\n  //   a) computing the epsilon closure of states\n  //   b) making a simple transition from resulting states of a)\n  //   c) computing the epsilon closure of resulting states of b)\n  noam.fsm.makeTransition = function(fsm, states, symbol) {\n    if (!(noam.util.containsAll(fsm.states, states))) {\n      throw new Error('FSM must contain all states for which the transition is being computed');\n    }\n\n    if (!(noam.util.contains(fsm.alphabet, symbol))) {\n      throw new Error('FSM must contain input symbol for which the transition is being computed');\n    }\n\n    var targetStates = noam.util.clone(states);\n\n    targetStates = noam.fsm.computeEpsilonClosure(fsm, targetStates);\n    targetStates = noam.fsm.makeSimpleTransition(fsm, targetStates, symbol);\n    targetStates = noam.fsm.computeEpsilonClosure(fsm, targetStates);\n\n    return targetStates;\n  };\n\n  // read a stream of input symbols and determine target states\n  noam.fsm.readString = function(fsm, inputSymbolStream) {\n    if (!(noam.util.containsAll(fsm.alphabet, inputSymbolStream))) {\n      throw new Error('FSM must contain all symbols for which the transition is being computed');\n    }\n\n    var states = noam.fsm.computeEpsilonClosure(fsm, [fsm.initialState]);\n\n    for (var i=0; i<inputSymbolStream.length; i++) {\n      states = noam.fsm.makeTransition(fsm, states, inputSymbolStream[i]);\n    }\n\n    return states;\n  };\n\n  // read a stream of input symbols starting from state and make a list of\n  // states that were on the transition path\n  noam.fsm.transitionTrail = function(fsm, state, inputSymbolStream) {\n    if (!(noam.util.containsAll(fsm.alphabet, inputSymbolStream))) {\n      throw new Error('FSM must contain all symbols for which the transition is being computed');\n    }\n\n    var states = [state];\n    var trail = [noam.util.clone(states)];\n\n    for (var i=0; i<inputSymbolStream.length; i++) {\n      states = noam.fsm.makeTransition(fsm, states, inputSymbolStream[i]);\n      trail.push(noam.util.clone(states));\n    }\n\n    return trail;\n  };\n\n  // test if a stream of input symbols leads a fsm to an accepting state\n  noam.fsm.isStringInLanguage = function(fsm, inputSymbolStream) {\n    var states = noam.fsm.readString(fsm, inputSymbolStream);\n\n    return noam.util.containsAny(fsm.acceptingStates, states);\n  };\n\n  // pretty print the fsm transition function and accepting states as a table\n  noam.fsm.printTable = function(fsm) {\n    var Table = require('cli-table');\n    var colHeads = [\"\"].concat(fsm.alphabet);\n\n    if (noam.fsm.determineType(fsm) === noam.fsm.enfaType) {\n      colHeads.push(noam.fsm.epsilonSymbol);\n    }\n\n    colHeads.push(\"\");\n\n    var table = new Table({\n       head: colHeads,\n       chars: {\n         'top': '-',\n         'top-mid': '+',\n         'top-left': '+',\n         'top-right': '+',\n         'bottom': '-',\n         'bottom-mid': '+',\n         'bottom-left': '+',\n         'bottom-right': '+',\n         'left': '|',\n         'left-mid': '+',\n         'mid': '-',\n         'mid-mid': '+',\n         'right': '|',\n         'right-mid': '+'\n       },\n       truncate: '~'\n    });\n\n    var tableRows = [], i, j;\n    for (i=0; i<fsm.states.length; i++) {\n      tableRows.push(new Array(colHeads.length));\n      for (j=0; j<colHeads.length; j++) {\n        tableRows[i][j] = \"\";\n      }\n      tableRows[i][0] = fsm.states[i].toString();\n      tableRows[i][colHeads.length-1] =\n        noam.util.contains(fsm.acceptingStates, fsm.states[i]) ?\n        \"1\" : \"0\" ;\n      table.push(tableRows[i]);\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      var colNum = null;\n      var rowNum = null;\n\n      for (j=0; j<fsm.states.length; j++) {\n        if (noam.util.areEquivalent(fsm.states[j], transition.fromState)) {\n          rowNum = j;\n          break;\n        }\n      }\n\n      if (transition.symbol === noam.fsm.epsilonSymbol) {\n        colNum = colHeads.length-2;\n      } else {\n        for (j=0; j<fsm.alphabet.length; j++) {\n          if (noam.util.areEquivalent(fsm.alphabet[j], transition.symbol)) {\n            colNum = j+1;\n            break;\n          }\n        }\n      }\n\n      if (typeof tableRows[rowNum][colNum].text === \"undefined\") {\n        tableRows[rowNum][colNum] = { text : [] };\n      }\n\n      tableRows[rowNum][colNum].text.push(transition.toStates);\n    }\n\n    return table.toString();\n  };\n\n  noam.fsm.serializeFsmToString = function(fsm) {\n    var lines = [];\n\n    lines.push(\"#states\");\n\n    for (var i = 0; i < fsm.states.length; i++) {\n      lines.push(fsm.states[i].toString());\n    }\n\n    lines.push(\"#initial\");\n\n    lines.push(fsm.initialState.toString());\n\n    lines.push(\"#accepting\");\n\n    for (var i = 0; i < fsm.acceptingStates.length; i++) {\n      lines.push(fsm.acceptingStates[i].toString());\n    }\n\n    lines.push(\"#alphabet\");\n\n    for (var i = 0; i < fsm.alphabet.length; i++) {\n      lines.push(fsm.alphabet[i].toString());\n    }\n\n    lines.push(\"#transitions\");\n\n    for (var i = 0; i < fsm.transitions.length; i++) {\n      lines.push(fsm.transitions[i].fromState.toString() + \":\" +\n                 fsm.transitions[i].symbol.toString() + \">\" +\n                 fsm.transitions[i].toStates.join(\",\"));\n    }\n\n    return lines.join(\"\\n\");\n  };\n\n  noam.fsm.parseFsmFromString = function(fsm_string) {\n    var lines = fsm_string.split(/\\r?\\n/);\n\n    var states = [];\n    var initial;\n    var accepting = [];\n    var alphabet = [];\n    var transitions = [];\n\n    var parseState = null;\n\n    var parseCounts = {\n      states : 0,\n      initial : 0,\n      accepting : 0,\n      alphabet : 0,\n      transitions : 0\n    };\n\n    for (var i=0; i<lines.length; i++) {\n      var line = lines[i].replace(/\\s/g, \"\");\n\n      if (line.length === 0) {\n        continue;\n      } else if (line[0] === '#') {\n        parseState = line.substr(1);\n\n        if (typeof parseCounts[parseState] === 'undefined') {\n          throw new Error('Line ' + (i+1).toString() + ': invalid section name ' +\n                           parseState + '. Must be one of: states, initial, \\\n                           accepting, alphabet, transitions.');\n        } else {\n          parseCounts[parseState] += 1;\n\n          if (parseCounts[parseState] > 1) {\n            throw new Error('Line ' + (i+1).toString() +\n                            ': duplicate section name ' + parseState + '.');\n          }\n        }\n      } else {\n        if (parseState == null) {\n          throw new Error('Line ' + (i+1).toString() + ': no #section declared. \\\n                          Add one section: states, initial, accepting, \\\n                          alphabet, transitions.');\n        } else if (parseState === 'states') {\n          var st = line.split(\";\");\n          states = states.concat(st);\n        } else if (parseState == 'initial') {\n          initial = line;\n        } else if (parseState == 'accepting') {\n          var ac = line.split(\";\");\n          accepting = accepting.concat(ac);\n        } else if (parseState == 'alphabet') {\n          var al = line.split(\";\");\n          alphabet = alphabet.concat(al);\n        } else if (parseState == 'transitions') {\n          var state_rest = line.split(':');\n\n          var state = state_rest[0].split(',');\n          var parts = state_rest[1].split(';');\n\n          for (var j=0; j<parts.length; j++) {\n            var left_right = parts[j].split('>');\n            var al_t = left_right[0].split(',');\n            var st_t = left_right[1].split(',');\n          }\n\n          transitions.push([state, al_t, st_t]);\n        }\n      }\n    }\n\n    for (var k in parseCounts) {\n      if (parseCounts[k] !== 1) {\n        throw new Error('Specification missing #' + parseCounts[k] +\n          ' section.');\n      }\n    }\n\n    var fsm = noam.fsm.makeNew();\n\n    for (var i = states.length - 1; i >= 0; i--) {\n      noam.fsm.addState(fsm, states[i]);\n    }\n\n    for (var i = alphabet.length - 1; i >= 0; i--) {\n      noam.fsm.addSymbol(fsm, alphabet[i]);\n    }\n\n    for (var i = 0; i < accepting.length; i++) {\n      noam.fsm.addAcceptingState(fsm, accepting[i]);\n    }\n\n    noam.fsm.setInitialState(fsm, initial);\n\n    for (var i = 0; i < transitions.length; i++) {\n      var transition = transitions[i];\n\n      for (var j = 0; j < transition[0].length; j++) {\n        for (var k = 0; k < transition[1].length; k++) {\n          if (transition[1][k] === noam.fsm.epsilonSymbol) {\n            noam.fsm.addEpsilonTransition(fsm, transition[0][j], transition[2]);\n          } else {\n            noam.fsm.addTransition(fsm, transition[0][j], transition[2], transition[1][k]);\n          }\n        }\n      }\n    }\n\n    noam.fsm.validate(fsm);\n\n    return fsm;\n  };\n\n  // print the fsm transition function and accepting states as an HTML table\n  noam.fsm.printHtmlTable = function(fsm) {\n    var headers = [\"\"].concat(fsm.alphabet);\n    if (noam.fsm.determineType(fsm) === noam.fsm.enfaType) {\n      headers.push(noam.fsm.epsilonSymbol);\n    }\n    headers.push(\"\");\n\n    var tableRows = [], i, j;\n\n    for (i=0; i<fsm.states.length; i++) {\n      tableRows.push(new Array(headers.length));\n      for (j=0; j<headers.length; j++) {\n        tableRows[i][j] = { text : []};\n      }\n      tableRows[i][0] = { text : fsm.states[i].toString() };\n      tableRows[i][headers.length-1] =\n        noam.util.contains(fsm.acceptingStates, fsm.states[i]) ?\n        { text : [\"1\"] } : { text : [\"0\"] };\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      var colNum = null;\n      var rowNum = null;\n\n      for (j=0; j<fsm.states.length; j++) {\n        if (noam.util.areEquivalent(fsm.states[j], transition.fromState)) {\n          rowNum = j;\n          break;\n        }\n      }\n\n      if (transition.symbol === noam.fsm.epsilonSymbol) {\n        colNum = headers.length-2;\n      } else {\n        for (j=0; j<fsm.alphabet.length; j++) {\n          if (noam.util.areEquivalent(fsm.alphabet[j], transition.symbol)) {\n            colNum = j+1;\n            break;\n          }\n        }\n      }\n\n      if (typeof tableRows[rowNum][colNum].text === \"undefined\") {\n        tableRows[rowNum][colNum] = { text : [] };\n      }\n\n      tableRows[rowNum][colNum].text.push(transition.toStates);\n    }\n\n    var htmlString = [];\n\n    htmlString.push(\"<table border='1'>\");\n    htmlString.push(\"  <tr>\");\n\n    for (i=0; i<headers.length; i++) {\n      htmlString.push(\"    <th>\" + headers[i].toString() + \"</th>\");\n    }\n\n    htmlString.push(\"  </tr>\");\n\n    for (i=0; i<tableRows.length; i++) {\n      htmlString.push(\"  <tr>\");\n      for (j=0; j<tableRows[i].length; j++) {\n        htmlString.push(\"    <td>\" + tableRows[i][j].text + \"</td>\");\n      }\n\n      htmlString.push(\"  </tr>\");\n    }\n\n    htmlString.push(\"</table>\");\n    return htmlString.join(\"\\n\");\n  };\n\n  // print the fsm in the graphviz dot format\n  noam.fsm.printDotFormat = function(fsm) {\n    var result = [\"digraph finite_state_machine {\", \"  rankdir=LR;\"];\n    var accStates = [\"  node [shape = doublecircle];\"];\n\n    var i, j, k, trans;\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      accStates.push(fsm.acceptingStates[i].toString());\n    }\n\n    accStates.push(\";\");\n    if (accStates.length > 2) {\n      result.push(accStates.join(\" \"));\n    }\n    result.push(\"  node [shape = circle];\");\n    result.push(\"  secret_node [style=invis, shape=point];\");\n    //var initState = ['  {rank = source; \"'];\n    //initState.push(fsm.initialState.toString());\n    //initState.push('\" \"secret_node\"}');\n    //result.push(initState.join(\"\"));\n\n    var initStateArrow = [\"  secret_node ->\"];\n    initStateArrow.push(fsm.initialState.toString());\n    initStateArrow.push(\"[style=bold];\");\n    result.push(initStateArrow.join(\" \"));\n\n    var newTransitions = [];\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      for (j=0; j<fsm.transitions[i].toStates.length; j++) {\n        var found = null;\n\n        for (k=0; k<newTransitions.length; k++) {\n          if (noam.util.areEquivalent(newTransitions[k].fromState, fsm.transitions[i].fromState) &&\n              noam.util.areEquivalent(newTransitions[k].toStates, [fsm.transitions[i].toStates[j]])) {\n            found = newTransitions[k];\n          }\n        }\n\n        if (found === null) {\n          var newTransition = noam.util.clone(fsm.transitions[i]);\n          newTransition.toStates = [newTransition.toStates[j]];\n          newTransition.symbol = [newTransition.symbol];\n          newTransitions.push(newTransition);\n        } else {\n          found.symbol.push(fsm.transitions[i].symbol);\n        }\n      }\n    }\n\n    for (i=0; i<newTransitions.length; i++) {\n      if (noam.util.areEquivalent(newTransitions[i].toStates[0], fsm.initialState)) {\n        trans = [\" \"];\n        trans.push(newTransitions[i].toStates[0].toString());\n        trans.push(\"->\");\n        trans.push(newTransitions[i].fromState.toString());\n        trans.push(\"[\");\n        trans.push(\"label =\");\n        trans.push('\"' + newTransitions[i].symbol.toString() + '\"');\n        trans.push(\" dir = back];\");\n        result.push(trans.join(\" \"));\n      } else {\n        trans = [\" \"];\n        trans.push(newTransitions[i].fromState.toString());\n        trans.push(\"->\");\n        trans.push(newTransitions[i].toStates[0].toString());\n        trans.push(\"[\");\n        trans.push(\"label =\");\n        trans.push('\"' + newTransitions[i].symbol.toString() + '\"');\n        trans.push(\" ];\");\n        result.push(trans.join(\" \"));\n      }\n    }\n\n    result.push(\"}\");\n\n    return result.join(\"\\n\").replace(/\\$/g, \"$\");\n  };\n\n  // determine reachable states\n  noam.fsm.getReachableStates = function(fsm, state, shouldIncludeInitialState) {\n    var unprocessedStates = [state], i, j;\n    var reachableStates = shouldIncludeInitialState ? [state] : [];\n\n    while (unprocessedStates.length !== 0) {\n      var currentState = unprocessedStates.pop();\n\n      for (i=0; i<fsm.transitions.length; i++) {\n        var transition = fsm.transitions[i];\n\n        if (noam.util.areEquivalent(currentState, transition.fromState)) {\n          for (j=0; j<transition.toStates.length; j++) {\n            if (!(noam.util.contains(reachableStates, transition.toStates[j]))) {\n              reachableStates.push(transition.toStates[j]);\n\n              if (!(noam.util.contains(unprocessedStates, transition.toStates[j]))) {\n                unprocessedStates.push(transition.toStates[j]);\n              }\n            }\n          }\n        }\n      }\n    }\n\n   return reachableStates;\n  };\n\n  // determine and remove unreachable states\n  noam.fsm.removeUnreachableStates = function (fsm) {\n    var reachableStates = noam.fsm.getReachableStates(fsm, fsm.initialState, true);\n    var newFsm = noam.util.clone(fsm), i;\n    newFsm.states = [];\n    newFsm.acceptingStates = [];\n    newFsm.transitions = [];\n\n    for (i=0; i<fsm.states.length; i++) {\n      if(noam.util.contains(reachableStates, fsm.states[i])) {\n        newFsm.states.push(noam.util.clone(fsm.states[i]));\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      if (noam.util.contains(reachableStates, fsm.acceptingStates[i])) {\n        newFsm.acceptingStates.push(noam.util.clone(fsm.acceptingStates[i]));\n      }\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      if (noam.util.contains(reachableStates, fsm.transitions[i].fromState)) {\n        newFsm.transitions.push(noam.util.clone(fsm.transitions[i]));\n      }\n    }\n\n    return newFsm;\n  };\n\n  // determines if two states from potentially different fsms are equivalent\n  noam.fsm.areEquivalentStates = function(fsmA, stateA, fsmB, stateB) {\n    if (noam.fsm.determineType(fsmA) !== noam.fsm.dfaType ||\n        noam.fsm.determineType(fsmB) !== noam.fsm.dfaType) {\n      throw new Error('FSMs must be DFAs');\n    }\n\n    if (fsmA.alphabet.length !== fsmB.alphabet.length ||\n        !(noam.util.containsAll(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error('FSM alphabets must be the same');\n    }\n\n    if (!(noam.util.contains(fsmA.states, stateA)) ||\n        !(noam.util.contains(fsmB.states, stateB))) {\n      throw new Error('FSMs must contain states');\n    }\n\n    function doBothStatesHaveSameAcceptance(fsmX, stateX, fsmY, stateY) {\n      var stateXAccepting = noam.util.contains(fsmX.acceptingStates, stateX);\n      var stateYAccepting = noam.util.contains(fsmY.acceptingStates, stateY);\n\n      return (stateXAccepting && stateYAccepting) ||\n             (!(stateXAccepting) && !(stateYAccepting));\n    }\n\n    var unprocessedPairs = [[stateA, stateB]];\n    var processedPairs = [], i, j;\n\n    while (unprocessedPairs.length !== 0) {\n      var currentPair = unprocessedPairs.pop();\n\n      if (!(doBothStatesHaveSameAcceptance(fsmA, currentPair[0], fsmB, currentPair[1]))) {\n          return false;\n        }\n\n      processedPairs.push(currentPair);\n\n      for (j=0; j<fsmA.alphabet.length; j++) {\n        var pair = [noam.fsm.makeTransition(fsmA, [currentPair[0]], fsmA.alphabet[j])[0],\n                    noam.fsm.makeTransition(fsmB, [currentPair[1]], fsmA.alphabet[j])[0]];\n\n        if (!(noam.util.contains(processedPairs, pair)) &&\n            !(noam.util.contains(unprocessedPairs, pair))) {\n          unprocessedPairs.push(pair);\n        }\n      }\n    }\n\n    return true;\n  };\n\n  // determines if two fsms are equivalent by testing equivalence of starting states\n  noam.fsm.areEquivalentFSMs = function(fsmA, fsmB) {\n    return noam.fsm.areEquivalentStates(fsmA, fsmA.initialState, fsmB, fsmB.initialState);\n  };\n\n  // finds and removes equivalent states\n  noam.fsm.removeEquivalentStates = function(fsm) {\n    if (noam.fsm.determineType(fsm) !== noam.fsm.dfaType) {\n      throw new Error('FSM must be DFA');\n    }\n\n    var equivalentPairs = [], i, j, k;\n\n    for (i=0; i<fsm.states.length; i++) {\n      for (j=i+1; j<fsm.states.length; j++) {\n        if (noam.fsm.areEquivalentStates(fsm, fsm.states[i], fsm, fsm.states[j])) {\n          var pair = [fsm.states[i], fsm.states[j]];\n\n          for (k=0; k<equivalentPairs.length; k++) {\n            if (noam.util.areEquivalent(equivalentPairs[k][1], pair[0])) {\n              pair[0] = equivalentPairs[k][1];\n              break;\n            }\n          }\n\n          if (!(noam.util.contains(equivalentPairs, pair))) {\n            equivalentPairs.push(pair);\n          }\n        }\n      }\n    }\n\n    var newFsm = {\n      states : [],\n      alphabet : noam.util.clone(fsm.alphabet),\n      initialState : [],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    function isOneOfEquivalentStates(s) {\n      for (var i=0; i<equivalentPairs.length; i++) {\n        if (noam.util.areEquivalent(equivalentPairs[i][1], s)) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    function getEquivalentState(s) {\n      for (var i=0; i<equivalentPairs.length; i++) {\n        if (noam.util.areEquivalent(equivalentPairs[i][1], s)) {\n          return equivalentPairs[i][0];\n        }\n      }\n\n      return s;\n    }\n\n    for (i=0; i<fsm.states.length; i++) {\n      if (!(isOneOfEquivalentStates(fsm.states[i]))) {\n        newFsm.states.push(noam.util.clone(fsm.states[i]));\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      if (!(isOneOfEquivalentStates(fsm.acceptingStates[i]))) {\n        newFsm.acceptingStates.push(noam.util.clone(fsm.acceptingStates[i]));\n      }\n    }\n\n    newFsm.initialState = noam.util.clone(getEquivalentState(fsm.initialState));\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var transition = noam.util.clone(fsm.transitions[i]);\n\n      if (isOneOfEquivalentStates(transition.fromState)) {\n        continue;\n      }\n\n      for (j=0; j<transition.toStates.length; j++) {\n        transition.toStates[j] = getEquivalentState(transition.toStates[j]);\n      }\n\n      newFsm.transitions.push(transition);\n    }\n\n    return newFsm;\n  };\n\n  // minimizes the fsm by removing unreachable and equivalent states\n  noam.fsm.minimize = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    var fsmWithoutUnreachableStates = noam.fsm.removeUnreachableStates(newFsm);\n    var minimalFsm = noam.fsm.removeEquivalentStates(fsmWithoutUnreachableStates);\n    return minimalFsm;\n  };\n\n  noam.fsm.convertStatesToNumbers = function(fsm) {\n    var newFsm = noam.fsm.makeNew();\n    var mapping = {};\n\n    for (i=0; i<fsm.states.length; i++) {\n      mapping[fsm.states[i].toString()] = i;\n    }\n\n    newFsm.alphabet = noam.util.clone(fsm.alphabet);\n\n    for (i=0; i<fsm.states.length; i++) {\n      noam.fsm.addState(newFsm, mapping[fsm.states[i].toString()]);\n    }\n\n    noam.fsm.setInitialState(newFsm, mapping[fsm.initialState.toString()]);\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      noam.fsm.addAcceptingState(newFsm, mapping[fsm.acceptingStates[i].toString()]);\n    }\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      var newToStates = [];\n\n      for (j=0; j<fsm.transitions[i].toStates.length; j++) {\n        newToStates.push(mapping[fsm.transitions[i].toStates[j].toString()]);\n      }\n\n      noam.fsm.addTransition(newFsm,\n        mapping[fsm.transitions[i].fromState.toString()],\n        newToStates,\n        fsm.transitions[i].symbol);\n    }\n\n    return newFsm;\n  }\n\n  // generate random fsm\n  noam.fsm.createRandomFsm = function(fsmType, numStates, numAlphabet, maxNumToStates) {\n    var newFsm = {}, i, j, k;\n\n    function prefix(ch, num, str) {\n      var retStr = str;\n\n      for (var i=0; i<str.length - num; i++) {\n        retStr = ch + str;\n      }\n\n      return retStr;\n    }\n\n    newFsm.states = [];\n    for (i=0, len=numStates.toString().length; i<numStates; i++) {\n      newFsm.states.push(\"s\" + prefix(\"0\", len, i.toString()));\n    }\n\n    newFsm.alphabet = [];\n\n    if (numAlphabet > 26) {\n      for (i=0, len=numAlphabet.toString().length; i<numAlphabet; i++) {\n        newFsm.alphabet.push(\"a\" + prefix(\"0\", len, i.toString()));\n      }\n    } else {\n      newFsm.alphabet = \"abcdefghijklmnopqrstuvwxyz\".substr(0,numAlphabet).split(\"\");\n    }\n\n    newFsm.initialState = newFsm.states[0];\n\n    newFsm.acceptingStates = [];\n    for (i=0; i<numStates; i++) {\n      if (Math.round(Math.random())) {\n        newFsm.acceptingStates.push(newFsm.states[i]);\n      }\n    }\n\n    if (fsmType === noam.fsm.enfaType) {\n      newFsm.alphabet.push(noam.fsm.epsilonSymbol);\n    }\n\n    newFsm.transitions = [];\n    for (i=0; i<numStates; i++) {\n      for (j=0; j<newFsm.alphabet.length; j++) {\n        var numToStates = 1;\n\n        if (fsmType !== noam.fsm.dfaType) {\n          numToStates = Math.floor(Math.random()*maxNumToStates);\n        }\n\n        if (numToStates > 0) {\n          var toStates = [];\n          for (k=0; k<newFsm.states.length && toStates.length < numToStates; k++) {\n            var diff = (newFsm.states.length-k)-(numToStates-toStates.length) + 1;\n\n            if (diff <= 0) {\n              diff = 1;\n            } else {\n              diff = 1/diff;\n            }\n\n            if (Math.random() <= diff) {\n              toStates.push(newFsm.states[k]);\n            }\n          }\n\n          newFsm.transitions.push({fromState : newFsm.states[i], symbol : newFsm.alphabet[j], toStates : toStates});\n        }\n      }\n    }\n\n    if (fsmType === noam.fsm.enfaType) {\n      newFsm.alphabet.pop();\n    }\n\n    return newFsm;\n  };\n\n  noam.fsm.convertNfaToDfa = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    if (fsmType === noam.fsm.enfaType) {\n      throw new Error('FSM must be an NFA');\n    }\n\n    if (fsmType === noam.fsm.dfaType) {\n      return fsm; // no need to convert it\n    }\n\n    var newFsm = {}, i, j, k, transition;\n\n    newFsm.alphabet = noam.util.clone(fsm.alphabet);\n    newFsm.states = [];\n    newFsm.acceptingStates = [];\n    newFsm.initialState = [noam.util.clone(fsm.initialState)];\n    newFsm.transitions = [];\n\n    for (i=0; i<fsm.states.length; i++) {\n      newFsm.states.push([noam.util.clone(fsm.states[i])]);\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      newFsm.acceptingStates.push([noam.util.clone(fsm.acceptingStates[i])]);\n    }\n\n    var newStates = [];\n    var multiStates = [];\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      transition = noam.util.clone(fsm.transitions[i]);\n      transition.fromState = [transition.fromState];\n\n      transition.toStates = [transition.toStates];\n\n      if (transition.toStates[0].length > 1) {\n        if (!(noam.util.containsSet(newStates, transition.toStates[0]))) {\n          newStates.push(transition.toStates[0]);\n        }\n      }\n\n      newFsm.transitions.push(transition);\n    }\n\n    while (newStates.length !== 0) {\n      var state = newStates.pop();\n\n      newFsm.states.push(state);\n\n      if (noam.util.containsAny(fsm.acceptingStates, state)) {\n        newFsm.acceptingStates.push(state);\n      }\n\n      for (i=0; i<newFsm.alphabet.length; i++) {\n        var ts = noam.fsm.makeTransition(fsm, state, newFsm.alphabet[i]).sort();\n\n        for (j=0; j<newFsm.states.length; j++) {\n          if (noam.util.areEqualSets(ts, newFsm.states[j])) {\n            ts = newFsm.states[j];\n            break;\n          }\n        }\n\n        for (j=0; j<newStates.length; j++) {\n          if (noam.util.areEqualSets(ts, newStates[j])) {\n            ts = newStates[j];\n            break;\n          }\n        }\n\n        if (ts.length > 0) {\n          newFsm.transitions.push({fromState : state, symbol : newFsm.alphabet[i], toStates : [ts]});\n        }\n\n        if (!(noam.util.containsSet(newFsm.states, ts)) && !(noam.util.containsSet(newStates, ts)) && ts.length > 1) {\n          newStates.push(ts);\n        }\n      }\n    }\n\n    var errorAdded = false;\n    var errorState = \"ERROR\";\n\n    for (i=0; i<newFsm.states.length; i++) {\n      for (j=0; j<newFsm.alphabet.length; j++) {\n        var found = false;\n        for (k=0; k<newFsm.transitions.length; k++) {\n          transition = newFsm.transitions[k];\n\n          if (noam.util.areEquivalent(transition.symbol, newFsm.alphabet[j]) &&\n              noam.util.areEquivalent(transition.fromState, newFsm.states[i])) {\n            found = true;\n            break;\n          }\n        }\n\n        if (found === false) {\n          if (errorAdded === false) {\n            newFsm.states.push([errorState]);\n            errorAdded = true;\n          }\n\n          newFsm.transitions.push({fromState : newFsm.states[i], symbol : newFsm.alphabet[j], toStates : [[errorState]]});\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  noam.fsm.convertEnfaToNfa = function(fsm) {\n    if (noam.fsm.determineType(fsm) !== noam.fsm.enfaType) {\n      return fsm; // this is already an NFA (or a DFA which is also an NFA)\n    }\n\n    var newFsm = noam.util.clone(fsm), i, j;\n\n    var initialEpsilon = noam.fsm.computeEpsilonClosure(fsm, [fsm.initialState]);\n\n    if (noam.util.containsAny(newFsm.acceptingStates, initialEpsilon) &&\n        !(noam.util.contains(newFsm.acceptingStates, newFsm.initialState))) {\n      newFsm.acceptingStates.push(newFsm.initialState);\n    }\n\n    var newTransitions = [];\n\n    for (i=0; i<newFsm.states.length; i++) {\n      for (j=0; j<newFsm.alphabet.length; j++) {\n        var toStates = noam.fsm.makeTransition(newFsm, [newFsm.states[i]], newFsm.alphabet[j]).sort();\n\n        if (toStates.length > 0) {\n          newTransitions.push({\n            fromState : newFsm.states[i],\n            toStates : toStates,\n            symbol : newFsm.alphabet[j]\n          });\n        }\n      }\n    }\n\n    newFsm.transitions = newTransitions;\n\n    var multiStateTransitions = [];\n\n    for (i=0; i<newFsm.transitions.length; i++) {\n      var transition = newFsm.transitions[i];\n\n      if (transition.toStates.length > 1) {\n        var existing = false;\n\n        for (j=0; j<multiStateTransitions.length; j++) {\n          if (noam.util.areEqualSets(transition.toStates, multiStateTransitions[j])) {\n            transition.toStates = multiStateTransitions[j];\n            existing = true;\n            break;\n          }\n        }\n\n        if (existing === false) {\n          multiStateTransitions.push(transition.toStates);\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // test whether if the language accepted by the fsm contains at least one string\n  noam.fsm.isLanguageNonEmpty = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    return newFsm.acceptingStates.length > 0;\n  };\n\n  noam.fsm.isLanguageInfinite = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    var deadState = null, i, reachable;\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (noam.util.contains(newFsm.acceptingStates, newFsm.states[i])) {\n        continue;\n      }\n\n      reachable = noam.fsm.getReachableStates(newFsm, newFsm.states[i], true);\n\n      if (noam.util.containsAny(newFsm.acceptingStates, reachable)) {\n        continue;\n      }\n\n      deadState = newFsm.states[i];\n      break;\n    }\n\n    if (deadState === null) {\n      return true;\n    }\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (noam.util.areEquivalent(deadState, newFsm.states[i])) {\n        continue;\n      }\n\n      reachable = noam.fsm.getReachableStates(newFsm, newFsm.states[i], false);\n\n      if (noam.util.contains(reachable, newFsm.states[i])) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // generate a random string which the fsm accepts\n  noam.fsm.randomStringInLanguage = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    if (newFsm.acceptingStates.length === 0) {\n      return null;\n    }\n\n    var currentState = newFsm.acceptingStates[Math.floor(Math.random()*newFsm.acceptingStates.length)];\n    var trail = [];\n\n    while (true) {\n      if (noam.util.areEquivalent(currentState, newFsm.initialState) === true) {\n        if (Math.round(Math.random())) {\n          break;\n        }\n      }\n\n      var transitions = [], i;\n\n      for (i=0; i<newFsm.transitions.length; i++) {\n        if (noam.util.areEquivalent(newFsm.transitions[i].toStates[0], currentState)) {\n          transitions.push(newFsm.transitions[i]);\n        }\n      }\n\n      if (transitions.length === 0) {\n        break;\n      }\n\n      var transition = transitions[Math.floor(Math.random()*transitions.length)];\n\n      trail.push(transition.symbol);\n      currentState = transition.fromState;\n    }\n\n    trail.reverse();\n\n    return trail;\n  };\n\n  // generate a random string which the fsm doest accept\n  noam.fsm.randomStringNotInLanguage = function(fsm) {\n    var fsmType = noam.fsm.determineType(fsm);\n    var newFsm = fsm;\n\n    if (fsmType === noam.fsm.nfaType) {\n      newFsm = noam.fsm.convertNfaToDfa(fsm);\n    } else if (fsmType === noam.fsm.enfaType) {\n      newFsm = noam.fsm.convertEnfaToNfa(fsm);\n      newFsm = noam.fsm.convertNfaToDfa(newFsm);\n    }\n\n    newFsm = noam.fsm.minimize(newFsm);\n\n    var nonAcceptingStates = [], i;\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (!(noam.util.contains(newFsm.acceptingStates, newFsm.states[i]))) {\n        nonAcceptingStates.push(newFsm.states[i]);\n      }\n    }\n\n    if (nonAcceptingStates.length === 0) {\n      return null;\n    }\n\n    var currentState = nonAcceptingStates[Math.floor(Math.random()*nonAcceptingStates.length)];\n    var trail = [];\n\n    while (true) {\n      if (noam.util.areEquivalent(currentState, newFsm.initialState) === true) {\n        if (Math.round(Math.random())) {\n          break;\n        }\n      }\n\n      var transitions = [];\n\n      for (i=0; i<newFsm.transitions.length; i++) {\n        if (noam.util.areEquivalent(newFsm.transitions[i].toStates[0], currentState)) {\n          transitions.push(newFsm.transitions[i]);\n        }\n      }\n\n      if (transitions.length === 0) {\n        break;\n      }\n\n      var transition = transitions[Math.floor(Math.random()*transitions.length)];\n\n      trail.push(transition.symbol);\n      currentState = transition.fromState;\n    }\n\n    trail.reverse();\n\n    return trail;\n  };\n\n  // get a new fsm which accepts the language L=L1+L2 (set union) where\n  // L1 is the language accepted by fsma and\n  // L2 is the language accepted by fsmB\n  noam.fsm.union = function(fsmA, fsmB) {\n    if (!(noam.util.areEquivalent(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error(\"Alphabets must be the same\");\n    }\n\n    var newFsm = {\n      alphabet : noam.util.clone(fsmA.alphabet),\n      states : [],\n      initialState : [noam.util.clone(fsmA.initialState), noam.util.clone(fsmB.initialState)],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    var i, j, k;\n\n    for (i=0; i<fsmA.states.length; i++) {\n      for (j=0; j<fsmB.states.length; j++) {\n        var newState = [noam.util.clone(fsmA.states[i]), noam.util.clone(fsmB.states[j])];\n        newFsm.states.push(newState);\n\n        if (noam.util.contains(fsmA.acceptingStates, fsmA.states[i]) ||\n            noam.util.contains(fsmB.acceptingStates, fsmB.states[j])) {\n          newFsm.acceptingStates.push(newState);\n        }\n\n        for (k=0; k<newFsm.alphabet.length; k++) {\n          newFsm.transitions.push({\n            fromState : newState,\n            symbol : newFsm.alphabet[k],\n            toStates : [[noam.fsm.makeTransition(fsmA, [fsmA.states[i]], newFsm.alphabet[k])[0],\n                        noam.fsm.makeTransition(fsmB, [fsmB.states[j]], newFsm.alphabet[k])[0]]]\n          });\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L=L1/L2 (set intersection) where\n  // L1 is the language accepted by fsma and\n  // L2 is the language accepted by fsmB\n  noam.fsm.intersection = function(fsmA, fsmB) {\n    var new_alphabet = noam.util.clone(noam.util.setIntersection(fsmA.alphabet, fsmB.alphabet));\n\n    var newFsm = {\n      alphabet : new_alphabet,\n      states : [],\n      initialState : [noam.util.clone(fsmA.initialState), noam.util.clone(fsmB.initialState)],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    var i, j, k;\n\n    for (i=0; i<fsmA.states.length; i++) {\n      for (j=0; j<fsmB.states.length; j++) {\n        var newState = [noam.util.clone(fsmA.states[i]), noam.util.clone(fsmB.states[j])];\n        newFsm.states.push(newState);\n\n        if (noam.util.contains(fsmA.acceptingStates, fsmA.states[i]) &&\n            noam.util.contains(fsmB.acceptingStates, fsmB.states[j])) {\n          newFsm.acceptingStates.push(newState);\n        }\n\n        for (k=0; k<newFsm.alphabet.length; k++) {\n          newFsm.transitions.push({\n            fromState : newState,\n            symbol : newFsm.alphabet[k],\n            toStates : [[noam.fsm.makeTransition(fsmA, [fsmA.states[i]], newFsm.alphabet[k])[0],\n                        noam.fsm.makeTransition(fsmB, [fsmB.states[j]], newFsm.alphabet[k])[0]]]\n          });\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L=L1-L2 (set difference) where\n  // L1 is the language accepted by fsma and\n  // L2 is the language accepted by fsmB\n  noam.fsm.difference = function(fsmA, fsmB) {\n    if (!(noam.util.areEquivalent(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error(\"Alphabets must be the same\");\n    }\n\n    var newFsm = {\n      alphabet : noam.util.clone(fsmA.alphabet),\n      states : [],\n      initialState : [noam.util.clone(fsmA.initialState), noam.util.clone(fsmB.initialState)],\n      acceptingStates : [],\n      transitions : []\n    };\n\n    var i, j, k;\n\n    for (i=0; i<fsmA.states.length; i++) {\n      for (j=0; j<fsmB.states.length; j++) {\n        var newState = [noam.util.clone(fsmA.states[i]), noam.util.clone(fsmB.states[j])];\n        newFsm.states.push(newState);\n\n        if (noam.util.contains(fsmA.acceptingStates, fsmA.states[i]) &&\n            !(noam.util.contains(fsmB.acceptingStates, fsmB.states[j]))) {\n          newFsm.acceptingStates.push(newState);\n        }\n\n        for (k=0; k<newFsm.alphabet.length; k++) {\n          newFsm.transitions.push({\n            fromState : newState,\n            symbol : newFsm.alphabet[k],\n            toStates : [[noam.fsm.makeTransition(fsmA, [fsmA.states[i]], newFsm.alphabet[k])[0],\n                        noam.fsm.makeTransition(fsmB, [fsmB.states[j]], newFsm.alphabet[k])[0]]]\n          });\n        }\n      }\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the complement language of the\n  // langauge accepted by the input fsm\n  noam.fsm.complement = function(fsm) {\n    var newFsm = noam.util.clone(fsm);\n\n    var newAccepting = [], i;\n\n    for (i=0; i<newFsm.states.length; i++) {\n      if (!(noam.util.contains(newFsm.acceptingStates, newFsm.states[i]))) {\n        newAccepting.push(newFsm.states[i]);\n      }\n    }\n\n    newFsm.acceptingStates = newAccepting;\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L1L2 where\n  // L1 is the language accepted by fsmA and L2 is the\n  // langauge accepted by fsmB\n  noam.fsm.concatenation = function(fsmA, fsmB) {\n    if (!(noam.util.areEquivalent(fsmA.alphabet, fsmB.alphabet))) {\n      throw new Error(\"Alphabets must be the same\");\n    }\n\n    if (noam.util.containsAny(fsmA.states, fsmB.states)) {\n      throw new Error(\"States must not overlap\");\n    }\n\n    var newFsm = {\n      alphabet : noam.util.clone(fsmA.alphabet),\n      states : noam.util.clone(fsmA.states).concat(noam.util.clone(fsmB.states)),\n      initialState : noam.util.clone(fsmA.initialState),\n      acceptingStates : noam.util.clone(fsmB.acceptingStates),\n      transitions : noam.util.clone(fsmA.transitions).concat(noam.util.clone(fsmB.transitions))\n    };\n\n    for (var i=0; i<fsmA.acceptingStates.length; i++) {\n      newFsm.transitions.push({\n        fromState : noam.util.clone(fsmA.acceptingStates[i]),\n        toStates : [noam.util.clone(fsmB.initialState)],\n        symbol : noam.fsm.epsilonSymbol\n      });\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the language L*, where L is\n  // accepted by the input fsm and * is the kleene operator\n  noam.fsm.kleene = function(fsm) {\n    var newFsm = noam.util.clone(fsm);\n\n    var newInitial = \"NEW_INITIAL\";\n\n    newFsm.states.push(newInitial);\n    newFsm.transitions.push({\n      fromState : newInitial,\n      toStates : [newFsm.initialState],\n      symbol : noam.fsm.epsilonSymbol\n    });\n    newFsm.initialState = newInitial;\n\n    for (var i=0; i<newFsm.acceptingStates.length; i++) {\n      newFsm.transitions.push({\n        fromState : newFsm.acceptingStates[i],\n        toStates : [newInitial],\n        symbol : noam.fsm.epsilonSymbol\n      });\n    }\n\n    return newFsm;\n  };\n\n  // get a new fsm which accepts the reverse language of the input fsm\n  noam.fsm.reverse = function(fsm) {\n    var newFsm = noam.util.clone(fsm);\n\n    var newTransitions = [];\n\n    for (var i=0; i<newFsm.transitions.length; i++) {\n      for (var j=0; j<newFsm.transitions[i].toStates.length; j++) {\n        newTransitions.push({\n          fromState : newFsm.transitions[i].toStates[j],\n          toStates : [newFsm.transitions[i].fromState],\n          symbol : newFsm.transitions[i].symbol\n        });\n      }\n    }\n\n    newFsm.transitions = newTransitions;\n\n    var oldAcceptingStates = newFsm.acceptingStates;\n\n    newFsm.acceptingStates = [newFsm.initialState];\n\n    var newInitialState = \"NEW_INITIAL\";\n    newFsm.states.push(newInitialState);\n    newFsm.initialState = newInitialState;\n\n    newFsm.transitions.push({\n      fromState : newInitialState,\n      toStates : oldAcceptingStates,\n      symbol : noam.fsm.epsilonSymbol\n    });\n\n    return newFsm;\n  };\n\n  // check whether the language accepted by fsmB is a subset of\n  // the language accepted by fsmA\n  noam.fsm.isSubset = function(fsmA, fsmB) {\n    var fsmIntersection = noam.fsm.intersection(fsmA, fsmB);\n\n    return noam.fsm.areEquivalentFSMs(fsmB, fsmIntersection);\n  };\n\n  // convert the fsm into a regular grammar\n  noam.fsm.grammar = function(fsm) {\n    var grammar = {\n      nonterminals : noam.util.clone(fsm.states),\n      terminals : noam.util.clone(fsm.alphabet),\n      initialNonterminal : noam.util.clone(fsm.initialState),\n      productions : []\n    };\n\n    var i;\n\n    for (i=0; i<fsm.transitions.length; i++) {\n      if (fsm.transitions[i].symbol === noam.fsm.epsilonSymbol) {\n        grammar.productions.push({\n          left : [noam.util.clone(fsm.transitions[i].fromState)],\n          right : noam.util.clone(fsm.transitions[i].toStates)\n        });\n      } else {\n        grammar.productions.push({\n          left : [noam.util.clone(fsm.transitions[i].fromState)],\n          right : [noam.util.clone(fsm.transitions[i].symbol)].concat(\n            noam.util.clone(fsm.transitions[i].toStates))\n        });\n      }\n    }\n\n    for (i=0; i<fsm.acceptingStates.length; i++) {\n      grammar.productions.push({\n        left : [noam.util.clone(fsm.acceptingStates[i])],\n        right : [noam.grammar.epsilonSymbol]\n      });\n    }\n\n    return grammar;\n  };\n\n  noam.fsm.symbolsForTransitions = function(fsm, stateA, stateB) {\n    var res = [];\n\n    for (var i=0; i<fsm.transitions.length; i++) {\n      var transition = fsm.transitions[i];\n\n      if (noam.util.areEquivalent(transition.fromState, stateA) &&\n          noam.util.contains(transition.toStates, stateB)) {\n        res.push(transition.symbol);\n      }\n    }\n\n    return res;\n  };\n\n  noam.fsm.toRegex = function(fsm) {\n    var r = [];\n    var n = fsm.states.length;\n\n    var i, j, k, z;\n\n    for (k=0; k<n+1; k++) {\n      r[k] = [];\n      for (i=0; i<n; i++) {\n        r[k][i] = [];\n      }\n    }\n\n    for (i=0; i<n; i++) {\n      for (j=0; j<n; j++) {\n        var symbols = noam.fsm.symbolsForTransitions(fsm, fsm.states[i], fsm.states[j]);\n\n        for (z=0; z<symbols.length; z++) {\n          symbols[z] = noam.re.tree.makeLit(symbols[z]);\n        }\n\n        if (i === j) {\n          symbols.push(noam.re.tree.makeEps());\n        }\n\n        r[0][i][j] = noam.re.tree.makeAlt(symbols);\n      }\n    }\n\n    for (k=1; k<n+1; k++) {\n      for (i=0; i<n; i++) {\n        for (j=0; j<n; j++) {\n          var t1 = ((typeof r[k-1][i][k-1].choices !== \"undefined\" && r[k-1][i][k-1].choices.length === 0) ||\n              (typeof r[k-1][k-1][j].choices !== \"undefined\" && r[k-1][k-1][j].choices.length === 0) ||\n              (typeof r[k-1][k-1][k-1].choices !== \"undefined\" && r[k-1][k-1][k-1].choices.length === 0));\n          var t2 =  (typeof r[k-1][i][j].choices !== \"undefined\" && r[k-1][i][j].choices.length === 0);\n\n          var seq = null\n\n          if (r[k-1][k-1][k-1].tag === noam.re.tree.tags.EPS) {\n            seq = noam.re.tree.makeSeq([r[k-1][i][k-1], r[k-1][k-1][j]]);\n          } else {\n            seq = noam.re.tree.makeSeq([r[k-1][i][k-1], noam.re.tree.makeKStar(r[k-1][k-1][k-1]), r[k-1][k-1][j]]);\n          }\n\n          var alt = [];\n\n          if (!t2) {\n            alt.push(r[k-1][i][j]);\n          }\n\n          if (!t1) {\n            alt.push(seq);\n          }\n\n          alt = noam.re.tree.makeAlt(alt);\n\n          r[k][i][j] = alt;\n        }\n      }\n    }\n\n    var startStateIndex = -1;\n    var acceptableStatesIndexes = [];\n\n    for (i=0; i<fsm.states.length; i++) {\n      if (noam.util.areEquivalent(fsm.states[i], fsm.initialState)) {\n        startStateIndex = i;\n      }\n\n      if (noam.util.contains(fsm.acceptingStates, fsm.states[i])) {\n        acceptableStatesIndexes.push(i);\n      }\n    }\n\n    var elements = [];\n\n    for (i=0; i<acceptableStatesIndexes.length; i++) {\n      elements.push(r[n][startStateIndex][acceptableStatesIndexes[i]]);\n    }\n\n    return noam.re.tree.makeAlt(elements);\n  };\n\n  noam.grammar = {};\n\n  noam.grammar.epsilonSymbol = '$';\n  noam.grammar.regType = 'regular';\n  noam.grammar.cfgType = 'context-free';\n  noam.grammar.csgType = 'context-sensitive';\n  noam.grammar.unrestrictedType = 'unrestricted';\n\n  // validate the grammar\n  noam.grammar.validate = function(grammar) {\n    if (!(typeof grammar !== 'undefined' &&\n        Array.isArray(grammar.nonterminals) &&\n        Array.isArray(grammar.terminals) &&\n        typeof grammar.initialNonterminal !== 'undefined' && grammar.initialNonterminal !== null &&\n        Array.isArray(grammar.productions))) {\n      throw new Error('Grammar must be defined and have nonterminals, terminals, initialNonterminal and productions array properties!');\n    }\n    \n    var i, j;\n\n    if (grammar.nonterminals.length < 1) {\n      throw new Error('Set of nonterminals must not be empty.');\n    }\n\n    if (grammar.terminals.length < 1) {\n      throw new Error('Set of terminals must not be empty.');\n    }\n\n    for (i=0; i<grammar.nonterminals.length; i++) {\n      if (noam.util.contains(grammar.nonterminals, grammar.nonterminals[i], i+1)) {\n        throw new Error('Equivalent nonterminals');\n      }\n    }\n\n    for (i=0; i<grammar.terminals.length; i++) {\n      if (noam.util.contains(grammar.terminals, grammar.terminals[i], i+1)) {\n        throw new Error('Equivalent terminals');\n      }\n    }\n\n    for (i=0; i<grammar.terminals.length; i++) {\n      if (noam.util.contains(grammar.nonterminals, grammar.terminals[i])) {\n        throw new Error('Terminals and nonterminals must not overlap');\n      }\n    }\n\n    if (!(noam.util.contains(grammar.nonterminals, grammar.initialNonterminal))) {\n      throw new Error('InitialNonterminal must be in nonterminals');\n    }\n\n    for (i=0; i<grammar.productions.length; i++) {\n      var production = grammar.productions[i];\n\n      if (!(Array.isArray(production.left))) {\n        throw new Error('Left side of production must be an array');\n      }\n\n      if (production.left.length === 0) {\n        throw new Error('Left side of production must have at least one terminal or nonterminal');\n      }\n\n      for (j=0; j<production.left.length; j++) {\n        if (!(noam.util.contains(grammar.nonterminals, production.left[j])) &&\n            !(noam.util.contains(grammar.terminals, production.left[j]))) {\n          throw new Error('Left side of production must be in nonterminals or terminals');\n        }\n      }\n\n      if (!(Array.isArray(production.right))) {\n        throw new Error('Right side of production must be an array');\n      }\n\n      if (production.right.length === 1 && production.right[0] === noam.grammar.epsilonSymbol) {\n        \n      } else {\n        if (production.right.length === 0) {\n          throw new Error('Right side of production must have at least one terminal or nonterminal or epsilon symbol');\n        }\n\n        for (j=0; j<production.right.length; j++) {\n          if (!(noam.util.contains(grammar.nonterminals, production.right[j])) &&\n              !(noam.util.contains(grammar.terminals, production.right[j]))) {\n            throw new Error('Right side of production must be in nonterminals or terminals');\n          }\n        }\n      }\n\n      if (noam.util.contains(grammar.productions, production, i+1)) {\n        throw new Error('Grammar must not have duplicate productions');\n      }\n    }\n\n    return true;\n  };\n\n  // determine whether the grammar is regular, context-free, \n  // context-sensitive or unrestricted\n  noam.grammar.determineType = function(grammar) {\n    var type = noam.grammar.regType;\n    var isRightRegular = null;\n    var i, j, indexOfNonterminal;\n\n    for (i=0; i<grammar.productions.length; i++) {\n      var production = grammar.productions[i];\n\n      // handle both left-regular and right-regular\n      if (type === noam.grammar.regType) {\n        if (production.left.length !== 1 || !(noam.util.contains(grammar.nonterminals, production.left[0]))) {\n          type = noam.grammar.cfgType;\n        } else {\n          if (production.right.length === 1) {\n            continue;\n          } else {\n            var rightNonTerminalCount = 0;\n            indexOfNonterminal = -1;\n\n            for (j=0; j<production.right.length; j++) {\n              if (noam.util.contains(grammar.nonterminals, production.right[j])) {\n                rightNonTerminalCount += 1;\n                indexOfNonterminal = j;\n              }\n            }\n\n            if (rightNonTerminalCount > 1) {\n              type = noam.grammar.cfgType;\n            } else if (rightNonTerminalCount === 0) {\n              continue;\n            } else {\n              if (indexOfNonterminal === 0) {\n                if (isRightRegular === null) {\n                  isRightRegular = false;\n                  continue;\n                } else if (isRightRegular === false) {\n                  continue;\n                } else if (isRightRegular === true) {\n                  type = noam.grammar.cfgType;\n                }\n              } else if (indexOfNonterminal === production.right.length - 1) {\n                if (isRightRegular === null) {\n                  isRightRegular = true;\n                  continue;\n                } else if (isRightRegular === true) {\n                  continue;\n                } else if (isRightRegular === false) {\n                  type = noam.grammar.cfgType;\n                }\n              } else {\n                type = noam.grammar.cfgType;\n              }\n            }\n          }\n        }\n      }\n\n      if (type === noam.grammar.cfgType) {\n        if (production.left.length !== 1 || !(noam.util.contains(grammar.nonterminals, production.left[0]))) {\n          type = noam.grammar.csgType;\n        }\n      }\n\n      if (type === noam.grammar.csgType) {\n        var leftNonTerminalCount = 0;\n        indexOfNonterminal = -1;\n\n        for (j=0; j<production.left.length; j++) {\n          if (noam.util.contains(grammar.nonterminals, production.left[j])) {\n            leftNonTerminalCount += 1;\n            indexOfNonterminal = j;\n          }\n        }\n\n        if (leftNonTerminalCount > 1) {\n          return noam.grammar.unrestrictedType;\n        }\n\n        var prefix = production.left.slice(0, indexOfNonterminal-1);\n        var sufix = production.left.slice(indexOfNonterminal);\n\n        for (j=0; j<prefix.length; j++) {\n          if (!(noam.util.areEquivalent(prefix[j], production.right[j]))) {\n            return noam.grammar.unrestrictedType;\n          }\n        }\n\n        for (j=0; j<sufix.length; j++) {\n          if (!(noam.util.areEquivalent(sufix[sufix.length-j-1], production.right[production.right.length-j-1]))) {\n            return noam.grammar.unrestrictedType;\n          }\n        }\n\n        if (production.right.length <= prefix.length + sufix.length) {\n          return noam.grammar.unrestrictedType;\n        }\n      }\n    }\n\n    return type;\n  };\n\n  // print the grammar in a human-readable condensed ascii format\n  noam.grammar.printAscii = function(grammar) {\n    var str = [];\n\n    str.push(\"Initial nonterminal: \" + \"<\" + grammar.initialNonterminal + \">\");\n\n    var slimProds = [], i, j, k;\n\n    for (i=0; i<grammar.productions.length; i++) {\n      var foundSlim = -1;\n\n      for (j=0; j<slimProds.length; j++) {\n        if (noam.util.areEquivalent(slimProds[j][0], grammar.productions[i].left)) {\n          foundSlim = j;\n          break;\n        }\n      }\n\n      if (foundSlim === -1) {\n        slimProds[slimProds.length] = [grammar.productions[i].left, [grammar.productions[i].right]];\n      } else {\n        slimProds[foundSlim][1].push(grammar.productions[i].right);\n      }\n    }\n\n    for (i=0; i<slimProds.length; i++) {\n      var prod = [];\n\n      for (j=0; j<slimProds[i][0].length; j++) {\n        if (noam.util.contains(grammar.nonterminals, slimProds[i][0][j])) {\n          prod.push(\"<\" + slimProds[i][0][j].toString() + \">\");\n        } else {\n          if (slimProds[i][0][j] === noam.grammar.epsilonSymbol) {\n            prod.push(slimProds[i][0][j].toString());\n          } else {\n            prod.push('\"' + slimProds[i][0][j].toString() + '\"');\n          }\n        }\n      }\n\n      prod.push(\"->\");\n\n      for (j=0; j<slimProds[i][1].length; j++) {\n        for (k=0; k<slimProds[i][1][j].length; k++) {\n          if (noam.util.contains(grammar.nonterminals, slimProds[i][1][j][k])) {\n            prod.push(\"<\" + slimProds[i][1][j][k].toString() + \">\");\n          } else {\n            if (slimProds[i][1][j][k] === noam.grammar.epsilonSymbol) {\n              prod.push(slimProds[i][1][j][k].toString());\n            } else {\n              prod.push('\"' + slimProds[i][1][j][k].toString() + '\"');\n            }\n          }\n        }\n\n        if (j < slimProds[i][1].length - 1) {\n          prod.push(\"|\");\n        }\n      }\n\n      str.push(prod.join(\" \"));\n    }\n\n    return str.join(\"\\n\");\n  };\n\n  /*\n   * Regular expressions module.\n   *\n   * Parsed regular expressions are represented by a syntax tree. Tools for working with that\n   * representation are accessible through noam.re.tree.\n   *\n   * Two linear representations are also available and provide a convenient way to specify\n   * some languages, but are not composable like the tree representation. The array representation\n   * is available through noam.re.array and supports arbitrarily complex literals. If all the\n   * literals are characters, the string representation should be more convenient. It is\n   * available through noam.re.string. These linear representations are only useful for specifying\n   * languages and should usually be converted to a tree representation or to an automaton immediately.\n   */\n  noam.re = (function() {\n\n    /*\n     * Tools for creating and manipulating parsed regular expressions.\n     *\n     * The make* functions are a minimal API that can be used to create arbitrarily complex\n     * regular expressions programatically.\n     */\n    var tree = (function() {\n      var tags = {\n        ALT: 'alt',\n        SEQ: 'sequence',\n        KSTAR: 'kleene_star',\n        LIT: 'literal',\n        EPS: 'epsilon'\n      };\n\n      function copyAndDeleteProperties(o1, o2) {\n        var p;\n\n        for (p in o1) {\n          if (o1.hasOwnProperty(p)) {\n            delete o1[p];\n          }\n        }\n\n        for (p in o2) {\n          if (o2.hasOwnProperty(p)) {\n            o1[p] = o2[p];\n          }\n        }\n      }\n\n      /*\n        Simplifies the regular expression @a tree (a noam.re.tree object).\n        The goal of simplification is to obtain a regular expression which\n        defines the same language but has a smaller number of elements in\n        the tree structure and therefore less elements in array or string\n        form. Simplification is performed by iteratively transforming the\n        tree using a set of known algebraic equivalences in Kleene algebra.\n        If specified, the @a numIterations integer limits the number of\n        transformations that will be performed. Furthermore, if specified,\n        the @a appliedPatterns array will be filled with objects that\n        describe which patterns were applied, i.e. which transformations\n        were performed. The original tree @a tree is not modified; a new\n        tree is returned as a result.\n\n        The current set of patterns that are checked are (small alphabet\n        letters represent any regular expression):\n\n          # (a) => a (sequence of 1 element)\n          # (a) => a (choices with 1 element)\n          # $* => $\n          # (a*)* => a*\n          # (a+b*)* => (a+b)*\n          # $+a* => a*\n          # (a*b*c*)* => (a*+b*+c*)*\n          # $a => a\n          # (a+(b+c)) => a+b+c\n          # ab(cd) => abcd\n          # a+b+a => b+a\n          # a+b+a* => b+a*\n          # a*a* => a*\n          # (aa+a)* => a*\n          # (a+$)* => a*\n          # (ab+ac) => a(b+c)\n          # a*aa* => aa*\n          # (ab+cb) => (a+c)b\n          # a*($+b(a+b)*) => (a+b)*\n          # ($+(a+b)*a)b* => (a+b)*\n          # (a()) => ()\n          # ()* => ()\n\n        If none of these \"simple\" patterns can be applied, the simplification\n        process tries to apply patterns based on language subset (via\n        transformations to fsms):\n\n          # L1+L2 => L2, if L1 is subset of L2\n          # (L1+L2)* => L2, if L1* is subset of L2*\n          # L1*L2* => L2, if L1* is subset of L2*\n          # $+L => L, if L contains $\n          # (L1+$)(L2)* => (L2)* if L1 is subset of L2\n\n        The tree transformation process is stopped after no transformation\n        can be applied to the tree.\n      */\n\n      var _regex_simplification_patterns = [];\n\n      // (a) => a (sequence)\n      function _regex_simplify_1(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length === 1){\n          tree.tag = tree.elements[0].tag;\n\n          copyAndDeleteProperties(tree, tree.elements[0]);\n          return true;\n        }\n\n        return false;\n      }\n\n      // (a) => a (choices)\n      function _regex_simplify_2(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length === 1) {\n          tree.tag = tree.choices[0].tag;\n\n          copyAndDeleteProperties(tree, tree.choices[0]);\n          return true;\n        }\n\n        return false;\n      }\n\n      // $* => $\n      function _regex_simplify_3(tree, fsmCache) {\n         if (tree.tag === tags.KSTAR && tree.expr.tag === tags.EPS) {\n           tree.tag = tree.expr.tag;\n           delete tree.expr;\n           return true;\n         }\n\n         return false;\n      }\n\n      // (a*)* => a*\n      function _regex_simplify_4(tree, fsmCache) {\n         if (tree.tag === tags.KSTAR && tree.expr.tag === tags.KSTAR) {\n           tree.expr = tree.expr.expr;\n           return true;\n         }\n\n         return false;\n      }\n\n      // (a+b*)* => (a+b)*\n      function _regex_simplify_5(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT) {\n          var changed = false;\n          for (var i=0; i<tree.expr.choices.length; i++) {\n            if (tree.expr.choices[i].tag === tags.KSTAR) {\n              tree.expr.choices[i] = tree.expr.choices[i].expr;\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // $+a* => a*\n      function _regex_simplify_6(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          var epsIndex = -1;\n          var kstarIndex = -1;\n\n          for (var i=0; i<tree.choices.length; i++) {\n            if (tree.choices[i].tag === tags.EPS) {\n              epsIndex = i;\n            } else if (tree.choices[i].tag === tags.KSTAR) {\n              kstarIndex = i;\n            }\n          }\n\n          if (epsIndex >= 0 && kstarIndex >= 0) {\n            tree.choices.splice(epsIndex, 1);\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // (a*b*)* => (a*+b*)*\n      function _regex_simplify_7(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.SEQ && tree.expr.elements.length > 0) {\n          var check = true;\n          for (var i=0; i<tree.expr.elements.length; i++) {\n            if (tree.expr.elements[i].tag !== tags.KSTAR) {\n              check = false;\n              break;\n            }\n          }\n\n          if (check) {\n            tree.expr.tag = tags.ALT;\n            tree.expr.choices = tree.expr.elements;\n            delete tree.expr.elements;\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // $a => a\n      function _regex_simplify_8(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var epsIndex = -1;\n\n          for (var i=0; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.EPS) {\n              epsIndex = i;\n            }\n          }\n\n          if (epsIndex >= 0) {\n            tree.elements.splice(epsIndex, 1);\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // (a+(b+c)) => a+b+c\n      function _regex_simplify_9(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          var found = -1, i;\n          for (i=0; i<tree.choices.length; i++) {\n            if (tree.choices[i].tag === tags.ALT) {\n              found = i;\n            }\n          }\n\n          if (found >= 0) {\n            var node = tree.choices[found];\n            tree.choices.splice(found, 1);\n\n            for (i=0; i<node.choices.length; i++) {\n              tree.choices.splice(found+i, 0, node.choices[i]);\n            }\n\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // ab(cd) => abcd\n      function _regex_simplify_10(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var found = -1, i;\n          for (i=0; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.SEQ) {\n              found = i;\n              break;\n            }\n          }\n\n          if (found >= 0) {\n            var node = tree.elements[i];\n            tree.elements.splice(i, 1);\n\n            for (i=0; i<node.elements.length; i++) {\n              tree.elements.splice(found+i, 0, node.elements[i]);\n            }\n\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // a+a => a\n      function _regex_simplify_11(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            var found = -1;\n            for (var j=i+1; j<tree.choices.length; j++) {\n              if (noam.util.areEquivalent(tree.choices[i], tree.choices[j])) {\n                found = j;\n                break;\n              }\n            }\n\n            if (found >= 0) {\n              tree.choices.splice(found, 1);\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a+a* => a*\n      function _regex_simplify_12(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            var found = -1;\n            for (var j=i+1; j<tree.choices.length; j++) {\n              if (tree.choices[j].tag === tags.KSTAR && noam.util.areEquivalent(tree.choices[j].expr, tree.choices[i])) {\n                found = i;\n                break;\n              }\n\n              else if (tree.choices[i].tag === tags.KSTAR && noam.util.areEquivalent(tree.choices[i].expr, tree.choices[j])) {\n                found = j;\n                break;\n              }\n            }\n\n            if (found >= 0) {\n              tree.choices.splice(found, 1);\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a*a* => a*\n      function _regex_simplify_13(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var found = -1;\n\n          for (var i=0; i<tree.elements.length-1; i++) {\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i+1].tag === tags.KSTAR && noam.util.areEquivalent(tree.elements[i], tree.elements[i+1])) {\n              found = i;\n              break;\n            }\n          }\n\n          if (found >= 0) {\n            tree.elements.splice(found+1, 1);\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      // (aa+a)* => (a)*\n      function _regex_simplify_14(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT && tree.expr.choices.length >= 2) {\n          for (var i=0; i<tree.expr.choices.length; i++) {\n            for (var j=0; j<tree.expr.choices.length; j++) {\n              if (i !== j && tree.expr.choices[j].tag === tags.SEQ && tree.expr.choices[j].elements.length >= 2) {\n                var found = true;\n\n                for (var k=0; k<tree.expr.choices[j].elements.length; k++) {\n                  if (!(noam.util.areEquivalent(tree.expr.choices[i], tree.expr.choices[j].elements[k]))) {\n                    found = false;\n                    break;\n                  }\n                }\n\n                if (found) {\n                  tree.expr.choices.splice(j, 1);\n                  return true;\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (a + $)* => (a)*\n      function _regex_simplify_15(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT && tree.expr.choices.length >= 2) {\n          for (var i=0; i<tree.expr.choices.length; i++) {\n            if (tree.expr.choices[i].tag === tags.EPS) {\n              tree.expr.choices.splice(i, 1);\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (ab+ac) => a(b+c)\n      function _regex_simplify_16(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >=2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            if (tree.choices[i].tag === tags.SEQ && tree.choices[i].elements.length >= 2) {\n              for (var j=i+1; j<tree.choices.length; j++) {\n                if (tree.choices[j].tag === tags.SEQ && tree.choices[j].elements.length >= 2) {\n                  if (noam.util.areEquivalent(tree.choices[j].elements[0], tree.choices[i].elements[0])) {\n                    var first = tree.choices[i].elements[0];\n                    var rest1 = makeSeq(tree.choices[i].elements.slice(1));\n                    var rest2 = makeSeq(tree.choices[j].elements.slice(1));\n\n                    var _alt = makeAlt([rest1, rest2]);\n                    var _seq = makeSeq([first, _alt]);\n\n                    tree.choices[i] = _seq;\n                    tree.choices.splice(j, 1);\n\n                    return true;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a*aa* => aa*\n      function _regex_simplify_17(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >=3) {\n          for (var i=1; i<tree.elements.length-1; i++) {\n            if (tree.elements[i-1].tag === tags.KSTAR && tree.elements[i+1].tag === tags.KSTAR) {\n              if (noam.util.areEquivalent(tree.elements[i-1], tree.elements[i+1]) &&\n                  noam.util.areEquivalent(tree.elements[i-1].expr, tree.elements[i])) {\n                tree.elements.splice(i-1, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (ab+cb) => (a+c)b\n      function _regex_simplify_18(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >=2) {\n          for (var i=0; i<tree.choices.length-1; i++) {\n            if (tree.choices[i].tag === tags.SEQ && tree.choices[i].elements.length >= 2) {\n              for (var j=i+1; j<tree.choices.length; j++) {\n                if (tree.choices[j].tag === tags.SEQ && tree.choices[j].elements.length >= 2) {\n                  if (noam.util.areEquivalent(tree.choices[j].elements[tree.choices[j].elements.length-1],\n                                              tree.choices[i].elements[tree.choices[i].elements.length-1])) {\n                    var last = tree.choices[i].elements[tree.choices[i].elements.length-1];\n                    var rest1 = makeSeq(tree.choices[i].elements.slice(0, tree.choices[i].elements.length-1));\n                    var rest2 = makeSeq(tree.choices[j].elements.slice(0, tree.choices[j].elements.length-1));\n\n                    var _alt = makeAlt([rest1, rest2]);\n                    var _seq = makeSeq([_alt, last]);\n\n                    tree.choices[i] = _seq;\n                    tree.choices.splice(j, 1);\n\n                    return true;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // L1+L2 => L2, if L1 is subset of L2\n      function _regex_simplify_19(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length >= 2) {\n          var fsms = [];\n\n          fsms.push(getFromCacheOrCreateFsm(tree.choices[0], fsmCache));\n\n          var found = -1;\n\n          for (var i=0; i<tree.choices.length-1; i++) {\n            for (var j=i+1; j<tree.choices.length; j++) {\n              if (fsms.length <= j) {\n                fsms.push(getFromCacheOrCreateFsm(tree.choices[j], fsmCache));\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[i], fsms[j]) ) {\n                  found = j;\n                }\n              } catch (e) {\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[j], fsms[i]) ) {\n                  found = i;\n                }\n              } catch (e) {\n              }\n\n              if (found >= 0) {\n                tree.choices.splice(found, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n          return false;\n      }\n\n      // (L1+L2)* => L2*, if L1* is subset of L2*\n      function _regex_simplify_20(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.ALT && tree.expr.choices.length >= 2) {\n          var fsms = [];\n\n          fsms.push(getFromCacheOrCreateFsm(makeKStar(tree.expr.choices[0]), fsmCache));\n\n          var found = -1;\n\n          for (var i=0; i<tree.expr.choices.length-1; i++) {\n            for (var j=i+1; j<tree.expr.choices.length; j++) {\n              if (fsms.length <= j) {\n                fsms.push(getFromCacheOrCreateFsm(makeKStar(tree.expr.choices[j]), fsmCache));\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[i], fsms[j]) ) {\n                  found = j;\n                }\n              } catch (e) {\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[j], fsms[i]) ) {\n                  found = i;\n                }\n              } catch (e) {\n              }\n\n              if (found >= 0) {\n                tree.expr.choices.splice(found, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      function getFromCacheOrCreateFsm(key, ht) {\n        var fsm = ht.get(key);\n\n        if (!(fsm)) {\n          fsm = noam.fsm.minimize(noam.re.tree.toAutomaton(key));\n          ht.put(key, fsm);\n        }\n\n        return fsm;\n      }\n\n      // L1*L2* => L2, if L1* is subset of L2*\n      function _regex_simplify_21(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 2) {\n          var fsms = [];\n          fsms.push(getFromCacheOrCreateFsm(tree.elements[0], fsmCache));\n\n          var found = -1;\n\n          for (var i=0; i<tree.elements.length-1; i++) {\n            fsms.push(getFromCacheOrCreateFsm(tree.elements[i+1], fsmCache));\n\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i+1].tag === tags.KSTAR) {\n              try {\n                if (noam.fsm.isSubset(fsms[i], fsms[i+1]) ) {\n                  found = i+1;\n                }\n              } catch (e) {\n              }\n\n              try {\n                if (noam.fsm.isSubset(fsms[i+1], fsms[i]) ) {\n                  found = i;\n                }\n              } catch (e) {\n              }\n\n              if (found >= 0) {\n                tree.elements.splice(found, 1);\n                return true;\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // $+L => L, if L contains $\n      function _regex_simplify_22(tree, fsmCache) {\n        if (tree.tag === tags.ALT && tree.choices.length > 1) {\n          var index_eps = noam.util.index(tree.choices, makeEps());\n\n          if (index_eps >= 0) {\n            for (var i=0; i<tree.choices.length; i++) {\n              if (tree.choices[i].tag !== tags.EPS) {\n                var fsm = getFromCacheOrCreateFsm(tree.choices[i], fsmCache);\n\n                if (noam.fsm.isAcceptingState(fsm, fsm.initialState)) {\n                  tree.choices.splice(index_eps, 1);\n                  return true;\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // a*($+b(a+b)*) => (a+b)*\n      function _regex_simplify_23(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length > 1) {\n          for (var i=0; i<tree.elements.length-1; i++) {\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i+1].tag === tags.ALT &&\n              tree.elements[i+1].choices.length === 2) {\n\n              var index_eps = noam.util.index(tree.elements[i+1].choices, makeEps());\n\n              if (index_eps >= 0) {\n                var internal = index_eps === 0 ? tree.elements[i+1].choices[1] : tree.elements[i+1].choices[0];\n\n                if (internal.tag === tags.SEQ && internal.elements.length === 2) {\n                  if (internal.elements[1].tag === tags.KSTAR && internal.elements[1].expr.tag === tags.ALT &&\n                      internal.elements[1].expr.choices.length === 2 && noam.util.contains(internal.elements[1].expr.choices, tree.elements[i].expr)) {\n                    if (noam.util.contains(internal.elements[1].expr.choices, internal.elements[0])) {\n                      tree.elements[i+1] = internal.elements[1];\n                      tree.elements.splice(i, 1);\n                      return true;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // ($+(a+b)*a)b* => (a+b)*\n      function _regex_simplify_24(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length > 1) {\n          for (var i=1; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.KSTAR && tree.elements[i-1].tag === tags.ALT &&\n              tree.elements[i-1].choices.length === 2) {\n\n              var index_eps = noam.util.index(tree.elements[i-1].choices, makeEps());\n\n              if (index_eps >= 0) {\n                var internal = index_eps === 0 ? tree.elements[i-1].choices[1] : tree.elements[i-1].choices[0];\n\n                if (internal.tag === tags.SEQ && internal.elements.length === 2) {\n                  if (internal.elements[0].tag === tags.KSTAR && internal.elements[0].expr.tag === tags.ALT &&\n                      internal.elements[0].expr.choices.length === 2 && noam.util.contains(internal.elements[0].expr.choices, tree.elements[i].expr)) {\n                    if (noam.util.contains(internal.elements[0].expr.choices, internal.elements[1])) {\n                      tree.elements[i-1] = internal.elements[0];\n                      tree.elements.splice(i, 1);\n                      return true;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // (L1+$)(L2)* => (L2)* if L1 is subset of L2\n      function _regex_simplify_27(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length > 1) {\n          for (var i=0; i<tree.elements.length; i++) {\n            if (tree.elements[i].tag === tags.KSTAR) {\n              if (i > 0 && tree.elements[i-1].tag === tags.ALT && tree.elements[i-1].choices.length > 1) {\n                var index_eps = noam.util.index(tree.elements[i-1].choices, makeEps());\n\n                if (index_eps >= 0) {\n                  var eps = tree.elements[i-1].choices.splice(index_eps, 1)[0];\n\n                  var fsm_kstar = getFromCacheOrCreateFsm(tree.elements[i], fsmCache);\n                  var fsm_other = getFromCacheOrCreateFsm(tree.elements[i-1], fsmCache);\n\n                  var found = false;\n\n                  try {\n                    if (noam.fsm.isSubset(fsm_kstar, fsm_other)) {\n                      found = true;\n                    }\n                  } catch (e) {\n                  }\n\n                  if (found) {\n                    tree.elements.splice(i-1, 1);\n                    return true;\n                  } else {\n                    tree.elements[i-1].choices.splice(index_eps, 0, eps);\n                  }\n                }\n              } else if (i < tree.elements.length-1 && tree.elements[i+1].tag === tags.ALT && tree.elements[i+1].choices.length > 1) {\n                var index_eps = noam.util.index(tree.elements[i+1].choices, makeEps());\n\n                if (index_eps >= 0) {\n                  var eps = tree.elements[i+1].choices.splice(index_eps, 1)[0];\n\n                  var fsm_kstar = getFromCacheOrCreateFsm(tree.elements[i], fsmCache);\n                  var fsm_other = getFromCacheOrCreateFsm(tree.elements[i+1], fsmCache);\n\n                  var found = false;\n\n                  try {\n                    if (noam.fsm.isSubset(fsm_kstar, fsm_other)) {\n                      found = true;\n                    }\n                  } catch (e) {\n                  }\n\n                  if (found) {\n                    tree.elements.splice(i+1, 1);\n                    return true;\n                  } else {\n                    tree.elements[i+1].choices.splice(index_eps, 0, eps);\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      // (a()) => ()\n      function _regex_simplify_25(tree, fsmCache) {\n        if (tree.tag === tags.SEQ && tree.elements.length >= 1) {\n          for (var i=0; i<tree.elements.length; i++) {\n            if ((tree.elements[i].tag === tags.SEQ && tree.elements[i].elements.length === 0) ||\n                (tree.elements[i].tag === tags.ALT && tree.elements[i].choices.length === 0)) {\n              tree.elements = [];\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // ()* => ()\n      function _regex_simplify_26(tree, fsmCache) {\n        if (tree.tag === tags.KSTAR && tree.expr.tag === tags.SEQ && tree.expr.elements.length === 0) {\n          tree.tag = tags.SEQ;\n          delete tree.expr;\n          tree.elements = [];\n          return true;\n        }\n\n        return false;\n      }\n\n      _regex_simplification_patterns.push({ 'pattern' : \"(a()) => ()\", 'type' : 'structure', 'function' : _regex_simplify_25});\n      _regex_simplification_patterns.push({ 'pattern' : \"()* => ()\", 'type' : 'structure', 'function' : _regex_simplify_26});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a) => a\", 'type' : 'structure', 'function' : _regex_simplify_1 });\n      _regex_simplification_patterns.push({ 'pattern' : \"(a) => a\", 'type' : 'structure', 'function' : _regex_simplify_2 });\n      _regex_simplification_patterns.push({ 'pattern' : \"$* => $\", 'type' : 'structure', 'function' : _regex_simplify_3});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a*)* => a*\", 'type' : 'structure', 'function' : _regex_simplify_4});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a+b*)* => (a+b)*\", 'type' : 'structure', 'function' : _regex_simplify_5});\n      _regex_simplification_patterns.push({ 'pattern' : \"$+a* => a*\", 'type' : 'structure', 'function' : _regex_simplify_6});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a*b*)* => (a*+b*)*\", 'type' : 'structure', 'function' : _regex_simplify_7});\n      _regex_simplification_patterns.push({ 'pattern' : \"$a => a\", 'type' : 'structure', 'function' : _regex_simplify_8});\n      _regex_simplification_patterns.push({ 'pattern' : \"a+a => a\", 'type' : 'structure', 'function' : _regex_simplify_11});\n      _regex_simplification_patterns.push({ 'pattern' : \"a+a* => a*\", 'type' : 'structure', 'function' : _regex_simplify_12});\n      _regex_simplification_patterns.push({ 'pattern' : \"a*a* => a*\", 'type' : 'structure', 'function' : _regex_simplify_13});\n      _regex_simplification_patterns.push({ 'pattern' : \"(aa+a)* => (a)*\", 'type' : 'structure', 'function' : _regex_simplify_14});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a + $)* => (a)*\", 'type' : 'structure', 'function' : _regex_simplify_15});\n      _regex_simplification_patterns.push({ 'pattern' : \"(ab+ac) => a(b+c)\", 'type' : 'structure', 'function' : _regex_simplify_16});\n      _regex_simplification_patterns.push({ 'pattern' : \"a*aa* => aa*\", 'type' : 'structure', 'function' : _regex_simplify_17});\n      _regex_simplification_patterns.push({ 'pattern' : \"(ab+cb) => (a+c)b\", 'type' : 'structure', 'function' : _regex_simplify_18});\n      _regex_simplification_patterns.push({ 'pattern' : \"a*($+b(a+b)*) => (a+b)*\", 'type' : 'structure', 'function' : _regex_simplify_23});\n      _regex_simplification_patterns.push({ 'pattern' : \"($+(a+b)*a)b* => (a+b)*\", 'type' : 'structure', 'function' : _regex_simplify_24});\n      _regex_simplification_patterns.push({ 'pattern' : \"$+L => L, if L contains $\", 'type' : 'fsm', 'function' : _regex_simplify_22});\n      _regex_simplification_patterns.push({ 'pattern' : \"L1+L2 => L2, if L1 is subset of L2\", 'type' : 'fsm', 'function' : _regex_simplify_19});\n      _regex_simplification_patterns.push({ 'pattern' : \"(L1+L2)* => L2, if L1* is subset of L2*\", 'type' : 'fsm', 'function' : _regex_simplify_20});\n      _regex_simplification_patterns.push({ 'pattern' : \"L1*L2* => L2, if L1* is subset of L2*\", 'type' : 'fsm', 'function' : _regex_simplify_21});\n      _regex_simplification_patterns.push({ 'pattern' : \"(L1+$)(L2)* => (L2)* if L1 is subset of L2\", 'type' : 'fsm', 'function' : _regex_simplify_27});\n      _regex_simplification_patterns.push({ 'pattern' : \"ab(cd) => abcd\", 'type' : 'structure', 'function' : _regex_simplify_10});\n      _regex_simplification_patterns.push({ 'pattern' : \"(a+(b+c)) => a+b+c\", 'type' : 'structure', 'function' : _regex_simplify_9});\n\n      function simplify(tree, config) {\n        var treeClone = noam.util.clone(tree);\n\n        if (typeof config === \"undefined\") {\n          config = {};\n        }\n\n        var opts = noam.util.clone(config);\n\n        if (typeof opts.numIterations === \"undefined\") {\n          opts.numIterations = null;\n        }\n\n        if (typeof opts.appliedPatterns === 'undefined') {\n          opts.appliedPatterns = null;\n        } else {\n          opts.appliedPatterns = config.appliedPatterns;\n        }\n\n        if (typeof opts.useFsmPatterns === \"undefined\") {\n          opts.useFsmPatterns = true;\n        }\n\n        var appliedPattern = \"temp\";\n        var iterCount = 0;\n        var fsmCache = new noam.util.HashTable();\n\n        while (appliedPattern !== null && (opts.numIterations === null || iterCount < opts.numIterations)) {\n          appliedPattern = _simplify_iteration(treeClone, fsmCache, opts.useFsmPatterns);\n\n          if (appliedPattern !== null && opts.appliedPatterns !== null) {\n            opts.appliedPatterns.push(appliedPattern);\n          }\n\n          iterCount += 1;\n        }\n\n        return treeClone;\n      }\n\n      function _simplify_iteration(tree, fsmCache, useFsmPatterns) {\n        var pattern = null;\n        var result = null;\n\n        for (var i=0; i<_regex_simplification_patterns.length; i++) {\n          pattern = _regex_simplification_patterns[i];\n\n          if (useFsmPatterns === false && pattern.type === \"fsm\") {\n            continue;\n          }\n\n          result = _simplify_recursion(tree, pattern['function'], fsmCache);\n\n          if (result) {\n            return pattern.pattern;\n          }\n        }\n\n        return null;\n      }\n\n      function _simplify_recursion(tree, patternFunction, fsmCache) {\n        var appliedPattern = patternFunction(tree, fsmCache);\n\n        if (appliedPattern) {\n          return appliedPattern;\n        }\n\n        var children = [];\n\n        if (tree.tag === tags.ALT) {\n          children = tree.choices;\n        } else if (tree.tag === tags.SEQ) {\n          children = tree.elements;\n        } else if (tree.tag === tags.KSTAR) {\n          children = [tree.expr];\n        }\n\n        for (var i=0; i<children.length; i++) {\n          appliedPattern = _simplify_recursion(children[i], patternFunction, fsmCache);\n          if (appliedPattern) {\n            return appliedPattern;\n          }\n        }\n\n        return false;\n      }\n\n      // The choices parameter must be an array of expression trees.\n      // Returns the root of a new tree that represents the expression that is the union of\n      // all the choices.\n      function makeAlt(choices) {\n        return {\n          tag: tags.ALT,\n          choices: choices\n        };\n      }\n\n      // The elements parameter must be an array of expression trees.\n      // Returns the root of a new tree that represents the expression that is the sequence\n      // of all the elements.\n      function makeSeq(elements) {\n        return {\n          tag: tags.SEQ,\n          elements: elements\n        };\n      }\n\n      // Wraps the given expressin tree unde a Kleene star operator.\n      // Returns the root of the new tree.\n      function makeKStar(expr) {\n        return {\n          tag: tags.KSTAR,\n          expr: expr\n        };\n      }\n\n      // Creates a node that represents the literal obj.\n      function makeLit(obj) {\n        return {\n          tag: tags.LIT,\n          obj: obj\n        };\n      }\n\n      var epsNode = {\n        tag: tags.EPS\n      };\n      // Returns a node representing the empty string regular expression.\n      function makeEps() {\n        return epsNode;\n      }\n\n      function _altToAutomaton(regex, automaton, stateCounter) {\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        for (var i=0; i<regex.choices.length; i++) {\n          var statePair = _dispatchToAutomaton(regex.choices[i], automaton, stateCounter);\n          noam.fsm.addEpsilonTransition(automaton, l, [statePair[0]]);\n          noam.fsm.addEpsilonTransition(automaton, statePair[1], [r]);\n        }\n        return [l, r];\n      }\n\n      function _seqToAutomaton(regex, automaton, stateCounter) {\n        // Create the parts for the sequence elements and connect them via epsilon transitions.\n        var l, r, statePair;\n        for (var i=0; i<regex.elements.length; i++) {\n          statePair = _dispatchToAutomaton(regex.elements[i], automaton, stateCounter);\n          if (i === 0) { // this is the first element\n            l = statePair[0];\n          } else { // this is a later element that needs to be connected to the previous elements\n            noam.fsm.addEpsilonTransition(automaton, r, [statePair[0]]);\n          }\n          r = statePair[1];\n        }\n\n        if (l === undefined) { // empty language\n          l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n          r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        }\n\n        return [l, r];\n      }\n\n      function _KStarToAutomaton(regex, automaton, stateCounter) {\n        // The $ sign in the following drawing represents an epsilon transition.\n        //\n        //    ----------------$>----------------\n        //   /                                  \\\n        // |l|-$>-|ll|...(regex.expr)...|rr|-$>-|r|\n        //          \\_________<$_________/\n        //\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var inner = _dispatchToAutomaton(regex.expr, automaton, stateCounter);\n        var ll = inner[0];\n        var rr = inner[1];\n        noam.fsm.addEpsilonTransition(automaton, l, [r]); // zero times\n        noam.fsm.addEpsilonTransition(automaton, l, [ll]); // once or more times\n        noam.fsm.addEpsilonTransition(automaton, rr, [ll]); // repeat\n        noam.fsm.addEpsilonTransition(automaton, rr, [r]); // continue after one or more repetitions\n\n        return [l, r];\n      }\n\n      function _litToAutomaton(regex, automaton, stateCounter) {\n        // Generate the \"left\" and \"right\" states and connect them with the appropriate\n        // transition symbol.\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        try {\n          noam.fsm.addSymbol(automaton, regex.obj);\n        } catch (err) {\n            // addSymbol can throw if the symbol already exists - that's ok but\n            // would like to be able to avoid catching other exceptions\n            // TODO: use a custom exception class instead of Error\n        }\n        noam.fsm.addTransition(automaton, l, [r], regex.obj);\n        return [l, r];\n      }\n\n      function _epsToAutomaton(regex, automaton, stateCounter) {\n        // Generate the \"left\" and \"right\" states and connect them with an epsilon transition.\n        var l = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        var r = noam.fsm.addState(automaton, stateCounter.getAndAdvance());\n        noam.fsm.addEpsilonTransition(automaton, l, [r]);\n        return [l, r];\n      }\n\n      var _toAutomatonFuns = {};\n      _toAutomatonFuns[tags.ALT] = _altToAutomaton;\n      _toAutomatonFuns[tags.SEQ] = _seqToAutomaton;\n      _toAutomatonFuns[tags.KSTAR] = _KStarToAutomaton;\n      _toAutomatonFuns[tags.LIT] = _litToAutomaton;\n      _toAutomatonFuns[tags.EPS] = _epsToAutomaton;\n\n      // Calls the appropriate *ToAutomaton function to handle the various kinds of regular expressions.\n      // @a stateCounter holds the number of the next state to be added to the automaton.\n      // Every *ToAutomaton function modifies @a automaton and returns a pair of states (as a two element array).\n      // The first state is the start state and the second state is the accepting state of the part of the\n      // automaton that accepts the language defined by @a regex.\n      function _dispatchToAutomaton(regex, automaton, stateCounter) {\n        return _toAutomatonFuns[regex.tag](regex, automaton, stateCounter);\n      }\n\n      // Returns the equivalent FSM for the specified regular expression in the tree representation.\n      function toAutomaton(regex) {\n        var automaton = noam.fsm.makeNew();\n        var statePair = _dispatchToAutomaton(regex, automaton, noam.util.makeCounter(0));\n        noam.fsm.setInitialState(automaton, statePair[0]);\n        noam.fsm.addAcceptingState(automaton, statePair[1]);\n        return automaton;\n      }\n\n\n      // \"Operator\" precedence lookup. This is used when determining if we need to\n      // insert parentheses to preserve the meaning of the regex when converting from\n      // the tree representation to the array representation.\n      var _prec = {};\n      _prec[tags.ALT] = 0;\n      _prec[tags.SEQ] = 1;\n      _prec[tags.KSTAR] = 2;\n      // these two are not operators, but it's convenient to assign them a precedence\n      // for uniformity... since they are just atoms (i.e. can't be \"regrouped\"), their\n      // precedence is higher than all the operators\n      _prec[tags.LIT] = 3;\n      _prec[tags.EPS] = 3;\n\n      // Returns true if parantheses are needed around the child expression\n      // when it is embedded into the parent expression, false otherwise.\n      function _needParens(par, child) {\n        return _prec[par.tag] >= _prec[child.tag];\n      }\n\n      // Add child to the array representation, and surround it with parentheses\n      // if necessary.\n      function _optParenToArray(par, child, arr) {\n        var parens = _needParens(par, child);\n        if (parens) {\n            arr.push(noam.re.array.specials.LEFT_PAREN);\n        }\n        _dispatchToArray(child, arr);\n        if (parens) {\n            arr.push(noam.re.array.specials.RIGHT_PAREN);\n        }\n      }\n\n      // Common implementation for _altToArray and _seqToArray.\n      function _binOpToArray(regex, arr, parts, operand) {\n        for (var i=0; i<parts.length; i++) {\n          if (operand!==undefined && i>0) {\n            arr.push(operand);\n          }\n          _optParenToArray(regex, parts[i], arr);\n        }\n      }\n\n      function _altToArray(regex, arr) {\n        _binOpToArray(regex, arr, regex.choices, noam.re.array.specials.ALT);\n      }\n\n      function _seqToArray(regex, arr) {\n        _binOpToArray(regex, arr, regex.elements);\n      }\n\n      function _KStarToArray(regex, arr) {\n        _optParenToArray(regex, regex.expr, arr);\n        arr.push(noam.re.array.specials.KSTAR);\n      }\n\n      function _litToArray(regex, arr) {\n        arr.push(regex.obj);\n      }\n\n      function _epsToArray(regex, arr) {\n        arr.push(noam.re.array.specials.EPS);\n      }\n\n      var _toArrayFuns = {};\n      _toArrayFuns[tags.ALT] = _altToArray;\n      _toArrayFuns[tags.SEQ] = _seqToArray;\n      _toArrayFuns[tags.KSTAR] = _KStarToArray;\n      _toArrayFuns[tags.LIT] = _litToArray;\n      _toArrayFuns[tags.EPS] = _epsToArray;\n\n      // Calls the appropriate *ToArray function to handle the various kinds of regular expressions.\n      // @a arr acts as an accumulator for all *ToArray functions.\n      function _dispatchToArray(regex, arr) {\n        return _toArrayFuns[regex.tag](regex, arr);\n      }\n\n      // Returns the array representation (i.e. noam.re.array) of @a regex which must\n      // be in the tree (i.e. noam.re.tree) representation.\n      // Parentheses are inserted into the array to preserve the meaning of the\n      // regex. However, this does not really lead to minimal parenthesization because\n      // it doesn't consider any rewriting rules. More specifically, if there were\n      // parentheses that modify associativity of alteration or sequencing in the\n      // original regex that was parsed into this tree, they will be preserved\n      // even though they are not necessary.\n      function toArray(regex) {\n        var arr = [];\n        _dispatchToArray(regex, arr);\n        return arr;\n      }\n\n      // Returns the string representation of @a regex which must be in the tree\n      // (i.e. noam.re.tree) representation. This is not always possible, so\n      // this function throws when the regex contains some symbols which are not\n      // single-character strings.\n      //\n      // Semantically equivalent to first calling toArray and then calling\n      // noam.re.array.toString on the result.\n      function toString(regex) {\n        return noam.re.array.toString(toArray(regex));\n      }\n\n      // Returns a random regex containing at most @a numSymbols symbols from the\n      // specified array of possible symbols @a alphabet. The probability distribution\n      // of symbol selection is uniform and can be skewed by repeating elements in\n      // alphabet. The parameter @a cfg is optional and can contain the following\n      // fields:\n      //   ALT_PROB    - the probability that alteration is used between two subexpressions\n      //                 instead of sequencing (default 0.5)\n      //   KLEENE_PROB - the probability that any subexpression is put under the Kleene\n      //                 star operator (default 0.1)\n      //   EPS_PROB    - the probability that epsilon is added as an alteration choice\n      //                 (default 0.1)\n      function random(numSymbols, alphabet, cfg) {\n        var altp = 0.5;\n        var kleenep = 0.1;\n        var epsp = 0.1;\n        if (cfg) {\n          if (cfg.ALT_PROB) {\n            altp = cfg.ALT_PROB;\n          }\n          if (cfg.KLEENE_PROB) {\n            kleenep = cfg.KLEENE_PROB;\n          }\n          if (cfg.EPS_PROB) {\n            epsp = cfg.EPS_PROB;\n          }\n        }\n\n        return _randomKleene(numSymbols, alphabet, altp, kleenep, epsp);\n      }\n\n      function _randomKleene(numSymbols, alphabet, altp, kleenep, epsp) {\n        var expr = _randomExpr(numSymbols, alphabet, altp, kleenep, epsp);\n        if (Math.random() <= kleenep) {\n          expr = makeKStar(expr);\n        }\n        return expr;\n      }\n\n      function _randomExpr(numSymbols, alphabet, altp, kleenep, epsp) {\n        if (numSymbols === 0) {\n          return makeEps();\n        } else if (numSymbols == 1) {\n          return makeLit(alphabet[noam.util.randint(0, alphabet.length-1)]);\n        } else if (Math.random() <= epsp) {\n          return makeAlt([makeEps(),\n              _randomKleene(numSymbols, alphabet, altp, kleenep, epsp)]);\n        } else {\n          var left_sz = noam.util.randint(1, numSymbols-1);\n          var left = _randomKleene(left_sz, alphabet, altp, kleenep, epsp);\n          var right = _randomKleene(numSymbols - left_sz, alphabet, altp, kleenep, epsp);\n          if (Math.random() <= altp) {\n            return makeAlt([left, right]);\n          } else {\n            return makeSeq([left, right]);\n          }\n        }\n      }\n\n      return {\n        tags: tags,\n\n        makeAlt: makeAlt,\n        makeSeq: makeSeq,\n        makeKStar: makeKStar,\n        makeLit: makeLit,\n        makeEps: makeEps,\n\n        toAutomaton: toAutomaton,\n        toArray: toArray,\n        toString: toString,\n\n        random: random,\n        simplify: simplify\n      };\n    })();\n\n    /*\n     * A linear representation of regular expressions.\n     * Every symbol can be an arbitrary object.\n     *\n     * Regular expression operators, parentheses and epsilon must be represented using\n     * the array.specials constants.\n     *\n     * Concatenation is implicit when there are no operators between two subexpressions.\n     * The default operator precedence is Kleene star > concatenation > alteration, and\n     * can be modified using parentheses.\n     */\n    var array = (function() {\n      // This is based on object identity, i.e. each of these constants will be different\n      // from any other object that can be inserted into the regex array.\n      var specials = {\n        ALT: {},\n        KSTAR: {},\n        LEFT_PAREN: {},\n        RIGHT_PAREN: {},\n        EPS: {}\n      };\n\n      // give objects their usual string representation\n      specials.ALT.toString = function() { return \"+\"; };\n      specials.KSTAR.toString = function() { return \"*\"; };\n      specials.LEFT_PAREN.toString = function() { return \"(\"; };\n      specials.RIGHT_PAREN.toString = function() { return \")\"; };\n      specials.EPS.toString = function() { return \"$\"; };\n\n      /* Custom Error constructor for regular expression errors.\n       *\n       * Every RegexError object has the following properties:\n       *  - name: the string \"RegexError\"\n       *  - message: a string description of the error\n       *  - position: a number specifying the 0-based index of the position where the error\n       *              was found (note that this might not be where the error actually is, i.e.\n       *              this number is a hint rather than a definite answer)\n       */\n      function RegexError(message, position) {\n        this.name = \"RegexError\";\n        this.message = message;\n        this.position = position;\n      }\n\n      // We do this to get the stack trace when RegexError objects are thrown.\n      RegexError.prototype = new Error();\n\n      // The next three functions are used to make a convenient array wrapper\n      // used in the parsing code.\n      //\n      // This peek method relies on the fact that accessing \"out of bounds\"\n      // will return undefined.\n      function _peek() {\n        return this.arr[this.idx];\n      }\n      function _advance() {\n        ++this.idx;\n      }\n      function _makeInputSeq(arr) {\n        return {\n          arr: arr,\n          idx: 0,\n          peek: _peek,\n          advance: _advance\n        };\n      }\n\n      // Returns the tree representation of the regex given by @a arr.\n      function toTree(arr) {\n        // special case for the empty language\n        // empty subexpressions are not allowed except when defining the empty language\n        if (arr.length === 0) {\n          return noam.re.tree.makeSeq([]);\n        }\n        var input = _makeInputSeq(arr);\n        var result = _parseExpr(input);\n\n        // should be at end of input\n        if (input.peek() !== undefined) {\n          throw new RegexError(\"Malformed regex array: successfully parsed up to position \" + input.idx, input.idx);\n        }\n        return result;\n      }\n\n      // Returns the replacement string for objects in noam.re.array.specials or\n      // undefined if @a obj doesn't match any of them.\n      function _replacementStr(obj) {\n        // This can't be done with a dict because objects are not hashable...\n        if (obj === specials.ALT || obj === specials.KSTAR ||\n            obj === specials.LEFT_PAREN || obj === specials.RIGHT_PAREN ||\n            obj === specials.EPS) {\n          return obj.toString();\n        } else {\n          return undefined;\n        }\n      }\n\n      // If @a chr is one of the escapable characters\n      // in the string representation (i.e. element of noam.re.string.escapable),\n      // returns it prefixed by a backslash (i.e. escaped).\n      // Otherwise returns chr unchanged.\n      function _escape(chr) {\n        var escapable = noam.re.string.escapable;\n        for (var i=0; i<escapable.length; i++) {\n          if (chr === escapable[i]) {\n            return \"\\\\\" + chr;\n          }\n        }\n        return chr;\n      }\n\n      // Returns the string representation of the regex given by @a arr.\n      //\n      // Throws if the regex contains any symbols which are not one-character strings\n      // and special symbols from noam.re.array.specials.\n      function toString(arr) {\n        var res = [];\n        var elem;\n        var failed = false;\n        for (var i=0; i<arr.length; i++) {\n          elem = arr[i];\n          if (typeof(elem) === \"string\") {\n            if (elem.length !== 1) {\n              failed = true;\n            } else {\n              elem = _escape(elem);\n            }\n          } else {\n            elem = _replacementStr(elem);\n            if (elem === undefined) {\n              failed = true;\n            }\n          }\n          if (failed) {\n            throw new RegexError(\"Array regex not convertible to string representation:\" +\n                \" failed at position \" + i, i);\n          }\n          res.push(elem);\n        }\n        return res.join(\"\");\n      }\n\n      // Returns the automaton accepting the language represented by the regex @a arr.\n      //\n      // Semantically equivalent to first calling toTree on @a arr and then converting\n      // the result to an automaton via noam.re.tree.toAutomaton.\n      function toAutomaton(arr) {\n        var tree = noam.re.array.toTree(arr);\n        return noam.re.tree.toAutomaton(tree);\n      }\n\n      // <expr> ::= <concat> (\"|\" <concat>)*\n      function _parseExpr(input) {\n        var concats = [];\n        while (true) {\n          concats.push(_parseConcat(input));\n          if (input.peek() === specials.ALT) {\n            input.advance();\n          } else {\n            break;\n          }\n        }\n\n        return noam.re.tree.makeAlt(concats);\n      }\n\n      // <concat> ::= <katom>+\n      function _parseConcat(input) {\n        var katoms = [];\n        var katom;\n        while (true) {\n          katom = _parseKatom(input);\n          if (katom === undefined) {\n            break;\n          }\n          katoms.push(katom);\n        }\n        if (katoms.length === 0) {\n          throw new RegexError(\"Malformed regex array: empty choice subexpression at index \" +\n              input.idx, input.idx);\n        }\n\n        return noam.re.tree.makeSeq(katoms);\n      }\n\n      // <katom> ::= <atom> (\"*\" | eps)\n      function _parseKatom(input) {\n        var atom = _parseAtom(input);\n        if (input.peek() === specials.KSTAR) {\n          input.advance();\n          atom = noam.re.tree.makeKStar(atom);\n        }\n        return atom;\n      }\n\n      // <atom> ::= \"(\" <expr> \")\" | eps | symbol\n      function _parseAtom(input) {\n        if (input.peek() === specials.LEFT_PAREN) {\n          input.advance(); // skip the left parenthesis\n          var expr = _parseExpr(input);\n          if (input.peek() !== specials.RIGHT_PAREN) {\n            throw new RegexError(\"Malformed regex array: missing matching right parenthesis at index \" +\n                input.idx, input.idx);\n          }\n          input.advance(); // skip the right parenthesis\n          return expr;\n        } else if (input.peek() === specials.EPS) {\n          input.advance();\n          return noam.re.tree.makeEps();\n        } else if (input.peek()===undefined || input.peek()===specials.ALT ||\n              input.peek()===specials.RIGHT_PAREN) {\n          return undefined; // this will stop the parsing of <concat>\n        } else if (input.peek() === specials.KSTAR) {\n            throw new RegexError(\"Malformed regex array: empty subexpression before Kleene star at index \" +\n                input.idx, input.idx);\n        } else {\n          var sym = noam.re.tree.makeLit(input.peek());\n          input.advance();\n          return sym;\n        }\n      }\n\n      // Returns a random regex in the array representation.\n      // See noam.re.tree.random for further information.\n      function random(numSymbols, alphabet, cfg) {\n        return noam.re.tree.toArray(noam.re.tree.random(numSymbols, alphabet, cfg));\n      }\n\n      function simplify(arr, numIterations, appliedPatterns) {\n        var tree = noam.re.array.toTree(arr);\n        var treeSimplified = noam.re.tree.simplify(tree, numIterations, appliedPatterns);\n        return noam.re.tree.toArray(treeSimplified);\n      }\n\n      return {\n        specials: specials,\n\n        toTree: toTree,\n        toString: toString,\n        toAutomaton: toAutomaton,\n\n        random: random,\n        simplify: simplify\n      };\n    })();\n\n\n    /*\n     * A string representation of regular expressions.\n     *\n     * The alphabet is limited to string characters, i.e. every character in the string is an input\n     * symbol in the language except:\n     *    - the dollar symbol ($) which is used as epsilon, i.e. the empty string\n     *    - the plus character (+) which is used as the alteration operator\n     *    - the star character (*) which is used as the Kleene star\n     *    - parentheses which are used for grouping\n     *    - the backslash character (\\) which is used for escaping the special meaning of all\n     *      the listed characters, including backslash itself; for example, the regex\n     *      \"(a+b)*\\\\+\" represents the language of all strings of as and bs ending in one\n     *      plus character (notice that due to the fact that backslash also escapes in\n     *      JavaScript strings, we need two backslashes to get the two-character\n     *      sequence \\+ that we want)\n     */\n    var string = (function() {\n\n      var escapable = \"$+*()\\\\\";\n\n      // Returns the array representation of the regex represented by @a str.\n      //\n      // Throws an Error if @a str contains illegal escape sequences.\n      function toArray(str) {\n        var arr = [];\n        var escaped = false;\n        var specials = noam.re.array.specials;\n        var chr;\n        for (var i=0; i<str.length; ++i) {\n          if (escaped) {\n            if (escapable.indexOf(str[i]) === -1) {\n              throw new RegexError(\"Malformed string regex: illegal escape sequence \\\\\" + str[i], i);\n            }\n            arr.push(str[i]); // the result of the escape sequence is the escaped character itself\n            escaped = false;\n          } else if (str[i] === '\\\\') {\n            escaped = true;\n          } else {\n            chr = str[i];\n            switch (chr) {\n              case \"$\": chr = specials.EPS; break;\n              case \"+\": chr = specials.ALT; break;\n              case \"*\": chr = specials.KSTAR; break;\n              case \"(\": chr = specials.LEFT_PAREN; break;\n              case \")\": chr = specials.RIGHT_PAREN; break;\n            }\n            arr.push(chr);\n          }\n        }\n        if (escaped) {\n          throw new RegexError(\"Malformed string regex: unfinished escape sequence at end of string\", str.length-1);\n        }\n\n        return arr;\n      }\n\n      // Returns the tree representation of the regex represented by @a str.\n      //\n      // Semantically equivalent to first converting the @a str to the array\n      // representation via noam.re.string.toArray and then converting the\n      // result to a tree via noam.re.array.toTree.\n      function toTree(str) {\n        var arr = noam.re.string.toArray(str);\n        return noam.re.array.toTree(arr);\n      }\n\n      // Returns an FSM accepting the language of the regex represented by @a str.\n      //\n      // Semantically equivalent to first converting the @a str to the array\n      // representation via noam.re.string.toArray, then converting the\n      // result to a tree via noam.re.array.toTree and finally converting the result\n      // of that to an automaton via noam.re.tree.toAutomaton.\n      function toAutomaton(str) {\n        var tree = noam.re.string.toTree(str);\n        return noam.re.tree.toAutomaton(tree);\n      }\n\n      // Returns a random regex string. @a alphabet must be a string. The other\n      // parameters have exactly the same role as in noam.re.tree.random.\n      function random(numSymbols, alphabet, cfg) {\n        var arr = [];\n        for (var i=0; i<alphabet.length; i++) {\n          arr.push(alphabet.charAt(i));\n        }\n        return noam.re.tree.toString(noam.re.tree.random(numSymbols, arr, cfg));\n      }\n\n      function simplify(str, numIterations, appliedPatterns) {\n        var tree = noam.re.string.toTree(str);\n        var treeSimplified = noam.re.tree.simplify(tree, numIterations, appliedPatterns);\n        return noam.re.tree.toString(treeSimplified);\n      }\n\n      return {\n        escapable: escapable,\n\n        toArray: toArray,\n        toTree: toTree,\n        toAutomaton: toAutomaton,\n\n        random: random,\n        simplify: simplify\n      };\n\n    })();\n\n    return {\n      tree: tree,\n      array: array,\n      string: string\n    };\n  })();\n\n  return noam;\n}())));\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? function(obj) { return Object.getPrototypeOf(obj); } : function(obj) { return obj.__proto__; };\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach(function(key) { def[key] = function() { return value[key]; }; });\n\t}\n\tdef['default'] = function() { return value; };\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + \"webfontloader\" + \".\" + \"02ff9497\" + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"dfa-regex:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkdfa_regex\"] = self[\"webpackChunkdfa_regex\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(9952); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","id","module","exports","class","_createElementVNode","_createVNode","_component_v_app","_component_v_main","_component_v_sheet","width","_component_AlphabetLister","_component_v_divider","_component_StateHelper","_hoisted_1","height","color","elevation","_hoisted_2","_component_v_btn_toggle","$setup","m","$event","mandatory","rounded","_createElementBlock","_Fragment","_renderList","tools","t","_createBlock","_component_v_btn","key","name","value","text","_component_v_tooltip","activator","contentClass","_hoisted_3","_toDisplayString","hotkey","_hoisted_4","_hoisted_5","onClick","_cache","mainStore","deleteAll","_hoisted_6","_hoisted_7","_hoisted_8","type","ref","onChange","args","loadJSON","fileinput","click","_component_v_icon","size","_hoisted_9","_hoisted_10","_component_v_dialog","_component_SaveFile","_component_FSMVisualizer","_component_v_text_field","regex","label","hideDetails","variant","onKeydown","_withKeys","genDFA","target","_hoisted_11","_component_SettingsMenu","_component_TransitionFab","InputProcessorKeyboardEvent","ipkey","this","_ipkey","replace","InputProcessor","seperator","activeKeys","ip","states","filter","v","map","ipkeySet","Set","altKey","ctrlKey","shiftKey","split","splitter","at","constructor","ev","_defineProperty","Object","assign","getModifierState","mouse","InputProcessorMouseEvent","cursor","client","structuredClone","screen","lastClick","isDragging","dragDiff","x","y","EventEmitter","__evs__","__any__","has","event","undefined","on","cb","push","onAny","off","i","findIndex","toString","splice","emit","forEach","renameEvent","oldEvent","newEvent","InputProcessorConfig","recognize","capKey","toUpperCase","match","length","charCode","charCodeAt","serialize","Array","isArray","sort","nonModifierIndex","k","MODIFIERS","includes","join","element","config","super","MouseInputModule","c","String","fromCharCode","n","monitor","el","__built_listeners__","bl","removeEventListener","fn","captureMouse","tagName","tabIndex","captureKey","addEventListener","bind","console","warn","__onKeyDown","__onKeyUp","__onFocusOut","toLowerCase","entries","check","every","direction","u","d","l","r","reset","focus","release","_processKeyBoardEvent","ALT","CONTROL","SHIFT","keyprop","active_keys","unshift","combined","ipev","preventDefault","repeat","Coordinate","difference","coord","sum","clone","arr","_monitor","__onClick","__onAuxClick","__onDblClick","__onContextMenu","__onMouseDown","__onMouseUp","__onMouseEnter","__onMouseOver","__onMouseLeave","__onMouseOut","__onMouseMove","processor","_ip","__processMouseEvent__","rect","getBoundingClientRect","screenX","screenY","clientX","left","clientY","top","ipmouse","buttons","Util","genString","len","Math","random","substring","FindHits","s","hits","drawArcFromTwoPoints","ctx","fx","fy","tx","ty","arcAngle","cw","f","Victor","a2","mix","distance","ti","cos","deg2Rad","center","subtract","rotateDeg","norm","multiplyScalar","coa","add","strokeStyle","sa","invert","angle","ea","beginPath","arc","toArray","stroke","closePath","endTangent","startTangent","ctd","ct","start","end","line","moveTo","lineTo","drawArrow","arrowAngle","arrowSize","goIn","o","a","rotateByDeg","fill","PI","deg","rad","navigator","clipboard","writeText","StateOptions","deg360","State","pos","_isDragging","options","defOptions","sq","radius","draw","useMainStore","border","borderColor","bg","labelColor","selected_bg","selected_labelColor","fullWidth","isFinish","fillStyle","ellipse","selected","textAlign","textBaseline","font","fillText","isStart","useForceStore","defineStore","stateStore","useStateStore","transitionStore","useTransitionStore","centerForce","d3","strength","simulation","stop","alphaDecay","alpha","alphaTarget","force","tick","restart","window","update","transitions","nodes","from","to","setDimensions","forceStore","reactive","addState","state","genRegex","getStateIndex","getState","find","removeState","froms","getTransitionsFrom","removeTransition","tos","getTransitionsTo","select","savedStart","setStart","accepting","computed","project","Local","_class","item","def","localStorage","getItem","parsed","JSON","parse","stringify","setItem","alert","get","removeItem","saveAsFile","data","filename","pom","document","createElement","setAttribute","encodeURIComponent","createEvent","initEvent","dispatchEvent","useFileStore","alphabetStore","useAlphabetStore","getFSMAsJSON","alphabet","values","final","saveDFA","loadDFA","log","removeAll","addAlphabet","gen","addTransition","labels","err","useSettingStore","fileStore","simplifyDFARegex","saveFSMOnExit","nfaMode","hideEpsilon","watch","startSync","fsmData","save","set","sync","Transition","source","equalWith","equals","other","addValue","removeValue","str","vdir","vnorm","settingsStore","textPos","tw","measureText","getTransitionIndex","cSet","connected","sLabel","sldir","arcCoverage","arcLoc","angleDeg","touchPoint","ssl","esl","dir","sel","eel","copy","maxArc","minArc","distanceSq","getTransition","MAX_ALHPABET","removeAlphabet","indexOf","ap","trim","resetAlphabet","Drawables","register","instances","isRegistered","gfx","remove","useMouseStore","nx","ny","useModeStore","mousestore","linkingArrow","linkStart","lineWidth","normalize","mode","linkReset","linkEnd","openTransitionDialog","HAS_INITIALIZED","initCanvas","mouseStore","modeStore","canvas","getContext","defineProperty","style","origin","selectedOrigin","ox","oy","clicked","hovering","getMonitor","FSMTransition","fromState","symbol","toStates","FSM","initial","initialState","acceptingStates","fi","index_s","index_tfrom","index_tto","remove_tfrom","remove_tto","res","tout","tins","remove_tall","noam","parseFsmFromString","toRegex","removeUnreachableStates","validate","add_s","add_t","counter","imd","lout","hasPath","outs","ins","lins","remove_s","ft","wrap","sl","et","targets","ts","sd","operation","wrapIfNot","endsWith","nvs","vs","shift","os","processInput","clientWidth","clientHeight","inputFocus","checkForValidity","transition","string","toAutomaton","convertEnfaToNfa","convertNfaToDfa","minimize","convertStatesToNumbers","st","al","acc","ini","trs","h","w","hand","gens","toStateArr","regexResult","formal_specs","tree","simplify","fsm","icon","forceDirectiveEnabled","_normalizeClass","setup","ctxRef","rafID","animate","clearRect","requestAnimationFrame","mounted","beforeUnmount","cancelAnimationFrame","emits","__exports__","resetAble","density","_component_v_container","_component_v_row","align","justify","noGutters","_component_v_col","cols","_component_v_chip","closable","placeholder","temp","maxLength","clearable","store","cancel","open","multiple","selectedItems","disabled","block","ex","toFixed","_component_v_switch","tempIsStart","changeStartStatus","transArr","index","setSelectedState","_component_v_autocomplete","chips","items","updateTransition","_hoisted_12","stateList","tempLabel","_hoisted_13","tempTransitions","associatedTransitions","updateTransArr","expand","copyFormalSpecs","copyToClipboard","components","FSMVisualizer","AlphabetLister","TransitionFab","StateHelper","SettingsMenu","SaveFile","async","file","files","render","createVuetify","directives","theme","defaultTheme","loadFonts","webFontLoader","load","google","families","pinia","createPinia","createApp","App","use","vuetify","mount","define","util","areEquivalent","object1","object2","Date","getTime","RegExp","global","multiline","lastIndex","ignoreCase","p","contains","obj","startIndex","containsAll","arr1","arr2","containsAny","areEqualSets","containsSet","setUnion","setIntersection","makeCounter","getAndAdvance","init","randint","floor","structure","CAPACITY_CHOICES","DEFAULT_INITIAL_CAPACITY_IDX","HASH_MASK","LF_HIGH","LF_LOW","_isArray","prototype","call","_get_capacity_index","wanted","max","min","mid","lo","hi","_defaultHash","props","hasOwnProperty","_defaultEquals","_HashChainNode","_HashChain","_HashChainIterator","chain","node","head","_resize","H","to_cap_idx","old_cap","capacity","old_slots","slots","capacity_index","chain_iter","iterator","hasNext","_putNodeRsz","next","_getSlotIndex","hash","isEmpty","insertHead","removeSuccessor","put","iter","prev","retval","HashTable","cfg","initial_capacity","numkeys","loadFactor","slot","clear","containsKey","it","keyIterator","valueIterator","keyValueIterator","Iterator","cur_chain_iterator","idx","slotval","_next","err_msg","extract_next","each","iterator_func","context","_KeyIterator","_ValueIterator","_KeyValueIterator","create","epsilonSymbol","dfaType","nfaType","enfaType","makeNew","_addStateOrSymbol","undefErrorMsg","existsErrorMsg","stateObj","addSymbol","symObj","addAcceptingState","setInitialState","_addTransition","transitionSymbol","added","addEpsilonTransition","j","isAcceptingState","determineType","fsmType","computeEpsilonClosure","unprocessedStates","targetStates","currentState","pop","makeSimpleTransition","makeTransition","readString","inputSymbolStream","transitionTrail","trail","isStringInLanguage","printTable","Table","require","colHeads","concat","table","chars","truncate","tableRows","colNum","rowNum","serializeFsmToString","lines","fsm_string","parseState","parseCounts","substr","ac","state_rest","parts","left_right","al_t","st_t","printHtmlTable","headers","htmlString","printDotFormat","trans","result","accStates","initStateArrow","newTransitions","found","newTransition","getReachableStates","shouldIncludeInitialState","reachableStates","newFsm","areEquivalentStates","fsmA","stateA","fsmB","stateB","doBothStatesHaveSameAcceptance","fsmX","stateX","fsmY","stateY","stateXAccepting","stateYAccepting","unprocessedPairs","processedPairs","currentPair","pair","areEquivalentFSMs","removeEquivalentStates","equivalentPairs","isOneOfEquivalentStates","getEquivalentState","fsmWithoutUnreachableStates","minimalFsm","mapping","newToStates","createRandomFsm","numStates","numAlphabet","maxNumToStates","prefix","ch","num","retStr","round","numToStates","diff","newStates","errorAdded","errorState","initialEpsilon","multiStateTransitions","existing","isLanguageNonEmpty","isLanguageInfinite","reachable","deadState","randomStringInLanguage","reverse","randomStringNotInLanguage","nonAcceptingStates","union","newState","intersection","new_alphabet","complement","newAccepting","concatenation","kleene","newInitial","oldAcceptingStates","newInitialState","isSubset","fsmIntersection","grammar","nonterminals","terminals","initialNonterminal","productions","right","symbolsForTransitions","z","symbols","re","makeLit","makeEps","makeAlt","t1","choices","t2","seq","tag","tags","EPS","makeSeq","makeKStar","alt","startStateIndex","acceptableStatesIndexes","elements","regType","cfgType","csgType","unrestrictedType","production","indexOfNonterminal","isRightRegular","rightNonTerminalCount","leftNonTerminalCount","slice","sufix","printAscii","slimProds","foundSlim","prod","SEQ","KSTAR","LIT","copyAndDeleteProperties","o1","o2","_regex_simplification_patterns","_regex_simplify_1","fsmCache","_regex_simplify_2","_regex_simplify_3","expr","_regex_simplify_4","_regex_simplify_5","_regex_simplify_6","epsIndex","kstarIndex","_regex_simplify_7","_regex_simplify_8","_regex_simplify_9","_regex_simplify_10","_regex_simplify_11","_regex_simplify_12","_regex_simplify_13","_regex_simplify_14","_regex_simplify_15","_regex_simplify_16","first","rest1","rest2","_alt","_seq","_regex_simplify_17","_regex_simplify_18","last","_regex_simplify_19","fsms","getFromCacheOrCreateFsm","_regex_simplify_20","ht","_regex_simplify_21","_regex_simplify_22","index_eps","_regex_simplify_23","internal","_regex_simplify_24","_regex_simplify_27","eps","fsm_kstar","fsm_other","_regex_simplify_25","_regex_simplify_26","treeClone","opts","numIterations","appliedPatterns","useFsmPatterns","appliedPattern","iterCount","_simplify_iteration","pattern","_simplify_recursion","patternFunction","children","epsNode","_altToAutomaton","automaton","stateCounter","statePair","_dispatchToAutomaton","_seqToAutomaton","_KStarToAutomaton","inner","ll","rr","_litToAutomaton","_epsToAutomaton","_toAutomatonFuns","_prec","_needParens","par","child","_optParenToArray","parens","array","specials","LEFT_PAREN","_dispatchToArray","RIGHT_PAREN","_binOpToArray","operand","_altToArray","_seqToArray","_KStarToArray","_litToArray","_epsToArray","_toArrayFuns","numSymbols","altp","kleenep","epsp","ALT_PROB","KLEENE_PROB","EPS_PROB","_randomKleene","_randomExpr","left_sz","RegexError","message","position","_peek","_advance","_makeInputSeq","peek","advance","toTree","input","_parseExpr","_replacementStr","_escape","chr","escapable","elem","failed","concats","_parseConcat","katom","katoms","_parseKatom","atom","_parseAtom","sym","treeSimplified","escaped","charAt","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","deferred","O","chunkIds","priority","notFulfilled","Infinity","fulfilled","getter","__esModule","leafPrototypes","getProto","getPrototypeOf","__proto__","then","ns","current","getOwnPropertyNames","definition","enumerable","chunkId","Promise","all","reduce","promises","miniCssF","g","globalThis","Function","prop","inProgress","dataWebpackPrefix","url","done","script","needAttach","scripts","getElementsByTagName","getAttribute","charset","timeout","nc","src","onScriptComplete","onerror","onload","clearTimeout","doneFns","parentNode","removeChild","setTimeout","appendChild","Symbol","toStringTag","installedChunks","installedChunkData","promise","reject","error","loadingEnded","errorType","realSrc","request","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}